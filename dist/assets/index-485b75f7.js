(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))u(m);new MutationObserver(m=>{for(const x of m)if(x.type==="childList")for(const B of x.addedNodes)B.tagName==="LINK"&&B.rel==="modulepreload"&&u(B)}).observe(document,{childList:!0,subtree:!0});function a(m){const x={};return m.integrity&&(x.integrity=m.integrity),m.referrerPolicy&&(x.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?x.credentials="include":m.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function u(m){if(m.ep)return;m.ep=!0;const x=a(m);fetch(m.href,x)}})();var po=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var QB={exports:{}},yr={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var mx=Object.getOwnPropertySymbols,ZF=Object.prototype.hasOwnProperty,XF=Object.prototype.propertyIsEnumerable;function WF(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function $F(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var o={},a=0;a<10;a++)o["_"+String.fromCharCode(a)]=a;var u=Object.getOwnPropertyNames(o).map(function(x){return o[x]});if(u.join("")!=="0123456789")return!1;var m={};return"abcdefghijklmnopqrst".split("").forEach(function(x){m[x]=x}),Object.keys(Object.assign({},m)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var MB=$F()?Object.assign:function(t,o){for(var a,u=WF(t),m,x=1;x<arguments.length;x++){a=Object(arguments[x]);for(var B in a)ZF.call(a,B)&&(u[B]=a[B]);if(mx){m=mx(a);for(var s=0;s<m.length;s++)XF.call(a,m[s])&&(u[m[s]]=a[m[s]])}}return u};/** @license React v17.0.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d_=MB,Bc=60103,LB=60106;yr.Fragment=60107;yr.StrictMode=60108;yr.Profiler=60114;var DB=60109,kB=60110,PB=60112;yr.Suspense=60113;var OB=60115,RB=60116;if(typeof Symbol=="function"&&Symbol.for){var es=Symbol.for;Bc=es("react.element"),LB=es("react.portal"),yr.Fragment=es("react.fragment"),yr.StrictMode=es("react.strict_mode"),yr.Profiler=es("react.profiler"),DB=es("react.provider"),kB=es("react.context"),PB=es("react.forward_ref"),yr.Suspense=es("react.suspense"),OB=es("react.memo"),RB=es("react.lazy")}var gx=typeof Symbol=="function"&&Symbol.iterator;function qF(t){return t===null||typeof t!="object"?null:(t=gx&&t[gx]||t["@@iterator"],typeof t=="function"?t:null)}function Sh(t){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+t,a=1;a<arguments.length;a++)o+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+t+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},HB={};function bc(t,o,a){this.props=t,this.context=o,this.refs=HB,this.updater=a||zB}bc.prototype.isReactComponent={};bc.prototype.setState=function(t,o){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error(Sh(85));this.updater.enqueueSetState(this,t,o,"setState")};bc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function NB(){}NB.prototype=bc.prototype;function f_(t,o,a){this.props=t,this.context=o,this.refs=HB,this.updater=a||zB}var p_=f_.prototype=new NB;p_.constructor=f_;d_(p_,bc.prototype);p_.isPureReactComponent=!0;var m_={current:null},VB=Object.prototype.hasOwnProperty,KB={key:!0,ref:!0,__self:!0,__source:!0};function GB(t,o,a){var u,m={},x=null,B=null;if(o!=null)for(u in o.ref!==void 0&&(B=o.ref),o.key!==void 0&&(x=""+o.key),o)VB.call(o,u)&&!KB.hasOwnProperty(u)&&(m[u]=o[u]);var s=arguments.length-2;if(s===1)m.children=a;else if(1<s){for(var F=Array(s),M=0;M<s;M++)F[M]=arguments[M+2];m.children=F}if(t&&t.defaultProps)for(u in s=t.defaultProps,s)m[u]===void 0&&(m[u]=s[u]);return{$$typeof:Bc,type:t,key:x,ref:B,props:m,_owner:m_.current}}function JF(t,o){return{$$typeof:Bc,type:t.type,key:o,ref:t.ref,props:t.props,_owner:t._owner}}function g_(t){return typeof t=="object"&&t!==null&&t.$$typeof===Bc}function YF(t){var o={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(a){return o[a]})}var yx=/\/+/g;function dg(t,o){return typeof t=="object"&&t!==null&&t.key!=null?YF(""+t.key):o.toString(36)}function zf(t,o,a,u,m){var x=typeof t;(x==="undefined"||x==="boolean")&&(t=null);var B=!1;if(t===null)B=!0;else switch(x){case"string":case"number":B=!0;break;case"object":switch(t.$$typeof){case Bc:case LB:B=!0}}if(B)return B=t,m=m(B),t=u===""?"."+dg(B,0):u,Array.isArray(m)?(a="",t!=null&&(a=t.replace(yx,"$&/")+"/"),zf(m,o,a,"",function(M){return M})):m!=null&&(g_(m)&&(m=JF(m,a+(!m.key||B&&B.key===m.key?"":(""+m.key).replace(yx,"$&/")+"/")+t)),o.push(m)),1;if(B=0,u=u===""?".":u+":",Array.isArray(t))for(var s=0;s<t.length;s++){x=t[s];var F=u+dg(x,s);B+=zf(x,o,a,F,m)}else if(F=qF(t),typeof F=="function")for(t=F.call(t),s=0;!(x=t.next()).done;)x=x.value,F=u+dg(x,s++),B+=zf(x,o,a,F,m);else if(x==="object")throw o=""+t,Error(Sh(31,o==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":o));return B}function nf(t,o,a){if(t==null)return t;var u=[],m=0;return zf(t,u,"","",function(x){return o.call(a,x,m++)}),u}function e2(t){if(t._status===-1){var o=t._result;o=o(),t._status=0,t._result=o,o.then(function(a){t._status===0&&(a=a.default,t._status=1,t._result=a)},function(a){t._status===0&&(t._status=2,t._result=a)})}if(t._status===1)return t._result;throw t._result}var jB={current:null};function sa(){var t=jB.current;if(t===null)throw Error(Sh(321));return t}var t2={ReactCurrentDispatcher:jB,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:m_,IsSomeRendererActing:{current:!1},assign:d_};yr.Children={map:nf,forEach:function(t,o,a){nf(t,function(){o.apply(this,arguments)},a)},count:function(t){var o=0;return nf(t,function(){o++}),o},toArray:function(t){return nf(t,function(o){return o})||[]},only:function(t){if(!g_(t))throw Error(Sh(143));return t}};yr.Component=bc;yr.PureComponent=f_;yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=t2;yr.cloneElement=function(t,o,a){if(t==null)throw Error(Sh(267,t));var u=d_({},t.props),m=t.key,x=t.ref,B=t._owner;if(o!=null){if(o.ref!==void 0&&(x=o.ref,B=m_.current),o.key!==void 0&&(m=""+o.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(F in o)VB.call(o,F)&&!KB.hasOwnProperty(F)&&(u[F]=o[F]===void 0&&s!==void 0?s[F]:o[F])}var F=arguments.length-2;if(F===1)u.children=a;else if(1<F){s=Array(F);for(var M=0;M<F;M++)s[M]=arguments[M+2];u.children=s}return{$$typeof:Bc,type:t.type,key:m,ref:x,props:u,_owner:B}};yr.createContext=function(t,o){return o===void 0&&(o=null),t={$$typeof:kB,_calculateChangedBits:o,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider={$$typeof:DB,_context:t},t.Consumer=t};yr.createElement=GB;yr.createFactory=function(t){var o=GB.bind(null,t);return o.type=t,o};yr.createRef=function(){return{current:null}};yr.forwardRef=function(t){return{$$typeof:PB,render:t}};yr.isValidElement=g_;yr.lazy=function(t){return{$$typeof:RB,_payload:{_status:-1,_result:t},_init:e2}};yr.memo=function(t,o){return{$$typeof:OB,type:t,compare:o===void 0?null:o}};yr.useCallback=function(t,o){return sa().useCallback(t,o)};yr.useContext=function(t,o){return sa().useContext(t,o)};yr.useDebugValue=function(){};yr.useEffect=function(t,o){return sa().useEffect(t,o)};yr.useImperativeHandle=function(t,o,a){return sa().useImperativeHandle(t,o,a)};yr.useLayoutEffect=function(t,o){return sa().useLayoutEffect(t,o)};yr.useMemo=function(t,o){return sa().useMemo(t,o)};yr.useReducer=function(t,o,a){return sa().useReducer(t,o,a)};yr.useRef=function(t){return sa().useRef(t)};yr.useState=function(t){return sa().useState(t)};yr.version="17.0.2";QB.exports=yr;var Pa=QB.exports;const Mo=Dp(Pa);var ZB={exports:{}},No={},XB={exports:{}},WB={};/** @license React v0.20.2
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){var o,a,u,m;if(typeof performance=="object"&&typeof performance.now=="function"){var x=performance;t.unstable_now=function(){return x.now()}}else{var B=Date,s=B.now();t.unstable_now=function(){return B.now()-s}}if(typeof window>"u"||typeof MessageChannel!="function"){var F=null,M=null,z=function(){if(F!==null)try{var Je=t.unstable_now();F(!0,Je),F=null}catch(yt){throw setTimeout(z,0),yt}};o=function(Je){F!==null?setTimeout(o,0,Je):(F=Je,setTimeout(z,0))},a=function(Je,yt){M=setTimeout(Je,yt)},u=function(){clearTimeout(M)},t.unstable_shouldYield=function(){return!1},m=t.unstable_forceFrameRate=function(){}}else{var L=window.setTimeout,Q=window.clearTimeout;if(typeof console<"u"){var V=window.cancelAnimationFrame;typeof window.requestAnimationFrame!="function"&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),typeof V!="function"&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var ie=!1,de=null,re=-1,K=5,G=0;t.unstable_shouldYield=function(){return t.unstable_now()>=G},m=function(){},t.unstable_forceFrameRate=function(Je){0>Je||125<Je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<Je?Math.floor(1e3/Je):5};var ne=new MessageChannel,oe=ne.port2;ne.port1.onmessage=function(){if(de!==null){var Je=t.unstable_now();G=Je+K;try{de(!0,Je)?oe.postMessage(null):(ie=!1,de=null)}catch(yt){throw oe.postMessage(null),yt}}else ie=!1},o=function(Je){de=Je,ie||(ie=!0,oe.postMessage(null))},a=function(Je,yt){re=L(function(){Je(t.unstable_now())},yt)},u=function(){Q(re),re=-1}}function we(Je,yt){var ke=Je.length;Je.push(yt);e:for(;;){var xt=ke-1>>>1,Se=Je[xt];if(Se!==void 0&&0<Ke(Se,yt))Je[xt]=yt,Je[ke]=Se,ke=xt;else break e}}function ge(Je){return Je=Je[0],Je===void 0?null:Je}function Ue(Je){var yt=Je[0];if(yt!==void 0){var ke=Je.pop();if(ke!==yt){Je[0]=ke;e:for(var xt=0,Se=Je.length;xt<Se;){var ot=2*(xt+1)-1,vt=Je[ot],Ot=ot+1,nt=Je[Ot];if(vt!==void 0&&0>Ke(vt,ke))nt!==void 0&&0>Ke(nt,vt)?(Je[xt]=nt,Je[Ot]=ke,xt=Ot):(Je[xt]=vt,Je[ot]=ke,xt=ot);else if(nt!==void 0&&0>Ke(nt,ke))Je[xt]=nt,Je[Ot]=ke,xt=Ot;else break e}}return yt}return null}function Ke(Je,yt){var ke=Je.sortIndex-yt.sortIndex;return ke!==0?ke:Je.id-yt.id}var Me=[],et=[],qe=1,it=null,Xe=3,Ne=!1,At=!1,Et=!1;function It(Je){for(var yt=ge(et);yt!==null;){if(yt.callback===null)Ue(et);else if(yt.startTime<=Je)Ue(et),yt.sortIndex=yt.expirationTime,we(Me,yt);else break;yt=ge(et)}}function Ut(Je){if(Et=!1,It(Je),!At)if(ge(Me)!==null)At=!0,o(Dt);else{var yt=ge(et);yt!==null&&a(Ut,yt.startTime-Je)}}function Dt(Je,yt){At=!1,Et&&(Et=!1,u()),Ne=!0;var ke=Xe;try{for(It(yt),it=ge(Me);it!==null&&(!(it.expirationTime>yt)||Je&&!t.unstable_shouldYield());){var xt=it.callback;if(typeof xt=="function"){it.callback=null,Xe=it.priorityLevel;var Se=xt(it.expirationTime<=yt);yt=t.unstable_now(),typeof Se=="function"?it.callback=Se:it===ge(Me)&&Ue(Me),It(yt)}else Ue(Me);it=ge(Me)}if(it!==null)var ot=!0;else{var vt=ge(et);vt!==null&&a(Ut,vt.startTime-yt),ot=!1}return ot}finally{it=null,Xe=ke,Ne=!1}}var Vt=m;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Je){Je.callback=null},t.unstable_continueExecution=function(){At||Ne||(At=!0,o(Dt))},t.unstable_getCurrentPriorityLevel=function(){return Xe},t.unstable_getFirstCallbackNode=function(){return ge(Me)},t.unstable_next=function(Je){switch(Xe){case 1:case 2:case 3:var yt=3;break;default:yt=Xe}var ke=Xe;Xe=yt;try{return Je()}finally{Xe=ke}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=Vt,t.unstable_runWithPriority=function(Je,yt){switch(Je){case 1:case 2:case 3:case 4:case 5:break;default:Je=3}var ke=Xe;Xe=Je;try{return yt()}finally{Xe=ke}},t.unstable_scheduleCallback=function(Je,yt,ke){var xt=t.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?xt+ke:xt):ke=xt,Je){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=ke+Se,Je={id:qe++,callback:yt,priorityLevel:Je,startTime:ke,expirationTime:Se,sortIndex:-1},ke>xt?(Je.sortIndex=ke,we(et,Je),ge(Me)===null&&Je===ge(et)&&(Et?u():Et=!0,a(Ut,ke-xt))):(Je.sortIndex=Se,we(Me,Je),At||Ne||(At=!0,o(Dt))),Je},t.unstable_wrapCallback=function(Je){var yt=Xe;return function(){var ke=Xe;Xe=yt;try{return Je.apply(this,arguments)}finally{Xe=ke}}}})(WB);XB.exports=WB;var r2=XB.exports;/** @license React v17.0.2
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kp=Pa,rn=MB,ii=r2;function _t(t){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+t,a=1;a<arguments.length;a++)o+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+t+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!kp)throw Error(_t(227));var $B=new Set,fh={};function $A(t,o){yc(t,o),yc(t+"Capture",o)}function yc(t,o){for(fh[t]=o,t=0;t<o.length;t++)$B.add(o[t])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),n2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_x=Object.prototype.hasOwnProperty,vx={},xx={};function i2(t){return _x.call(xx,t)?!0:_x.call(vx,t)?!1:n2.test(t)?xx[t]=!0:(vx[t]=!0,!1)}function o2(t,o,a,u){if(a!==null&&a.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return u?!1:a!==null?!a.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function s2(t,o,a,u){if(o===null||typeof o>"u"||o2(t,o,a,u))return!0;if(u)return!1;if(a!==null)switch(a.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function Vi(t,o,a,u,m,x,B){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=u,this.attributeNamespace=m,this.mustUseProperty=a,this.propertyName=t,this.type=o,this.sanitizeURL=x,this.removeEmptyString=B}var pi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){pi[t]=new Vi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var o=t[0];pi[o]=new Vi(o,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){pi[t]=new Vi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){pi[t]=new Vi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){pi[t]=new Vi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){pi[t]=new Vi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){pi[t]=new Vi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){pi[t]=new Vi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){pi[t]=new Vi(t,5,!1,t.toLowerCase(),null,!1,!1)});var y_=/[\-:]([a-z])/g;function __(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var o=t.replace(y_,__);pi[o]=new Vi(o,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var o=t.replace(y_,__);pi[o]=new Vi(o,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var o=t.replace(y_,__);pi[o]=new Vi(o,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){pi[t]=new Vi(t,1,!1,t.toLowerCase(),null,!1,!1)});pi.xlinkHref=new Vi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){pi[t]=new Vi(t,1,!1,t.toLowerCase(),null,!0,!0)});function v_(t,o,a,u){var m=pi.hasOwnProperty(o)?pi[o]:null,x=m!==null?m.type===0:u?!1:!(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N");x||(s2(o,a,m,u)&&(a=null),u||m===null?i2(o)&&(a===null?t.removeAttribute(o):t.setAttribute(o,""+a)):m.mustUseProperty?t[m.propertyName]=a===null?m.type===3?!1:"":a:(o=m.attributeName,u=m.attributeNamespace,a===null?t.removeAttribute(o):(m=m.type,a=m===3||m===4&&a===!0?"":""+a,u?t.setAttributeNS(u,o,a):t.setAttribute(o,a))))}var qA=kp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ru=60103,OA=60106,za=60107,x_=60108,qu=60114,w_=60109,B_=60110,Pp=60112,Ju=60113,rp=60120,Op=60115,b_=60116,C_=60121,E_=60128,qB=60129,F_=60130,iy=60131;if(typeof Symbol=="function"&&Symbol.for){var ri=Symbol.for;Ru=ri("react.element"),OA=ri("react.portal"),za=ri("react.fragment"),x_=ri("react.strict_mode"),qu=ri("react.profiler"),w_=ri("react.provider"),B_=ri("react.context"),Pp=ri("react.forward_ref"),Ju=ri("react.suspense"),rp=ri("react.suspense_list"),Op=ri("react.memo"),b_=ri("react.lazy"),C_=ri("react.block"),ri("react.scope"),E_=ri("react.opaque.id"),qB=ri("react.debug_trace_mode"),F_=ri("react.offscreen"),iy=ri("react.legacy_hidden")}var wx=typeof Symbol=="function"&&Symbol.iterator;function Bu(t){return t===null||typeof t!="object"?null:(t=wx&&t[wx]||t["@@iterator"],typeof t=="function"?t:null)}var fg;function zu(t){if(fg===void 0)try{throw Error()}catch(a){var o=a.stack.trim().match(/\n( *(at )?)/);fg=o&&o[1]||""}return`
`+fg+t}var pg=!1;function of(t,o){if(!t||pg)return"";pg=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(F){var u=F}Reflect.construct(t,[],o)}else{try{o.call()}catch(F){u=F}t.call(o.prototype)}else{try{throw Error()}catch(F){u=F}t()}}catch(F){if(F&&u&&typeof F.stack=="string"){for(var m=F.stack.split(`
`),x=u.stack.split(`
`),B=m.length-1,s=x.length-1;1<=B&&0<=s&&m[B]!==x[s];)s--;for(;1<=B&&0<=s;B--,s--)if(m[B]!==x[s]){if(B!==1||s!==1)do if(B--,s--,0>s||m[B]!==x[s])return`
`+m[B].replace(" at new "," at ");while(1<=B&&0<=s);break}}}finally{pg=!1,Error.prepareStackTrace=a}return(t=t?t.displayName||t.name:"")?zu(t):""}function a2(t){switch(t.tag){case 5:return zu(t.type);case 16:return zu("Lazy");case 13:return zu("Suspense");case 19:return zu("SuspenseList");case 0:case 2:case 15:return t=of(t.type,!1),t;case 11:return t=of(t.type.render,!1),t;case 22:return t=of(t.type._render,!1),t;case 1:return t=of(t.type,!0),t;default:return""}}function ac(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case za:return"Fragment";case OA:return"Portal";case qu:return"Profiler";case x_:return"StrictMode";case Ju:return"Suspense";case rp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case B_:return(t.displayName||"Context")+".Consumer";case w_:return(t._context.displayName||"Context")+".Provider";case Pp:var o=t.render;return o=o.displayName||o.name||"",t.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case Op:return ac(t.type);case C_:return ac(t._render);case b_:o=t._payload,t=t._init;try{return ac(t(o))}catch{}}return null}function nA(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function JB(t){var o=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function A2(t){var o=JB(t)?"checked":"value",a=Object.getOwnPropertyDescriptor(t.constructor.prototype,o),u=""+t[o];if(!t.hasOwnProperty(o)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var m=a.get,x=a.set;return Object.defineProperty(t,o,{configurable:!0,get:function(){return m.call(this)},set:function(B){u=""+B,x.call(this,B)}}),Object.defineProperty(t,o,{enumerable:a.enumerable}),{getValue:function(){return u},setValue:function(B){u=""+B},stopTracking:function(){t._valueTracker=null,delete t[o]}}}}function sf(t){t._valueTracker||(t._valueTracker=A2(t))}function YB(t){if(!t)return!1;var o=t._valueTracker;if(!o)return!0;var a=o.getValue(),u="";return t&&(u=JB(t)?t.checked?"true":"false":t.value),t=u,t!==a?(o.setValue(t),!0):!1}function np(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function oy(t,o){var a=o.checked;return rn({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??t._wrapperState.initialChecked})}function Bx(t,o){var a=o.defaultValue==null?"":o.defaultValue,u=o.checked!=null?o.checked:o.defaultChecked;a=nA(o.value!=null?o.value:a),t._wrapperState={initialChecked:u,initialValue:a,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function e1(t,o){o=o.checked,o!=null&&v_(t,"checked",o,!1)}function sy(t,o){e1(t,o);var a=nA(o.value),u=o.type;if(a!=null)u==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+a):t.value!==""+a&&(t.value=""+a);else if(u==="submit"||u==="reset"){t.removeAttribute("value");return}o.hasOwnProperty("value")?ay(t,o.type,a):o.hasOwnProperty("defaultValue")&&ay(t,o.type,nA(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(t.defaultChecked=!!o.defaultChecked)}function bx(t,o,a){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var u=o.type;if(!(u!=="submit"&&u!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+t._wrapperState.initialValue,a||o===t.value||(t.value=o),t.defaultValue=o}a=t.name,a!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,a!==""&&(t.name=a)}function ay(t,o,a){(o!=="number"||np(t.ownerDocument)!==t)&&(a==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+a&&(t.defaultValue=""+a))}function l2(t){var o="";return kp.Children.forEach(t,function(a){a!=null&&(o+=a)}),o}function Ay(t,o){return t=rn({children:void 0},o),(o=l2(o.children))&&(t.children=o),t}function Ac(t,o,a,u){if(t=t.options,o){o={};for(var m=0;m<a.length;m++)o["$"+a[m]]=!0;for(a=0;a<t.length;a++)m=o.hasOwnProperty("$"+t[a].value),t[a].selected!==m&&(t[a].selected=m),m&&u&&(t[a].defaultSelected=!0)}else{for(a=""+nA(a),o=null,m=0;m<t.length;m++){if(t[m].value===a){t[m].selected=!0,u&&(t[m].defaultSelected=!0);return}o!==null||t[m].disabled||(o=t[m])}o!==null&&(o.selected=!0)}}function ly(t,o){if(o.dangerouslySetInnerHTML!=null)throw Error(_t(91));return rn({},o,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Cx(t,o){var a=o.value;if(a==null){if(a=o.children,o=o.defaultValue,a!=null){if(o!=null)throw Error(_t(92));if(Array.isArray(a)){if(!(1>=a.length))throw Error(_t(93));a=a[0]}o=a}o==null&&(o=""),a=o}t._wrapperState={initialValue:nA(a)}}function t1(t,o){var a=nA(o.value),u=nA(o.defaultValue);a!=null&&(a=""+a,a!==t.value&&(t.value=a),o.defaultValue==null&&t.defaultValue!==a&&(t.defaultValue=a)),u!=null&&(t.defaultValue=""+u)}function Ex(t){var o=t.textContent;o===t._wrapperState.initialValue&&o!==""&&o!==null&&(t.value=o)}var cy={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function r1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function uy(t,o){return t==null||t==="http://www.w3.org/1999/xhtml"?r1(o):t==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var af,n1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,a,u,m){MSApp.execUnsafeLocalFunction(function(){return t(o,a,u,m)})}:t}(function(t,o){if(t.namespaceURI!==cy.svg||"innerHTML"in t)t.innerHTML=o;else{for(af=af||document.createElement("div"),af.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=af.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;o.firstChild;)t.appendChild(o.firstChild)}});function ph(t,o){if(o){var a=t.firstChild;if(a&&a===t.lastChild&&a.nodeType===3){a.nodeValue=o;return}}t.textContent=o}var Yu={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},c2=["Webkit","ms","Moz","O"];Object.keys(Yu).forEach(function(t){c2.forEach(function(o){o=o+t.charAt(0).toUpperCase()+t.substring(1),Yu[o]=Yu[t]})});function i1(t,o,a){return o==null||typeof o=="boolean"||o===""?"":a||typeof o!="number"||o===0||Yu.hasOwnProperty(t)&&Yu[t]?(""+o).trim():o+"px"}function o1(t,o){t=t.style;for(var a in o)if(o.hasOwnProperty(a)){var u=a.indexOf("--")===0,m=i1(a,o[a],u);a==="float"&&(a="cssFloat"),u?t.setProperty(a,m):t[a]=m}}var u2=rn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hy(t,o){if(o){if(u2[t]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(_t(137,t));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(_t(60));if(!(typeof o.dangerouslySetInnerHTML=="object"&&"__html"in o.dangerouslySetInnerHTML))throw Error(_t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(_t(62))}}function dy(t,o){if(t.indexOf("-")===-1)return typeof o.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function I_(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fy=null,lc=null,cc=null;function Fx(t){if(t=Mh(t)){if(typeof fy!="function")throw Error(_t(280));var o=t.stateNode;o&&(o=Kp(o),fy(t.stateNode,t.type,o))}}function s1(t){lc?cc?cc.push(t):cc=[t]:lc=t}function a1(){if(lc){var t=lc,o=cc;if(cc=lc=null,Fx(t),o)for(t=0;t<o.length;t++)Fx(o[t])}}function T_(t,o){return t(o)}function A1(t,o,a,u,m){return t(o,a,u,m)}function U_(){}var l1=T_,RA=!1,mg=!1;function S_(){(lc!==null||cc!==null)&&(U_(),a1())}function h2(t,o,a){if(mg)return t(o,a);mg=!0;try{return l1(t,o,a)}finally{mg=!1,S_()}}function mh(t,o){var a=t.stateNode;if(a===null)return null;var u=Kp(a);if(u===null)return null;a=u[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(t=t.type,u=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!u;break e;default:t=!1}if(t)return null;if(a&&typeof a!="function")throw Error(_t(231,o,typeof a));return a}var py=!1;if(ia)try{var bu={};Object.defineProperty(bu,"passive",{get:function(){py=!0}}),window.addEventListener("test",bu,bu),window.removeEventListener("test",bu,bu)}catch{py=!1}function d2(t,o,a,u,m,x,B,s,F){var M=Array.prototype.slice.call(arguments,3);try{o.apply(a,M)}catch(z){this.onError(z)}}var eh=!1,ip=null,op=!1,my=null,f2={onError:function(t){eh=!0,ip=t}};function p2(t,o,a,u,m,x,B,s,F){eh=!1,ip=null,d2.apply(f2,arguments)}function m2(t,o,a,u,m,x,B,s,F){if(p2.apply(this,arguments),eh){if(eh){var M=ip;eh=!1,ip=null}else throw Error(_t(198));op||(op=!0,my=M)}}function JA(t){var o=t,a=t;if(t.alternate)for(;o.return;)o=o.return;else{t=o;do o=t,o.flags&1026&&(a=o.return),t=o.return;while(t)}return o.tag===3?a:null}function c1(t){if(t.tag===13){var o=t.memoizedState;if(o===null&&(t=t.alternate,t!==null&&(o=t.memoizedState)),o!==null)return o.dehydrated}return null}function Ix(t){if(JA(t)!==t)throw Error(_t(188))}function g2(t){var o=t.alternate;if(!o){if(o=JA(t),o===null)throw Error(_t(188));return o!==t?null:t}for(var a=t,u=o;;){var m=a.return;if(m===null)break;var x=m.alternate;if(x===null){if(u=m.return,u!==null){a=u;continue}break}if(m.child===x.child){for(x=m.child;x;){if(x===a)return Ix(m),t;if(x===u)return Ix(m),o;x=x.sibling}throw Error(_t(188))}if(a.return!==u.return)a=m,u=x;else{for(var B=!1,s=m.child;s;){if(s===a){B=!0,a=m,u=x;break}if(s===u){B=!0,u=m,a=x;break}s=s.sibling}if(!B){for(s=x.child;s;){if(s===a){B=!0,a=x,u=m;break}if(s===u){B=!0,u=x,a=m;break}s=s.sibling}if(!B)throw Error(_t(189))}}if(a.alternate!==u)throw Error(_t(190))}if(a.tag!==3)throw Error(_t(188));return a.stateNode.current===a?t:o}function u1(t){if(t=g2(t),!t)return null;for(var o=t;;){if(o.tag===5||o.tag===6)return o;if(o.child)o.child.return=o,o=o.child;else{if(o===t)break;for(;!o.sibling;){if(!o.return||o.return===t)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}}return null}function Tx(t,o){for(var a=t.alternate;o!==null;){if(o===t||o===a)return!0;o=o.return}return!1}var h1,Q_,d1,f1,gy=!1,Ts=[],Za=null,Xa=null,Wa=null,gh=new Map,yh=new Map,Cu=[],Ux="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yy(t,o,a,u,m){return{blockedOn:t,domEventName:o,eventSystemFlags:a|16,nativeEvent:m,targetContainers:[u]}}function Sx(t,o){switch(t){case"focusin":case"focusout":Za=null;break;case"dragenter":case"dragleave":Xa=null;break;case"mouseover":case"mouseout":Wa=null;break;case"pointerover":case"pointerout":gh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":yh.delete(o.pointerId)}}function Eu(t,o,a,u,m,x){return t===null||t.nativeEvent!==x?(t=yy(o,a,u,m,x),o!==null&&(o=Mh(o),o!==null&&Q_(o)),t):(t.eventSystemFlags|=u,o=t.targetContainers,m!==null&&o.indexOf(m)===-1&&o.push(m),t)}function y2(t,o,a,u,m){switch(o){case"focusin":return Za=Eu(Za,t,o,a,u,m),!0;case"dragenter":return Xa=Eu(Xa,t,o,a,u,m),!0;case"mouseover":return Wa=Eu(Wa,t,o,a,u,m),!0;case"pointerover":var x=m.pointerId;return gh.set(x,Eu(gh.get(x)||null,t,o,a,u,m)),!0;case"gotpointercapture":return x=m.pointerId,yh.set(x,Eu(yh.get(x)||null,t,o,a,u,m)),!0}return!1}function _2(t){var o=zA(t.target);if(o!==null){var a=JA(o);if(a!==null){if(o=a.tag,o===13){if(o=c1(a),o!==null){t.blockedOn=o,f1(t.lanePriority,function(){ii.unstable_runWithPriority(t.priority,function(){d1(a)})});return}}else if(o===3&&a.stateNode.hydrate){t.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hf(t){if(t.blockedOn!==null)return!1;for(var o=t.targetContainers;0<o.length;){var a=k_(t.domEventName,t.eventSystemFlags,o[0],t.nativeEvent);if(a!==null)return o=Mh(a),o!==null&&Q_(o),t.blockedOn=a,!1;o.shift()}return!0}function Qx(t,o,a){Hf(t)&&a.delete(o)}function v2(){for(gy=!1;0<Ts.length;){var t=Ts[0];if(t.blockedOn!==null){t=Mh(t.blockedOn),t!==null&&h1(t);break}for(var o=t.targetContainers;0<o.length;){var a=k_(t.domEventName,t.eventSystemFlags,o[0],t.nativeEvent);if(a!==null){t.blockedOn=a;break}o.shift()}t.blockedOn===null&&Ts.shift()}Za!==null&&Hf(Za)&&(Za=null),Xa!==null&&Hf(Xa)&&(Xa=null),Wa!==null&&Hf(Wa)&&(Wa=null),gh.forEach(Qx),yh.forEach(Qx)}function Fu(t,o){t.blockedOn===o&&(t.blockedOn=null,gy||(gy=!0,ii.unstable_scheduleCallback(ii.unstable_NormalPriority,v2)))}function p1(t){function o(m){return Fu(m,t)}if(0<Ts.length){Fu(Ts[0],t);for(var a=1;a<Ts.length;a++){var u=Ts[a];u.blockedOn===t&&(u.blockedOn=null)}}for(Za!==null&&Fu(Za,t),Xa!==null&&Fu(Xa,t),Wa!==null&&Fu(Wa,t),gh.forEach(o),yh.forEach(o),a=0;a<Cu.length;a++)u=Cu[a],u.blockedOn===t&&(u.blockedOn=null);for(;0<Cu.length&&(a=Cu[0],a.blockedOn===null);)_2(a),a.blockedOn===null&&Cu.shift()}function Af(t,o){var a={};return a[t.toLowerCase()]=o.toLowerCase(),a["Webkit"+t]="webkit"+o,a["Moz"+t]="moz"+o,a}var ec={animationend:Af("Animation","AnimationEnd"),animationiteration:Af("Animation","AnimationIteration"),animationstart:Af("Animation","AnimationStart"),transitionend:Af("Transition","TransitionEnd")},gg={},m1={};ia&&(m1=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function Rp(t){if(gg[t])return gg[t];if(!ec[t])return t;var o=ec[t],a;for(a in o)if(o.hasOwnProperty(a)&&a in m1)return gg[t]=o[a];return t}var g1=Rp("animationend"),y1=Rp("animationiteration"),_1=Rp("animationstart"),v1=Rp("transitionend"),x1=new Map,M_=new Map,x2=["abort","abort",g1,"animationEnd",y1,"animationIteration",_1,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",v1,"transitionEnd","waiting","waiting"];function L_(t,o){for(var a=0;a<t.length;a+=2){var u=t[a],m=t[a+1];m="on"+(m[0].toUpperCase()+m.slice(1)),M_.set(u,o),x1.set(u,m),$A(m,[u])}}var w2=ii.unstable_now;w2();var Vr=8;function $l(t){if(1&t)return Vr=15,1;if(2&t)return Vr=14,2;if(4&t)return Vr=13,4;var o=24&t;return o!==0?(Vr=12,o):t&32?(Vr=11,32):(o=192&t,o!==0?(Vr=10,o):t&256?(Vr=9,256):(o=3584&t,o!==0?(Vr=8,o):t&4096?(Vr=7,4096):(o=4186112&t,o!==0?(Vr=6,o):(o=62914560&t,o!==0?(Vr=5,o):t&67108864?(Vr=4,67108864):t&134217728?(Vr=3,134217728):(o=805306368&t,o!==0?(Vr=2,o):1073741824&t?(Vr=1,1073741824):(Vr=8,t))))))}function B2(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}function b2(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(_t(358,t))}}function _h(t,o){var a=t.pendingLanes;if(a===0)return Vr=0;var u=0,m=0,x=t.expiredLanes,B=t.suspendedLanes,s=t.pingedLanes;if(x!==0)u=x,m=Vr=15;else if(x=a&134217727,x!==0){var F=x&~B;F!==0?(u=$l(F),m=Vr):(s&=x,s!==0&&(u=$l(s),m=Vr))}else x=a&~B,x!==0?(u=$l(x),m=Vr):s!==0&&(u=$l(s),m=Vr);if(u===0)return 0;if(u=31-iA(u),u=a&((0>u?0:1<<u)<<1)-1,o!==0&&o!==u&&!(o&B)){if($l(o),m<=Vr)return o;Vr=m}if(o=t.entangledLanes,o!==0)for(t=t.entanglements,o&=u;0<o;)a=31-iA(o),m=1<<a,u|=t[a],o&=~m;return u}function w1(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function sp(t,o){switch(t){case 15:return 1;case 14:return 2;case 12:return t=ql(24&~o),t===0?sp(10,o):t;case 10:return t=ql(192&~o),t===0?sp(8,o):t;case 8:return t=ql(3584&~o),t===0&&(t=ql(4186112&~o),t===0&&(t=512)),t;case 2:return o=ql(805306368&~o),o===0&&(o=268435456),o}throw Error(_t(358,t))}function ql(t){return t&-t}function yg(t){for(var o=[],a=0;31>a;a++)o.push(t);return o}function zp(t,o,a){t.pendingLanes|=o;var u=o-1;t.suspendedLanes&=u,t.pingedLanes&=u,t=t.eventTimes,o=31-iA(o),t[o]=a}var iA=Math.clz32?Math.clz32:F2,C2=Math.log,E2=Math.LN2;function F2(t){return t===0?32:31-(C2(t)/E2|0)|0}var I2=ii.unstable_UserBlockingPriority,T2=ii.unstable_runWithPriority,Nf=!0;function U2(t,o,a,u){RA||U_();var m=D_,x=RA;RA=!0;try{A1(m,t,o,a,u)}finally{(RA=x)||S_()}}function S2(t,o,a,u){T2(I2,D_.bind(null,t,o,a,u))}function D_(t,o,a,u){if(Nf){var m;if((m=(o&4)===0)&&0<Ts.length&&-1<Ux.indexOf(t))t=yy(null,t,o,a,u),Ts.push(t);else{var x=k_(t,o,a,u);if(x===null)m&&Sx(t,u);else{if(m){if(-1<Ux.indexOf(t)){t=yy(x,t,o,a,u),Ts.push(t);return}if(y2(x,t,o,a,u))return;Sx(t,u)}D1(t,o,u,null,a)}}}}function k_(t,o,a,u){var m=I_(u);if(m=zA(m),m!==null){var x=JA(m);if(x===null)m=null;else{var B=x.tag;if(B===13){if(m=c1(x),m!==null)return m;m=null}else if(B===3){if(x.stateNode.hydrate)return x.tag===3?x.stateNode.containerInfo:null;m=null}else x!==m&&(m=null)}}return D1(t,o,u,m,a),null}var Ha=null,P_=null,Vf=null;function B1(){if(Vf)return Vf;var t,o=P_,a=o.length,u,m="value"in Ha?Ha.value:Ha.textContent,x=m.length;for(t=0;t<a&&o[t]===m[t];t++);var B=a-t;for(u=1;u<=B&&o[a-u]===m[x-u];u++);return Vf=m.slice(t,1<u?1-u:void 0)}function Kf(t){var o=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&o===13&&(t=13)):t=o,t===10&&(t=13),32<=t||t===13?t:0}function lf(){return!0}function Mx(){return!1}function yo(t){function o(a,u,m,x,B){this._reactName=a,this._targetInst=m,this.type=u,this.nativeEvent=x,this.target=B,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(a=t[s],this[s]=a?a(x):x[s]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?lf:Mx,this.isPropagationStopped=Mx,this}return rn(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=lf)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=lf)},persist:function(){},isPersistent:lf}),o}var Cc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},O_=yo(Cc),Qh=rn({},Cc,{view:0,detail:0}),Q2=yo(Qh),_g,vg,Iu,Hp=rn({},Qh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:R_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Iu&&(Iu&&t.type==="mousemove"?(_g=t.screenX-Iu.screenX,vg=t.screenY-Iu.screenY):vg=_g=0,Iu=t),_g)},movementY:function(t){return"movementY"in t?t.movementY:vg}}),Lx=yo(Hp),M2=rn({},Hp,{dataTransfer:0}),L2=yo(M2),D2=rn({},Qh,{relatedTarget:0}),xg=yo(D2),k2=rn({},Cc,{animationName:0,elapsedTime:0,pseudoElement:0}),P2=yo(k2),O2=rn({},Cc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),R2=yo(O2),z2=rn({},Cc,{data:0}),Dx=yo(z2),H2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},N2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},V2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function K2(t){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(t):(t=V2[t])?!!o[t]:!1}function R_(){return K2}var G2=rn({},Qh,{key:function(t){if(t.key){var o=H2[t.key]||t.key;if(o!=="Unidentified")return o}return t.type==="keypress"?(t=Kf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?N2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:R_,charCode:function(t){return t.type==="keypress"?Kf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Kf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),j2=yo(G2),Z2=rn({},Hp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kx=yo(Z2),X2=rn({},Qh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:R_}),W2=yo(X2),$2=rn({},Cc,{propertyName:0,elapsedTime:0,pseudoElement:0}),q2=yo($2),J2=rn({},Hp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Y2=yo(J2),eI=[9,13,27,32],z_=ia&&"CompositionEvent"in window,th=null;ia&&"documentMode"in document&&(th=document.documentMode);var tI=ia&&"TextEvent"in window&&!th,b1=ia&&(!z_||th&&8<th&&11>=th),Px=String.fromCharCode(32),Ox=!1;function C1(t,o){switch(t){case"keyup":return eI.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function E1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var tc=!1;function rI(t,o){switch(t){case"compositionend":return E1(o);case"keypress":return o.which!==32?null:(Ox=!0,Px);case"textInput":return t=o.data,t===Px&&Ox?null:t;default:return null}}function nI(t,o){if(tc)return t==="compositionend"||!z_&&C1(t,o)?(t=B1(),Vf=P_=Ha=null,tc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return b1&&o.locale!=="ko"?null:o.data;default:return null}}var iI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rx(t){var o=t&&t.nodeName&&t.nodeName.toLowerCase();return o==="input"?!!iI[t.type]:o==="textarea"}function F1(t,o,a,u){s1(u),o=ap(o,"onChange"),0<o.length&&(a=new O_("onChange","change",null,a,u),t.push({event:a,listeners:o}))}var rh=null,vh=null;function oI(t){Q1(t,0)}function Np(t){var o=nc(t);if(YB(o))return t}function sI(t,o){if(t==="change")return o}var I1=!1;if(ia){var wg;if(ia){var Bg="oninput"in document;if(!Bg){var zx=document.createElement("div");zx.setAttribute("oninput","return;"),Bg=typeof zx.oninput=="function"}wg=Bg}else wg=!1;I1=wg&&(!document.documentMode||9<document.documentMode)}function Hx(){rh&&(rh.detachEvent("onpropertychange",T1),vh=rh=null)}function T1(t){if(t.propertyName==="value"&&Np(vh)){var o=[];if(F1(o,vh,t,I_(t)),t=oI,RA)t(o);else{RA=!0;try{T_(t,o)}finally{RA=!1,S_()}}}}function aI(t,o,a){t==="focusin"?(Hx(),rh=o,vh=a,rh.attachEvent("onpropertychange",T1)):t==="focusout"&&Hx()}function AI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Np(vh)}function lI(t,o){if(t==="click")return Np(o)}function cI(t,o){if(t==="input"||t==="change")return Np(o)}function uI(t,o){return t===o&&(t!==0||1/t===1/o)||t!==t&&o!==o}var Do=typeof Object.is=="function"?Object.is:uI,hI=Object.prototype.hasOwnProperty;function xh(t,o){if(Do(t,o))return!0;if(typeof t!="object"||t===null||typeof o!="object"||o===null)return!1;var a=Object.keys(t),u=Object.keys(o);if(a.length!==u.length)return!1;for(u=0;u<a.length;u++)if(!hI.call(o,a[u])||!Do(t[a[u]],o[a[u]]))return!1;return!0}function Nx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Vx(t,o){var a=Nx(t);t=0;for(var u;a;){if(a.nodeType===3){if(u=t+a.textContent.length,t<=o&&u>=o)return{node:a,offset:o-t};t=u}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Nx(a)}}function U1(t,o){return t&&o?t===o?!0:t&&t.nodeType===3?!1:o&&o.nodeType===3?U1(t,o.parentNode):"contains"in t?t.contains(o):t.compareDocumentPosition?!!(t.compareDocumentPosition(o)&16):!1:!1}function Kx(){for(var t=window,o=np();o instanceof t.HTMLIFrameElement;){try{var a=typeof o.contentWindow.location.href=="string"}catch{a=!1}if(a)t=o.contentWindow;else break;o=np(t.document)}return o}function _y(t){var o=t&&t.nodeName&&t.nodeName.toLowerCase();return o&&(o==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||o==="textarea"||t.contentEditable==="true")}var dI=ia&&"documentMode"in document&&11>=document.documentMode,rc=null,vy=null,nh=null,xy=!1;function Gx(t,o,a){var u=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;xy||rc==null||rc!==np(u)||(u=rc,"selectionStart"in u&&_y(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),nh&&xh(nh,u)||(nh=u,u=ap(vy,"onSelect"),0<u.length&&(o=new O_("onSelect","select",null,o,a),t.push({event:o,listeners:u}),o.target=rc)))}L_("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0);L_("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);L_(x2,2);for(var jx="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),bg=0;bg<jx.length;bg++)M_.set(jx[bg],0);yc("onMouseEnter",["mouseout","mouseover"]);yc("onMouseLeave",["mouseout","mouseover"]);yc("onPointerEnter",["pointerout","pointerover"]);yc("onPointerLeave",["pointerout","pointerover"]);$A("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$A("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$A("onBeforeInput",["compositionend","keypress","textInput","paste"]);$A("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$A("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$A("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),S1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hu));function Zx(t,o,a){var u=t.type||"unknown-event";t.currentTarget=a,m2(u,o,void 0,t),t.currentTarget=null}function Q1(t,o){o=(o&4)!==0;for(var a=0;a<t.length;a++){var u=t[a],m=u.event;u=u.listeners;e:{var x=void 0;if(o)for(var B=u.length-1;0<=B;B--){var s=u[B],F=s.instance,M=s.currentTarget;if(s=s.listener,F!==x&&m.isPropagationStopped())break e;Zx(m,s,M),x=F}else for(B=0;B<u.length;B++){if(s=u[B],F=s.instance,M=s.currentTarget,s=s.listener,F!==x&&m.isPropagationStopped())break e;Zx(m,s,M),x=F}}}if(op)throw t=my,op=!1,my=null,t}function Xr(t,o){var a=P1(o),u=t+"__bubble";a.has(u)||(L1(o,t,2,!1),a.add(u))}var Xx="_reactListening"+Math.random().toString(36).slice(2);function M1(t){t[Xx]||(t[Xx]=!0,$B.forEach(function(o){S1.has(o)||Wx(o,!1,t,null),Wx(o,!0,t,null)}))}function Wx(t,o,a,u){var m=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,x=a;if(t==="selectionchange"&&a.nodeType!==9&&(x=a.ownerDocument),u!==null&&!o&&S1.has(t)){if(t!=="scroll")return;m|=2,x=u}var B=P1(x),s=t+"__"+(o?"capture":"bubble");B.has(s)||(o&&(m|=4),L1(x,t,m,o),B.add(s))}function L1(t,o,a,u){var m=M_.get(o);switch(m===void 0?2:m){case 0:m=U2;break;case 1:m=S2;break;default:m=D_}a=m.bind(null,o,a,t),m=void 0,!py||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(m=!0),u?m!==void 0?t.addEventListener(o,a,{capture:!0,passive:m}):t.addEventListener(o,a,!0):m!==void 0?t.addEventListener(o,a,{passive:m}):t.addEventListener(o,a,!1)}function D1(t,o,a,u,m){var x=u;if(!(o&1)&&!(o&2)&&u!==null)e:for(;;){if(u===null)return;var B=u.tag;if(B===3||B===4){var s=u.stateNode.containerInfo;if(s===m||s.nodeType===8&&s.parentNode===m)break;if(B===4)for(B=u.return;B!==null;){var F=B.tag;if((F===3||F===4)&&(F=B.stateNode.containerInfo,F===m||F.nodeType===8&&F.parentNode===m))return;B=B.return}for(;s!==null;){if(B=zA(s),B===null)return;if(F=B.tag,F===5||F===6){u=x=B;continue e}s=s.parentNode}}u=u.return}h2(function(){var M=x,z=I_(a),L=[];e:{var Q=x1.get(t);if(Q!==void 0){var V=O_,ie=t;switch(t){case"keypress":if(Kf(a)===0)break e;case"keydown":case"keyup":V=j2;break;case"focusin":ie="focus",V=xg;break;case"focusout":ie="blur",V=xg;break;case"beforeblur":case"afterblur":V=xg;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=Lx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=L2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=W2;break;case g1:case y1:case _1:V=P2;break;case v1:V=q2;break;case"scroll":V=Q2;break;case"wheel":V=Y2;break;case"copy":case"cut":case"paste":V=R2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=kx}var de=(o&4)!==0,re=!de&&t==="scroll",K=de?Q!==null?Q+"Capture":null:Q;de=[];for(var G=M,ne;G!==null;){ne=G;var oe=ne.stateNode;if(ne.tag===5&&oe!==null&&(ne=oe,K!==null&&(oe=mh(G,K),oe!=null&&de.push(wh(G,oe,ne)))),re)break;G=G.return}0<de.length&&(Q=new V(Q,ie,null,a,z),L.push({event:Q,listeners:de}))}}if(!(o&7)){e:{if(Q=t==="mouseover"||t==="pointerover",V=t==="mouseout"||t==="pointerout",Q&&!(o&16)&&(ie=a.relatedTarget||a.fromElement)&&(zA(ie)||ie[Ec]))break e;if((V||Q)&&(Q=z.window===z?z:(Q=z.ownerDocument)?Q.defaultView||Q.parentWindow:window,V?(ie=a.relatedTarget||a.toElement,V=M,ie=ie?zA(ie):null,ie!==null&&(re=JA(ie),ie!==re||ie.tag!==5&&ie.tag!==6)&&(ie=null)):(V=null,ie=M),V!==ie)){if(de=Lx,oe="onMouseLeave",K="onMouseEnter",G="mouse",(t==="pointerout"||t==="pointerover")&&(de=kx,oe="onPointerLeave",K="onPointerEnter",G="pointer"),re=V==null?Q:nc(V),ne=ie==null?Q:nc(ie),Q=new de(oe,G+"leave",V,a,z),Q.target=re,Q.relatedTarget=ne,oe=null,zA(z)===M&&(de=new de(K,G+"enter",ie,a,z),de.target=ne,de.relatedTarget=re,oe=de),re=oe,V&&ie)t:{for(de=V,K=ie,G=0,ne=de;ne;ne=Vl(ne))G++;for(ne=0,oe=K;oe;oe=Vl(oe))ne++;for(;0<G-ne;)de=Vl(de),G--;for(;0<ne-G;)K=Vl(K),ne--;for(;G--;){if(de===K||K!==null&&de===K.alternate)break t;de=Vl(de),K=Vl(K)}de=null}else de=null;V!==null&&$x(L,Q,V,de,!1),ie!==null&&re!==null&&$x(L,re,ie,de,!0)}}e:{if(Q=M?nc(M):window,V=Q.nodeName&&Q.nodeName.toLowerCase(),V==="select"||V==="input"&&Q.type==="file")var we=sI;else if(Rx(Q))if(I1)we=cI;else{we=AI;var ge=aI}else(V=Q.nodeName)&&V.toLowerCase()==="input"&&(Q.type==="checkbox"||Q.type==="radio")&&(we=lI);if(we&&(we=we(t,M))){F1(L,we,a,z);break e}ge&&ge(t,Q,M),t==="focusout"&&(ge=Q._wrapperState)&&ge.controlled&&Q.type==="number"&&ay(Q,"number",Q.value)}switch(ge=M?nc(M):window,t){case"focusin":(Rx(ge)||ge.contentEditable==="true")&&(rc=ge,vy=M,nh=null);break;case"focusout":nh=vy=rc=null;break;case"mousedown":xy=!0;break;case"contextmenu":case"mouseup":case"dragend":xy=!1,Gx(L,a,z);break;case"selectionchange":if(dI)break;case"keydown":case"keyup":Gx(L,a,z)}var Ue;if(z_)e:{switch(t){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else tc?C1(t,a)&&(Ke="onCompositionEnd"):t==="keydown"&&a.keyCode===229&&(Ke="onCompositionStart");Ke&&(b1&&a.locale!=="ko"&&(tc||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&tc&&(Ue=B1()):(Ha=z,P_="value"in Ha?Ha.value:Ha.textContent,tc=!0)),ge=ap(M,Ke),0<ge.length&&(Ke=new Dx(Ke,t,null,a,z),L.push({event:Ke,listeners:ge}),Ue?Ke.data=Ue:(Ue=E1(a),Ue!==null&&(Ke.data=Ue)))),(Ue=tI?rI(t,a):nI(t,a))&&(M=ap(M,"onBeforeInput"),0<M.length&&(z=new Dx("onBeforeInput","beforeinput",null,a,z),L.push({event:z,listeners:M}),z.data=Ue))}Q1(L,o)})}function wh(t,o,a){return{instance:t,listener:o,currentTarget:a}}function ap(t,o){for(var a=o+"Capture",u=[];t!==null;){var m=t,x=m.stateNode;m.tag===5&&x!==null&&(m=x,x=mh(t,a),x!=null&&u.unshift(wh(t,x,m)),x=mh(t,o),x!=null&&u.push(wh(t,x,m))),t=t.return}return u}function Vl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $x(t,o,a,u,m){for(var x=o._reactName,B=[];a!==null&&a!==u;){var s=a,F=s.alternate,M=s.stateNode;if(F!==null&&F===u)break;s.tag===5&&M!==null&&(s=M,m?(F=mh(a,x),F!=null&&B.unshift(wh(a,F,s))):m||(F=mh(a,x),F!=null&&B.push(wh(a,F,s)))),a=a.return}B.length!==0&&t.push({event:o,listeners:B})}function Ap(){}var Cg=null,Eg=null;function k1(t,o){switch(t){case"button":case"input":case"select":case"textarea":return!!o.autoFocus}return!1}function wy(t,o){return t==="textarea"||t==="option"||t==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var qx=typeof setTimeout=="function"?setTimeout:void 0,fI=typeof clearTimeout=="function"?clearTimeout:void 0;function H_(t){t.nodeType===1?t.textContent="":t.nodeType===9&&(t=t.body,t!=null&&(t.textContent=""))}function uc(t){for(;t!=null;t=t.nextSibling){var o=t.nodeType;if(o===1||o===3)break}return t}function Jx(t){t=t.previousSibling;for(var o=0;t;){if(t.nodeType===8){var a=t.data;if(a==="$"||a==="$!"||a==="$?"){if(o===0)return t;o--}else a==="/$"&&o++}t=t.previousSibling}return null}var Fg=0;function pI(t){return{$$typeof:E_,toString:t,valueOf:t}}var Vp=Math.random().toString(36).slice(2),Na="__reactFiber$"+Vp,lp="__reactProps$"+Vp,Ec="__reactContainer$"+Vp,Yx="__reactEvents$"+Vp;function zA(t){var o=t[Na];if(o)return o;for(var a=t.parentNode;a;){if(o=a[Ec]||a[Na]){if(a=o.alternate,o.child!==null||a!==null&&a.child!==null)for(t=Jx(t);t!==null;){if(a=t[Na])return a;t=Jx(t)}return o}t=a,a=t.parentNode}return null}function Mh(t){return t=t[Na]||t[Ec],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function nc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(_t(33))}function Kp(t){return t[lp]||null}function P1(t){var o=t[Yx];return o===void 0&&(o=t[Yx]=new Set),o}var By=[],ic=-1;function lA(t){return{current:t}}function Wr(t){0>ic||(t.current=By[ic],By[ic]=null,ic--)}function xn(t,o){ic++,By[ic]=t.current,t.current=o}var oA={},Fi=lA(oA),Yi=lA(!1),ZA=oA;function _c(t,o){var a=t.type.contextTypes;if(!a)return oA;var u=t.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===o)return u.__reactInternalMemoizedMaskedChildContext;var m={},x;for(x in a)m[x]=o[x];return u&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=m),m}function eo(t){return t=t.childContextTypes,t!=null}function cp(){Wr(Yi),Wr(Fi)}function ew(t,o,a){if(Fi.current!==oA)throw Error(_t(168));xn(Fi,o),xn(Yi,a)}function O1(t,o,a){var u=t.stateNode;if(t=o.childContextTypes,typeof u.getChildContext!="function")return a;u=u.getChildContext();for(var m in u)if(!(m in t))throw Error(_t(108,ac(o)||"Unknown",m));return rn({},a,u)}function Gf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||oA,ZA=Fi.current,xn(Fi,t),xn(Yi,Yi.current),!0}function tw(t,o,a){var u=t.stateNode;if(!u)throw Error(_t(169));a?(t=O1(t,o,ZA),u.__reactInternalMemoizedMergedChildContext=t,Wr(Yi),Wr(Fi),xn(Fi,t)):Wr(Yi),xn(Yi,a)}var N_=null,KA=null,mI=ii.unstable_runWithPriority,V_=ii.unstable_scheduleCallback,by=ii.unstable_cancelCallback,gI=ii.unstable_shouldYield,rw=ii.unstable_requestPaint,Cy=ii.unstable_now,yI=ii.unstable_getCurrentPriorityLevel,Gp=ii.unstable_ImmediatePriority,R1=ii.unstable_UserBlockingPriority,z1=ii.unstable_NormalPriority,H1=ii.unstable_LowPriority,N1=ii.unstable_IdlePriority,Ig={},_I=rw!==void 0?rw:function(){},Js=null,jf=null,Tg=!1,nw=Cy(),Ci=1e4>nw?Cy:function(){return Cy()-nw};function vc(){switch(yI()){case Gp:return 99;case R1:return 98;case z1:return 97;case H1:return 96;case N1:return 95;default:throw Error(_t(332))}}function V1(t){switch(t){case 99:return Gp;case 98:return R1;case 97:return z1;case 96:return H1;case 95:return N1;default:throw Error(_t(332))}}function XA(t,o){return t=V1(t),mI(t,o)}function Bh(t,o,a){return t=V1(t),V_(t,o,a)}function Ls(){if(jf!==null){var t=jf;jf=null,by(t)}K1()}function K1(){if(!Tg&&Js!==null){Tg=!0;var t=0;try{var o=Js;XA(99,function(){for(;t<o.length;t++){var a=o[t];do a=a(!0);while(a!==null)}}),Js=null}catch(a){throw Js!==null&&(Js=Js.slice(t+1)),V_(Gp,Ls),a}finally{Tg=!1}}}var vI=qA.ReactCurrentBatchConfig;function rs(t,o){if(t&&t.defaultProps){o=rn({},o),t=t.defaultProps;for(var a in t)o[a]===void 0&&(o[a]=t[a]);return o}return o}var up=lA(null),hp=null,oc=null,dp=null;function K_(){dp=oc=hp=null}function G_(t){var o=up.current;Wr(up),t.type._context._currentValue=o}function G1(t,o){for(;t!==null;){var a=t.alternate;if((t.childLanes&o)===o){if(a===null||(a.childLanes&o)===o)break;a.childLanes|=o}else t.childLanes|=o,a!==null&&(a.childLanes|=o);t=t.return}}function hc(t,o){hp=t,dp=oc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&o&&(ns=!0),t.firstContext=null)}function zo(t,o){if(dp!==t&&o!==!1&&o!==0)if((typeof o!="number"||o===1073741823)&&(dp=t,o=1073741823),o={context:t,observedBits:o,next:null},oc===null){if(hp===null)throw Error(_t(308));oc=o,hp.dependencies={lanes:0,firstContext:o,responders:null}}else oc=oc.next=o;return t._currentValue}var Oa=!1;function j_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function j1(t,o){t=t.updateQueue,o.updateQueue===t&&(o.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $a(t,o){return{eventTime:t,lane:o,tag:0,payload:null,callback:null,next:null}}function qa(t,o){if(t=t.updateQueue,t!==null){t=t.shared;var a=t.pending;a===null?o.next=o:(o.next=a.next,a.next=o),t.pending=o}}function iw(t,o){var a=t.updateQueue,u=t.alternate;if(u!==null&&(u=u.updateQueue,a===u)){var m=null,x=null;if(a=a.firstBaseUpdate,a!==null){do{var B={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};x===null?m=x=B:x=x.next=B,a=a.next}while(a!==null);x===null?m=x=o:x=x.next=o}else m=x=o;a={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:x,shared:u.shared,effects:u.effects},t.updateQueue=a;return}t=a.lastBaseUpdate,t===null?a.firstBaseUpdate=o:t.next=o,a.lastBaseUpdate=o}function bh(t,o,a,u){var m=t.updateQueue;Oa=!1;var x=m.firstBaseUpdate,B=m.lastBaseUpdate,s=m.shared.pending;if(s!==null){m.shared.pending=null;var F=s,M=F.next;F.next=null,B===null?x=M:B.next=M,B=F;var z=t.alternate;if(z!==null){z=z.updateQueue;var L=z.lastBaseUpdate;L!==B&&(L===null?z.firstBaseUpdate=M:L.next=M,z.lastBaseUpdate=F)}}if(x!==null){L=m.baseState,B=0,z=M=F=null;do{s=x.lane;var Q=x.eventTime;if((u&s)===s){z!==null&&(z=z.next={eventTime:Q,lane:0,tag:x.tag,payload:x.payload,callback:x.callback,next:null});e:{var V=t,ie=x;switch(s=o,Q=a,ie.tag){case 1:if(V=ie.payload,typeof V=="function"){L=V.call(Q,L,s);break e}L=V;break e;case 3:V.flags=V.flags&-4097|64;case 0:if(V=ie.payload,s=typeof V=="function"?V.call(Q,L,s):V,s==null)break e;L=rn({},L,s);break e;case 2:Oa=!0}}x.callback!==null&&(t.flags|=32,s=m.effects,s===null?m.effects=[x]:s.push(x))}else Q={eventTime:Q,lane:s,tag:x.tag,payload:x.payload,callback:x.callback,next:null},z===null?(M=z=Q,F=L):z=z.next=Q,B|=s;if(x=x.next,x===null){if(s=m.shared.pending,s===null)break;x=s.next,s.next=null,m.lastBaseUpdate=s,m.shared.pending=null}}while(1);z===null&&(F=L),m.baseState=F,m.firstBaseUpdate=M,m.lastBaseUpdate=z,Dh|=B,t.lanes=B,t.memoizedState=L}}function ow(t,o,a){if(t=o.effects,o.effects=null,t!==null)for(o=0;o<t.length;o++){var u=t[o],m=u.callback;if(m!==null){if(u.callback=null,u=a,typeof m!="function")throw Error(_t(191,m));m.call(u)}}}var Z1=new kp.Component().refs;function fp(t,o,a,u){o=t.memoizedState,a=a(u,o),a=a==null?o:rn({},o,a),t.memoizedState=a,t.lanes===0&&(t.updateQueue.baseState=a)}var jp={isMounted:function(t){return(t=t._reactInternals)?JA(t)===t:!1},enqueueSetState:function(t,o,a){t=t._reactInternals;var u=go(),m=Ja(t),x=$a(u,m);x.payload=o,a!=null&&(x.callback=a),qa(t,x),Ya(t,m,u)},enqueueReplaceState:function(t,o,a){t=t._reactInternals;var u=go(),m=Ja(t),x=$a(u,m);x.tag=1,x.payload=o,a!=null&&(x.callback=a),qa(t,x),Ya(t,m,u)},enqueueForceUpdate:function(t,o){t=t._reactInternals;var a=go(),u=Ja(t),m=$a(a,u);m.tag=2,o!=null&&(m.callback=o),qa(t,m),Ya(t,u,a)}};function sw(t,o,a,u,m,x,B){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(u,x,B):o.prototype&&o.prototype.isPureReactComponent?!xh(a,u)||!xh(m,x):!0}function X1(t,o,a){var u=!1,m=oA,x=o.contextType;return typeof x=="object"&&x!==null?x=zo(x):(m=eo(o)?ZA:Fi.current,u=o.contextTypes,x=(u=u!=null)?_c(t,m):oA),o=new o(a,x),t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=jp,t.stateNode=o,o._reactInternals=t,u&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=m,t.__reactInternalMemoizedMaskedChildContext=x),o}function aw(t,o,a,u){t=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(a,u),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(a,u),o.state!==t&&jp.enqueueReplaceState(o,o.state,null)}function Ey(t,o,a,u){var m=t.stateNode;m.props=a,m.state=t.memoizedState,m.refs=Z1,j_(t);var x=o.contextType;typeof x=="object"&&x!==null?m.context=zo(x):(x=eo(o)?ZA:Fi.current,m.context=_c(t,x)),bh(t,a,m,u),m.state=t.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(fp(t,o,x,a),m.state=t.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(o=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),o!==m.state&&jp.enqueueReplaceState(m,m.state,null),bh(t,a,m,u),m.state=t.memoizedState),typeof m.componentDidMount=="function"&&(t.flags|=4)}var cf=Array.isArray;function Tu(t,o,a){if(t=a.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(_t(309));var u=a.stateNode}if(!u)throw Error(_t(147,t));var m=""+t;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===m?o.ref:(o=function(x){var B=u.refs;B===Z1&&(B=u.refs={}),x===null?delete B[m]:B[m]=x},o._stringRef=m,o)}if(typeof t!="string")throw Error(_t(284));if(!a._owner)throw Error(_t(290,t))}return t}function uf(t,o){if(t.type!=="textarea")throw Error(_t(31,Object.prototype.toString.call(o)==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":o))}function W1(t){function o(re,K){if(t){var G=re.lastEffect;G!==null?(G.nextEffect=K,re.lastEffect=K):re.firstEffect=re.lastEffect=K,K.nextEffect=null,K.flags=8}}function a(re,K){if(!t)return null;for(;K!==null;)o(re,K),K=K.sibling;return null}function u(re,K){for(re=new Map;K!==null;)K.key!==null?re.set(K.key,K):re.set(K.index,K),K=K.sibling;return re}function m(re,K){return re=aA(re,K),re.index=0,re.sibling=null,re}function x(re,K,G){return re.index=G,t?(G=re.alternate,G!==null?(G=G.index,G<K?(re.flags=2,K):G):(re.flags=2,K)):K}function B(re){return t&&re.alternate===null&&(re.flags=2),re}function s(re,K,G,ne){return K===null||K.tag!==6?(K=Lg(G,re.mode,ne),K.return=re,K):(K=m(K,G),K.return=re,K)}function F(re,K,G,ne){return K!==null&&K.elementType===G.type?(ne=m(K,G.props),ne.ref=Tu(re,K,G),ne.return=re,ne):(ne=$f(G.type,G.key,G.props,null,re.mode,ne),ne.ref=Tu(re,K,G),ne.return=re,ne)}function M(re,K,G,ne){return K===null||K.tag!==4||K.stateNode.containerInfo!==G.containerInfo||K.stateNode.implementation!==G.implementation?(K=Dg(G,re.mode,ne),K.return=re,K):(K=m(K,G.children||[]),K.return=re,K)}function z(re,K,G,ne,oe){return K===null||K.tag!==7?(K=mc(G,re.mode,ne,oe),K.return=re,K):(K=m(K,G),K.return=re,K)}function L(re,K,G){if(typeof K=="string"||typeof K=="number")return K=Lg(""+K,re.mode,G),K.return=re,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case Ru:return G=$f(K.type,K.key,K.props,null,re.mode,G),G.ref=Tu(re,null,K),G.return=re,G;case OA:return K=Dg(K,re.mode,G),K.return=re,K}if(cf(K)||Bu(K))return K=mc(K,re.mode,G,null),K.return=re,K;uf(re,K)}return null}function Q(re,K,G,ne){var oe=K!==null?K.key:null;if(typeof G=="string"||typeof G=="number")return oe!==null?null:s(re,K,""+G,ne);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case Ru:return G.key===oe?G.type===za?z(re,K,G.props.children,ne,oe):F(re,K,G,ne):null;case OA:return G.key===oe?M(re,K,G,ne):null}if(cf(G)||Bu(G))return oe!==null?null:z(re,K,G,ne,null);uf(re,G)}return null}function V(re,K,G,ne,oe){if(typeof ne=="string"||typeof ne=="number")return re=re.get(G)||null,s(K,re,""+ne,oe);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case Ru:return re=re.get(ne.key===null?G:ne.key)||null,ne.type===za?z(K,re,ne.props.children,oe,ne.key):F(K,re,ne,oe);case OA:return re=re.get(ne.key===null?G:ne.key)||null,M(K,re,ne,oe)}if(cf(ne)||Bu(ne))return re=re.get(G)||null,z(K,re,ne,oe,null);uf(K,ne)}return null}function ie(re,K,G,ne){for(var oe=null,we=null,ge=K,Ue=K=0,Ke=null;ge!==null&&Ue<G.length;Ue++){ge.index>Ue?(Ke=ge,ge=null):Ke=ge.sibling;var Me=Q(re,ge,G[Ue],ne);if(Me===null){ge===null&&(ge=Ke);break}t&&ge&&Me.alternate===null&&o(re,ge),K=x(Me,K,Ue),we===null?oe=Me:we.sibling=Me,we=Me,ge=Ke}if(Ue===G.length)return a(re,ge),oe;if(ge===null){for(;Ue<G.length;Ue++)ge=L(re,G[Ue],ne),ge!==null&&(K=x(ge,K,Ue),we===null?oe=ge:we.sibling=ge,we=ge);return oe}for(ge=u(re,ge);Ue<G.length;Ue++)Ke=V(ge,re,Ue,G[Ue],ne),Ke!==null&&(t&&Ke.alternate!==null&&ge.delete(Ke.key===null?Ue:Ke.key),K=x(Ke,K,Ue),we===null?oe=Ke:we.sibling=Ke,we=Ke);return t&&ge.forEach(function(et){return o(re,et)}),oe}function de(re,K,G,ne){var oe=Bu(G);if(typeof oe!="function")throw Error(_t(150));if(G=oe.call(G),G==null)throw Error(_t(151));for(var we=oe=null,ge=K,Ue=K=0,Ke=null,Me=G.next();ge!==null&&!Me.done;Ue++,Me=G.next()){ge.index>Ue?(Ke=ge,ge=null):Ke=ge.sibling;var et=Q(re,ge,Me.value,ne);if(et===null){ge===null&&(ge=Ke);break}t&&ge&&et.alternate===null&&o(re,ge),K=x(et,K,Ue),we===null?oe=et:we.sibling=et,we=et,ge=Ke}if(Me.done)return a(re,ge),oe;if(ge===null){for(;!Me.done;Ue++,Me=G.next())Me=L(re,Me.value,ne),Me!==null&&(K=x(Me,K,Ue),we===null?oe=Me:we.sibling=Me,we=Me);return oe}for(ge=u(re,ge);!Me.done;Ue++,Me=G.next())Me=V(ge,re,Ue,Me.value,ne),Me!==null&&(t&&Me.alternate!==null&&ge.delete(Me.key===null?Ue:Me.key),K=x(Me,K,Ue),we===null?oe=Me:we.sibling=Me,we=Me);return t&&ge.forEach(function(qe){return o(re,qe)}),oe}return function(re,K,G,ne){var oe=typeof G=="object"&&G!==null&&G.type===za&&G.key===null;oe&&(G=G.props.children);var we=typeof G=="object"&&G!==null;if(we)switch(G.$$typeof){case Ru:e:{for(we=G.key,oe=K;oe!==null;){if(oe.key===we){switch(oe.tag){case 7:if(G.type===za){a(re,oe.sibling),K=m(oe,G.props.children),K.return=re,re=K;break e}break;default:if(oe.elementType===G.type){a(re,oe.sibling),K=m(oe,G.props),K.ref=Tu(re,oe,G),K.return=re,re=K;break e}}a(re,oe);break}else o(re,oe);oe=oe.sibling}G.type===za?(K=mc(G.props.children,re.mode,ne,G.key),K.return=re,re=K):(ne=$f(G.type,G.key,G.props,null,re.mode,ne),ne.ref=Tu(re,K,G),ne.return=re,re=ne)}return B(re);case OA:e:{for(oe=G.key;K!==null;){if(K.key===oe)if(K.tag===4&&K.stateNode.containerInfo===G.containerInfo&&K.stateNode.implementation===G.implementation){a(re,K.sibling),K=m(K,G.children||[]),K.return=re,re=K;break e}else{a(re,K);break}else o(re,K);K=K.sibling}K=Dg(G,re.mode,ne),K.return=re,re=K}return B(re)}if(typeof G=="string"||typeof G=="number")return G=""+G,K!==null&&K.tag===6?(a(re,K.sibling),K=m(K,G),K.return=re,re=K):(a(re,K),K=Lg(G,re.mode,ne),K.return=re,re=K),B(re);if(cf(G))return ie(re,K,G,ne);if(Bu(G))return de(re,K,G,ne);if(we&&uf(re,G),typeof G>"u"&&!oe)switch(re.tag){case 1:case 22:case 0:case 11:case 15:throw Error(_t(152,ac(re.type)||"Component"))}return a(re,K)}}var pp=W1(!0),$1=W1(!1),Lh={},Qs=lA(Lh),Ch=lA(Lh),Eh=lA(Lh);function HA(t){if(t===Lh)throw Error(_t(174));return t}function Fy(t,o){switch(xn(Eh,o),xn(Ch,t),xn(Qs,Lh),t=o.nodeType,t){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:uy(null,"");break;default:t=t===8?o.parentNode:o,o=t.namespaceURI||null,t=t.tagName,o=uy(o,t)}Wr(Qs),xn(Qs,o)}function xc(){Wr(Qs),Wr(Ch),Wr(Eh)}function Aw(t){HA(Eh.current);var o=HA(Qs.current),a=uy(o,t.type);o!==a&&(xn(Ch,t),xn(Qs,a))}function Z_(t){Ch.current===t&&(Wr(Qs),Wr(Ch))}var vn=lA(0);function mp(t){for(var o=t;o!==null;){if(o.tag===13){var a=o.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&64)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===t)break;for(;o.sibling===null;){if(o.return===null||o.return===t)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var ea=null,Va=null,Ms=!1;function q1(t,o){var a=ko(5,null,null,0);a.elementType="DELETED",a.type="DELETED",a.stateNode=o,a.return=t,a.flags=8,t.lastEffect!==null?(t.lastEffect.nextEffect=a,t.lastEffect=a):t.firstEffect=t.lastEffect=a}function lw(t,o){switch(t.tag){case 5:var a=t.type;return o=o.nodeType!==1||a.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(t.stateNode=o,!0):!1;case 6:return o=t.pendingProps===""||o.nodeType!==3?null:o,o!==null?(t.stateNode=o,!0):!1;case 13:return!1;default:return!1}}function Iy(t){if(Ms){var o=Va;if(o){var a=o;if(!lw(t,o)){if(o=uc(a.nextSibling),!o||!lw(t,o)){t.flags=t.flags&-1025|2,Ms=!1,ea=t;return}q1(ea,a)}ea=t,Va=uc(o.firstChild)}else t.flags=t.flags&-1025|2,Ms=!1,ea=t}}function cw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ea=t}function hf(t){if(t!==ea)return!1;if(!Ms)return cw(t),Ms=!0,!1;var o=t.type;if(t.tag!==5||o!=="head"&&o!=="body"&&!wy(o,t.memoizedProps))for(o=Va;o;)q1(t,o),o=uc(o.nextSibling);if(cw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(_t(317));e:{for(t=t.nextSibling,o=0;t;){if(t.nodeType===8){var a=t.data;if(a==="/$"){if(o===0){Va=uc(t.nextSibling);break e}o--}else a!=="$"&&a!=="$!"&&a!=="$?"||o++}t=t.nextSibling}Va=null}}else Va=ea?uc(t.stateNode.nextSibling):null;return!0}function Ug(){Va=ea=null,Ms=!1}var dc=[];function X_(){for(var t=0;t<dc.length;t++)dc[t]._workInProgressVersionPrimary=null;dc.length=0}var ih=qA.ReactCurrentDispatcher,Ro=qA.ReactCurrentBatchConfig,Fh=0,In=null,Bi=null,hi=null,gp=!1,oh=!1;function $i(){throw Error(_t(321))}function W_(t,o){if(o===null)return!1;for(var a=0;a<o.length&&a<t.length;a++)if(!Do(t[a],o[a]))return!1;return!0}function $_(t,o,a,u,m,x){if(Fh=x,In=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ih.current=t===null||t.memoizedState===null?wI:BI,t=a(u,m),oh){x=0;do{if(oh=!1,!(25>x))throw Error(_t(301));x+=1,hi=Bi=null,o.updateQueue=null,ih.current=bI,t=a(u,m)}while(oh)}if(ih.current=xp,o=Bi!==null&&Bi.next!==null,Fh=0,hi=Bi=In=null,gp=!1,o)throw Error(_t(300));return t}function NA(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hi===null?In.memoizedState=hi=t:hi=hi.next=t,hi}function YA(){if(Bi===null){var t=In.alternate;t=t!==null?t.memoizedState:null}else t=Bi.next;var o=hi===null?In.memoizedState:hi.next;if(o!==null)hi=o,Bi=t;else{if(t===null)throw Error(_t(310));Bi=t,t={memoizedState:Bi.memoizedState,baseState:Bi.baseState,baseQueue:Bi.baseQueue,queue:Bi.queue,next:null},hi===null?In.memoizedState=hi=t:hi=hi.next=t}return hi}function Us(t,o){return typeof o=="function"?o(t):o}function Uu(t){var o=YA(),a=o.queue;if(a===null)throw Error(_t(311));a.lastRenderedReducer=t;var u=Bi,m=u.baseQueue,x=a.pending;if(x!==null){if(m!==null){var B=m.next;m.next=x.next,x.next=B}u.baseQueue=m=x,a.pending=null}if(m!==null){m=m.next,u=u.baseState;var s=B=x=null,F=m;do{var M=F.lane;if((Fh&M)===M)s!==null&&(s=s.next={lane:0,action:F.action,eagerReducer:F.eagerReducer,eagerState:F.eagerState,next:null}),u=F.eagerReducer===t?F.eagerState:t(u,F.action);else{var z={lane:M,action:F.action,eagerReducer:F.eagerReducer,eagerState:F.eagerState,next:null};s===null?(B=s=z,x=u):s=s.next=z,In.lanes|=M,Dh|=M}F=F.next}while(F!==null&&F!==m);s===null?x=u:s.next=B,Do(u,o.memoizedState)||(ns=!0),o.memoizedState=u,o.baseState=x,o.baseQueue=s,a.lastRenderedState=u}return[o.memoizedState,a.dispatch]}function Su(t){var o=YA(),a=o.queue;if(a===null)throw Error(_t(311));a.lastRenderedReducer=t;var u=a.dispatch,m=a.pending,x=o.memoizedState;if(m!==null){a.pending=null;var B=m=m.next;do x=t(x,B.action),B=B.next;while(B!==m);Do(x,o.memoizedState)||(ns=!0),o.memoizedState=x,o.baseQueue===null&&(o.baseState=x),a.lastRenderedState=x}return[x,u]}function uw(t,o,a){var u=o._getVersion;u=u(o._source);var m=o._workInProgressVersionPrimary;if(m!==null?t=m===u:(t=t.mutableReadLanes,(t=(Fh&t)===t)&&(o._workInProgressVersionPrimary=u,dc.push(o))),t)return a(o._source);throw dc.push(o),Error(_t(350))}function J1(t,o,a,u){var m=Ni;if(m===null)throw Error(_t(349));var x=o._getVersion,B=x(o._source),s=ih.current,F=s.useState(function(){return uw(m,o,a)}),M=F[1],z=F[0];F=hi;var L=t.memoizedState,Q=L.refs,V=Q.getSnapshot,ie=L.source;L=L.subscribe;var de=In;return t.memoizedState={refs:Q,source:o,subscribe:u},s.useEffect(function(){Q.getSnapshot=a,Q.setSnapshot=M;var re=x(o._source);if(!Do(B,re)){re=a(o._source),Do(z,re)||(M(re),re=Ja(de),m.mutableReadLanes|=re&m.pendingLanes),re=m.mutableReadLanes,m.entangledLanes|=re;for(var K=m.entanglements,G=re;0<G;){var ne=31-iA(G),oe=1<<ne;K[ne]|=re,G&=~oe}}},[a,o,u]),s.useEffect(function(){return u(o._source,function(){var re=Q.getSnapshot,K=Q.setSnapshot;try{K(re(o._source));var G=Ja(de);m.mutableReadLanes|=G&m.pendingLanes}catch(ne){K(function(){throw ne})}})},[o,u]),Do(V,a)&&Do(ie,o)&&Do(L,u)||(t={pending:null,dispatch:null,lastRenderedReducer:Us,lastRenderedState:z},t.dispatch=M=Y_.bind(null,In,t),F.queue=t,F.baseQueue=null,z=uw(m,o,a),F.memoizedState=F.baseState=z),z}function Y1(t,o,a){var u=YA();return J1(u,t,o,a)}function Qu(t){var o=NA();return typeof t=="function"&&(t=t()),o.memoizedState=o.baseState=t,t=o.queue={pending:null,dispatch:null,lastRenderedReducer:Us,lastRenderedState:t},t=t.dispatch=Y_.bind(null,In,t),[o.memoizedState,t]}function yp(t,o,a,u){return t={tag:t,create:o,destroy:a,deps:u,next:null},o=In.updateQueue,o===null?(o={lastEffect:null},In.updateQueue=o,o.lastEffect=t.next=t):(a=o.lastEffect,a===null?o.lastEffect=t.next=t:(u=a.next,a.next=t,t.next=u,o.lastEffect=t)),t}function hw(t){var o=NA();return t={current:t},o.memoizedState=t}function _p(){return YA().memoizedState}function Ty(t,o,a,u){var m=NA();In.flags|=t,m.memoizedState=yp(1|o,a,void 0,u===void 0?null:u)}function q_(t,o,a,u){var m=YA();u=u===void 0?null:u;var x=void 0;if(Bi!==null){var B=Bi.memoizedState;if(x=B.destroy,u!==null&&W_(u,B.deps)){yp(o,a,x,u);return}}In.flags|=t,m.memoizedState=yp(1|o,a,x,u)}function dw(t,o){return Ty(516,4,t,o)}function vp(t,o){return q_(516,4,t,o)}function eb(t,o){return q_(4,2,t,o)}function tb(t,o){if(typeof o=="function")return t=t(),o(t),function(){o(null)};if(o!=null)return t=t(),o.current=t,function(){o.current=null}}function rb(t,o,a){return a=a!=null?a.concat([t]):null,q_(4,2,tb.bind(null,o,t),a)}function J_(){}function nb(t,o){var a=YA();o=o===void 0?null:o;var u=a.memoizedState;return u!==null&&o!==null&&W_(o,u[1])?u[0]:(a.memoizedState=[t,o],t)}function ib(t,o){var a=YA();o=o===void 0?null:o;var u=a.memoizedState;return u!==null&&o!==null&&W_(o,u[1])?u[0]:(t=t(),a.memoizedState=[t,o],t)}function xI(t,o){var a=vc();XA(98>a?98:a,function(){t(!0)}),XA(97<a?97:a,function(){var u=Ro.transition;Ro.transition=1;try{t(!1),o()}finally{Ro.transition=u}})}function Y_(t,o,a){var u=go(),m=Ja(t),x={lane:m,action:a,eagerReducer:null,eagerState:null,next:null},B=o.pending;if(B===null?x.next=x:(x.next=B.next,B.next=x),o.pending=x,B=t.alternate,t===In||B!==null&&B===In)oh=gp=!0;else{if(t.lanes===0&&(B===null||B.lanes===0)&&(B=o.lastRenderedReducer,B!==null))try{var s=o.lastRenderedState,F=B(s,a);if(x.eagerReducer=B,x.eagerState=F,Do(F,s))return}catch{}finally{}Ya(t,m,u)}}var xp={readContext:zo,useCallback:$i,useContext:$i,useEffect:$i,useImperativeHandle:$i,useLayoutEffect:$i,useMemo:$i,useReducer:$i,useRef:$i,useState:$i,useDebugValue:$i,useDeferredValue:$i,useTransition:$i,useMutableSource:$i,useOpaqueIdentifier:$i,unstable_isNewReconciler:!1},wI={readContext:zo,useCallback:function(t,o){return NA().memoizedState=[t,o===void 0?null:o],t},useContext:zo,useEffect:dw,useImperativeHandle:function(t,o,a){return a=a!=null?a.concat([t]):null,Ty(4,2,tb.bind(null,o,t),a)},useLayoutEffect:function(t,o){return Ty(4,2,t,o)},useMemo:function(t,o){var a=NA();return o=o===void 0?null:o,t=t(),a.memoizedState=[t,o],t},useReducer:function(t,o,a){var u=NA();return o=a!==void 0?a(o):o,u.memoizedState=u.baseState=o,t=u.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:o},t=t.dispatch=Y_.bind(null,In,t),[u.memoizedState,t]},useRef:hw,useState:Qu,useDebugValue:J_,useDeferredValue:function(t){var o=Qu(t),a=o[0],u=o[1];return dw(function(){var m=Ro.transition;Ro.transition=1;try{u(t)}finally{Ro.transition=m}},[t]),a},useTransition:function(){var t=Qu(!1),o=t[0];return t=xI.bind(null,t[1]),hw(t),[t,o]},useMutableSource:function(t,o,a){var u=NA();return u.memoizedState={refs:{getSnapshot:o,setSnapshot:null},source:t,subscribe:a},J1(u,t,o,a)},useOpaqueIdentifier:function(){if(Ms){var t=!1,o=pI(function(){throw t||(t=!0,a("r:"+(Fg++).toString(36))),Error(_t(355))}),a=Qu(o)[1];return!(In.mode&2)&&(In.flags|=516,yp(5,function(){a("r:"+(Fg++).toString(36))},void 0,null)),o}return o="r:"+(Fg++).toString(36),Qu(o),o},unstable_isNewReconciler:!1},BI={readContext:zo,useCallback:nb,useContext:zo,useEffect:vp,useImperativeHandle:rb,useLayoutEffect:eb,useMemo:ib,useReducer:Uu,useRef:_p,useState:function(){return Uu(Us)},useDebugValue:J_,useDeferredValue:function(t){var o=Uu(Us),a=o[0],u=o[1];return vp(function(){var m=Ro.transition;Ro.transition=1;try{u(t)}finally{Ro.transition=m}},[t]),a},useTransition:function(){var t=Uu(Us)[0];return[_p().current,t]},useMutableSource:Y1,useOpaqueIdentifier:function(){return Uu(Us)[0]},unstable_isNewReconciler:!1},bI={readContext:zo,useCallback:nb,useContext:zo,useEffect:vp,useImperativeHandle:rb,useLayoutEffect:eb,useMemo:ib,useReducer:Su,useRef:_p,useState:function(){return Su(Us)},useDebugValue:J_,useDeferredValue:function(t){var o=Su(Us),a=o[0],u=o[1];return vp(function(){var m=Ro.transition;Ro.transition=1;try{u(t)}finally{Ro.transition=m}},[t]),a},useTransition:function(){var t=Su(Us)[0];return[_p().current,t]},useMutableSource:Y1,useOpaqueIdentifier:function(){return Su(Us)[0]},unstable_isNewReconciler:!1},CI=qA.ReactCurrentOwner,ns=!1;function qi(t,o,a,u){o.child=t===null?$1(o,null,a,u):pp(o,t.child,a,u)}function fw(t,o,a,u,m){a=a.render;var x=o.ref;return hc(o,m),u=$_(t,o,a,u,x,m),t!==null&&!ns?(o.updateQueue=t.updateQueue,o.flags&=-517,t.lanes&=~m,ta(t,o,m)):(o.flags|=1,qi(t,o,u,m),o.child)}function pw(t,o,a,u,m,x){if(t===null){var B=a.type;return typeof B=="function"&&!o0(B)&&B.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(o.tag=15,o.type=B,ob(t,o,B,u,m,x)):(t=$f(a.type,null,u,o,o.mode,x),t.ref=o.ref,t.return=o,o.child=t)}return B=t.child,!(m&x)&&(m=B.memoizedProps,a=a.compare,a=a!==null?a:xh,a(m,u)&&t.ref===o.ref)?ta(t,o,x):(o.flags|=1,t=aA(B,u),t.ref=o.ref,t.return=o,o.child=t)}function ob(t,o,a,u,m,x){if(t!==null&&xh(t.memoizedProps,u)&&t.ref===o.ref)if(ns=!1,(x&m)!==0)t.flags&16384&&(ns=!0);else return o.lanes=t.lanes,ta(t,o,x);return Uy(t,o,a,u,x)}function Sg(t,o,a){var u=o.pendingProps,m=u.children,x=t!==null?t.memoizedState:null;if(u.mode==="hidden"||u.mode==="unstable-defer-without-hiding")if(!(o.mode&4))o.memoizedState={baseLanes:0},ff(o,a);else if(a&1073741824)o.memoizedState={baseLanes:0},ff(o,x!==null?x.baseLanes:a);else return t=x!==null?x.baseLanes|a:a,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:t},ff(o,t),null;else x!==null?(u=x.baseLanes|a,o.memoizedState=null):u=a,ff(o,u);return qi(t,o,m,a),o.child}function sb(t,o){var a=o.ref;(t===null&&a!==null||t!==null&&t.ref!==a)&&(o.flags|=128)}function Uy(t,o,a,u,m){var x=eo(a)?ZA:Fi.current;return x=_c(o,x),hc(o,m),a=$_(t,o,a,u,x,m),t!==null&&!ns?(o.updateQueue=t.updateQueue,o.flags&=-517,t.lanes&=~m,ta(t,o,m)):(o.flags|=1,qi(t,o,a,m),o.child)}function mw(t,o,a,u,m){if(eo(a)){var x=!0;Gf(o)}else x=!1;if(hc(o,m),o.stateNode===null)t!==null&&(t.alternate=null,o.alternate=null,o.flags|=2),X1(o,a,u),Ey(o,a,u,m),u=!0;else if(t===null){var B=o.stateNode,s=o.memoizedProps;B.props=s;var F=B.context,M=a.contextType;typeof M=="object"&&M!==null?M=zo(M):(M=eo(a)?ZA:Fi.current,M=_c(o,M));var z=a.getDerivedStateFromProps,L=typeof z=="function"||typeof B.getSnapshotBeforeUpdate=="function";L||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(s!==u||F!==M)&&aw(o,B,u,M),Oa=!1;var Q=o.memoizedState;B.state=Q,bh(o,u,B,m),F=o.memoizedState,s!==u||Q!==F||Yi.current||Oa?(typeof z=="function"&&(fp(o,a,z,u),F=o.memoizedState),(s=Oa||sw(o,a,s,u,Q,F,M))?(L||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(o.flags|=4)):(typeof B.componentDidMount=="function"&&(o.flags|=4),o.memoizedProps=u,o.memoizedState=F),B.props=u,B.state=F,B.context=M,u=s):(typeof B.componentDidMount=="function"&&(o.flags|=4),u=!1)}else{B=o.stateNode,j1(t,o),s=o.memoizedProps,M=o.type===o.elementType?s:rs(o.type,s),B.props=M,L=o.pendingProps,Q=B.context,F=a.contextType,typeof F=="object"&&F!==null?F=zo(F):(F=eo(a)?ZA:Fi.current,F=_c(o,F));var V=a.getDerivedStateFromProps;(z=typeof V=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(s!==L||Q!==F)&&aw(o,B,u,F),Oa=!1,Q=o.memoizedState,B.state=Q,bh(o,u,B,m);var ie=o.memoizedState;s!==L||Q!==ie||Yi.current||Oa?(typeof V=="function"&&(fp(o,a,V,u),ie=o.memoizedState),(M=Oa||sw(o,a,M,u,Q,ie,F))?(z||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(u,ie,F),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(u,ie,F)),typeof B.componentDidUpdate=="function"&&(o.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(o.flags|=256)):(typeof B.componentDidUpdate!="function"||s===t.memoizedProps&&Q===t.memoizedState||(o.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&Q===t.memoizedState||(o.flags|=256),o.memoizedProps=u,o.memoizedState=ie),B.props=u,B.state=ie,B.context=F,u=M):(typeof B.componentDidUpdate!="function"||s===t.memoizedProps&&Q===t.memoizedState||(o.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&Q===t.memoizedState||(o.flags|=256),u=!1)}return Sy(t,o,a,u,x,m)}function Sy(t,o,a,u,m,x){sb(t,o);var B=(o.flags&64)!==0;if(!u&&!B)return m&&tw(o,a,!1),ta(t,o,x);u=o.stateNode,CI.current=o;var s=B&&typeof a.getDerivedStateFromError!="function"?null:u.render();return o.flags|=1,t!==null&&B?(o.child=pp(o,t.child,null,x),o.child=pp(o,null,s,x)):qi(t,o,s,x),o.memoizedState=u.state,m&&tw(o,a,!0),o.child}function gw(t){var o=t.stateNode;o.pendingContext?ew(t,o.pendingContext,o.pendingContext!==o.context):o.context&&ew(t,o.context,!1),Fy(t,o.containerInfo)}var df={dehydrated:null,retryLane:0};function yw(t,o,a){var u=o.pendingProps,m=vn.current,x=!1,B;return(B=(o.flags&64)!==0)||(B=t!==null&&t.memoizedState===null?!1:(m&2)!==0),B?(x=!0,o.flags&=-65):t!==null&&t.memoizedState===null||u.fallback===void 0||u.unstable_avoidThisFallback===!0||(m|=1),xn(vn,m&1),t===null?(u.fallback!==void 0&&Iy(o),t=u.children,m=u.fallback,x?(t=_w(o,t,m,a),o.child.memoizedState={baseLanes:a},o.memoizedState=df,t):typeof u.unstable_expectedLoadTime=="number"?(t=_w(o,t,m,a),o.child.memoizedState={baseLanes:a},o.memoizedState=df,o.lanes=33554432,t):(a=s0({mode:"visible",children:t},o.mode,a,null),a.return=o,o.child=a)):t.memoizedState!==null?x?(u=xw(t,o,u.children,u.fallback,a),x=o.child,m=t.child.memoizedState,x.memoizedState=m===null?{baseLanes:a}:{baseLanes:m.baseLanes|a},x.childLanes=t.childLanes&~a,o.memoizedState=df,u):(a=vw(t,o,u.children,a),o.memoizedState=null,a):x?(u=xw(t,o,u.children,u.fallback,a),x=o.child,m=t.child.memoizedState,x.memoizedState=m===null?{baseLanes:a}:{baseLanes:m.baseLanes|a},x.childLanes=t.childLanes&~a,o.memoizedState=df,u):(a=vw(t,o,u.children,a),o.memoizedState=null,a)}function _w(t,o,a,u){var m=t.mode,x=t.child;return o={mode:"hidden",children:o},!(m&2)&&x!==null?(x.childLanes=0,x.pendingProps=o):x=s0(o,m,0,null),a=mc(a,m,u,null),x.return=t,a.return=t,x.sibling=a,t.child=x,a}function vw(t,o,a,u){var m=t.child;return t=m.sibling,a=aA(m,{mode:"visible",children:a}),!(o.mode&2)&&(a.lanes=u),a.return=o,a.sibling=null,t!==null&&(t.nextEffect=null,t.flags=8,o.firstEffect=o.lastEffect=t),o.child=a}function xw(t,o,a,u,m){var x=o.mode,B=t.child;t=B.sibling;var s={mode:"hidden",children:a};return!(x&2)&&o.child!==B?(a=o.child,a.childLanes=0,a.pendingProps=s,B=a.lastEffect,B!==null?(o.firstEffect=a.firstEffect,o.lastEffect=B,B.nextEffect=null):o.firstEffect=o.lastEffect=null):a=aA(B,s),t!==null?u=aA(t,u):(u=mc(u,x,m,null),u.flags|=2),u.return=o,a.return=o,a.sibling=u,o.child=a,u}function ww(t,o){t.lanes|=o;var a=t.alternate;a!==null&&(a.lanes|=o),G1(t.return,o)}function Qg(t,o,a,u,m,x){var B=t.memoizedState;B===null?t.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:u,tail:a,tailMode:m,lastEffect:x}:(B.isBackwards=o,B.rendering=null,B.renderingStartTime=0,B.last=u,B.tail=a,B.tailMode=m,B.lastEffect=x)}function Bw(t,o,a){var u=o.pendingProps,m=u.revealOrder,x=u.tail;if(qi(t,o,u.children,a),u=vn.current,u&2)u=u&1|2,o.flags|=64;else{if(t!==null&&t.flags&64)e:for(t=o.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ww(t,a);else if(t.tag===19)ww(t,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===o)break e;for(;t.sibling===null;){if(t.return===null||t.return===o)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}u&=1}if(xn(vn,u),!(o.mode&2))o.memoizedState=null;else switch(m){case"forwards":for(a=o.child,m=null;a!==null;)t=a.alternate,t!==null&&mp(t)===null&&(m=a),a=a.sibling;a=m,a===null?(m=o.child,o.child=null):(m=a.sibling,a.sibling=null),Qg(o,!1,m,a,x,o.lastEffect);break;case"backwards":for(a=null,m=o.child,o.child=null;m!==null;){if(t=m.alternate,t!==null&&mp(t)===null){o.child=m;break}t=m.sibling,m.sibling=a,a=m,m=t}Qg(o,!0,a,null,x,o.lastEffect);break;case"together":Qg(o,!1,null,null,void 0,o.lastEffect);break;default:o.memoizedState=null}return o.child}function ta(t,o,a){if(t!==null&&(o.dependencies=t.dependencies),Dh|=o.lanes,a&o.childLanes){if(t!==null&&o.child!==t.child)throw Error(_t(153));if(o.child!==null){for(t=o.child,a=aA(t,t.pendingProps),o.child=a,a.return=o;t.sibling!==null;)t=t.sibling,a=a.sibling=aA(t,t.pendingProps),a.return=o;a.sibling=null}return o.child}return null}var ab,Qy,Ab,lb;ab=function(t,o){for(var a=o.child;a!==null;){if(a.tag===5||a.tag===6)t.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};Qy=function(){};Ab=function(t,o,a,u){var m=t.memoizedProps;if(m!==u){t=o.stateNode,HA(Qs.current);var x=null;switch(a){case"input":m=oy(t,m),u=oy(t,u),x=[];break;case"option":m=Ay(t,m),u=Ay(t,u),x=[];break;case"select":m=rn({},m,{value:void 0}),u=rn({},u,{value:void 0}),x=[];break;case"textarea":m=ly(t,m),u=ly(t,u),x=[];break;default:typeof m.onClick!="function"&&typeof u.onClick=="function"&&(t.onclick=Ap)}hy(a,u);var B;a=null;for(M in m)if(!u.hasOwnProperty(M)&&m.hasOwnProperty(M)&&m[M]!=null)if(M==="style"){var s=m[M];for(B in s)s.hasOwnProperty(B)&&(a||(a={}),a[B]="")}else M!=="dangerouslySetInnerHTML"&&M!=="children"&&M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(fh.hasOwnProperty(M)?x||(x=[]):(x=x||[]).push(M,null));for(M in u){var F=u[M];if(s=m!=null?m[M]:void 0,u.hasOwnProperty(M)&&F!==s&&(F!=null||s!=null))if(M==="style")if(s){for(B in s)!s.hasOwnProperty(B)||F&&F.hasOwnProperty(B)||(a||(a={}),a[B]="");for(B in F)F.hasOwnProperty(B)&&s[B]!==F[B]&&(a||(a={}),a[B]=F[B])}else a||(x||(x=[]),x.push(M,a)),a=F;else M==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,s=s?s.__html:void 0,F!=null&&s!==F&&(x=x||[]).push(M,F)):M==="children"?typeof F!="string"&&typeof F!="number"||(x=x||[]).push(M,""+F):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&(fh.hasOwnProperty(M)?(F!=null&&M==="onScroll"&&Xr("scroll",t),x||s===F||(x=[])):typeof F=="object"&&F!==null&&F.$$typeof===E_?F.toString():(x=x||[]).push(M,F))}a&&(x=x||[]).push("style",a);var M=x;(o.updateQueue=M)&&(o.flags|=4)}};lb=function(t,o,a,u){a!==u&&(o.flags|=4)};function Mu(t,o){if(!Ms)switch(t.tailMode){case"hidden":o=t.tail;for(var a=null;o!==null;)o.alternate!==null&&(a=o),o=o.sibling;a===null?t.tail=null:a.sibling=null;break;case"collapsed":a=t.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?o||t.tail===null?t.tail=null:t.tail.sibling=null:u.sibling=null}}function EI(t,o,a){var u=o.pendingProps;switch(o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return eo(o.type)&&cp(),null;case 3:return xc(),Wr(Yi),Wr(Fi),X_(),u=o.stateNode,u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(t===null||t.child===null)&&(hf(o)?o.flags|=4:u.hydrate||(o.flags|=256)),Qy(o),null;case 5:Z_(o);var m=HA(Eh.current);if(a=o.type,t!==null&&o.stateNode!=null)Ab(t,o,a,u,m),t.ref!==o.ref&&(o.flags|=128);else{if(!u){if(o.stateNode===null)throw Error(_t(166));return null}if(t=HA(Qs.current),hf(o)){u=o.stateNode,a=o.type;var x=o.memoizedProps;switch(u[Na]=o,u[lp]=x,a){case"dialog":Xr("cancel",u),Xr("close",u);break;case"iframe":case"object":case"embed":Xr("load",u);break;case"video":case"audio":for(t=0;t<Hu.length;t++)Xr(Hu[t],u);break;case"source":Xr("error",u);break;case"img":case"image":case"link":Xr("error",u),Xr("load",u);break;case"details":Xr("toggle",u);break;case"input":Bx(u,x),Xr("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!x.multiple},Xr("invalid",u);break;case"textarea":Cx(u,x),Xr("invalid",u)}hy(a,x),t=null;for(var B in x)x.hasOwnProperty(B)&&(m=x[B],B==="children"?typeof m=="string"?u.textContent!==m&&(t=["children",m]):typeof m=="number"&&u.textContent!==""+m&&(t=["children",""+m]):fh.hasOwnProperty(B)&&m!=null&&B==="onScroll"&&Xr("scroll",u));switch(a){case"input":sf(u),bx(u,x,!0);break;case"textarea":sf(u),Ex(u);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(u.onclick=Ap)}u=t,o.updateQueue=u,u!==null&&(o.flags|=4)}else{switch(B=m.nodeType===9?m:m.ownerDocument,t===cy.html&&(t=r1(a)),t===cy.html?a==="script"?(t=B.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof u.is=="string"?t=B.createElement(a,{is:u.is}):(t=B.createElement(a),a==="select"&&(B=t,u.multiple?B.multiple=!0:u.size&&(B.size=u.size))):t=B.createElementNS(t,a),t[Na]=o,t[lp]=u,ab(t,o,!1,!1),o.stateNode=t,B=dy(a,u),a){case"dialog":Xr("cancel",t),Xr("close",t),m=u;break;case"iframe":case"object":case"embed":Xr("load",t),m=u;break;case"video":case"audio":for(m=0;m<Hu.length;m++)Xr(Hu[m],t);m=u;break;case"source":Xr("error",t),m=u;break;case"img":case"image":case"link":Xr("error",t),Xr("load",t),m=u;break;case"details":Xr("toggle",t),m=u;break;case"input":Bx(t,u),m=oy(t,u),Xr("invalid",t);break;case"option":m=Ay(t,u);break;case"select":t._wrapperState={wasMultiple:!!u.multiple},m=rn({},u,{value:void 0}),Xr("invalid",t);break;case"textarea":Cx(t,u),m=ly(t,u),Xr("invalid",t);break;default:m=u}hy(a,m);var s=m;for(x in s)if(s.hasOwnProperty(x)){var F=s[x];x==="style"?o1(t,F):x==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,F!=null&&n1(t,F)):x==="children"?typeof F=="string"?(a!=="textarea"||F!=="")&&ph(t,F):typeof F=="number"&&ph(t,""+F):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(fh.hasOwnProperty(x)?F!=null&&x==="onScroll"&&Xr("scroll",t):F!=null&&v_(t,x,F,B))}switch(a){case"input":sf(t),bx(t,u,!1);break;case"textarea":sf(t),Ex(t);break;case"option":u.value!=null&&t.setAttribute("value",""+nA(u.value));break;case"select":t.multiple=!!u.multiple,x=u.value,x!=null?Ac(t,!!u.multiple,x,!1):u.defaultValue!=null&&Ac(t,!!u.multiple,u.defaultValue,!0);break;default:typeof m.onClick=="function"&&(t.onclick=Ap)}k1(a,u)&&(o.flags|=4)}o.ref!==null&&(o.flags|=128)}return null;case 6:if(t&&o.stateNode!=null)lb(t,o,t.memoizedProps,u);else{if(typeof u!="string"&&o.stateNode===null)throw Error(_t(166));a=HA(Eh.current),HA(Qs.current),hf(o)?(u=o.stateNode,a=o.memoizedProps,u[Na]=o,u.nodeValue!==a&&(o.flags|=4)):(u=(a.nodeType===9?a:a.ownerDocument).createTextNode(u),u[Na]=o,o.stateNode=u)}return null;case 13:return Wr(vn),u=o.memoizedState,o.flags&64?(o.lanes=a,o):(u=u!==null,a=!1,t===null?o.memoizedProps.fallback!==void 0&&hf(o):a=t.memoizedState!==null,u&&!a&&o.mode&2&&(t===null&&o.memoizedProps.unstable_avoidThisFallback!==!0||vn.current&1?di===0&&(di=3):((di===0||di===3)&&(di=4),Ni===null||!(Dh&134217727)&&!(Ic&134217727)||fc(Ni,Ei))),(u||a)&&(o.flags|=4),null);case 4:return xc(),Qy(o),t===null&&M1(o.stateNode.containerInfo),null;case 10:return G_(o),null;case 17:return eo(o.type)&&cp(),null;case 19:if(Wr(vn),u=o.memoizedState,u===null)return null;if(x=(o.flags&64)!==0,B=u.rendering,B===null)if(x)Mu(u,!1);else{if(di!==0||t!==null&&t.flags&64)for(t=o.child;t!==null;){if(B=mp(t),B!==null){for(o.flags|=64,Mu(u,!1),x=B.updateQueue,x!==null&&(o.updateQueue=x,o.flags|=4),u.lastEffect===null&&(o.firstEffect=null),o.lastEffect=u.lastEffect,u=a,a=o.child;a!==null;)x=a,t=u,x.flags&=2,x.nextEffect=null,x.firstEffect=null,x.lastEffect=null,B=x.alternate,B===null?(x.childLanes=0,x.lanes=t,x.child=null,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=B.childLanes,x.lanes=B.lanes,x.child=B.child,x.memoizedProps=B.memoizedProps,x.memoizedState=B.memoizedState,x.updateQueue=B.updateQueue,x.type=B.type,t=B.dependencies,x.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),a=a.sibling;return xn(vn,vn.current&1|2),o.child}t=t.sibling}u.tail!==null&&Ci()>Oy&&(o.flags|=64,x=!0,Mu(u,!1),o.lanes=33554432)}else{if(!x)if(t=mp(B),t!==null){if(o.flags|=64,x=!0,a=t.updateQueue,a!==null&&(o.updateQueue=a,o.flags|=4),Mu(u,!0),u.tail===null&&u.tailMode==="hidden"&&!B.alternate&&!Ms)return o=o.lastEffect=u.lastEffect,o!==null&&(o.nextEffect=null),null}else 2*Ci()-u.renderingStartTime>Oy&&a!==1073741824&&(o.flags|=64,x=!0,Mu(u,!1),o.lanes=33554432);u.isBackwards?(B.sibling=o.child,o.child=B):(a=u.last,a!==null?a.sibling=B:o.child=B,u.last=B)}return u.tail!==null?(a=u.tail,u.rendering=a,u.tail=a.sibling,u.lastEffect=o.lastEffect,u.renderingStartTime=Ci(),a.sibling=null,o=vn.current,xn(vn,x?o&1|2:o&1),a):null;case 23:case 24:return i0(),t!==null&&t.memoizedState!==null!=(o.memoizedState!==null)&&u.mode!=="unstable-defer-without-hiding"&&(o.flags|=4),null}throw Error(_t(156,o.tag))}function FI(t){switch(t.tag){case 1:eo(t.type)&&cp();var o=t.flags;return o&4096?(t.flags=o&-4097|64,t):null;case 3:if(xc(),Wr(Yi),Wr(Fi),X_(),o=t.flags,o&64)throw Error(_t(285));return t.flags=o&-4097|64,t;case 5:return Z_(t),null;case 13:return Wr(vn),o=t.flags,o&4096?(t.flags=o&-4097|64,t):null;case 19:return Wr(vn),null;case 4:return xc(),null;case 10:return G_(t),null;case 23:case 24:return i0(),null;default:return null}}function e0(t,o){try{var a="",u=o;do a+=a2(u),u=u.return;while(u);var m=a}catch(x){m=`
Error generating stack: `+x.message+`
`+x.stack}return{value:t,source:o,stack:m}}function My(t,o){try{console.error(o.value)}catch(a){setTimeout(function(){throw a})}}var II=typeof WeakMap=="function"?WeakMap:Map;function cb(t,o,a){a=$a(-1,a),a.tag=3,a.payload={element:null};var u=o.value;return a.callback=function(){Bp||(Bp=!0,Ry=u),My(t,o)},a}function ub(t,o,a){a=$a(-1,a),a.tag=3;var u=t.type.getDerivedStateFromError;if(typeof u=="function"){var m=o.value;a.payload=function(){return My(t,o),u(m)}}var x=t.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(a.callback=function(){typeof u!="function"&&(Ss===null?Ss=new Set([this]):Ss.add(this),My(t,o));var B=o.stack;this.componentDidCatch(o.value,{componentStack:B!==null?B:""})}),a}var TI=typeof WeakSet=="function"?WeakSet:Set;function bw(t){var o=t.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(a){eA(t,a)}else o.current=null}function UI(t,o){switch(o.tag){case 0:case 11:case 15:case 22:return;case 1:if(o.flags&256&&t!==null){var a=t.memoizedProps,u=t.memoizedState;t=o.stateNode,o=t.getSnapshotBeforeUpdate(o.elementType===o.type?a:rs(o.type,a),u),t.__reactInternalSnapshotBeforeUpdate=o}return;case 3:o.flags&256&&H_(o.stateNode.containerInfo);return;case 5:case 6:case 4:case 17:return}throw Error(_t(163))}function SI(t,o,a){switch(a.tag){case 0:case 11:case 15:case 22:if(o=a.updateQueue,o=o!==null?o.lastEffect:null,o!==null){t=o=o.next;do{if((t.tag&3)===3){var u=t.create;t.destroy=u()}t=t.next}while(t!==o)}if(o=a.updateQueue,o=o!==null?o.lastEffect:null,o!==null){t=o=o.next;do{var m=t;u=m.next,m=m.tag,m&4&&m&1&&(vb(a,t),RI(a,t)),t=u}while(t!==o)}return;case 1:t=a.stateNode,a.flags&4&&(o===null?t.componentDidMount():(u=a.elementType===a.type?o.memoizedProps:rs(a.type,o.memoizedProps),t.componentDidUpdate(u,o.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),o=a.updateQueue,o!==null&&ow(a,o,t);return;case 3:if(o=a.updateQueue,o!==null){if(t=null,a.child!==null)switch(a.child.tag){case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}ow(a,o,t)}return;case 5:t=a.stateNode,o===null&&a.flags&4&&k1(a.type,a.memoizedProps)&&t.focus();return;case 6:return;case 4:return;case 12:return;case 13:a.memoizedState===null&&(a=a.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&p1(a))));return;case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(_t(163))}function Cw(t,o){for(var a=t;;){if(a.tag===5){var u=a.stateNode;if(o)u=u.style,typeof u.setProperty=="function"?u.setProperty("display","none","important"):u.display="none";else{u=a.stateNode;var m=a.memoizedProps.style;m=m!=null&&m.hasOwnProperty("display")?m.display:null,u.style.display=i1("display",m)}}else if(a.tag===6)a.stateNode.nodeValue=o?"":a.memoizedProps;else if((a.tag!==23&&a.tag!==24||a.memoizedState===null||a===t)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return;a=a.return}a.sibling.return=a.return,a=a.sibling}}function Ew(t,o){if(KA&&typeof KA.onCommitFiberUnmount=="function")try{KA.onCommitFiberUnmount(N_,o)}catch{}switch(o.tag){case 0:case 11:case 14:case 15:case 22:if(t=o.updateQueue,t!==null&&(t=t.lastEffect,t!==null)){var a=t=t.next;do{var u=a,m=u.destroy;if(u=u.tag,m!==void 0)if(u&4)vb(o,a);else{u=o;try{m()}catch(x){eA(u,x)}}a=a.next}while(a!==t)}break;case 1:if(bw(o),t=o.stateNode,typeof t.componentWillUnmount=="function")try{t.props=o.memoizedProps,t.state=o.memoizedState,t.componentWillUnmount()}catch(x){eA(o,x)}break;case 5:bw(o);break;case 4:hb(t,o)}}function Fw(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function Iw(t){return t.tag===5||t.tag===3||t.tag===4}function Tw(t){e:{for(var o=t.return;o!==null;){if(Iw(o))break e;o=o.return}throw Error(_t(160))}var a=o;switch(o=a.stateNode,a.tag){case 5:var u=!1;break;case 3:o=o.containerInfo,u=!0;break;case 4:o=o.containerInfo,u=!0;break;default:throw Error(_t(161))}a.flags&16&&(ph(o,""),a.flags&=-17);e:t:for(a=t;;){for(;a.sibling===null;){if(a.return===null||Iw(a.return)){a=null;break e}a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue t;a.child.return=a,a=a.child}if(!(a.flags&2)){a=a.stateNode;break e}}u?Ly(t,a,o):Dy(t,a,o)}function Ly(t,o,a){var u=t.tag,m=u===5||u===6;if(m)t=m?t.stateNode:t.stateNode.instance,o?a.nodeType===8?a.parentNode.insertBefore(t,o):a.insertBefore(t,o):(a.nodeType===8?(o=a.parentNode,o.insertBefore(t,a)):(o=a,o.appendChild(t)),a=a._reactRootContainer,a!=null||o.onclick!==null||(o.onclick=Ap));else if(u!==4&&(t=t.child,t!==null))for(Ly(t,o,a),t=t.sibling;t!==null;)Ly(t,o,a),t=t.sibling}function Dy(t,o,a){var u=t.tag,m=u===5||u===6;if(m)t=m?t.stateNode:t.stateNode.instance,o?a.insertBefore(t,o):a.appendChild(t);else if(u!==4&&(t=t.child,t!==null))for(Dy(t,o,a),t=t.sibling;t!==null;)Dy(t,o,a),t=t.sibling}function hb(t,o){for(var a=o,u=!1,m,x;;){if(!u){u=a.return;e:for(;;){if(u===null)throw Error(_t(160));switch(m=u.stateNode,u.tag){case 5:x=!1;break e;case 3:m=m.containerInfo,x=!0;break e;case 4:m=m.containerInfo,x=!0;break e}u=u.return}u=!0}if(a.tag===5||a.tag===6){e:for(var B=t,s=a,F=s;;)if(Ew(B,F),F.child!==null&&F.tag!==4)F.child.return=F,F=F.child;else{if(F===s)break e;for(;F.sibling===null;){if(F.return===null||F.return===s)break e;F=F.return}F.sibling.return=F.return,F=F.sibling}x?(B=m,s=a.stateNode,B.nodeType===8?B.parentNode.removeChild(s):B.removeChild(s)):m.removeChild(a.stateNode)}else if(a.tag===4){if(a.child!==null){m=a.stateNode.containerInfo,x=!0,a.child.return=a,a=a.child;continue}}else if(Ew(t,a),a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return;a=a.return,a.tag===4&&(u=!1)}a.sibling.return=a.return,a=a.sibling}}function Mg(t,o){switch(o.tag){case 0:case 11:case 14:case 15:case 22:var a=o.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var u=a=a.next;do(u.tag&3)===3&&(t=u.destroy,u.destroy=void 0,t!==void 0&&t()),u=u.next;while(u!==a)}return;case 1:return;case 5:if(a=o.stateNode,a!=null){u=o.memoizedProps;var m=t!==null?t.memoizedProps:u;t=o.type;var x=o.updateQueue;if(o.updateQueue=null,x!==null){for(a[lp]=u,t==="input"&&u.type==="radio"&&u.name!=null&&e1(a,u),dy(t,m),o=dy(t,u),m=0;m<x.length;m+=2){var B=x[m],s=x[m+1];B==="style"?o1(a,s):B==="dangerouslySetInnerHTML"?n1(a,s):B==="children"?ph(a,s):v_(a,B,s,o)}switch(t){case"input":sy(a,u);break;case"textarea":t1(a,u);break;case"select":t=a._wrapperState.wasMultiple,a._wrapperState.wasMultiple=!!u.multiple,x=u.value,x!=null?Ac(a,!!u.multiple,x,!1):t!==!!u.multiple&&(u.defaultValue!=null?Ac(a,!!u.multiple,u.defaultValue,!0):Ac(a,!!u.multiple,u.multiple?[]:"",!1))}}}return;case 6:if(o.stateNode===null)throw Error(_t(162));o.stateNode.nodeValue=o.memoizedProps;return;case 3:a=o.stateNode,a.hydrate&&(a.hydrate=!1,p1(a.containerInfo));return;case 12:return;case 13:o.memoizedState!==null&&(n0=Ci(),Cw(o.child,!0)),Uw(o);return;case 19:Uw(o);return;case 17:return;case 23:case 24:Cw(o,o.memoizedState!==null);return}throw Error(_t(163))}function Uw(t){var o=t.updateQueue;if(o!==null){t.updateQueue=null;var a=t.stateNode;a===null&&(a=t.stateNode=new TI),o.forEach(function(u){var m=NI.bind(null,t,u);a.has(u)||(a.add(u),u.then(m,m))})}}function QI(t,o){return t!==null&&(t=t.memoizedState,t===null||t.dehydrated!==null)?(o=o.memoizedState,o!==null&&o.dehydrated===null):!1}var MI=Math.ceil,wp=qA.ReactCurrentDispatcher,t0=qA.ReactCurrentOwner,nr=0,Ni=null,jn=null,Ei=0,WA=0,ky=lA(0),di=0,Zp=null,Fc=0,Dh=0,Ic=0,r0=0,Py=null,n0=0,Oy=1/0;function Tc(){Oy=Ci()+500}var Lt=null,Bp=!1,Ry=null,Ss=null,sA=!1,sh=null,Nu=90,zy=[],Hy=[],ra=null,ah=0,Ny=null,Zf=-1,Ys=0,Xf=0,Ah=null,Wf=!1;function go(){return nr&48?Ci():Zf!==-1?Zf:Zf=Ci()}function Ja(t){if(t=t.mode,!(t&2))return 1;if(!(t&4))return vc()===99?1:2;if(Ys===0&&(Ys=Fc),vI.transition!==0){Xf!==0&&(Xf=Py!==null?Py.pendingLanes:0),t=Ys;var o=4186112&~Xf;return o&=-o,o===0&&(t=4186112&~t,o=t&-t,o===0&&(o=8192)),o}return t=vc(),nr&4&&t===98?t=sp(12,Ys):(t=B2(t),t=sp(t,Ys)),t}function Ya(t,o,a){if(50<ah)throw ah=0,Ny=null,Error(_t(185));if(t=Xp(t,o),t===null)return null;zp(t,o,a),t===Ni&&(Ic|=o,di===4&&fc(t,Ei));var u=vc();o===1?nr&8&&!(nr&48)?Vy(t):(Ho(t,a),nr===0&&(Tc(),Ls())):(!(nr&4)||u!==98&&u!==99||(ra===null?ra=new Set([t]):ra.add(t)),Ho(t,a)),Py=t}function Xp(t,o){t.lanes|=o;var a=t.alternate;for(a!==null&&(a.lanes|=o),a=t,t=t.return;t!==null;)t.childLanes|=o,a=t.alternate,a!==null&&(a.childLanes|=o),a=t,t=t.return;return a.tag===3?a.stateNode:null}function Ho(t,o){for(var a=t.callbackNode,u=t.suspendedLanes,m=t.pingedLanes,x=t.expirationTimes,B=t.pendingLanes;0<B;){var s=31-iA(B),F=1<<s,M=x[s];if(M===-1){if(!(F&u)||F&m){M=o,$l(F);var z=Vr;x[s]=10<=z?M+250:6<=z?M+5e3:-1}}else M<=o&&(t.expiredLanes|=F);B&=~F}if(u=_h(t,t===Ni?Ei:0),o=Vr,u===0)a!==null&&(a!==Ig&&by(a),t.callbackNode=null,t.callbackPriority=0);else{if(a!==null){if(t.callbackPriority===o)return;a!==Ig&&by(a)}o===15?(a=Vy.bind(null,t),Js===null?(Js=[a],jf=V_(Gp,K1)):Js.push(a),a=Ig):o===14?a=Bh(99,Vy.bind(null,t)):(a=b2(o),a=Bh(a,db.bind(null,t))),t.callbackPriority=o,t.callbackNode=a}}function db(t){if(Zf=-1,Xf=Ys=0,nr&48)throw Error(_t(327));var o=t.callbackNode;if(cA()&&t.callbackNode!==o)return null;var a=_h(t,t===Ni?Ei:0);if(a===0)return null;var u=a,m=nr;nr|=16;var x=gb();(Ni!==t||Ei!==u)&&(Tc(),pc(t,u));do try{kI();break}catch(s){mb(t,s)}while(1);if(K_(),wp.current=x,nr=m,jn!==null?u=0:(Ni=null,Ei=0,u=di),Fc&Ic)pc(t,0);else if(u!==0){if(u===2&&(nr|=64,t.hydrate&&(t.hydrate=!1,H_(t.containerInfo)),a=w1(t),a!==0&&(u=Vu(t,a))),u===1)throw o=Zp,pc(t,0),fc(t,a),Ho(t,Ci()),o;switch(t.finishedWork=t.current.alternate,t.finishedLanes=a,u){case 0:case 1:throw Error(_t(345));case 2:kA(t);break;case 3:if(fc(t,a),(a&62914560)===a&&(u=n0+500-Ci(),10<u)){if(_h(t,0)!==0)break;if(m=t.suspendedLanes,(m&a)!==a){go(),t.pingedLanes|=t.suspendedLanes&m;break}t.timeoutHandle=qx(kA.bind(null,t),u);break}kA(t);break;case 4:if(fc(t,a),(a&4186112)===a)break;for(u=t.eventTimes,m=-1;0<a;){var B=31-iA(a);x=1<<B,B=u[B],B>m&&(m=B),a&=~x}if(a=m,a=Ci()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*MI(a/1960))-a,10<a){t.timeoutHandle=qx(kA.bind(null,t),a);break}kA(t);break;case 5:kA(t);break;default:throw Error(_t(329))}}return Ho(t,Ci()),t.callbackNode===o?db.bind(null,t):null}function fc(t,o){for(o&=~r0,o&=~Ic,t.suspendedLanes|=o,t.pingedLanes&=~o,t=t.expirationTimes;0<o;){var a=31-iA(o),u=1<<a;t[a]=-1,o&=~u}}function Vy(t){if(nr&48)throw Error(_t(327));if(cA(),t===Ni&&t.expiredLanes&Ei){var o=Ei,a=Vu(t,o);Fc&Ic&&(o=_h(t,o),a=Vu(t,o))}else o=_h(t,0),a=Vu(t,o);if(t.tag!==0&&a===2&&(nr|=64,t.hydrate&&(t.hydrate=!1,H_(t.containerInfo)),o=w1(t),o!==0&&(a=Vu(t,o))),a===1)throw a=Zp,pc(t,0),fc(t,o),Ho(t,Ci()),a;return t.finishedWork=t.current.alternate,t.finishedLanes=o,kA(t),Ho(t,Ci()),null}function LI(){if(ra!==null){var t=ra;ra=null,t.forEach(function(o){o.expiredLanes|=24&o.pendingLanes,Ho(o,Ci())})}Ls()}function fb(t,o){var a=nr;nr|=1;try{return t(o)}finally{nr=a,nr===0&&(Tc(),Ls())}}function pb(t,o){var a=nr;nr&=-2,nr|=8;try{return t(o)}finally{nr=a,nr===0&&(Tc(),Ls())}}function ff(t,o){xn(ky,WA),WA|=o,Fc|=o}function i0(){WA=ky.current,Wr(ky)}function pc(t,o){t.finishedWork=null,t.finishedLanes=0;var a=t.timeoutHandle;if(a!==-1&&(t.timeoutHandle=-1,fI(a)),jn!==null)for(a=jn.return;a!==null;){var u=a;switch(u.tag){case 1:u=u.type.childContextTypes,u!=null&&cp();break;case 3:xc(),Wr(Yi),Wr(Fi),X_();break;case 5:Z_(u);break;case 4:xc();break;case 13:Wr(vn);break;case 19:Wr(vn);break;case 10:G_(u);break;case 23:case 24:i0()}a=a.return}Ni=t,jn=aA(t.current,null),Ei=WA=Fc=o,di=0,Zp=null,r0=Ic=Dh=0}function mb(t,o){do{var a=jn;try{if(K_(),ih.current=xp,gp){for(var u=In.memoizedState;u!==null;){var m=u.queue;m!==null&&(m.pending=null),u=u.next}gp=!1}if(Fh=0,hi=Bi=In=null,oh=!1,t0.current=null,a===null||a.return===null){di=1,Zp=o,jn=null;break}e:{var x=t,B=a.return,s=a,F=o;if(o=Ei,s.flags|=2048,s.firstEffect=s.lastEffect=null,F!==null&&typeof F=="object"&&typeof F.then=="function"){var M=F;if(!(s.mode&2)){var z=s.alternate;z?(s.updateQueue=z.updateQueue,s.memoizedState=z.memoizedState,s.lanes=z.lanes):(s.updateQueue=null,s.memoizedState=null)}var L=(vn.current&1)!==0,Q=B;do{var V;if(V=Q.tag===13){var ie=Q.memoizedState;if(ie!==null)V=ie.dehydrated!==null;else{var de=Q.memoizedProps;V=de.fallback===void 0?!1:de.unstable_avoidThisFallback!==!0?!0:!L}}if(V){var re=Q.updateQueue;if(re===null){var K=new Set;K.add(M),Q.updateQueue=K}else re.add(M);if(!(Q.mode&2)){if(Q.flags|=64,s.flags|=16384,s.flags&=-2981,s.tag===1)if(s.alternate===null)s.tag=17;else{var G=$a(-1,1);G.tag=2,qa(s,G)}s.lanes|=1;break e}F=void 0,s=o;var ne=x.pingCache;if(ne===null?(ne=x.pingCache=new II,F=new Set,ne.set(M,F)):(F=ne.get(M),F===void 0&&(F=new Set,ne.set(M,F))),!F.has(s)){F.add(s);var oe=HI.bind(null,x,M,s);M.then(oe,oe)}Q.flags|=4096,Q.lanes=o;break e}Q=Q.return}while(Q!==null);F=Error((ac(s.type)||"A React component")+` suspended while rendering, but no fallback UI was specified.

Add a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.`)}di!==5&&(di=2),F=e0(F,s),Q=B;do{switch(Q.tag){case 3:x=F,Q.flags|=4096,o&=-o,Q.lanes|=o;var we=cb(Q,x,o);iw(Q,we);break e;case 1:x=F;var ge=Q.type,Ue=Q.stateNode;if(!(Q.flags&64)&&(typeof ge.getDerivedStateFromError=="function"||Ue!==null&&typeof Ue.componentDidCatch=="function"&&(Ss===null||!Ss.has(Ue)))){Q.flags|=4096,o&=-o,Q.lanes|=o;var Ke=ub(Q,x,o);iw(Q,Ke);break e}}Q=Q.return}while(Q!==null)}_b(a)}catch(Me){o=Me,jn===a&&a!==null&&(jn=a=a.return);continue}break}while(1)}function gb(){var t=wp.current;return wp.current=xp,t===null?xp:t}function Vu(t,o){var a=nr;nr|=16;var u=gb();Ni===t&&Ei===o||pc(t,o);do try{DI();break}catch(m){mb(t,m)}while(1);if(K_(),nr=a,wp.current=u,jn!==null)throw Error(_t(261));return Ni=null,Ei=0,di}function DI(){for(;jn!==null;)yb(jn)}function kI(){for(;jn!==null&&!gI();)yb(jn)}function yb(t){var o=xb(t.alternate,t,WA);t.memoizedProps=t.pendingProps,o===null?_b(t):jn=o,t0.current=null}function _b(t){var o=t;do{var a=o.alternate;if(t=o.return,o.flags&2048){if(a=FI(o),a!==null){a.flags&=2047,jn=a;return}t!==null&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}else{if(a=EI(a,o,WA),a!==null){jn=a;return}if(a=o,a.tag!==24&&a.tag!==23||a.memoizedState===null||WA&1073741824||!(a.mode&4)){for(var u=0,m=a.child;m!==null;)u|=m.lanes|m.childLanes,m=m.sibling;a.childLanes=u}t!==null&&!(t.flags&2048)&&(t.firstEffect===null&&(t.firstEffect=o.firstEffect),o.lastEffect!==null&&(t.lastEffect!==null&&(t.lastEffect.nextEffect=o.firstEffect),t.lastEffect=o.lastEffect),1<o.flags&&(t.lastEffect!==null?t.lastEffect.nextEffect=o:t.firstEffect=o,t.lastEffect=o))}if(o=o.sibling,o!==null){jn=o;return}jn=o=t}while(o!==null);di===0&&(di=5)}function kA(t){var o=vc();return XA(99,PI.bind(null,t,o)),null}function PI(t,o){do cA();while(sh!==null);if(nr&48)throw Error(_t(327));var a=t.finishedWork;if(a===null)return null;if(t.finishedWork=null,t.finishedLanes=0,a===t.current)throw Error(_t(177));t.callbackNode=null;var u=a.lanes|a.childLanes,m=u,x=t.pendingLanes&~m;t.pendingLanes=m,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=m,t.mutableReadLanes&=m,t.entangledLanes&=m,m=t.entanglements;for(var B=t.eventTimes,s=t.expirationTimes;0<x;){var F=31-iA(x),M=1<<F;m[F]=0,B[F]=-1,s[F]=-1,x&=~M}if(ra!==null&&!(u&24)&&ra.has(t)&&ra.delete(t),t===Ni&&(jn=Ni=null,Ei=0),1<a.flags?a.lastEffect!==null?(a.lastEffect.nextEffect=a,u=a.firstEffect):u=a:u=a.firstEffect,u!==null){if(m=nr,nr|=32,t0.current=null,Cg=Nf,B=Kx(),_y(B)){if("selectionStart"in B)s={start:B.selectionStart,end:B.selectionEnd};else e:if(s=(s=B.ownerDocument)&&s.defaultView||window,(M=s.getSelection&&s.getSelection())&&M.rangeCount!==0){s=M.anchorNode,x=M.anchorOffset,F=M.focusNode,M=M.focusOffset;try{s.nodeType,F.nodeType}catch{s=null;break e}var z=0,L=-1,Q=-1,V=0,ie=0,de=B,re=null;t:for(;;){for(var K;de!==s||x!==0&&de.nodeType!==3||(L=z+x),de!==F||M!==0&&de.nodeType!==3||(Q=z+M),de.nodeType===3&&(z+=de.nodeValue.length),(K=de.firstChild)!==null;)re=de,de=K;for(;;){if(de===B)break t;if(re===s&&++V===x&&(L=z),re===F&&++ie===M&&(Q=z),(K=de.nextSibling)!==null)break;de=re,re=de.parentNode}de=K}s=L===-1||Q===-1?null:{start:L,end:Q}}else s=null;s=s||{start:0,end:0}}else s=null;Eg={focusedElem:B,selectionRange:s},Nf=!1,Ah=null,Wf=!1,Lt=u;do try{OI()}catch(Me){if(Lt===null)throw Error(_t(330));eA(Lt,Me),Lt=Lt.nextEffect}while(Lt!==null);Ah=null,Lt=u;do try{for(B=t;Lt!==null;){var G=Lt.flags;if(G&16&&ph(Lt.stateNode,""),G&128){var ne=Lt.alternate;if(ne!==null){var oe=ne.ref;oe!==null&&(typeof oe=="function"?oe(null):oe.current=null)}}switch(G&1038){case 2:Tw(Lt),Lt.flags&=-3;break;case 6:Tw(Lt),Lt.flags&=-3,Mg(Lt.alternate,Lt);break;case 1024:Lt.flags&=-1025;break;case 1028:Lt.flags&=-1025,Mg(Lt.alternate,Lt);break;case 4:Mg(Lt.alternate,Lt);break;case 8:s=Lt,hb(B,s);var we=s.alternate;Fw(s),we!==null&&Fw(we)}Lt=Lt.nextEffect}}catch(Me){if(Lt===null)throw Error(_t(330));eA(Lt,Me),Lt=Lt.nextEffect}while(Lt!==null);if(oe=Eg,ne=Kx(),G=oe.focusedElem,B=oe.selectionRange,ne!==G&&G&&G.ownerDocument&&U1(G.ownerDocument.documentElement,G)){for(B!==null&&_y(G)&&(ne=B.start,oe=B.end,oe===void 0&&(oe=ne),"selectionStart"in G?(G.selectionStart=ne,G.selectionEnd=Math.min(oe,G.value.length)):(oe=(ne=G.ownerDocument||document)&&ne.defaultView||window,oe.getSelection&&(oe=oe.getSelection(),s=G.textContent.length,we=Math.min(B.start,s),B=B.end===void 0?we:Math.min(B.end,s),!oe.extend&&we>B&&(s=B,B=we,we=s),s=Vx(G,we),x=Vx(G,B),s&&x&&(oe.rangeCount!==1||oe.anchorNode!==s.node||oe.anchorOffset!==s.offset||oe.focusNode!==x.node||oe.focusOffset!==x.offset)&&(ne=ne.createRange(),ne.setStart(s.node,s.offset),oe.removeAllRanges(),we>B?(oe.addRange(ne),oe.extend(x.node,x.offset)):(ne.setEnd(x.node,x.offset),oe.addRange(ne)))))),ne=[],oe=G;oe=oe.parentNode;)oe.nodeType===1&&ne.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof G.focus=="function"&&G.focus(),G=0;G<ne.length;G++)oe=ne[G],oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}Nf=!!Cg,Eg=Cg=null,t.current=a,Lt=u;do try{for(G=t;Lt!==null;){var ge=Lt.flags;if(ge&36&&SI(G,Lt.alternate,Lt),ge&128){ne=void 0;var Ue=Lt.ref;if(Ue!==null){var Ke=Lt.stateNode;switch(Lt.tag){case 5:ne=Ke;break;default:ne=Ke}typeof Ue=="function"?Ue(ne):Ue.current=ne}}Lt=Lt.nextEffect}}catch(Me){if(Lt===null)throw Error(_t(330));eA(Lt,Me),Lt=Lt.nextEffect}while(Lt!==null);Lt=null,_I(),nr=m}else t.current=a;if(sA)sA=!1,sh=t,Nu=o;else for(Lt=u;Lt!==null;)o=Lt.nextEffect,Lt.nextEffect=null,Lt.flags&8&&(ge=Lt,ge.sibling=null,ge.stateNode=null),Lt=o;if(u=t.pendingLanes,u===0&&(Ss=null),u===1?t===Ny?ah++:(ah=0,Ny=t):ah=0,a=a.stateNode,KA&&typeof KA.onCommitFiberRoot=="function")try{KA.onCommitFiberRoot(N_,a,void 0,(a.current.flags&64)===64)}catch{}if(Ho(t,Ci()),Bp)throw Bp=!1,t=Ry,Ry=null,t;return nr&8||Ls(),null}function OI(){for(;Lt!==null;){var t=Lt.alternate;Wf||Ah===null||(Lt.flags&8?Tx(Lt,Ah)&&(Wf=!0):Lt.tag===13&&QI(t,Lt)&&Tx(Lt,Ah)&&(Wf=!0));var o=Lt.flags;o&256&&UI(t,Lt),!(o&512)||sA||(sA=!0,Bh(97,function(){return cA(),null})),Lt=Lt.nextEffect}}function cA(){if(Nu!==90){var t=97<Nu?97:Nu;return Nu=90,XA(t,zI)}return!1}function RI(t,o){zy.push(o,t),sA||(sA=!0,Bh(97,function(){return cA(),null}))}function vb(t,o){Hy.push(o,t),sA||(sA=!0,Bh(97,function(){return cA(),null}))}function zI(){if(sh===null)return!1;var t=sh;if(sh=null,nr&48)throw Error(_t(331));var o=nr;nr|=32;var a=Hy;Hy=[];for(var u=0;u<a.length;u+=2){var m=a[u],x=a[u+1],B=m.destroy;if(m.destroy=void 0,typeof B=="function")try{B()}catch(F){if(x===null)throw Error(_t(330));eA(x,F)}}for(a=zy,zy=[],u=0;u<a.length;u+=2){m=a[u],x=a[u+1];try{var s=m.create;m.destroy=s()}catch(F){if(x===null)throw Error(_t(330));eA(x,F)}}for(s=t.current.firstEffect;s!==null;)t=s.nextEffect,s.nextEffect=null,s.flags&8&&(s.sibling=null,s.stateNode=null),s=t;return nr=o,Ls(),!0}function Sw(t,o,a){o=e0(a,o),o=cb(t,o,1),qa(t,o),o=go(),t=Xp(t,1),t!==null&&(zp(t,1,o),Ho(t,o))}function eA(t,o){if(t.tag===3)Sw(t,t,o);else for(var a=t.return;a!==null;){if(a.tag===3){Sw(a,t,o);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ss===null||!Ss.has(u))){t=e0(o,t);var m=ub(a,t,1);if(qa(a,m),m=go(),a=Xp(a,1),a!==null)zp(a,1,m),Ho(a,m);else if(typeof u.componentDidCatch=="function"&&(Ss===null||!Ss.has(u)))try{u.componentDidCatch(o,t)}catch{}break}}a=a.return}}function HI(t,o,a){var u=t.pingCache;u!==null&&u.delete(o),o=go(),t.pingedLanes|=t.suspendedLanes&a,Ni===t&&(Ei&a)===a&&(di===4||di===3&&(Ei&62914560)===Ei&&500>Ci()-n0?pc(t,0):r0|=a),Ho(t,o)}function NI(t,o){var a=t.stateNode;a!==null&&a.delete(o),o=0,o===0&&(o=t.mode,o&2?o&4?(Ys===0&&(Ys=Fc),o=ql(62914560&~Ys),o===0&&(o=4194304)):o=vc()===99?1:2:o=1),a=go(),t=Xp(t,o),t!==null&&(zp(t,o,a),Ho(t,a))}var xb;xb=function(t,o,a){var u=o.lanes;if(t!==null)if(t.memoizedProps!==o.pendingProps||Yi.current)ns=!0;else if(a&u)ns=!!(t.flags&16384);else{switch(ns=!1,o.tag){case 3:gw(o),Ug();break;case 5:Aw(o);break;case 1:eo(o.type)&&Gf(o);break;case 4:Fy(o,o.stateNode.containerInfo);break;case 10:u=o.memoizedProps.value;var m=o.type._context;xn(up,m._currentValue),m._currentValue=u;break;case 13:if(o.memoizedState!==null)return a&o.child.childLanes?yw(t,o,a):(xn(vn,vn.current&1),o=ta(t,o,a),o!==null?o.sibling:null);xn(vn,vn.current&1);break;case 19:if(u=(a&o.childLanes)!==0,t.flags&64){if(u)return Bw(t,o,a);o.flags|=64}if(m=o.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),xn(vn,vn.current),u)break;return null;case 23:case 24:return o.lanes=0,Sg(t,o,a)}return ta(t,o,a)}else ns=!1;switch(o.lanes=0,o.tag){case 2:if(u=o.type,t!==null&&(t.alternate=null,o.alternate=null,o.flags|=2),t=o.pendingProps,m=_c(o,Fi.current),hc(o,a),m=$_(null,o,u,t,m,a),o.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0){if(o.tag=1,o.memoizedState=null,o.updateQueue=null,eo(u)){var x=!0;Gf(o)}else x=!1;o.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,j_(o);var B=u.getDerivedStateFromProps;typeof B=="function"&&fp(o,u,B,t),m.updater=jp,o.stateNode=m,m._reactInternals=o,Ey(o,u,t,a),o=Sy(null,o,u,!0,x,a)}else o.tag=0,qi(null,o,m,a),o=o.child;return o;case 16:m=o.elementType;e:{switch(t!==null&&(t.alternate=null,o.alternate=null,o.flags|=2),t=o.pendingProps,x=m._init,m=x(m._payload),o.type=m,x=o.tag=KI(m),t=rs(m,t),x){case 0:o=Uy(null,o,m,t,a);break e;case 1:o=mw(null,o,m,t,a);break e;case 11:o=fw(null,o,m,t,a);break e;case 14:o=pw(null,o,m,rs(m.type,t),u,a);break e}throw Error(_t(306,m,""))}return o;case 0:return u=o.type,m=o.pendingProps,m=o.elementType===u?m:rs(u,m),Uy(t,o,u,m,a);case 1:return u=o.type,m=o.pendingProps,m=o.elementType===u?m:rs(u,m),mw(t,o,u,m,a);case 3:if(gw(o),u=o.updateQueue,t===null||u===null)throw Error(_t(282));if(u=o.pendingProps,m=o.memoizedState,m=m!==null?m.element:null,j1(t,o),bh(o,u,null,a),u=o.memoizedState.element,u===m)Ug(),o=ta(t,o,a);else{if(m=o.stateNode,(x=m.hydrate)&&(Va=uc(o.stateNode.containerInfo.firstChild),ea=o,x=Ms=!0),x){if(t=m.mutableSourceEagerHydrationData,t!=null)for(m=0;m<t.length;m+=2)x=t[m],x._workInProgressVersionPrimary=t[m+1],dc.push(x);for(a=$1(o,null,u,a),o.child=a;a;)a.flags=a.flags&-3|1024,a=a.sibling}else qi(t,o,u,a),Ug();o=o.child}return o;case 5:return Aw(o),t===null&&Iy(o),u=o.type,m=o.pendingProps,x=t!==null?t.memoizedProps:null,B=m.children,wy(u,m)?B=null:x!==null&&wy(u,x)&&(o.flags|=16),sb(t,o),qi(t,o,B,a),o.child;case 6:return t===null&&Iy(o),null;case 13:return yw(t,o,a);case 4:return Fy(o,o.stateNode.containerInfo),u=o.pendingProps,t===null?o.child=pp(o,null,u,a):qi(t,o,u,a),o.child;case 11:return u=o.type,m=o.pendingProps,m=o.elementType===u?m:rs(u,m),fw(t,o,u,m,a);case 7:return qi(t,o,o.pendingProps,a),o.child;case 8:return qi(t,o,o.pendingProps.children,a),o.child;case 12:return qi(t,o,o.pendingProps.children,a),o.child;case 10:e:{u=o.type._context,m=o.pendingProps,B=o.memoizedProps,x=m.value;var s=o.type._context;if(xn(up,s._currentValue),s._currentValue=x,B!==null)if(s=B.value,x=Do(s,x)?0:(typeof u._calculateChangedBits=="function"?u._calculateChangedBits(s,x):1073741823)|0,x===0){if(B.children===m.children&&!Yi.current){o=ta(t,o,a);break e}}else for(s=o.child,s!==null&&(s.return=o);s!==null;){var F=s.dependencies;if(F!==null){B=s.child;for(var M=F.firstContext;M!==null;){if(M.context===u&&M.observedBits&x){s.tag===1&&(M=$a(-1,a&-a),M.tag=2,qa(s,M)),s.lanes|=a,M=s.alternate,M!==null&&(M.lanes|=a),G1(s.return,a),F.lanes|=a;break}M=M.next}}else B=s.tag===10&&s.type===o.type?null:s.child;if(B!==null)B.return=s;else for(B=s;B!==null;){if(B===o){B=null;break}if(s=B.sibling,s!==null){s.return=B.return,B=s;break}B=B.return}s=B}qi(t,o,m.children,a),o=o.child}return o;case 9:return m=o.type,x=o.pendingProps,u=x.children,hc(o,a),m=zo(m,x.unstable_observedBits),u=u(m),o.flags|=1,qi(t,o,u,a),o.child;case 14:return m=o.type,x=rs(m,o.pendingProps),x=rs(m.type,x),pw(t,o,m,x,u,a);case 15:return ob(t,o,o.type,o.pendingProps,u,a);case 17:return u=o.type,m=o.pendingProps,m=o.elementType===u?m:rs(u,m),t!==null&&(t.alternate=null,o.alternate=null,o.flags|=2),o.tag=1,eo(u)?(t=!0,Gf(o)):t=!1,hc(o,a),X1(o,u,m),Ey(o,u,m,a),Sy(null,o,u,!0,t,a);case 19:return Bw(t,o,a);case 23:return Sg(t,o,a);case 24:return Sg(t,o,a)}throw Error(_t(156,o.tag))};function VI(t,o,a,u){this.tag=t,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function ko(t,o,a,u){return new VI(t,o,a,u)}function o0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function KI(t){if(typeof t=="function")return o0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Pp)return 11;if(t===Op)return 14}return 2}function aA(t,o){var a=t.alternate;return a===null?(a=ko(t.tag,o,t.key,t.mode),a.elementType=t.elementType,a.type=t.type,a.stateNode=t.stateNode,a.alternate=t,t.alternate=a):(a.pendingProps=o,a.type=t.type,a.flags=0,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null),a.childLanes=t.childLanes,a.lanes=t.lanes,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,o=t.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},a.sibling=t.sibling,a.index=t.index,a.ref=t.ref,a}function $f(t,o,a,u,m,x){var B=2;if(u=t,typeof t=="function")o0(t)&&(B=1);else if(typeof t=="string")B=5;else e:switch(t){case za:return mc(a.children,m,x,o);case qB:B=8,m|=16;break;case x_:B=8,m|=1;break;case qu:return t=ko(12,a,o,m|8),t.elementType=qu,t.type=qu,t.lanes=x,t;case Ju:return t=ko(13,a,o,m),t.type=Ju,t.elementType=Ju,t.lanes=x,t;case rp:return t=ko(19,a,o,m),t.elementType=rp,t.lanes=x,t;case F_:return s0(a,m,x,o);case iy:return t=ko(24,a,o,m),t.elementType=iy,t.lanes=x,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case w_:B=10;break e;case B_:B=9;break e;case Pp:B=11;break e;case Op:B=14;break e;case b_:B=16,u=null;break e;case C_:B=22;break e}throw Error(_t(130,t==null?t:typeof t,""))}return o=ko(B,a,o,m),o.elementType=t,o.type=u,o.lanes=x,o}function mc(t,o,a,u){return t=ko(7,t,u,o),t.lanes=a,t}function s0(t,o,a,u){return t=ko(23,t,u,o),t.elementType=F_,t.lanes=a,t}function Lg(t,o,a){return t=ko(6,t,null,o),t.lanes=a,t}function Dg(t,o,a){return o=ko(4,t.children!==null?t.children:[],t.key,o),o.lanes=a,o.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},o}function GI(t,o,a){this.tag=o,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=a,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=yg(0),this.expirationTimes=yg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yg(0),this.mutableSourceEagerHydrationData=null}function jI(t,o,a){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:OA,key:u==null?null:""+u,children:t,containerInfo:o,implementation:a}}function bp(t,o,a,u){var m=o.current,x=go(),B=Ja(m);e:if(a){a=a._reactInternals;t:{if(JA(a)!==a||a.tag!==1)throw Error(_t(170));var s=a;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(eo(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(s!==null);throw Error(_t(171))}if(a.tag===1){var F=a.type;if(eo(F)){a=O1(a,F,s);break e}}a=s}else a=oA;return o.context===null?o.context=a:o.pendingContext=a,o=$a(x,B),o.payload={element:t},u=u===void 0?null:u,u!==null&&(o.callback=u),qa(m,o),Ya(m,B,x),B}function kg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Qw(t,o){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var a=t.retryLane;t.retryLane=a!==0&&a<o?a:o}}function a0(t,o){Qw(t,o),(t=t.alternate)&&Qw(t,o)}function ZI(){return null}function A0(t,o,a){var u=a!=null&&a.hydrationOptions!=null&&a.hydrationOptions.mutableSources||null;if(a=new GI(t,o,a!=null&&a.hydrate===!0),o=ko(3,null,null,o===2?7:o===1?3:0),a.current=o,o.stateNode=a,j_(o),t[Ec]=a.current,M1(t.nodeType===8?t.parentNode:t),u)for(t=0;t<u.length;t++){o=u[t];var m=o._getVersion;m=m(o._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[o,m]:a.mutableSourceEagerHydrationData.push(o,m)}this._internalRoot=a}A0.prototype.render=function(t){bp(t,this._internalRoot,null,null)};A0.prototype.unmount=function(){var t=this._internalRoot,o=t.containerInfo;bp(null,t,null,function(){o[Ec]=null})};function kh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function XI(t,o){if(o||(o=t?t.nodeType===9?t.documentElement:t.firstChild:null,o=!(!o||o.nodeType!==1||!o.hasAttribute("data-reactroot"))),!o)for(var a;a=t.lastChild;)t.removeChild(a);return new A0(t,0,o?{hydrate:!0}:void 0)}function Wp(t,o,a,u,m){var x=a._reactRootContainer;if(x){var B=x._internalRoot;if(typeof m=="function"){var s=m;m=function(){var M=kg(B);s.call(M)}}bp(o,B,t,m)}else{if(x=a._reactRootContainer=XI(a,u),B=x._internalRoot,typeof m=="function"){var F=m;m=function(){var M=kg(B);F.call(M)}}pb(function(){bp(o,B,t,m)})}return kg(B)}h1=function(t){if(t.tag===13){var o=go();Ya(t,4,o),a0(t,4)}};Q_=function(t){if(t.tag===13){var o=go();Ya(t,67108864,o),a0(t,67108864)}};d1=function(t){if(t.tag===13){var o=go(),a=Ja(t);Ya(t,a,o),a0(t,a)}};f1=function(t,o){return o()};fy=function(t,o,a){switch(o){case"input":if(sy(t,a),o=a.name,a.type==="radio"&&o!=null){for(a=t;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<a.length;o++){var u=a[o];if(u!==t&&u.form===t.form){var m=Kp(u);if(!m)throw Error(_t(90));YB(u),sy(u,m)}}}break;case"textarea":t1(t,a);break;case"select":o=a.value,o!=null&&Ac(t,!!a.multiple,o,!1)}};T_=fb;A1=function(t,o,a,u,m){var x=nr;nr|=4;try{return XA(98,t.bind(null,o,a,u,m))}finally{nr=x,nr===0&&(Tc(),Ls())}};U_=function(){!(nr&49)&&(LI(),cA())};l1=function(t,o){var a=nr;nr|=2;try{return t(o)}finally{nr=a,nr===0&&(Tc(),Ls())}};function wb(t,o){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kh(o))throw Error(_t(200));return jI(t,o,null,a)}var WI={Events:[Mh,nc,Kp,s1,a1,cA,{current:!1}]},Lu={findFiberByHostInstance:zA,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},$I={bundleType:Lu.bundleType,version:Lu.version,rendererPackageName:Lu.rendererPackageName,rendererConfig:Lu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qA.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=u1(t),t===null?null:t.stateNode},findFiberByHostInstance:Lu.findFiberByHostInstance||ZI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pf.isDisabled&&pf.supportsFiber)try{N_=pf.inject($I),KA=pf}catch{}}No.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WI;No.createPortal=wb;No.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var o=t._reactInternals;if(o===void 0)throw typeof t.render=="function"?Error(_t(188)):Error(_t(268,Object.keys(t)));return t=u1(o),t=t===null?null:t.stateNode,t};No.flushSync=function(t,o){var a=nr;if(a&48)return t(o);nr|=1;try{if(t)return XA(99,t.bind(null,o))}finally{nr=a,Ls()}};No.hydrate=function(t,o,a){if(!kh(o))throw Error(_t(200));return Wp(null,t,o,!0,a)};No.render=function(t,o,a){if(!kh(o))throw Error(_t(200));return Wp(null,t,o,!1,a)};No.unmountComponentAtNode=function(t){if(!kh(t))throw Error(_t(40));return t._reactRootContainer?(pb(function(){Wp(null,null,t,!1,function(){t._reactRootContainer=null,t[Ec]=null})}),!0):!1};No.unstable_batchedUpdates=fb;No.unstable_createPortal=function(t,o){return wb(t,o,2<arguments.length&&arguments[2]!==void 0?arguments[2]:null)};No.unstable_renderSubtreeIntoContainer=function(t,o,a,u){if(!kh(a))throw Error(_t(200));if(t==null||t._reactInternals===void 0)throw Error(_t(38));return Wp(t,o,a,!1,u)};No.version="17.0.2";function Bb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Bb)}catch(t){console.error(t)}}Bb(),ZB.exports=No;var qI=ZB.exports;const JI=Dp(qI);var bb={exports:{}};(function(t,o){(function(a,u){t.exports=u()})(po,function(){var a,u,m;function x(s,F){if(!a)a=F;else if(!u)u=F;else{var M="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+u+")(sharedChunk); self.onerror = null;",z={};a(z),m=F(z),typeof window<"u"&&(m.workerUrl=window.URL.createObjectURL(new Blob([M],{type:"text/javascript"})))}}x(["exports"],function(s){var F="2.6.1",M=z;function z(n,e,i,A){this.cx=3*n,this.bx=3*(i-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(A-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=A,this.p2x=i,this.p2y=A}z.prototype.sampleCurveX=function(n){return((this.ax*n+this.bx)*n+this.cx)*n},z.prototype.sampleCurveY=function(n){return((this.ay*n+this.by)*n+this.cy)*n},z.prototype.sampleCurveDerivativeX=function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},z.prototype.solveCurveX=function(n,e){var i,A,h,f,g;for(e===void 0&&(e=1e-6),h=n,g=0;g<8;g++){if(f=this.sampleCurveX(h)-n,Math.abs(f)<e)return h;var v=this.sampleCurveDerivativeX(h);if(Math.abs(v)<1e-6)break;h-=f/v}if((h=n)<(i=0))return i;if(h>(A=1))return A;for(;i<A;){if(f=this.sampleCurveX(h),Math.abs(f-n)<e)return h;n>f?i=h:A=h,h=.5*(A-i)+i}return h},z.prototype.solve=function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))};var L=Q;function Q(n,e){this.x=n,this.y=e}Q.prototype={clone:function(){return new Q(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,i=n.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),i=Math.sin(n),A=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=A,this},_rotateAround:function(n,e){var i=Math.cos(n),A=Math.sin(n),h=e.y+A*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-A*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Q.convert=function(n){return n instanceof Q?n:Array.isArray(n)?new Q(n[0],n[1]):n};var V=typeof self<"u"?self:{};const ie=Math.pow(2,53)-1,de=Math.PI/180,re=180/Math.PI;function K(n){return n*de}function G(n){return n*re}const ne=[[0,0],[1,0],[1,1],[0,1]];function oe(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,i=e*n;return 4*(n<.5?i:3*(n-e)+i-.75)}function we(n,e,i,A){const h=new M(n,e,i,A);return function(f){return h.solve(f)}}const ge=we(.25,.1,.25,1);function Ue(n,e,i){return Math.min(i,Math.max(e,n))}function Ke(n,e,i){const A=i-e,h=((n-e)%A+A)%A+e;return h===e?i:h}function Me(n,e,i){if(!n.length)return i(null,[]);let A=n.length;const h=new Array(n.length);let f=null;n.forEach((g,v)=>{e(g,(w,C)=>{w&&(f=w),h[v]=C,--A==0&&i(f,h)})})}function et(n){const e=[];for(const i in n)e.push(n[i]);return e}function qe(n,...e){for(const i of e)for(const A in i)n[A]=i[A];return n}let it=1;function Xe(){return it++}function Ne(){return function n(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function At(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Et(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function It(n,e){n.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function Ut(n,e){return n.indexOf(e,n.length-e.length)!==-1}function Dt(n,e,i){const A={};for(const h in n)A[h]=e.call(i||this,n[h],h,n);return A}function Vt(n,e,i){const A={};for(const h in n)e.call(i||this,n[h],h,n)&&(A[h]=n[h]);return A}function Je(n){return Array.isArray(n)?n.map(Je):typeof n=="object"&&n?Dt(n,Je):n}const yt={};function ke(n){yt[n]||(typeof console<"u"&&console.warn(n),yt[n]=!0)}function xt(n,e,i){return(i.y-n.y)*(e.x-n.x)>(e.y-n.y)*(i.x-n.x)}function Se(n){let e=0;for(let i,A,h=0,f=n.length,g=f-1;h<f;g=h++)i=n[h],A=n[g],e+=(A.x-i.x)*(i.y+A.y);return e}function ot(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function vt(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,A,h,f)=>{const g=h||f;return e[A]=!g||g.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let Ot,nt,tr,br=null;function Dr(n){if(br==null){const e=n.navigator?n.navigator.userAgent:null;br=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return br}function sr(n){try{const e=V[n];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}const dr={now:()=>tr!==void 0?tr:V.performance.now(),setNow(n){tr=n},restoreNow(){tr=void 0},frame(n){const e=V.requestAnimationFrame(n);return{cancel:()=>V.cancelAnimationFrame(e)}},getImageData(n,e=0){const i=V.document.createElement("canvas"),A=i.getContext("2d");if(!A)throw new Error("failed to create canvas 2d context");return i.width=n.width,i.height=n.height,A.drawImage(n,0,0,n.width,n.height),A.getImageData(-e,-e,n.width+2*e,n.height+2*e)},resolveURL:n=>(Ot||(Ot=V.document.createElement("a")),Ot.href=n,Ot.href),get devicePixelRatio(){return V.devicePixelRatio},get prefersReducedMotion(){return!!V.matchMedia&&(nt==null&&(nt=V.matchMedia("(prefers-reduced-motion: reduce)")),nt.matches)}};let An;const Ct={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(An==null){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{An={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):n}catch{An=n}}return An},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},mi={supported:!1,testSupport:function(n){!to&&$r&&(Ii?gi(n):Nr=n)}};let Nr,$r,to=!1,Ii=!1;function gi(n){const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,$r),n.isContextLost())return;mi.supported=!0}catch{}n.deleteTexture(e),to=!0}V.document&&($r=V.document.createElement("img"),$r.onload=function(){Nr&&gi(Nr),Nr=null,Ii=!0},$r.onerror=function(){to=!0,Nr=null},$r.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ro="01",Ki="NO_ACCESS_TOKEN";function Mn(n){return n.indexOf("mapbox:")===0}function Ti(n){return Ct.API_URL_REGEX.test(n)}const Vo=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ln(n){const e=n.match(Vo);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function wn(n){const e=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${e}`}function os(n){if(!n)return null;const e=n.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(V.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ui{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=os(Ct.ACCESS_TOKEN);let A="";return A=i&&i.u?V.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(h,f)=>String.fromCharCode(+("0x"+f)))):Ct.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${A}`:`mapbox.eventData:${A}`}fetchEventData(){const e=sr("localStorage"),i=this.getStorageKey(),A=this.getStorageKey("uuid");if(e)try{const h=V.localStorage.getItem(i);h&&(this.eventData=JSON.parse(h));const f=V.localStorage.getItem(A);f&&(this.anonId=f)}catch{ke("Unable to read from LocalStorage")}}saveEventData(){const e=sr("localStorage"),i=this.getStorageKey(),A=this.getStorageKey("uuid");if(e)try{V.localStorage.setItem(A,this.anonId),Object.keys(this.eventData).length>=1&&V.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{ke("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,A,h){if(!Ct.EVENTS_URL)return;const f=Ln(Ct.EVENTS_URL);f.params.push(`access_token=${h||Ct.ACCESS_TOKEN||""}`);const g={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:F,skuId:ro,userId:this.anonId},v=i?qe(g,i):g,w={url:wn(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};this.pendingRequest=q(w,C=>{this.pendingRequest=null,A(C),this.saveEventData(),this.processRequests(h)})}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const no=new class extends Ui{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,e){Ct.EVENTS_URL&&Ct.ACCESS_TOKEN&&Array.isArray(n)&&n.some(i=>Mn(i)||Ti(i))&&this.queueRequest(Date.now(),e)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=os(Ct.ACCESS_TOKEN),i=e?e.u:Ct.ACCESS_TOKEN;let A=i!==this.eventData.tokenU;Et(this.anonId)||(this.anonId=Ne(),A=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const f=new Date(this.eventData.lastSuccess),g=new Date(h),v=(h-this.eventData.lastSuccess)/864e5;A=A||v>=1||v<-1||f.getDate()!==g.getDate()}else A=!0;if(!A)return this.processRequests();this.postEvent(h,{"enabled.telemetry":!1},f=>{f||(this.eventData.lastSuccess=h,this.eventData.tokenU=i)},n)}},_o=no.postTurnstileEvent.bind(no),ln=new class extends Ui{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,e,i,A){this.skuToken=e,this.errorCb=A,Ct.EVENTS_URL&&(i||Ct.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Ki)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Et(this.anonId)||(this.anonId=Ne()),this.postEvent(i,{skuToken:this.skuToken},A=>{A?this.errorCb(A):e&&(this.success[e]=!0)},n))}},ss=ln.postMapLoadEvent.bind(ln),Si=new class extends Ui{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,e,i,A){if(!Ct.API_URL||!Ct.SESSION_PATH)return;const h=Ln(Ct.API_URL+Ct.SESSION_PATH);h.params.push(`sku=${e||""}`),h.params.push(`access_token=${A||Ct.ACCESS_TOKEN||""}`);const f={url:wn(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=le(f,g=>{this.pendingRequest=null,i(g),this.saveEventData(),this.processRequests(A)})}getSessionAPI(n,e,i,A){this.skuToken=e,this.errorCb=A,Ct.SESSION_PATH&&Ct.API_URL&&(i||Ct.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Ki)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,A=>{A?this.errorCb(A):e&&(this.success[e]=!0)},n)}},vo=Si.getSessionAPI.bind(Si),Zn=new Set,qr="mapbox-tiles";let Tn,Qi,as=500,Dn=50;function oi(){V.caches&&!Tn&&(Tn=V.caches.open(qr))}function Mi(n){const e=n.indexOf("?");return e<0?n:n.slice(0,e)}let Ko=1/0;const Li={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Li);class nn extends Error{constructor(e,i,A){i===401&&Ti(A)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=A}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Y=ot()?()=>self.worker&&self.worker.referrer:()=>(V.location.protocol==="blob:"?V.parent:V).location.href,O=function(n,e){if(!(/^file:/.test(i=n.url)||/^file:/.test(Y())&&!/^\w+:/.test(i))){if(V.fetch&&V.Request&&V.AbortController&&V.Request.prototype.hasOwnProperty("signal"))return function(A,h){const f=new V.AbortController,g=new V.Request(A.url,{method:A.method||"GET",body:A.body,credentials:A.credentials,headers:A.headers,referrer:Y(),signal:f.signal});let v=!1,w=!1;const C=(I=g.url).indexOf("sku=")>0&&Ti(I);var I;A.type==="json"&&g.headers.set("Accept","application/json");const T=(R,H,Z)=>{if(w)return;if(R&&R.message!=="SecurityError"&&ke(R),H&&Z)return S(H);const te=Date.now();V.fetch(g).then(ce=>{if(ce.ok){const fe=C?ce.clone():null;return S(ce,fe,te)}return h(new nn(ce.statusText,ce.status,A.url))}).catch(ce=>{ce.code!==20&&h(new Error(ce.message))})},S=(R,H,Z)=>{(A.type==="arrayBuffer"?R.arrayBuffer():A.type==="json"?R.json():R.text()).then(te=>{w||(H&&Z&&function(ce,fe,ve){if(oi(),!Tn)return;const be={status:fe.status,statusText:fe.statusText,headers:new V.Headers};fe.headers.forEach((Ie,je)=>be.headers.set(je,Ie));const Be=vt(fe.headers.get("Cache-Control")||"");Be["no-store"]||(Be["max-age"]&&be.headers.set("Expires",new Date(ve+1e3*Be["max-age"]).toUTCString()),new Date(be.headers.get("Expires")).getTime()-ve<42e4||function(Ie,je){if(Qi===void 0)try{new Response(new ReadableStream),Qi=!0}catch{Qi=!1}Qi?je(Ie.body):Ie.blob().then(je)}(fe,Ie=>{const je=new V.Response(Ie,be);oi(),Tn&&Tn.then(Oe=>Oe.put(Mi(ce.url),je)).catch(Oe=>ke(Oe.message))}))}(g,H,Z),v=!0,h(null,te,R.headers.get("Cache-Control"),R.headers.get("Expires")))}).catch(te=>{w||h(new Error(te.message))})};return C?function(R,H){if(oi(),!Tn)return H(null);const Z=Mi(R.url);Tn.then(te=>{te.match(Z).then(ce=>{const fe=function(ve){if(!ve)return!1;const be=new Date(ve.headers.get("Expires")||0),Be=vt(ve.headers.get("Cache-Control")||"");return be>Date.now()&&!Be["no-cache"]}(ce);te.delete(Z),fe&&te.put(Z,ce.clone()),H(null,ce,fe)}).catch(H)}).catch(H)}(g,T):T(null,null),{cancel:()=>{w=!0,v||f.abort()}}}(n,e);if(ot()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var i;return function(A,h){const f=new V.XMLHttpRequest;f.open(A.method||"GET",A.url,!0),A.type==="arrayBuffer"&&(f.responseType="arraybuffer");for(const g in A.headers)f.setRequestHeader(g,A.headers[g]);return A.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=A.credentials==="include",f.onerror=()=>{h(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){let g=f.response;if(A.type==="json")try{g=JSON.parse(f.response)}catch(v){return h(v)}h(null,g,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else h(new nn(f.statusText,f.status,A.url))},f.send(A.body),{cancel:()=>f.abort()}}(n,e)},N=function(n,e){return O(qe(n,{type:"arrayBuffer"}),e)},q=function(n,e){return O(qe(n,{method:"POST"}),e)},le=function(n,e){return O(qe(n,{method:"GET"}),e)};function pe(n){const e=V.document.createElement("a");return e.href=n,e.protocol===V.document.location.protocol&&e.host===V.document.location.host}const Fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ce,me;Ce=[],me=0;const Te=function(n,e){if(mi.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),me>=Ct.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:n,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Ce.push(f),f}me++;let i=!1;const A=()=>{if(!i)for(i=!0,me--;Ce.length&&me<Ct.MAX_PARALLEL_IMAGE_REQUESTS;){const f=Ce.shift(),{requestParameters:g,callback:v,cancelled:w}=f;w||(f.cancel=Te(g,v).cancel)}},h=N(n,(f,g,v,w)=>{A(),f?e(f):g&&(V.createImageBitmap?function(C,I){const T=new V.Blob([new Uint8Array(C)],{type:"image/png"});V.createImageBitmap(T).then(S=>{I(null,S)}).catch(S=>{I(new Error(`Could not load image because of ${S.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(C,I)=>e(C,I,v,w)):function(C,I){const T=new V.Image,S=V.URL;T.onload=()=>{I(null,T),S.revokeObjectURL(T.src),T.onload=null,V.requestAnimationFrame(()=>{T.src=Fe})},T.onerror=()=>I(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const R=new V.Blob([new Uint8Array(C)],{type:"image/png"});T.src=C.byteLength?S.createObjectURL(R):Fe}(g,(C,I)=>e(C,I,v,w)))});return{cancel:()=>{h.cancel(),A()}}};function Re(n,e,i){i[n]&&i[n].indexOf(e)!==-1||(i[n]=i[n]||[],i[n].push(e))}function lt(n,e,i){if(i&&i[n]){const A=i[n].indexOf(e);A!==-1&&i[n].splice(A,1)}}class $e{constructor(e,i={}){qe(this,i),this.type=e}}class St extends $e{constructor(e,i={}){super("error",qe({error:e},i))}}class ut{on(e,i){return this._listeners=this._listeners||{},Re(e,i,this._listeners),this}off(e,i){return lt(e,i,this._listeners),lt(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Re(e,i,this._oneTimeListeners),this):new Promise(A=>this.once(e,A))}fire(e,i){typeof e=="string"&&(e=new $e(e,i||{}));const A=e.type;if(this.listens(A)){e.target=this;const h=this._listeners&&this._listeners[A]?this._listeners[A].slice():[];for(const v of h)v.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[A]?this._oneTimeListeners[A].slice():[];for(const v of f)lt(A,v,this._oneTimeListeners),v.call(this,e);const g=this._eventedParent;g&&(qe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(e))}else e instanceof St&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var xe=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class Pe{constructor(e,i,A,h){this.message=(e?`${e}: `:"")+A,h&&(this.identifier=h),i!=null&&i.__line__&&(this.line=i.__line__)}}function zt(n){const e=n.value;return e?[new Pe(n.key,e,"constants have been deprecated as of v8")]:[]}function ar(n,...e){for(const i of e)for(const A in i)n[A]=i[A];return n}function Rt(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function ir(n){if(Array.isArray(n))return n.map(ir);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const i in n)e[i]=ir(n[i]);return e}return Rt(n)}class or extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class io{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[A,h]of i)this.bindings[A]=h}concat(e){return new io(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const cn={kind:"null"},dt={kind:"number"},Yt={kind:"string"},Wt={kind:"boolean"},kr={kind:"color"},oo={kind:"object"},Zt={kind:"value"},As={kind:"collator"},xo={kind:"formatted"},kn={kind:"resolvedImage"};function Pn(n,e){return{kind:"array",itemType:n,N:e}}function gr(n){if(n.kind==="array"){const e=gr(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}return n.kind}const aa=[cn,dt,Yt,Wt,kr,xo,oo,Pn(Zt),kn];function Di(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Di(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(const i of aa)if(!Di(i,e))return null}}return`Expected ${gr(n)} but found ${gr(e)} instead.`}function Go(n,e){return e.some(i=>i.kind===n.kind)}function si(n,e){return e.some(i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n)}function Gi(n){var e={exports:{}};return n(e,e.exports),e.exports}var Xn=Gi(function(n,e){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function A(v){return(v=Math.round(v))<0?0:v>255?255:v}function h(v){return A(v[v.length-1]==="%"?parseFloat(v)/100*255:parseInt(v))}function f(v){return(w=v[v.length-1]==="%"?parseFloat(v)/100:parseFloat(v))<0?0:w>1?1:w;var w}function g(v,w,C){return C<0?C+=1:C>1&&(C-=1),6*C<1?v+(w-v)*C*6:2*C<1?w:3*C<2?v+(w-v)*(2/3-C)*6:v}try{e.parseCSSColor=function(v){var w,C=v.replace(/ /g,"").toLowerCase();if(C in i)return i[C].slice();if(C[0]==="#")return C.length===4?(w=parseInt(C.substr(1),16))>=0&&w<=4095?[(3840&w)>>4|(3840&w)>>8,240&w|(240&w)>>4,15&w|(15&w)<<4,1]:null:C.length===7&&(w=parseInt(C.substr(1),16))>=0&&w<=16777215?[(16711680&w)>>16,(65280&w)>>8,255&w,1]:null;var I=C.indexOf("("),T=C.indexOf(")");if(I!==-1&&T+1===C.length){var S=C.substr(0,I),R=C.substr(I+1,T-(I+1)).split(","),H=1;switch(S){case"rgba":if(R.length!==4)return null;H=f(R.pop());case"rgb":return R.length!==3?null:[h(R[0]),h(R[1]),h(R[2]),H];case"hsla":if(R.length!==4)return null;H=f(R.pop());case"hsl":if(R.length!==3)return null;var Z=(parseFloat(R[0])%360+360)%360/360,te=f(R[1]),ce=f(R[2]),fe=ce<=.5?ce*(te+1):ce+te-ce*te,ve=2*ce-fe;return[A(255*g(ve,fe,Z+1/3)),A(255*g(ve,fe,Z)),A(255*g(ve,fe,Z-1/3)),H];default:return null}}return null}}catch{}});class rr{constructor(e,i,A,h=1){this.r=e,this.g=i,this.b=A,this.a=h}static parse(e){if(!e)return;if(e instanceof rr)return e;if(typeof e!="string")return;const i=Xn.parseCSSColor(e);return i?new rr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,A,h]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(A)},${h})`}toArray(){const{r:e,g:i,b:A,a:h}=this;return h===0?[0,0,0,0]:[255*e/h,255*i/h,255*A/h,h]}}rr.black=new rr(0,0,0,1),rr.white=new rr(1,1,1,1),rr.transparent=new rr(0,0,0,0),rr.red=new rr(1,0,0,1),rr.blue=new rr(0,0,1,1);class ji{constructor(e,i,A){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=A,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class On{constructor(e,i,A,h,f){this.text=e,this.image=i,this.scale=A,this.fontStack=h,this.textColor=f}}class un{constructor(e){this.sections=e}static fromString(e){return new un([new On(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof un?e:un.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);const A={};i.fontStack&&(A["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(A["font-scale"]=i.scale),i.textColor&&(A["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(A)}return e}}class Wn{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Wn({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Aa(n,e,i,A){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?A===void 0||typeof A=="number"&&A>=0&&A<=1?null:`Invalid rgba value [${[n,e,i,A].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof A=="number"?[n,e,i,A]:[n,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ls(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof rr||n instanceof ji||n instanceof un||n instanceof Wn)return!0;if(Array.isArray(n)){for(const e of n)if(!ls(e))return!1;return!0}if(typeof n=="object"){for(const e in n)if(!ls(n[e]))return!1;return!0}return!1}function Ur(n){if(n===null)return cn;if(typeof n=="string")return Yt;if(typeof n=="boolean")return Wt;if(typeof n=="number")return dt;if(n instanceof rr)return kr;if(n instanceof ji)return As;if(n instanceof un)return xo;if(n instanceof Wn)return kn;if(Array.isArray(n)){const e=n.length;let i;for(const A of n){const h=Ur(A);if(i){if(i===h)continue;i=Zt;break}i=h}return Pn(i||Zt,e)}return oo}function so(n){const e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof rr||n instanceof un||n instanceof Wn?n.toString():JSON.stringify(n)}class ao{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ls(e[1]))return i.error("invalid value");const A=e[1];let h=Ur(A);const f=i.expectedType;return h.kind!=="array"||h.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(h=f),new ao(h,A)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof rr?["rgba"].concat(this.value.toArray()):this.value instanceof un?this.value.serialize():this.value}}class zr{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const wo={string:Yt,number:dt,boolean:Wt,object:oo};class hn{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let A,h=1;const f=e[0];if(f==="array"){let v,w;if(e.length>2){const C=e[1];if(typeof C!="string"||!(C in wo)||C==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);v=wo[C],h++}else v=Zt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);w=e[2],h++}A=Pn(v,w)}else A=wo[f];const g=[];for(;h<e.length;h++){const v=i.parse(e[h],h,Zt);if(!v)return null;g.push(v)}return new hn(A,g)}evaluate(e){for(let i=0;i<this.args.length;i++){const A=this.args[i].evaluate(e);if(!Di(this.type,Ur(A)))return A;if(i===this.args.length-1)throw new zr(`Expected value to be of type ${gr(this.type)}, but found ${gr(Ur(A))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if(e.kind==="array"){const A=e.itemType;if(A.kind==="string"||A.kind==="number"||A.kind==="boolean"){i.push(A.kind);const h=e.N;(typeof h=="number"||this.args.length>1)&&i.push(h)}}return i.concat(this.args.map(A=>A.serialize()))}}class Bo{constructor(e){this.type=xo,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const A=e[1];if(!Array.isArray(A)&&typeof A=="object")return i.error("First argument must be an image or text section.");const h=[];let f=!1;for(let g=1;g<=e.length-1;++g){const v=e[g];if(f&&typeof v=="object"&&!Array.isArray(v)){f=!1;let w=null;if(v["font-scale"]&&(w=i.parse(v["font-scale"],1,dt),!w))return null;let C=null;if(v["text-font"]&&(C=i.parse(v["text-font"],1,Pn(Yt)),!C))return null;let I=null;if(v["text-color"]&&(I=i.parse(v["text-color"],1,kr),!I))return null;const T=h[h.length-1];T.scale=w,T.font=C,T.textColor=I}else{const w=i.parse(e[g],1,Zt);if(!w)return null;const C=w.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,h.push({content:w,scale:null,font:null,textColor:null})}}return new Bo(h)}evaluate(e){return new un(this.sections.map(i=>{const A=i.content.evaluate(e);return Ur(A)===kn?new On("",A,null,null,null):new On(so(A),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const A={};i.scale&&(A["font-scale"]=i.scale.serialize()),i.font&&(A["text-font"]=i.font.serialize()),i.textColor&&(A["text-color"]=i.textColor.serialize()),e.push(A)}return e}}class cs{constructor(e){this.type=kn,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const A=i.parse(e[1],1,Yt);return A?new cs(A):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),A=Wn.fromString(i);return A&&e.availableImages&&(A.available=e.availableImages.indexOf(i)>-1),A}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const _e={"to-boolean":Wt,"to-color":kr,"to-number":dt,"to-string":Yt};class ze{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const A=e[0];if((A==="to-boolean"||A==="to-string")&&e.length!==2)return i.error("Expected one argument.");const h=_e[A],f=[];for(let g=1;g<e.length;g++){const v=i.parse(e[g],g,Zt);if(!v)return null;f.push(v)}return new ze(h,f)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let i,A;for(const h of this.args){if(i=h.evaluate(e),A=null,i instanceof rr)return i;if(typeof i=="string"){const f=e.parseColor(i);if(f)return f}else if(Array.isArray(i)&&(A=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Aa(i[0],i[1],i[2],i[3]),!A))return new rr(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new zr(A||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const A of this.args){if(i=A.evaluate(e),i===null)return 0;const h=Number(i);if(!isNaN(h))return h}throw new zr(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?un.fromString(so(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Wn.fromString(so(this.args[0].evaluate(e))):so(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Bo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new cs(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}const ct=["Unknown","Point","LineString","Polygon"];class $t{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ct[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:A,y:h}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(A*i-e[0])+this.featureDistanceData.bearing[1]*(h*i-e[1])}return 0}parseColor(e){let i=this._parseColorCache[e];return i||(i=this._parseColorCache[e]=rr.parse(e)),i}}class jt{constructor(e,i,A,h){this.name=e,this.type=i,this._evaluate=A,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const A=e[0],h=jt.definitions[A];if(!h)return i.error(`Unknown expression "${A}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(h)?h[0]:h.type,g=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=g.filter(([C])=>!Array.isArray(C)||C.length===e.length-1);let w=null;for(const[C,I]of v){w=new Qr(i.registry,i.path,null,i.scope);const T=[];let S=!1;for(let R=1;R<e.length;R++){const H=e[R],Z=Array.isArray(C)?C[R-1]:C.type,te=w.parse(H,1+T.length,Z);if(!te){S=!0;break}T.push(te)}if(!S)if(Array.isArray(C)&&C.length!==T.length)w.error(`Expected ${C.length} arguments, but found ${T.length} instead.`);else{for(let R=0;R<T.length;R++){const H=Array.isArray(C)?C[R]:C.type,Z=T[R];w.concat(R+1).checkSubtype(H,Z.type)}if(w.errors.length===0)return new jt(A,f,I,T)}}if(v.length===1)i.errors.push(...w.errors);else{const C=(v.length?v:g).map(([T])=>{return S=T,Array.isArray(S)?`(${S.map(gr).join(", ")})`:`(${gr(S.type)}...)`;var S}).join(" | "),I=[];for(let T=1;T<e.length;T++){const S=i.parse(e[T],1+I.length);if(!S)return null;I.push(gr(S.type))}i.error(`Expected arguments of type ${C}, but found (${I.join(", ")}) instead.`)}return null}static register(e,i){jt.definitions=i;for(const A in i)e[A]=jt}}class Pr{constructor(e,i,A){this.type=As,this.locale=A,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const A=e[1];if(typeof A!="object"||Array.isArray(A))return i.error("Collator options argument must be an object.");const h=i.parse(A["case-sensitive"]!==void 0&&A["case-sensitive"],1,Wt);if(!h)return null;const f=i.parse(A["diacritic-sensitive"]!==void 0&&A["diacritic-sensitive"],1,Wt);if(!f)return null;let g=null;return A.locale&&(g=i.parse(A.locale,1,Yt),!g)?null:new Pr(h,f,g)}evaluate(e){return new ji(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const xr=8192;function Sr(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function Rn(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function Bn(n,e){const i=(180+n[0])/360,A=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(i*h*xr),Math.round(A*h*xr)]}function la(n,e,i){const A=n[0]-e[0],h=n[1]-e[1],f=n[0]-i[0],g=n[1]-i[1];return A*g-f*h==0&&A*f<=0&&h*g<=0}function Gr(n,e){let i=!1;for(let g=0,v=e.length;g<v;g++){const w=e[g];for(let C=0,I=w.length;C<I-1;C++){if(la(n,w[C],w[C+1]))return!1;(h=w[C])[1]>(A=n)[1]!=(f=w[C+1])[1]>A[1]&&A[0]<(f[0]-h[0])*(A[1]-h[1])/(f[1]-h[1])+h[0]&&(i=!i)}}var A,h,f;return i}function us(n,e){for(let i=0;i<e.length;i++)if(Gr(n,e[i]))return!0;return!1}function Ps(n,e,i,A){const h=A[0]-i[0],f=A[1]-i[1],g=(n[0]-i[0])*f-h*(n[1]-i[1]),v=(e[0]-i[0])*f-h*(e[1]-i[1]);return g>0&&v<0||g<0&&v>0}function hs(n,e,i){for(const C of i)for(let I=0;I<C.length-1;++I)if((v=[(g=C[I+1])[0]-(f=C[I])[0],g[1]-f[1]])[0]*(w=[(h=e)[0]-(A=n)[0],h[1]-A[1]])[1]-v[1]*w[0]!=0&&Ps(A,h,f,g)&&Ps(f,g,A,h))return!0;var A,h,f,g,v,w;return!1}function bo(n,e){for(let i=0;i<n.length;++i)if(!Gr(n[i],e))return!1;for(let i=0;i<n.length-1;++i)if(hs(n[i],n[i+1],e))return!1;return!0}function Co(n,e){for(let i=0;i<e.length;i++)if(bo(n,e[i]))return!0;return!1}function Un(n,e,i){const A=[];for(let h=0;h<n.length;h++){const f=[];for(let g=0;g<n[h].length;g++){const v=Bn(n[h][g],i);Sr(e,v),f.push(v)}A.push(f)}return A}function Eo(n,e,i){const A=[];for(let h=0;h<n.length;h++){const f=Un(n[h],e,i);A.push(f)}return A}function Os(n,e,i,A){if(n[0]<i[0]||n[0]>i[2]){const h=.5*A;let f=n[0]-i[0]>h?-A:i[0]-n[0]>h?A:0;f===0&&(f=n[0]-i[2]>h?-A:i[2]-n[0]>h?A:0),n[0]+=f}Sr(e,n)}function Fo(n,e,i,A){const h=Math.pow(2,A.z)*xr,f=[A.x*xr,A.y*xr],g=[];for(const v of n)for(const w of v){const C=[w.x+f[0],w.y+f[1]];Os(C,e,i,h),g.push(C)}return g}function se(n,e,i,A){const h=Math.pow(2,A.z)*xr,f=[A.x*xr,A.y*xr],g=[];for(const w of n){const C=[];for(const I of w){const T=[I.x+f[0],I.y+f[1]];Sr(e,T),C.push(T)}g.push(C)}if(e[2]-e[0]<=h/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const w of g)for(const C of w)Os(C,e,i,h)}var v;return g}class Ee{constructor(e,i){this.type=Wt,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ls(e[1])){const A=e[1];if(A.type==="FeatureCollection")for(let h=0;h<A.features.length;++h){const f=A.features[h].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Ee(A,A.features[h].geometry)}else if(A.type==="Feature"){const h=A.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Ee(A,A.geometry)}else if(A.type==="Polygon"||A.type==="MultiPolygon")return new Ee(A,A)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(i,A){const h=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(A.type==="Polygon"){const v=Un(A.coordinates,f,g),w=Fo(i.geometry(),h,f,g);if(!Rn(h,f))return!1;for(const C of w)if(!Gr(C,v))return!1}if(A.type==="MultiPolygon"){const v=Eo(A.coordinates,f,g),w=Fo(i.geometry(),h,f,g);if(!Rn(h,f))return!1;for(const C of w)if(!us(C,v))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(i,A){const h=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(A.type==="Polygon"){const v=Un(A.coordinates,f,g),w=se(i.geometry(),h,f,g);if(!Rn(h,f))return!1;for(const C of w)if(!bo(C,v))return!1}if(A.type==="MultiPolygon"){const v=Eo(A.coordinates,f,g),w=se(i.geometry(),h,f,g);if(!Rn(h,f))return!1;for(const C of w)if(!Co(C,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function Ye(n){if(n instanceof jt&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof Ee)return!1;let e=!0;return n.eachChild(i=>{e&&!Ye(i)&&(e=!1)}),e}function Ft(n){if(n instanceof jt&&n.name==="feature-state")return!1;let e=!0;return n.eachChild(i=>{e&&!Ft(i)&&(e=!1)}),e}function Mt(n,e){if(n instanceof jt&&e.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild(A=>{i&&!Mt(A,e)&&(i=!1)}),i}class er{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const A=e[1];return i.scope.has(A)?new er(A,i.scope.get(A)):i.error(`Unknown variable "${A}". Make sure "${A}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Qr{constructor(e,i=[],A,h=new io,f=[]){this.registry=e,this.path=i,this.key=i.map(g=>`[${g}]`).join(""),this.scope=h,this.errors=f,this.expectedType=A}parse(e,i,A,h,f={}){return i?this.concat(i,A,h)._parse(e,f):this._parse(e,f)}_parse(e,i){function A(h,f,g){return g==="assert"?new hn(f,[h]):g==="coerce"?new ze(f,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[h];if(f){let g=f.parse(e,this);if(!g)return null;if(this.expectedType){const v=this.expectedType,w=g.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||w.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||w.kind!=="value"&&w.kind!=="string"){if(this.checkSubtype(v,w))return null}else g=A(g,v,i.typeAnnotation||"coerce");else g=A(g,v,i.typeAnnotation||"assert")}if(!(g instanceof ao)&&g.type.kind!=="resolvedImage"&&Jr(g)){const v=new $t;try{g=new ao(g.type,g.evaluate(v))}catch(w){return this.error(w.message),null}}return g}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,A){const h=typeof e=="number"?this.path.concat(e):this.path,f=A?this.scope.concat(A):this.scope;return new Qr(this.registry,h,i||null,f,this.errors)}error(e,...i){const A=`${this.key}${i.map(h=>`[${h}]`).join("")}`;this.errors.push(new or(A,e))}checkSubtype(e,i){const A=Di(e,i);return A&&this.error(A),A}}function Jr(n){if(n instanceof er)return Jr(n.boundExpression);if(n instanceof jt&&n.name==="error"||n instanceof Pr||n instanceof Ee)return!1;const e=n instanceof ze||n instanceof hn;let i=!0;return n.eachChild(A=>{i=e?i&&Jr(A):i&&A instanceof ao}),!!i&&Ye(n)&&Mt(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function jr(n,e){const i=n.length-1;let A,h,f=0,g=i,v=0;for(;f<=g;)if(v=Math.floor((f+g)/2),A=n[v],h=n[v+1],A<=e){if(v===i||e<h)return v;f=v+1}else{if(!(A>e))throw new zr("Input is not a number.");g=v-1}return 0}class wr{constructor(e,i,A){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[h,f]of A)this.labels.push(h),this.outputs.push(f)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const A=i.parse(e[1],1,dt);if(!A)return null;const h=[];let f=null;i.expectedType&&i.expectedType.kind!=="value"&&(f=i.expectedType);for(let g=1;g<e.length;g+=2){const v=g===1?-1/0:e[g],w=e[g+1],C=g,I=g+1;if(typeof v!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(h.length&&h[h.length-1][0]>=v)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const T=i.parse(w,I,f);if(!T)return null;f=f||T.type,h.push([v,T])}return new wr(f,A,h)}evaluate(e){const i=this.labels,A=this.outputs;if(i.length===1)return A[0].evaluate(e);const h=this.input.evaluate(e);if(h<=i[0])return A[0].evaluate(e);const f=i.length;return h>=i[f-1]?A[f-1].evaluate(e):A[jr(i,h)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}function Xt(n,e,i){return n*(1-i)+e*i}var zn=Object.freeze({__proto__:null,number:Xt,color:function(n,e,i){return new rr(Xt(n.r,e.r,i),Xt(n.g,e.g,i),Xt(n.b,e.b,i),Xt(n.a,e.a,i))},array:function(n,e,i){return n.map((A,h)=>Xt(A,e[h],i))}});const on=.95047,$n=1.08883,ai=4/29,yi=6/29,ki=3*yi*yi,jo=Math.PI/180,uA=180/Math.PI;function ds(n){return n>.008856451679035631?Math.pow(n,1/3):n/ki+ai}function Zo(n){return n>yi?n*n*n:ki*(n-ai)}function el(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function tl(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Sc(n){const e=tl(n.r),i=tl(n.g),A=tl(n.b),h=ds((.4124564*e+.3575761*i+.1804375*A)/on),f=ds((.2126729*e+.7151522*i+.072175*A)/1);return{l:116*f-16,a:500*(h-f),b:200*(f-ds((.0193339*e+.119192*i+.9503041*A)/$n)),alpha:n.a}}function Rh(n){let e=(n.l+16)/116,i=isNaN(n.a)?e:e+n.a/500,A=isNaN(n.b)?e:e-n.b/200;return e=1*Zo(e),i=on*Zo(i),A=$n*Zo(A),new rr(el(3.2404542*i-1.5371385*e-.4985314*A),el(-.969266*i+1.8760108*e+.041556*A),el(.0556434*i-.2040259*e+1.0572252*A),n.alpha)}function zh(n,e,i){const A=e-n;return n+i*(A>180||A<-180?A-360*Math.round(A/360):A)}const ca={forward:Sc,reverse:Rh,interpolate:function(n,e,i){return{l:Xt(n.l,e.l,i),a:Xt(n.a,e.a,i),b:Xt(n.b,e.b,i),alpha:Xt(n.alpha,e.alpha,i)}}},hA={forward:function(n){const{l:e,a:i,b:A}=Sc(n),h=Math.atan2(A,i)*uA;return{h:h<0?h+360:h,c:Math.sqrt(i*i+A*A),l:e,alpha:n.a}},reverse:function(n){const e=n.h*jo,i=n.c;return Rh({l:n.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:n.alpha})},interpolate:function(n,e,i){return{h:zh(n.h,e.h,i),c:Xt(n.c,e.c,i),l:Xt(n.l,e.l,i),alpha:Xt(n.alpha,e.alpha,i)}}};var Hh=Object.freeze({__proto__:null,lab:ca,hcl:hA});class Pi{constructor(e,i,A,h,f){this.type=e,this.operator=i,this.interpolation=A,this.input=h,this.labels=[],this.outputs=[];for(const[g,v]of f)this.labels.push(g),this.outputs.push(v)}static interpolationFactor(e,i,A,h){let f=0;if(e.name==="exponential")f=Qc(i,e.base,A,h);else if(e.name==="linear")f=Qc(i,1,A,h);else if(e.name==="cubic-bezier"){const g=e.controlPoints;f=new M(g[0],g[1],g[2],g[3]).solve(Qc(i,1,A,h))}return f}static parse(e,i){let[A,h,f,...g]=e;if(!Array.isArray(h)||h.length===0)return i.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const C=h[1];if(typeof C!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:C}}else{if(h[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const C=h.slice(1);if(C.length!==4||C.some(I=>typeof I!="number"||I<0||I>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:C}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(f=i.parse(f,2,dt),!f)return null;const v=[];let w=null;A==="interpolate-hcl"||A==="interpolate-lab"?w=kr:i.expectedType&&i.expectedType.kind!=="value"&&(w=i.expectedType);for(let C=0;C<g.length;C+=2){const I=g[C],T=g[C+1],S=C+3,R=C+4;if(typeof I!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(v.length&&v[v.length-1][0]>=I)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',S);const H=i.parse(T,R,w);if(!H)return null;w=w||H.type,v.push([I,H])}return w.kind==="number"||w.kind==="color"||w.kind==="array"&&w.itemType.kind==="number"&&typeof w.N=="number"?new Pi(w,A,h,f,v):i.error(`Type ${gr(w)} is not interpolatable.`)}evaluate(e){const i=this.labels,A=this.outputs;if(i.length===1)return A[0].evaluate(e);const h=this.input.evaluate(e);if(h<=i[0])return A[0].evaluate(e);const f=i.length;if(h>=i[f-1])return A[f-1].evaluate(e);const g=jr(i,h),v=Pi.interpolationFactor(this.interpolation,h,i[g],i[g+1]),w=A[g].evaluate(e),C=A[g+1].evaluate(e);return this.operator==="interpolate"?zn[this.type.kind.toLowerCase()](w,C,v):this.operator==="interpolate-hcl"?hA.reverse(hA.interpolate(hA.forward(w),hA.forward(C),v)):ca.reverse(ca.interpolate(ca.forward(w),ca.forward(C),v))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let A=0;A<this.labels.length;A++)i.push(this.labels[A],this.outputs[A].serialize());return i}}function Qc(n,e,i,A){const h=A-i,f=n-i;return h===0?0:e===1?f/h:(Math.pow(e,f)-1)/(Math.pow(e,h)-1)}class rl{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let A=null;const h=i.expectedType;h&&h.kind!=="value"&&(A=h);const f=[];for(const v of e.slice(1)){const w=i.parse(v,1+f.length,A,void 0,{typeAnnotation:"omit"});if(!w)return null;A=A||w.type,f.push(w)}const g=h&&f.some(v=>Di(h,v.type));return new rl(g?Zt:A,f)}evaluate(e){let i,A=null,h=0;for(const f of this.args)if(h++,A=f.evaluate(e),A&&A instanceof Wn&&!A.available&&(i||(i=A.name),A=null,h===this.args.length&&(A=i)),A!==null)break;return A}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}class dA{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const A=[];for(let f=1;f<e.length-1;f+=2){const g=e[f];if(typeof g!="string")return i.error(`Expected string, but found ${typeof g} instead.`,f);if(/[^a-zA-Z0-9_]/.test(g))return i.error("Variable names must contain only alphanumeric characters or '_'.",f);const v=i.parse(e[f+1],f+1);if(!v)return null;A.push([g,v])}const h=i.parse(e[e.length-1],e.length-1,i.expectedType,A);return h?new dA(A,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,A]of this.bindings)e.push(i,A.serialize());return e.push(this.result.serialize()),e}}class Mc{constructor(e,i,A){this.type=e,this.index=i,this.input=A}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const A=i.parse(e[1],1,dt),h=i.parse(e[2],2,Pn(i.expectedType||Zt));return A&&h?new Mc(h.type.itemType,A,h):null}evaluate(e){const i=this.index.evaluate(e),A=this.input.evaluate(e);if(i<0)throw new zr(`Array index out of bounds: ${i} < 0.`);if(i>=A.length)throw new zr(`Array index out of bounds: ${i} > ${A.length-1}.`);if(i!==Math.floor(i))throw new zr(`Array index must be an integer, but found ${i} instead.`);return A[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Lc{constructor(e,i){this.type=Wt,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const A=i.parse(e[1],1,Zt),h=i.parse(e[2],2,Zt);return A&&h?Go(A.type,[Wt,Yt,dt,cn,Zt])?new Lc(A,h):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${gr(A.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),A=this.haystack.evaluate(e);if(!A)return!1;if(!si(i,["boolean","string","number","null"]))throw new zr(`Expected first argument to be of type boolean, string, number or null, but found ${gr(Ur(i))} instead.`);if(!si(A,["string","array"]))throw new zr(`Expected second argument to be of type array or string, but found ${gr(Ur(A))} instead.`);return A.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class nl{constructor(e,i,A){this.type=dt,this.needle=e,this.haystack=i,this.fromIndex=A}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const A=i.parse(e[1],1,Zt),h=i.parse(e[2],2,Zt);if(!A||!h)return null;if(!Go(A.type,[Wt,Yt,dt,cn,Zt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${gr(A.type)} instead`);if(e.length===4){const f=i.parse(e[3],3,dt);return f?new nl(A,h,f):null}return new nl(A,h)}evaluate(e){const i=this.needle.evaluate(e),A=this.haystack.evaluate(e);if(!si(i,["boolean","string","number","null"]))throw new zr(`Expected first argument to be of type boolean, string, number or null, but found ${gr(Ur(i))} instead.`);if(!si(A,["string","array"]))throw new zr(`Expected second argument to be of type array or string, but found ${gr(Ur(A))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return A.indexOf(i,h)}return A.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class il{constructor(e,i,A,h,f,g){this.inputType=e,this.type=i,this.input=A,this.cases=h,this.outputs=f,this.otherwise=g}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let A,h;i.expectedType&&i.expectedType.kind!=="value"&&(h=i.expectedType);const f={},g=[];for(let C=2;C<e.length-1;C+=2){let I=e[C];const T=e[C+1];Array.isArray(I)||(I=[I]);const S=i.concat(C);if(I.length===0)return S.error("Expected at least one branch label.");for(const H of I){if(typeof H!="number"&&typeof H!="string")return S.error("Branch labels must be numbers or strings.");if(typeof H=="number"&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return S.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof H=="number"&&Math.floor(H)!==H)return S.error("Numeric branch labels must be integer values.");if(A){if(S.checkSubtype(A,Ur(H)))return null}else A=Ur(H);if(f[String(H)]!==void 0)return S.error("Branch labels must be unique.");f[String(H)]=g.length}const R=i.parse(T,C,h);if(!R)return null;h=h||R.type,g.push(R)}const v=i.parse(e[1],1,Zt);if(!v)return null;const w=i.parse(e[e.length-1],e.length-1,h);return w?v.type.kind!=="value"&&i.concat(1).checkSubtype(A,v.type)?null:new il(A,h,v,f,g,w):null}evaluate(e){const i=this.input.evaluate(e);return(Ur(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),A=[],h={};for(const g of i){const v=h[this.cases[g]];v===void 0?(h[this.cases[g]]=A.length,A.push([this.cases[g],[g]])):A[v][1].push(g)}const f=g=>this.inputType.kind==="number"?Number(g):g;for(const[g,v]of A)e.push(v.length===1?f(v[0]):v.map(f)),e.push(this.outputs[g].serialize());return e.push(this.otherwise.serialize()),e}}class ol{constructor(e,i,A){this.type=e,this.branches=i,this.otherwise=A}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let A;i.expectedType&&i.expectedType.kind!=="value"&&(A=i.expectedType);const h=[];for(let g=1;g<e.length-1;g+=2){const v=i.parse(e[g],g,Wt);if(!v)return null;const w=i.parse(e[g+1],g+1,A);if(!w)return null;h.push([v,w]),A=A||w.type}const f=i.parse(e[e.length-1],e.length-1,A);return f?new ol(A,h,f):null}evaluate(e){for(const[i,A]of this.branches)if(i.evaluate(e))return A.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,A]of this.branches)e(i),e(A);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}class sl{constructor(e,i,A,h){this.type=e,this.input=i,this.beginIndex=A,this.endIndex=h}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const A=i.parse(e[1],1,Zt),h=i.parse(e[2],2,dt);if(!A||!h)return null;if(!Go(A.type,[Pn(Zt),Yt,Zt]))return i.error(`Expected first argument to be of type array or string, but found ${gr(A.type)} instead`);if(e.length===4){const f=i.parse(e[3],3,dt);return f?new sl(A.type,A,h,f):null}return new sl(A.type,A,h)}evaluate(e){const i=this.input.evaluate(e),A=this.beginIndex.evaluate(e);if(!si(i,["string","array"]))throw new zr(`Expected first argument to be of type array or string, but found ${gr(Ur(i))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return i.slice(A,h)}return i.slice(A)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Dc(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Nh(n,e,i,A){return A.compare(e,i)===0}function ua(n,e,i){const A=n!=="=="&&n!=="!=";return class Cb{constructor(f,g,v){this.type=Wt,this.lhs=f,this.rhs=g,this.collator=v,this.hasUntypedArgument=f.type.kind==="value"||g.type.kind==="value"}static parse(f,g){if(f.length!==3&&f.length!==4)return g.error("Expected two or three arguments.");const v=f[0];let w=g.parse(f[1],1,Zt);if(!w)return null;if(!Dc(v,w.type))return g.concat(1).error(`"${v}" comparisons are not supported for type '${gr(w.type)}'.`);let C=g.parse(f[2],2,Zt);if(!C)return null;if(!Dc(v,C.type))return g.concat(2).error(`"${v}" comparisons are not supported for type '${gr(C.type)}'.`);if(w.type.kind!==C.type.kind&&w.type.kind!=="value"&&C.type.kind!=="value")return g.error(`Cannot compare types '${gr(w.type)}' and '${gr(C.type)}'.`);A&&(w.type.kind==="value"&&C.type.kind!=="value"?w=new hn(C.type,[w]):w.type.kind!=="value"&&C.type.kind==="value"&&(C=new hn(w.type,[C])));let I=null;if(f.length===4){if(w.type.kind!=="string"&&C.type.kind!=="string"&&w.type.kind!=="value"&&C.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(I=g.parse(f[3],3,As),!I)return null}return new Cb(w,C,I)}evaluate(f){const g=this.lhs.evaluate(f),v=this.rhs.evaluate(f);if(A&&this.hasUntypedArgument){const w=Ur(g),C=Ur(v);if(w.kind!==C.kind||w.kind!=="string"&&w.kind!=="number")throw new zr(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${w.kind}, ${C.kind}) instead.`)}if(this.collator&&!A&&this.hasUntypedArgument){const w=Ur(g),C=Ur(v);if(w.kind!=="string"||C.kind!=="string")return e(f,g,v)}return this.collator?i(f,g,v,this.collator.evaluate(f)):e(f,g,v)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[n];return this.eachChild(g=>{f.push(g.serialize())}),f}}}const Vh=ua("==",function(n,e,i){return e===i},Nh),Kh=ua("!=",function(n,e,i){return e!==i},function(n,e,i,A){return!Nh(0,e,i,A)}),sm=ua("<",function(n,e,i){return e<i},function(n,e,i,A){return A.compare(e,i)<0}),am=ua(">",function(n,e,i){return e>i},function(n,e,i,A){return A.compare(e,i)>0}),Am=ua("<=",function(n,e,i){return e<=i},function(n,e,i,A){return A.compare(e,i)<=0}),lm=ua(">=",function(n,e,i){return e>=i},function(n,e,i,A){return A.compare(e,i)>=0});class ha{constructor(e,i,A,h,f){this.type=Yt,this.number=e,this.locale=i,this.currency=A,this.minFractionDigits=h,this.maxFractionDigits=f}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const A=i.parse(e[1],1,dt);if(!A)return null;const h=e[2];if(typeof h!="object"||Array.isArray(h))return i.error("NumberFormat options argument must be an object.");let f=null;if(h.locale&&(f=i.parse(h.locale,1,Yt),!f))return null;let g=null;if(h.currency&&(g=i.parse(h.currency,1,Yt),!g))return null;let v=null;if(h["min-fraction-digits"]&&(v=i.parse(h["min-fraction-digits"],1,dt),!v))return null;let w=null;return h["max-fraction-digits"]&&(w=i.parse(h["max-fraction-digits"],1,dt),!w)?null:new ha(A,f,g,v,w)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class al{constructor(e){this.type=dt,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const A=i.parse(e[1],1);return A?A.type.kind!=="array"&&A.type.kind!=="string"&&A.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${gr(A.type)} instead.`):new al(A):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new zr(`Expected value to be of type string or array, but found ${gr(Ur(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}const Rs={"==":Vh,"!=":Kh,">":am,"<":sm,">=":lm,"<=":Am,array:hn,at:Mc,boolean:hn,case:ol,coalesce:rl,collator:Pr,format:Bo,image:cs,in:Lc,"index-of":nl,interpolate:Pi,"interpolate-hcl":Pi,"interpolate-lab":Pi,length:al,let:dA,literal:ao,match:il,number:hn,"number-format":ha,object:hn,slice:sl,step:wr,string:hn,"to-boolean":ze,"to-color":ze,"to-number":ze,"to-string":ze,var:er,within:Ee};function Gh(n,[e,i,A,h]){e=e.evaluate(n),i=i.evaluate(n),A=A.evaluate(n);const f=h?h.evaluate(n):1,g=Aa(e,i,A,f);if(g)throw new zr(g);return new rr(e/255*f,i/255*f,A/255*f,f)}function jh(n,e){return n in e}function kc(n,e){const i=e[n];return i===void 0?null:i}function fs(n){return{type:n}}function Pc(n){return{result:"success",value:n}}function zs(n){return{result:"error",value:n}}function ps(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function Zh(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function Oc(n){return!!n.expression&&n.expression.interpolated}function cr(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Al(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function cm(n){return n}function Xh(n,e){const i=e.type==="color",A=n.stops&&typeof n.stops[0][0]=="object",h=A||!(A||n.property!==void 0),f=n.type||(Oc(e)?"exponential":"interval");if(i&&((n=ar({},n)).stops&&(n.stops=n.stops.map(C=>[C[0],rr.parse(C[1])])),n.default=rr.parse(n.default?n.default:e.default)),n.colorSpace&&n.colorSpace!=="rgb"&&!Hh[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let g,v,w;if(f==="exponential")g=$h;else if(f==="interval")g=ll;else if(f==="categorical"){g=Wh,v=Object.create(null);for(const C of n.stops)v[C[0]]=C[1];w=typeof n.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);g=um}if(A){const C={},I=[];for(let R=0;R<n.stops.length;R++){const H=n.stops[R],Z=H[0].zoom;C[Z]===void 0&&(C[Z]={zoom:Z,type:n.type,property:n.property,default:n.default,stops:[]},I.push(Z)),C[Z].stops.push([H[0].value,H[1]])}const T=[];for(const R of I)T.push([C[R].zoom,Xh(C[R],e)]);const S={name:"linear"};return{kind:"composite",interpolationType:S,interpolationFactor:Pi.interpolationFactor.bind(void 0,S),zoomStops:T.map(R=>R[0]),evaluate:({zoom:R},H)=>$h({stops:T,base:n.base},e,R).evaluate(R,H)}}if(h){const C=f==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:Pi.interpolationFactor.bind(void 0,C),zoomStops:n.stops.map(I=>I[0]),evaluate:({zoom:I})=>g(n,e,I,v,w)}}return{kind:"source",evaluate(C,I){const T=I&&I.properties?I.properties[n.property]:void 0;return T===void 0?da(n.default,e.default):g(n,e,T,v,w)}}}function da(n,e,i){return n!==void 0?n:e!==void 0?e:i!==void 0?i:void 0}function Wh(n,e,i,A,h){return da(typeof i===h?A[i]:void 0,n.default,e.default)}function ll(n,e,i){if(cr(i)!=="number")return da(n.default,e.default);const A=n.stops.length;if(A===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[A-1][0])return n.stops[A-1][1];const h=jr(n.stops.map(f=>f[0]),i);return n.stops[h][1]}function $h(n,e,i){const A=n.base!==void 0?n.base:1;if(cr(i)!=="number")return da(n.default,e.default);const h=n.stops.length;if(h===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[h-1][0])return n.stops[h-1][1];const f=jr(n.stops.map(I=>I[0]),i),g=function(I,T,S,R){const H=R-S,Z=I-S;return H===0?0:T===1?Z/H:(Math.pow(T,Z)-1)/(Math.pow(T,H)-1)}(i,A,n.stops[f][0],n.stops[f+1][0]),v=n.stops[f][1],w=n.stops[f+1][1];let C=zn[e.type]||cm;if(n.colorSpace&&n.colorSpace!=="rgb"){const I=Hh[n.colorSpace];C=(T,S)=>I.reverse(I.interpolate(I.forward(T),I.forward(S),g))}return typeof v.evaluate=="function"?{evaluate(...I){const T=v.evaluate.apply(void 0,I),S=w.evaluate.apply(void 0,I);if(T!==void 0&&S!==void 0)return C(T,S,g)}}:C(v,w,g)}function um(n,e,i){return e.type==="color"?i=rr.parse(i):e.type==="formatted"?i=un.fromString(i.toString()):e.type==="resolvedImage"?i=Wn.fromString(i.toString()):cr(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0),da(i,n.default,e.default)}jt.register(Rs,{error:[{kind:"error"},[Yt],(n,[e])=>{throw new zr(e.evaluate(n))}],typeof:[Yt,[Zt],(n,[e])=>gr(Ur(e.evaluate(n)))],"to-rgba":[Pn(dt,4),[kr],(n,[e])=>e.evaluate(n).toArray()],rgb:[kr,[dt,dt,dt],Gh],rgba:[kr,[dt,dt,dt,dt],Gh],has:{type:Wt,overloads:[[[Yt],(n,[e])=>jh(e.evaluate(n),n.properties())],[[Yt,oo],(n,[e,i])=>jh(e.evaluate(n),i.evaluate(n))]]},get:{type:Zt,overloads:[[[Yt],(n,[e])=>kc(e.evaluate(n),n.properties())],[[Yt,oo],(n,[e,i])=>kc(e.evaluate(n),i.evaluate(n))]]},"feature-state":[Zt,[Yt],(n,[e])=>kc(e.evaluate(n),n.featureState||{})],properties:[oo,[],n=>n.properties()],"geometry-type":[Yt,[],n=>n.geometryType()],id:[Zt,[],n=>n.id()],zoom:[dt,[],n=>n.globals.zoom],pitch:[dt,[],n=>n.globals.pitch||0],"distance-from-center":[dt,[],n=>n.distanceFromCenter()],"heatmap-density":[dt,[],n=>n.globals.heatmapDensity||0],"line-progress":[dt,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[dt,[],n=>n.globals.skyRadialProgress||0],accumulated:[Zt,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[dt,fs(dt),(n,e)=>{let i=0;for(const A of e)i+=A.evaluate(n);return i}],"*":[dt,fs(dt),(n,e)=>{let i=1;for(const A of e)i*=A.evaluate(n);return i}],"-":{type:dt,overloads:[[[dt,dt],(n,[e,i])=>e.evaluate(n)-i.evaluate(n)],[[dt],(n,[e])=>-e.evaluate(n)]]},"/":[dt,[dt,dt],(n,[e,i])=>e.evaluate(n)/i.evaluate(n)],"%":[dt,[dt,dt],(n,[e,i])=>e.evaluate(n)%i.evaluate(n)],ln2:[dt,[],()=>Math.LN2],pi:[dt,[],()=>Math.PI],e:[dt,[],()=>Math.E],"^":[dt,[dt,dt],(n,[e,i])=>Math.pow(e.evaluate(n),i.evaluate(n))],sqrt:[dt,[dt],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[dt,[dt],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[dt,[dt],(n,[e])=>Math.log(e.evaluate(n))],log2:[dt,[dt],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[dt,[dt],(n,[e])=>Math.sin(e.evaluate(n))],cos:[dt,[dt],(n,[e])=>Math.cos(e.evaluate(n))],tan:[dt,[dt],(n,[e])=>Math.tan(e.evaluate(n))],asin:[dt,[dt],(n,[e])=>Math.asin(e.evaluate(n))],acos:[dt,[dt],(n,[e])=>Math.acos(e.evaluate(n))],atan:[dt,[dt],(n,[e])=>Math.atan(e.evaluate(n))],min:[dt,fs(dt),(n,e)=>Math.min(...e.map(i=>i.evaluate(n)))],max:[dt,fs(dt),(n,e)=>Math.max(...e.map(i=>i.evaluate(n)))],abs:[dt,[dt],(n,[e])=>Math.abs(e.evaluate(n))],round:[dt,[dt],(n,[e])=>{const i=e.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[dt,[dt],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[dt,[dt],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[Wt,[Yt,Zt],(n,[e,i])=>n.properties()[e.value]===i.value],"filter-id-==":[Wt,[Zt],(n,[e])=>n.id()===e.value],"filter-type-==":[Wt,[Yt],(n,[e])=>n.geometryType()===e.value],"filter-<":[Wt,[Yt,Zt],(n,[e,i])=>{const A=n.properties()[e.value],h=i.value;return typeof A==typeof h&&A<h}],"filter-id-<":[Wt,[Zt],(n,[e])=>{const i=n.id(),A=e.value;return typeof i==typeof A&&i<A}],"filter->":[Wt,[Yt,Zt],(n,[e,i])=>{const A=n.properties()[e.value],h=i.value;return typeof A==typeof h&&A>h}],"filter-id->":[Wt,[Zt],(n,[e])=>{const i=n.id(),A=e.value;return typeof i==typeof A&&i>A}],"filter-<=":[Wt,[Yt,Zt],(n,[e,i])=>{const A=n.properties()[e.value],h=i.value;return typeof A==typeof h&&A<=h}],"filter-id-<=":[Wt,[Zt],(n,[e])=>{const i=n.id(),A=e.value;return typeof i==typeof A&&i<=A}],"filter->=":[Wt,[Yt,Zt],(n,[e,i])=>{const A=n.properties()[e.value],h=i.value;return typeof A==typeof h&&A>=h}],"filter-id->=":[Wt,[Zt],(n,[e])=>{const i=n.id(),A=e.value;return typeof i==typeof A&&i>=A}],"filter-has":[Wt,[Zt],(n,[e])=>e.value in n.properties()],"filter-has-id":[Wt,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[Wt,[Pn(Yt)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[Wt,[Pn(Zt)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[Wt,[Yt,Pn(Zt)],(n,[e,i])=>i.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[Wt,[Yt,Pn(Zt)],(n,[e,i])=>function(A,h,f,g){for(;f<=g;){const v=f+g>>1;if(h[v]===A)return!0;h[v]>A?g=v-1:f=v+1}return!1}(n.properties()[e.value],i.value,0,i.value.length-1)],all:{type:Wt,overloads:[[[Wt,Wt],(n,[e,i])=>e.evaluate(n)&&i.evaluate(n)],[fs(Wt),(n,e)=>{for(const i of e)if(!i.evaluate(n))return!1;return!0}]]},any:{type:Wt,overloads:[[[Wt,Wt],(n,[e,i])=>e.evaluate(n)||i.evaluate(n)],[fs(Wt),(n,e)=>{for(const i of e)if(i.evaluate(n))return!0;return!1}]]},"!":[Wt,[Wt],(n,[e])=>!e.evaluate(n)],"is-supported-script":[Wt,[Yt],(n,[e])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(e.evaluate(n))}],upcase:[Yt,[Yt],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[Yt,[Yt],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[Yt,fs(Zt),(n,e)=>e.map(i=>so(i.evaluate(n))).join("")],"resolved-locale":[Yt,[As],(n,[e])=>e.evaluate(n).resolvedLocale()]});class Rc{constructor(e,i){this.expression=e,this._warningHistory={},this._evaluator=new $t,this._defaultValue=i?function(A){return A.type==="color"&&Al(A.default)?new rr(0,0,0,0):A.type==="color"?rr.parse(A.default)||null:A.default===void 0?null:A.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(e,i,A,h,f,g,v,w){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=A,this._evaluator.canonical=h,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=w||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,A,h,f,g,v,w){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=A||null,this._evaluator.canonical=h,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=w||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new zr(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function Ao(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Rs}function fa(n,e){const i=new Qr(Rs,[],e?function(h){const f={color:kr,string:Yt,number:dt,enum:Yt,boolean:Wt,formatted:xo,resolvedImage:kn};return h.type==="array"?Pn(f[h.value]||Zt,h.length):f[h.type]}(e):void 0),A=i.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return A?Pc(new Rc(A,e)):zs(i.errors)}class ms{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!Ft(i.expression)}evaluateWithoutErrorHandling(e,i,A,h,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,i,A,h,f,g)}evaluate(e,i,A,h,f,g){return this._styleExpression.evaluate(e,i,A,h,f,g)}}class cl{constructor(e,i,A,h){this.kind=e,this.zoomStops=A,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!Ft(i.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,i,A,h,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,i,A,h,f,g)}evaluate(e,i,A,h,f,g){return this._styleExpression.evaluate(e,i,A,h,f,g)}interpolationFactor(e,i,A){return this.interpolationType?Pi.interpolationFactor(this.interpolationType,e,i,A):0}}function qh(n,e){if((n=fa(n,e)).result==="error")return n;const i=n.value.expression,A=Ye(i);if(!A&&!ps(e))return zs([new or("","data expressions not supported")]);const h=Mt(i,["zoom","pitch","distance-from-center"]);if(!h&&!Zh(e))return zs([new or("","zoom expressions not supported")]);const f=gs(i);return f||h?f instanceof or?zs([f]):f instanceof Pi&&!Oc(e)?zs([new or("",'"interpolate" expressions cannot be used with this property')]):Pc(f?new cl(A?"camera":"composite",n.value,f.labels,f instanceof Pi?f.interpolation:void 0):new ms(A?"constant":"source",n.value)):zs([new or("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class pa{constructor(e,i){this._parameters=e,this._specification=i,ar(this,Xh(this._parameters,this._specification))}static deserialize(e){return new pa(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function gs(n){let e=null;if(n instanceof dA)e=gs(n.result);else if(n instanceof rl){for(const i of n.args)if(e=gs(i),e)break}else(n instanceof wr||n instanceof Pi)&&n.input instanceof jt&&n.input.name==="zoom"&&(e=n);return e instanceof or||n.eachChild(i=>{const A=gs(i);A instanceof or?e=A:!e&&A?e=new or("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&A&&e!==A&&(e=new or("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Zi(n){const e=n.key,i=n.value,A=n.valueSpec||{},h=n.objectElementValidators||{},f=n.style,g=n.styleSpec;let v=[];const w=cr(i);if(w!=="object")return[new Pe(e,i,`object expected, ${w} found`)];for(const C in i){const I=C.split(".")[0],T=A[I]||A["*"];let S;if(h[I])S=h[I];else if(A[I])S=qn;else if(h["*"])S=h["*"];else{if(!A["*"]){v.push(new Pe(e,i[C],`unknown property "${C}"`));continue}S=qn}v=v.concat(S({key:(e&&`${e}.`)+C,value:i[C],valueSpec:T,style:f,styleSpec:g,object:i,objectKey:C},i))}for(const C in A)h[C]||A[C].required&&A[C].default===void 0&&i[C]===void 0&&v.push(new Pe(e,i,`missing required property "${C}"`));return v}function ul(n){const e=n.value,i=n.valueSpec,A=n.style,h=n.styleSpec,f=n.key,g=n.arrayElementValidator||qn;if(cr(e)!=="array")return[new Pe(f,e,`array expected, ${cr(e)} found`)];if(i.length&&e.length!==i.length)return[new Pe(f,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new Pe(f,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let v={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum};h.$version<7&&(v.function=i.function),cr(i.value)==="object"&&(v=i.value);let w=[];for(let C=0;C<e.length;C++)w=w.concat(g({array:e,arrayIndex:C,value:e[C],valueSpec:v,style:A,styleSpec:h,key:`${f}[${C}]`}));return w}function zc(n){const e=n.key,i=n.value,A=n.valueSpec;let h=cr(i);if(h==="number"&&i!=i&&(h="NaN"),h!=="number")return[new Pe(e,i,`number expected, ${h} found`)];if("minimum"in A){let f=A.minimum;if(cr(A.minimum)==="array"&&(f=A.minimum[n.arrayIndex]),i<f)return[new Pe(e,i,`${i} is less than the minimum value ${f}`)]}if("maximum"in A){let f=A.maximum;if(cr(A.maximum)==="array"&&(f=A.maximum[n.arrayIndex]),i>f)return[new Pe(e,i,`${i} is greater than the maximum value ${f}`)]}return[]}function hl(n){const e=n.valueSpec,i=Rt(n.value.type);let A,h,f,g={};const v=i!=="categorical"&&n.value.property===void 0,w=!v,C=cr(n.value.stops)==="array"&&cr(n.value.stops[0])==="array"&&cr(n.value.stops[0][0])==="object",I=Zi({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(R){if(i==="identity")return[new Pe(R.key,R.value,'identity function may not have a "stops" property')];let H=[];const Z=R.value;return H=H.concat(ul({key:R.key,value:Z,valueSpec:R.valueSpec,style:R.style,styleSpec:R.styleSpec,arrayElementValidator:T})),cr(Z)==="array"&&Z.length===0&&H.push(new Pe(R.key,Z,"array must have at least one stop")),H},default:function(R){return qn({key:R.key,value:R.value,valueSpec:e,style:R.style,styleSpec:R.styleSpec})}}});return i==="identity"&&v&&I.push(new Pe(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||I.push(new Pe(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!Oc(n.valueSpec)&&I.push(new Pe(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(w&&!ps(n.valueSpec)?I.push(new Pe(n.key,n.value,"property functions not supported")):v&&!Zh(n.valueSpec)&&I.push(new Pe(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!C||n.value.property!==void 0||I.push(new Pe(n.key,n.value,'"property" property is required')),I;function T(R){let H=[];const Z=R.value,te=R.key;if(cr(Z)!=="array")return[new Pe(te,Z,`array expected, ${cr(Z)} found`)];if(Z.length!==2)return[new Pe(te,Z,`array length 2 expected, length ${Z.length} found`)];if(C){if(cr(Z[0])!=="object")return[new Pe(te,Z,`object expected, ${cr(Z[0])} found`)];if(Z[0].zoom===void 0)return[new Pe(te,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new Pe(te,Z,"object stop key must have value")];if(f&&f>Rt(Z[0].zoom))return[new Pe(te,Z[0].zoom,"stop zoom values must appear in ascending order")];Rt(Z[0].zoom)!==f&&(f=Rt(Z[0].zoom),h=void 0,g={}),H=H.concat(Zi({key:`${te}[0]`,value:Z[0],valueSpec:{zoom:{}},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{zoom:zc,value:S}}))}else H=H.concat(S({key:`${te}[0]`,value:Z[0],valueSpec:{},style:R.style,styleSpec:R.styleSpec},Z));return Ao(ir(Z[1]))?H.concat([new Pe(`${te}[1]`,Z[1],"expressions are not allowed in function stops.")]):H.concat(qn({key:`${te}[1]`,value:Z[1],valueSpec:e,style:R.style,styleSpec:R.styleSpec}))}function S(R,H){const Z=cr(R.value),te=Rt(R.value),ce=R.value!==null?R.value:H;if(A){if(Z!==A)return[new Pe(R.key,ce,`${Z} stop domain type must match previous stop domain type ${A}`)]}else A=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new Pe(R.key,ce,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&i!=="categorical"){let fe=`number expected, ${Z} found`;return ps(e)&&i===void 0&&(fe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Pe(R.key,ce,fe)]}return i!=="categorical"||Z!=="number"||isFinite(te)&&Math.floor(te)===te?i!=="categorical"&&Z==="number"&&h!==void 0&&te<h?[new Pe(R.key,ce,"stop domain values must appear in ascending order")]:(h=te,i==="categorical"&&te in g?[new Pe(R.key,ce,"stop domain values must be unique")]:(g[te]=!0,[])):[new Pe(R.key,ce,`integer expected, found ${te}`)]}}function ys(n){const e=(n.expressionContext==="property"?qh:fa)(ir(n.value),n.valueSpec);if(e.result==="error")return e.value.map(A=>new Pe(`${n.key}${A.key}`,n.value,A.message));const i=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new Pe(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!Ft(i))return[new Pe(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter")return Hc(i,n);if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!Mt(i,["zoom","feature-state"]))return[new Pe(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!Ye(i))return[new Pe(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hc(n,e){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);for(const h of e.valueSpec.expression.parameters)i.delete(h);if(i.size===0)return[];const A=[];return n instanceof jt&&i.has(n.name)?[new Pe(e.key,e.value,`["${n.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(n.eachChild(h=>{A.push(...Hc(h,e))}),A)}function ma(n){const e=n.key,i=n.value,A=n.valueSpec,h=[];return Array.isArray(A.values)?A.values.indexOf(Rt(i))===-1&&h.push(new Pe(e,i,`expected one of [${A.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(A.values).indexOf(Rt(i))===-1&&h.push(new Pe(e,i,`expected one of [${Object.keys(A.values).join(", ")}], ${JSON.stringify(i)} found`)),h}function dl(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!dl(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function fA(n,e="fill"){if(n==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};dl(n)||(n=fl(n));const i=n;let A=!0;try{A=function(C){if(!Ns(C))return C;let I=ir(C);return Hs(I),I=Nc(I),I}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const h=xe[`filter_${e}`],f=fa(A,h);let g=null;if(f.result==="error")throw new Error(f.value.map(C=>`${C.key}: ${C.message}`).join(", "));g=(C,I,T)=>f.value.evaluate(C,I,{},T);let v=null,w=null;if(A!==i){const C=fa(i,h);if(C.result==="error")throw new Error(C.value.map(I=>`${I.key}: ${I.message}`).join(", "));v=(I,T,S,R,H)=>C.value.evaluate(I,T,{},S,void 0,void 0,R,H),w=!Ye(C.value.expression)}return g=g,{filter:g,dynamicFilter:v||void 0,needGeometry:Kc(A),needFeature:!!w}}function Nc(n){if(!Array.isArray(n))return n;const e=function(i){if(Jh.has(i[0])){for(let A=1;A<i.length;A++)if(Ns(i[A]))return!0}return i}(n);return e===!0?e:e.map(i=>Nc(i))}function Hs(n){let e=!1;const i=[];if(n[0]==="case"){for(let A=1;A<n.length-1;A+=2)e=e||Ns(n[A]),i.push(n[A+1]);i.push(n[n.length-1])}else if(n[0]==="match"){e=e||Ns(n[1]);for(let A=2;A<n.length-1;A+=2)i.push(n[A+1]);i.push(n[n.length-1])}else if(n[0]==="step"){e=e||Ns(n[1]);for(let A=1;A<n.length-1;A+=2)i.push(n[A+1])}e&&(n.length=0,n.push("any",...i));for(let A=1;A<n.length;A++)Hs(n[A])}function Ns(n){if(!Array.isArray(n))return!1;if((e=n[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let i=1;i<n.length;i++)if(Ns(n[i]))return!0;return!1}const Jh=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Vc(n,e){return n<e?-1:n>e?1:0}function Kc(n){if(!Array.isArray(n))return!1;if(n[0]==="within")return!0;for(let e=1;e<n.length;e++)if(Kc(n[e]))return!0;return!1}function fl(n){if(!n)return!0;const e=n[0];return n.length<=1?e!=="any":e==="=="?ga(n[1],n[2],"=="):e==="!="?pl(ga(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?ga(n[1],n[2],e):e==="any"?(i=n.slice(1),["any"].concat(i.map(fl))):e==="all"?["all"].concat(n.slice(1).map(fl)):e==="none"?["all"].concat(n.slice(1).map(fl).map(pl)):e==="in"?Yh(n[1],n.slice(2)):e==="!in"?pl(Yh(n[1],n.slice(2))):e==="has"?ed(n[1]):e==="!has"?pl(ed(n[1])):e!=="within"||n;var i}function ga(n,e,i){switch(n){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,n,e]}}function Yh(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",n,["literal",e.sort(Vc)]]:["filter-in-small",n,["literal",e]]}}function ed(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function pl(n){return["!",n]}function Gc(n){if(dl(ir(n.value))){const e=ir(n.layerType);return ys(ar({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${e||"fill"}`]}))}return td(n)}function td(n){const e=n.value,i=n.key;if(cr(e)!=="array")return[new Pe(i,e,`array expected, ${cr(e)} found`)];const A=n.styleSpec;let h,f=[];if(e.length<1)return[new Pe(i,e,"filter array must have at least 1 element")];switch(f=f.concat(ma({key:`${i}[0]`,value:e[0],valueSpec:A.filter_operator,style:n.style,styleSpec:n.styleSpec})),Rt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Rt(e[1])==="$type"&&f.push(new Pe(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&f.push(new Pe(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=cr(e[1]),h!=="string"&&f.push(new Pe(`${i}[1]`,e[1],`string expected, ${h} found`)));for(let g=2;g<e.length;g++)h=cr(e[g]),Rt(e[1])==="$type"?f=f.concat(ma({key:`${i}[${g}]`,value:e[g],valueSpec:A.geometry_type,style:n.style,styleSpec:n.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&f.push(new Pe(`${i}[${g}]`,e[g],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let g=1;g<e.length;g++)f=f.concat(td({key:`${i}[${g}]`,value:e[g],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":h=cr(e[1]),e.length!==2?f.push(new Pe(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="string"&&f.push(new Pe(`${i}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=cr(e[1]),e.length!==2?f.push(new Pe(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="object"&&f.push(new Pe(`${i}[1]`,e[1],`object expected, ${h} found`))}return f}function pA(n,e){const i=n.key,A=n.style,h=n.styleSpec,f=n.value,g=n.objectKey,v=h[`${e}_${n.layerType}`];if(!v)return[];const w=g.match(/^(.*)-transition$/);if(e==="paint"&&w&&v[w[1]]&&v[w[1]].transition)return qn({key:i,value:f,valueSpec:h.transition,style:A,styleSpec:h});const C=n.valueSpec||v[g];if(!C)return[new Pe(i,f,`unknown property "${g}"`)];let I;if(cr(f)==="string"&&ps(C)&&!C.tokens&&(I=/^{([^}]+)}$/.exec(f)))return[new Pe(i,f,`"${g}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(I[1])} }\`.`)];const T=[];return n.layerType==="symbol"&&(g==="text-field"&&A&&!A.glyphs&&T.push(new Pe(i,f,'use of "text-field" requires a style "glyphs" property')),g==="text-font"&&Al(ir(f))&&Rt(f.type)==="identity"&&T.push(new Pe(i,f,'"text-font" does not support identity functions'))),T.concat(qn({key:n.key,value:f,valueSpec:C,style:A,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:g}))}function mA(n){return pA(n,"paint")}function _i(n){return pA(n,"layout")}function gA(n){let e=[];const i=n.value,A=n.key,h=n.style,f=n.styleSpec;i.type||i.ref||e.push(new Pe(A,i,'either "type" or "ref" is required'));let g=Rt(i.type);const v=Rt(i.ref);if(i.id){const w=Rt(i.id);for(let C=0;C<n.arrayIndex;C++){const I=h.layers[C];Rt(I.id)===w&&e.push(new Pe(A,i.id,`duplicate layer id "${i.id}", previously used at line ${I.id.__line__}`))}}if("ref"in i){let w;["type","source","source-layer","filter","layout"].forEach(C=>{C in i&&e.push(new Pe(A,i[C],`"${C}" is prohibited for ref layers`))}),h.layers.forEach(C=>{Rt(C.id)===v&&(w=C)}),w?w.ref?e.push(new Pe(A,i.ref,"ref cannot reference another ref layer")):g=Rt(w.type):e.push(new Pe(A,i.ref,`ref layer "${v}" not found`))}else if(g!=="background"&&g!=="sky")if(i.source){const w=h.sources&&h.sources[i.source],C=w&&Rt(w.type);w?C==="vector"&&g==="raster"?e.push(new Pe(A,i.source,`layer "${i.id}" requires a raster source`)):C==="raster"&&g!=="raster"?e.push(new Pe(A,i.source,`layer "${i.id}" requires a vector source`)):C!=="vector"||i["source-layer"]?C==="raster-dem"&&g!=="hillshade"?e.push(new Pe(A,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!i.paint||!i.paint["line-gradient"]||C==="geojson"&&w.lineMetrics||e.push(new Pe(A,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Pe(A,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new Pe(A,i.source,`source "${i.source}" not found`))}else e.push(new Pe(A,i,'missing required property "source"'));return e=e.concat(Zi({key:A,value:i,valueSpec:f.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>qn({key:`${A}.type`,value:i.type,valueSpec:f.layer.type,style:n.style,styleSpec:n.styleSpec,object:i,objectKey:"type"}),filter:w=>Gc(ar({layerType:g},w)),layout:w=>Zi({layer:i,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":C=>_i(ar({layerType:g},C))}}),paint:w=>Zi({layer:i,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":C=>mA(ar({layerType:g},C))}})}})),e}function ya(n){const e=n.value,i=n.key,A=cr(e);return A!=="string"?[new Pe(i,e,`string expected, ${A} found`)]:[]}const rd={promoteId:function({key:n,value:e}){if(cr(e)==="string")return ya({key:n,value:e});{const i=[];for(const A in e)i.push(...ya({key:`${n}.${A}`,value:e[A]}));return i}}};function nd(n){const e=n.value,i=n.key,A=n.styleSpec,h=n.style;if(!e.type)return[new Pe(i,e,'"type" is required')];const f=Rt(e.type);let g;switch(f){case"vector":case"raster":case"raster-dem":return g=Zi({key:i,value:e,valueSpec:A[`source_${f.replace("-","_")}`],style:n.style,styleSpec:A,objectElementValidators:rd}),g;case"geojson":if(g=Zi({key:i,value:e,valueSpec:A.source_geojson,style:h,styleSpec:A,objectElementValidators:rd}),e.cluster)for(const v in e.clusterProperties){const[w,C]=e.clusterProperties[v],I=typeof w=="string"?[w,["accumulated"],["get",v]]:w;g.push(...ys({key:`${i}.${v}.map`,value:C,expressionContext:"cluster-map"})),g.push(...ys({key:`${i}.${v}.reduce`,value:I,expressionContext:"cluster-reduce"}))}return g;case"video":return Zi({key:i,value:e,valueSpec:A.source_video,style:h,styleSpec:A});case"image":return Zi({key:i,value:e,valueSpec:A.source_image,style:h,styleSpec:A});case"canvas":return[new Pe(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ma({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:A})}}function id(n){const e=n.value,i=n.styleSpec,A=i.light,h=n.style;let f=[];const g=cr(e);if(e===void 0)return f;if(g!=="object")return f=f.concat([new Pe("light",e,`object expected, ${g} found`)]),f;for(const v in e){const w=v.match(/^(.*)-transition$/);f=f.concat(w&&A[w[1]]&&A[w[1]].transition?qn({key:v,value:e[v],valueSpec:i.transition,style:h,styleSpec:i}):A[v]?qn({key:v,value:e[v],valueSpec:A[v],style:h,styleSpec:i}):[new Pe(v,e[v],`unknown property "${v}"`)])}return f}function ml(n){const e=n.value,i=n.key,A=n.style,h=n.styleSpec,f=h.terrain;let g=[];const v=cr(e);if(e===void 0)return g;if(v!=="object")return g=g.concat([new Pe("terrain",e,`object expected, ${v} found`)]),g;for(const w in e){const C=w.match(/^(.*)-transition$/);g=g.concat(C&&f[C[1]]&&f[C[1]].transition?qn({key:w,value:e[w],valueSpec:h.transition,style:A,styleSpec:h}):f[w]?qn({key:w,value:e[w],valueSpec:f[w],style:A,styleSpec:h}):[new Pe(w,e[w],`unknown property "${w}"`)])}if(e.source){const w=A.sources&&A.sources[e.source],C=w&&Rt(w.type);w?C!=="raster-dem"&&g.push(new Pe(i,e.source,`terrain cannot be used with a source of type ${C}, it only be used with a "raster-dem" source type`)):g.push(new Pe(i,e.source,`source "${e.source}" not found`))}else g.push(new Pe(i,e,'terrain is missing required property "source"'));return g}function od(n){const e=n.value,i=n.style,A=n.styleSpec,h=A.fog;let f=[];const g=cr(e);if(e===void 0)return f;if(g!=="object")return f=f.concat([new Pe("fog",e,`object expected, ${g} found`)]),f;for(const v in e){const w=v.match(/^(.*)-transition$/);f=f.concat(w&&h[w[1]]&&h[w[1]].transition?qn({key:v,value:e[v],valueSpec:A.transition,style:i,styleSpec:A}):h[v]?qn({key:v,value:e[v],valueSpec:h[v],style:i,styleSpec:A}):[new Pe(v,e[v],`unknown property "${v}"`)])}return f}const gl={"*":()=>[],array:ul,boolean:function(n){const e=n.value,i=n.key,A=cr(e);return A!=="boolean"?[new Pe(i,e,`boolean expected, ${A} found`)]:[]},number:zc,color:function(n){const e=n.key,i=n.value,A=cr(i);return A!=="string"?[new Pe(e,i,`color expected, ${A} found`)]:Xn.parseCSSColor(i)===null?[new Pe(e,i,`color expected, "${i}" found`)]:[]},constants:zt,enum:ma,filter:Gc,function:hl,layer:gA,object:Zi,source:nd,light:id,terrain:ml,fog:od,string:ya,formatted:function(n){return ya(n).length===0?[]:ys(n)},resolvedImage:function(n){return ya(n).length===0?[]:ys(n)},projection:function(n){const e=n.value,i=n.styleSpec,A=i.projection,h=n.style;let f=[];const g=cr(e);if(g==="object")for(const v in e)f=f.concat(qn({key:v,value:e[v],valueSpec:A[v],style:h,styleSpec:i}));else g!=="string"&&(f=f.concat([new Pe("projection",e,`object or string expected, ${g} found`)]));return f}};function qn(n){const e=n.value,i=n.valueSpec,A=n.styleSpec;return i.expression&&Al(Rt(e))?hl(n):i.expression&&Ao(ir(e))?ys(n):i.type&&gl[i.type]?gl[i.type](n):Zi(ar({},n,{valueSpec:i.type?A[i.type]:i}))}function hm(n){const e=n.value,i=n.key,A=ya(n);return A.length||(e.indexOf("{fontstack}")===-1&&A.push(new Pe(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&A.push(new Pe(i,e,'"glyphs" url must include a "{range}" token'))),A}function lo(n,e=xe){let i=[];return i=i.concat(qn({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,objectElementValidators:{glyphs:hm,"*":()=>[]}})),n.constants&&(i=i.concat(zt({key:"constants",value:n.constants,style:n,styleSpec:e}))),sd(i)}function sd(n){return[].concat(n).sort((e,i)=>e.line-i.line)}function Xo(n){return function(...e){return sd(n.apply(this,e))}}lo.source=Xo(nd),lo.light=Xo(id),lo.terrain=Xo(ml),lo.fog=Xo(od),lo.layer=Xo(gA),lo.filter=Xo(Gc),lo.paintProperty=Xo(mA),lo.layoutProperty=Xo(_i);const Vs=lo,dm=Vs.light,jc=Vs.fog,yl=Vs.paintProperty,ad=Vs.layoutProperty;function Ad(n,e){let i=!1;if(e&&e.length)for(const A of e)n.fire(new St(new Error(A.message))),i=!0;return i}var _a=Io;function Io(n,e,i){var A=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var h=new Int32Array(this.arrayBuffer);n=h[0],this.d=(e=h[1])+2*(i=h[2]);for(var f=0;f<this.d*this.d;f++){var g=h[3+f],v=h[3+f+1];A.push(g===v?null:h.subarray(g,v))}var w=h[3+A.length+1];this.keys=h.subarray(h[3+A.length],w),this.bboxes=h.subarray(w),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var C=0;C<this.d*this.d;C++)A.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=n,this.padding=i,this.scale=e/n,this.uid=0;var I=i/e*n;this.min=-I,this.max=n+I}Io.prototype.insert=function(n,e,i,A,h){this._forEachCell(e,i,A,h,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(A),this.bboxes.push(h)},Io.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Io.prototype._insertCell=function(n,e,i,A,h,f){this.cells[h].push(f)},Io.prototype.query=function(n,e,i,A,h){var f=this.min,g=this.max;if(n<=f&&e<=f&&g<=i&&g<=A&&!h)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(n,e,i,A,this._queryCell,v,{},h),v},Io.prototype._queryCell=function(n,e,i,A,h,f,g,v){var w=this.cells[h];if(w!==null)for(var C=this.keys,I=this.bboxes,T=0;T<w.length;T++){var S=w[T];if(g[S]===void 0){var R=4*S;(v?v(I[R+0],I[R+1],I[R+2],I[R+3]):n<=I[R+2]&&e<=I[R+3]&&i>=I[R+0]&&A>=I[R+1])?(g[S]=!0,f.push(C[S])):g[S]=!1}}},Io.prototype._forEachCell=function(n,e,i,A,h,f,g,v){for(var w=this._convertToCellCoord(n),C=this._convertToCellCoord(e),I=this._convertToCellCoord(i),T=this._convertToCellCoord(A),S=w;S<=I;S++)for(var R=C;R<=T;R++){var H=this.d*R+S;if((!v||v(this._convertFromCellCoord(S),this._convertFromCellCoord(R),this._convertFromCellCoord(S+1),this._convertFromCellCoord(R+1)))&&h.call(this,n,e,i,A,H,f,g,v))return}},Io.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},Io.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},Io.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,e=3+this.cells.length+1+1,i=0,A=0;A<this.cells.length;A++)i+=this.cells[A].length;var h=new Int32Array(e+i+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var f=e,g=0;g<n.length;g++){var v=n[g];h[3+g]=f,h.set(v,f),f+=v.length}return h[3+n.length]=f,h.set(this.keys,f),h[3+n.length+1]=f+=this.keys.length,h.set(this.bboxes,f),f+=this.bboxes.length,h.buffer};const{ImageData:_l,ImageBitmap:ld}=V,yA={};function Bt(n,e,i={}){Object.defineProperty(e,"_classRegistryKey",{value:n,writeable:!1}),yA[n]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}Bt("Object",Object),_a.serialize=function(n,e){const i=n.toArrayBuffer();return e&&e.push(i),{buffer:i}},_a.deserialize=function(n){return new _a(n.buffer)},Bt("Grid",_a),Bt("Color",rr),Bt("Error",Error),Bt("ResolvedImage",Wn),Bt("StylePropertyFunction",pa),Bt("StyleExpression",Rc,{omit:["_evaluator"]}),Bt("ZoomDependentExpression",cl),Bt("ZoomConstantExpression",ms),Bt("CompoundExpression",jt,{omit:["_evaluate"]});for(const n in Rs)Rs[n]._classRegistryKey||Bt(`Expression_${n}`,Rs[n]);function cd(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function Zc(n){return ld&&n instanceof ld}function _A(n,e){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(cd(n)||Zc(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const i=n;return e&&e.push(i.buffer),i}if(n instanceof _l)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const i=[];for(const A of n)i.push(_A(A,e));return i}if(typeof n=="object"){const i=n.constructor,A=i._classRegistryKey;if(!A)throw new Error("can't serialize object of unregistered class");const h=i.serialize?i.serialize(n,e):{};if(!i.serialize){for(const f in n){if(!n.hasOwnProperty(f)||yA[A].omit.indexOf(f)>=0)continue;const g=n[f];h[f]=yA[A].shallow.indexOf(f)>=0?g:_A(g,e)}n instanceof Error&&(h.message=n.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return A!=="Object"&&(h.$name=A),h}throw new Error("can't serialize object of type "+typeof n)}function vA(n){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||cd(n)||Zc(n)||ArrayBuffer.isView(n)||n instanceof _l)return n;if(Array.isArray(n))return n.map(vA);if(typeof n=="object"){const e=n.$name||"Object",{klass:i}=yA[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(n);const A=Object.create(i.prototype);for(const h of Object.keys(n)){if(h==="$name")continue;const f=n[h];A[h]=yA[e].shallow.indexOf(h)>=0?f:vA(f)}return A}throw new Error("can't deserialize object of type "+typeof n)}class ud{constructor(){this.first=!0}update(e,i){const A=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=A,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=A,!0):(this.lastFloorZoom>A?(this.lastIntegerZoom=A+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<A&&(this.lastIntegerZoom=A,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=A,!0))}}const hd=n=>n>=1536&&n<=1791,dd=n=>n>=1872&&n<=1919,fd=n=>n>=2208&&n<=2303,pd=n=>n>=11904&&n<=12031,xA=n=>n>=12032&&n<=12255,md=n=>n>=12272&&n<=12287,vl=n=>n>=12288&&n<=12351,va=n=>n>=12352&&n<=12447,xl=n=>n>=12448&&n<=12543,Xc=n=>n>=12544&&n<=12591,gd=n=>n>=12704&&n<=12735,Wc=n=>n>=12736&&n<=12783,$c=n=>n>=12784&&n<=12799,qc=n=>n>=12800&&n<=13055,Jc=n=>n>=13056&&n<=13311,wl=n=>n>=13312&&n<=19903,wA=n=>n>=19968&&n<=40959,yd=n=>n>=40960&&n<=42127,_d=n=>n>=42128&&n<=42191,BA=n=>n>=44032&&n<=55215,vd=n=>n>=63744&&n<=64255,_s=n=>n>=64336&&n<=65023,xd=n=>n>=65040&&n<=65055,bA=n=>n>=65072&&n<=65103,wd=n=>n>=65104&&n<=65135,Yc=n=>n>=65136&&n<=65279,eu=n=>n>=65280&&n<=65519;function vs(n){for(const e of n)if(tu(e.charCodeAt(0)))return!0;return!1}function Bl(n){for(const e of n)if(!CA(e.charCodeAt(0)))return!1;return!0}function CA(n){return!(hd(n)||dd(n)||fd(n)||_s(n)||Yc(n))}function tu(n){return!(n!==746&&n!==747&&(n<4352||!(gd(n)||Xc(n)||bA(n)&&!(n>=65097&&n<=65103)||vd(n)||Jc(n)||pd(n)||Wc(n)||!(!vl(n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||wl(n)||wA(n)||qc(n)||(e=>e>=12592&&e<=12687)(n)||(e=>e>=43360&&e<=43391)(n)||(e=>e>=55216&&e<=55295)(n)||(e=>e>=4352&&e<=4607)(n)||BA(n)||va(n)||md(n)||(e=>e>=12688&&e<=12703)(n)||xA(n)||$c(n)||xl(n)&&n!==12540||!(!eu(n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!wd(n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||(e=>e>=5120&&e<=5759)(n)||(e=>e>=6320&&e<=6399)(n)||xd(n)||(e=>e>=19904&&e<=19967)(n)||yd(n)||_d(n))))}function ru(n){return!(tu(n)||function(e){return!!((i=>i>=128&&i<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(i=>i>=8192&&i<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(i=>i>=8448&&i<=8527)(e)||(i=>i>=8528&&i<=8591)(e)||(i=>i>=8960&&i<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(i=>i>=9216&&i<=9279)(e)&&e!==9251||(i=>i>=9280&&i<=9311)(e)||(i=>i>=9312&&i<=9471)(e)||(i=>i>=9632&&i<=9727)(e)||(i=>i>=9728&&i<=9983)(e)&&!(e>=9754&&e<=9759)||(i=>i>=11008&&i<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||vl(e)||xl(e)||(i=>i>=57344&&i<=63743)(e)||bA(e)||wd(e)||eu(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(n))}function xa(n){return n>=1424&&n<=2303||_s(n)||Yc(n)}function fm(n,e){return!(!e&&xa(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||(i=>i>=6016&&i<=6143)(n))}function pm(n){for(const e of n)if(xa(e.charCodeAt(0)))return!0;return!1}const wa="deferred",d="loading",r="loaded";let c=null,p="unavailable",y=null;const _=function(n){n&&typeof n=="string"&&n.indexOf("NetworkError")>-1&&(p="error"),c&&c(n)};function b(){E.fire(new $e("pluginStateChange",{pluginStatus:p,pluginURL:y}))}const E=new ut,U=function(){return p},D=function(){if(p!==wa||!y)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");p=d,b(),y&&N({url:y},n=>{n?_(n):(p=r,b())})},k={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>p===r||k.applyArabicShaping!=null,isLoading:()=>p===d,setState(n){p=n.pluginStatus,y=n.pluginURL},isParsed:()=>k.applyArabicShaping!=null&&k.processBidirectionalText!=null&&k.processStyledBidirectionalText!=null,getPluginURL:()=>y};class P{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ud,this.transition={},this.pitch=0)}isSupportedScript(e){return function(i,A){for(const h of i)if(!fm(h.charCodeAt(0),A))return!1;return!0}(e,k.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),A=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*A}:{fromScale:.5,toScale:1,t:1-(1-A)*i}}}class j{constructor(e,i){this.property=e,this.value=i,this.expression=function(A,h){if(Al(A))return new pa(A,h);if(Ao(A)){const f=qh(A,h);if(f.result==="error")throw new Error(f.value.map(g=>`${g.key}: ${g.message}`).join(", "));return f.value}{let f=A;return typeof A=="string"&&h.type==="color"&&(f=rr.parse(A)),{kind:"constant",evaluate:()=>f}}}(i===void 0?e.specification.default:i,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,A){return this.property.possiblyEvaluate(this,e,i,A)}}class ${constructor(e){this.property=e,this.value=new j(e,void 0)}transitioned(e,i){return new X(this.property,this.value,i,qe({},e.transition,this.transition),e.now)}untransitioned(){return new X(this.property,this.value,null,{},0)}}class ee{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Je(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new $(this._values[e].property)),this._values[e].value=new j(this._values[e].property,i===null?void 0:Je(i))}getTransition(e){return Je(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new $(this._values[e].property)),this._values[e].transition=Je(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const A=this.getValue(i);A!==void 0&&(e[i]=A);const h=this.getTransition(i);h!==void 0&&(e[`${i}-transition`]=h)}return e}transitioned(e,i){const A=new ae(this._properties);for(const h of Object.keys(this._values))A._values[h]=this._values[h].transitioned(e,i._values[h]);return A}untransitioned(){const e=new ae(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class X{constructor(e,i,A,h,f){const g=h.delay||0,v=h.duration||0;f=f||0,this.property=e,this.value=i,this.begin=f+g,this.end=this.begin+v,e.specification.transition&&(h.delay||h.duration)&&(this.prior=A)}possiblyEvaluate(e,i,A){const h=e.now||0,f=this.value.possiblyEvaluate(e,i,A),g=this.prior;if(g){if(h>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(h<this.begin)return g.possiblyEvaluate(e,i,A);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,i,A),f,oe(v))}}return f}}class ae{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,A){const h=new ue(this._properties);for(const f of Object.keys(this._values))h._values[f]=this._values[f].possiblyEvaluate(e,i,A);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class W{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Je(this._values[e].value)}setValue(e,i){this._values[e]=new j(this._values[e].property,i===null?void 0:Je(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const A=this.getValue(i);A!==void 0&&(e[i]=A)}return e}possiblyEvaluate(e,i,A){const h=new ue(this._properties);for(const f of Object.keys(this._values))h._values[f]=this._values[f].possiblyEvaluate(e,i,A);return h}}class Ae{constructor(e,i,A){this.property=e,this.value=i,this.parameters=A}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,A,h){return this.property.evaluate(this.value,this.parameters,e,i,A,h)}}class ue{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class J{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,A){const h=zn[this.specification.type];return h?h(e,i,A):e}}class he{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,A,h){return new Ae(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},A,h)}:e.expression,i)}interpolate(e,i,A){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new Ae(this,{kind:"constant",value:void 0},e.parameters);const h=zn[this.specification.type];return h?new Ae(this,{kind:"constant",value:h(e.value.value,i.value.value,A)},e.parameters):e}evaluate(e,i,A,h,f,g){return e.kind==="constant"?e.value:e.evaluate(i,A,h,f,g)}}class ye extends he{possiblyEvaluate(e,i,A,h){if(e.value===void 0)return new Ae(this,{kind:"constant",value:void 0},i);if(e.expression.kind==="constant"){const f=e.expression.evaluate(i,null,{},A,h),g=e.property.specification.type==="resolvedImage"&&typeof f!="string"?f.name:f,v=this._calculate(g,g,g,i);return new Ae(this,{kind:"constant",value:v},i)}if(e.expression.kind==="camera"){const f=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new Ae(this,{kind:"constant",value:f},i)}return new Ae(this,e.expression,i)}evaluate(e,i,A,h,f,g){if(e.kind==="source"){const v=e.evaluate(i,A,h,f,g);return this._calculate(v,v,v,i)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},A,h),e.evaluate({zoom:Math.floor(i.zoom)},A,h),e.evaluate({zoom:Math.floor(i.zoom)+1},A,h),i):e.value}_calculate(e,i,A,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:i,other:A}:{from:A,to:i,other:e}}interpolate(e){return e}}class De{constructor(e){this.specification=e}possiblyEvaluate(e,i,A,h){if(e.value!==void 0){if(e.expression.kind==="constant"){const f=e.expression.evaluate(i,null,{},A,h);return this._calculate(f,f,f,i)}return this._calculate(e.expression.evaluate(new P(Math.floor(i.zoom-1),i)),e.expression.evaluate(new P(Math.floor(i.zoom),i)),e.expression.evaluate(new P(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,A,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:A,to:i}}interpolate(e){return e}}class Le{constructor(e){this.specification=e}possiblyEvaluate(e,i,A,h){return!!e.expression.evaluate(i,null,{},A,h)}interpolate(){return!1}}class Ve{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in e){const A=e[i];A.specification.overridable&&this.overridableProperties.push(i);const h=this.defaultPropertyValues[i]=new j(A,void 0),f=this.defaultTransitionablePropertyValues[i]=new $(A);this.defaultTransitioningPropertyValues[i]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=h.possiblyEvaluate({})}}}function Ge(n,e){return 256*(n=Ue(Math.floor(n),0,255))+Ue(Math.floor(e),0,255)}Bt("DataDrivenProperty",he),Bt("DataConstantProperty",J),Bt("CrossFadedDataDrivenProperty",ye),Bt("CrossFadedProperty",De),Bt("ColorRampProperty",Le);const at={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class He{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ht{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Qe(n,e=1){let i=0,A=0;return{members:n.map(h=>{const f=at[h.type].BYTES_PER_ELEMENT,g=i=ft(i,Math.max(e,f)),v=h.components||1;return A=Math.max(A,f),i+=f*v,{name:h.name,type:h.type,components:v,offset:g}}),size:ft(i,Math.max(A,e)),alignment:e}}function ft(n,e){return Math.ceil(n/e)*e}class bt extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const A=this.length;return this.resize(A+1),this.emplace(A,e,i)}emplace(e,i,A){const h=2*e;return this.int16[h+0]=i,this.int16[h+1]=A,e}}bt.prototype.bytesPerElement=4,Bt("StructArrayLayout2i4",bt);class Pt extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,A,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,A,h)}emplace(e,i,A,h,f){const g=4*e;return this.int16[g+0]=i,this.int16[g+1]=A,this.int16[g+2]=h,this.int16[g+3]=f,e}}Pt.prototype.bytesPerElement=8,Bt("StructArrayLayout4i8",Pt);class Ht extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,A,h,f,g,v){const w=this.length;return this.resize(w+1),this.emplace(w,e,i,A,h,f,g,v)}emplace(e,i,A,h,f,g,v,w){const C=6*e,I=12*e,T=3*e;return this.int16[C+0]=i,this.int16[C+1]=A,this.uint8[I+4]=h,this.uint8[I+5]=f,this.uint8[I+6]=g,this.uint8[I+7]=v,this.float32[T+2]=w,e}}Ht.prototype.bytesPerElement=12,Bt("StructArrayLayout2i4ub1f12",Ht);class Kt extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,A){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,A)}emplace(e,i,A,h){const f=3*e;return this.float32[f+0]=i,this.float32[f+1]=A,this.float32[f+2]=h,e}}Kt.prototype.bytesPerElement=12,Bt("StructArrayLayout3f12",Kt);class Gt extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,A,h,f,g,v,w,C,I){const T=this.length;return this.resize(T+1),this.emplace(T,e,i,A,h,f,g,v,w,C,I)}emplace(e,i,A,h,f,g,v,w,C,I,T){const S=10*e;return this.uint16[S+0]=i,this.uint16[S+1]=A,this.uint16[S+2]=h,this.uint16[S+3]=f,this.uint16[S+4]=g,this.uint16[S+5]=v,this.uint16[S+6]=w,this.uint16[S+7]=C,this.uint16[S+8]=I,this.uint16[S+9]=T,e}}Gt.prototype.bytesPerElement=20,Bt("StructArrayLayout10ui20",Gt);class kt extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,A,h,f,g,v,w){const C=this.length;return this.resize(C+1),this.emplace(C,e,i,A,h,f,g,v,w)}emplace(e,i,A,h,f,g,v,w,C){const I=8*e;return this.uint16[I+0]=i,this.uint16[I+1]=A,this.uint16[I+2]=h,this.uint16[I+3]=f,this.uint16[I+4]=g,this.uint16[I+5]=v,this.uint16[I+6]=w,this.uint16[I+7]=C,e}}kt.prototype.bytesPerElement=16,Bt("StructArrayLayout8ui16",kt);class qt extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z,te){const ce=this.length;return this.resize(ce+1),this.emplace(ce,e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z,te)}emplace(e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z,te,ce){const fe=16*e;return this.int16[fe+0]=i,this.int16[fe+1]=A,this.int16[fe+2]=h,this.int16[fe+3]=f,this.uint16[fe+4]=g,this.uint16[fe+5]=v,this.uint16[fe+6]=w,this.uint16[fe+7]=C,this.int16[fe+8]=I,this.int16[fe+9]=T,this.int16[fe+10]=S,this.int16[fe+11]=R,this.int16[fe+12]=H,this.int16[fe+13]=Z,this.int16[fe+14]=te,this.int16[fe+15]=ce,e}}qt.prototype.bytesPerElement=32,Bt("StructArrayLayout4i4ui4i4i32",qt);class fr extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}fr.prototype.bytesPerElement=4,Bt("StructArrayLayout1ul4",fr);class dn extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,A,h,f,g,v,w,C,I,T,S,R){const H=this.length;return this.resize(H+1),this.emplace(H,e,i,A,h,f,g,v,w,C,I,T,S,R)}emplace(e,i,A,h,f,g,v,w,C,I,T,S,R,H){const Z=20*e,te=10*e;return this.int16[Z+0]=i,this.int16[Z+1]=A,this.int16[Z+2]=h,this.int16[Z+3]=f,this.int16[Z+4]=g,this.float32[te+3]=v,this.float32[te+4]=w,this.float32[te+5]=C,this.float32[te+6]=I,this.int16[Z+14]=T,this.uint32[te+8]=S,this.uint16[Z+18]=R,this.uint16[Z+19]=H,e}}dn.prototype.bytesPerElement=40,Bt("StructArrayLayout5i4f1i1ul2ui40",dn);class Hn extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,A,h,f,g,v){const w=this.length;return this.resize(w+1),this.emplace(w,e,i,A,h,f,g,v)}emplace(e,i,A,h,f,g,v,w){const C=8*e;return this.int16[C+0]=i,this.int16[C+1]=A,this.int16[C+2]=h,this.int16[C+4]=f,this.int16[C+5]=g,this.int16[C+6]=v,this.int16[C+7]=w,e}}Hn.prototype.bytesPerElement=16,Bt("StructArrayLayout3i2i2i16",Hn);class Jn extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,A,h,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,A,h,f)}emplace(e,i,A,h,f,g){const v=4*e,w=8*e;return this.float32[v+0]=i,this.float32[v+1]=A,this.float32[v+2]=h,this.int16[w+6]=f,this.int16[w+7]=g,e}}Jn.prototype.bytesPerElement=16,Bt("StructArrayLayout2f1f2i16",Jn);class Ai extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,A,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,A,h)}emplace(e,i,A,h,f){const g=12*e,v=3*e;return this.uint8[g+0]=i,this.uint8[g+1]=A,this.float32[v+1]=h,this.float32[v+2]=f,e}}Ai.prototype.bytesPerElement=12,Bt("StructArrayLayout2ub2f12",Ai);class fn extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,A){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,A)}emplace(e,i,A,h){const f=3*e;return this.uint16[f+0]=i,this.uint16[f+1]=A,this.uint16[f+2]=h,e}}fn.prototype.bytesPerElement=6,Bt("StructArrayLayout3ui6",fn);class Wo extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z,te,ce,fe,ve,be,Be){const Ie=this.length;return this.resize(Ie+1),this.emplace(Ie,e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z,te,ce,fe,ve,be,Be)}emplace(e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z,te,ce,fe,ve,be,Be,Ie){const je=30*e,Oe=15*e,pt=60*e;return this.int16[je+0]=i,this.int16[je+1]=A,this.int16[je+2]=h,this.float32[Oe+2]=f,this.float32[Oe+3]=g,this.uint16[je+8]=v,this.uint16[je+9]=w,this.uint32[Oe+5]=C,this.uint32[Oe+6]=I,this.uint32[Oe+7]=T,this.uint16[je+16]=S,this.uint16[je+17]=R,this.uint16[je+18]=H,this.float32[Oe+10]=Z,this.float32[Oe+11]=te,this.uint8[pt+48]=ce,this.uint8[pt+49]=fe,this.uint8[pt+50]=ve,this.uint32[Oe+13]=be,this.int16[je+28]=Be,this.uint8[pt+58]=Ie,e}}Wo.prototype.bytesPerElement=60,Bt("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",Wo);class To extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z,te,ce,fe,ve,be,Be,Ie,je,Oe,pt,tt,Ze,rt,st,We){const mt=this.length;return this.resize(mt+1),this.emplace(mt,e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z,te,ce,fe,ve,be,Be,Ie,je,Oe,pt,tt,Ze,rt,st,We)}emplace(e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z,te,ce,fe,ve,be,Be,Ie,je,Oe,pt,tt,Ze,rt,st,We,mt){const wt=38*e,Jt=19*e;return this.int16[wt+0]=i,this.int16[wt+1]=A,this.int16[wt+2]=h,this.float32[Jt+2]=f,this.float32[Jt+3]=g,this.int16[wt+8]=v,this.int16[wt+9]=w,this.int16[wt+10]=C,this.int16[wt+11]=I,this.int16[wt+12]=T,this.int16[wt+13]=S,this.uint16[wt+14]=R,this.uint16[wt+15]=H,this.uint16[wt+16]=Z,this.uint16[wt+17]=te,this.uint16[wt+18]=ce,this.uint16[wt+19]=fe,this.uint16[wt+20]=ve,this.uint16[wt+21]=be,this.uint16[wt+22]=Be,this.uint16[wt+23]=Ie,this.uint16[wt+24]=je,this.uint16[wt+25]=Oe,this.uint16[wt+26]=pt,this.uint16[wt+27]=tt,this.uint16[wt+28]=Ze,this.uint32[Jt+15]=rt,this.float32[Jt+16]=st,this.float32[Jt+17]=We,this.float32[Jt+18]=mt,e}}To.prototype.bytesPerElement=76,Bt("StructArrayLayout3i2f6i15ui1ul3f76",To);class Mr extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}Mr.prototype.bytesPerElement=4,Bt("StructArrayLayout1f4",Mr);class Yr extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,A){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,A)}emplace(e,i,A,h){const f=3*e;return this.int16[f+0]=i,this.int16[f+1]=A,this.int16[f+2]=h,e}}Yr.prototype.bytesPerElement=6,Bt("StructArrayLayout3i6",Yr);class Ar extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,A,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,A,h)}emplace(e,i,A,h,f){const g=6*e;return this.uint32[3*e+0]=i,this.uint16[g+2]=A,this.uint16[g+3]=h,this.uint16[g+4]=f,e}}Ar.prototype.bytesPerElement=12,Bt("StructArrayLayout1ul3ui12",Ar);class Or extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const A=this.length;return this.resize(A+1),this.emplace(A,e,i)}emplace(e,i,A){const h=2*e;return this.uint16[h+0]=i,this.uint16[h+1]=A,e}}Or.prototype.bytesPerElement=4,Bt("StructArrayLayout2ui4",Or);class Nn extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}Nn.prototype.bytesPerElement=2,Bt("StructArrayLayout1ui2",Nn);class Lr extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const A=this.length;return this.resize(A+1),this.emplace(A,e,i)}emplace(e,i,A){const h=2*e;return this.float32[h+0]=i,this.float32[h+1]=A,e}}Lr.prototype.bytesPerElement=8,Bt("StructArrayLayout2f8",Lr);class Oi extends ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,A,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,A,h)}emplace(e,i,A,h,f){const g=4*e;return this.float32[g+0]=i,this.float32[g+1]=A,this.float32[g+2]=h,this.float32[g+3]=f,e}}Oi.prototype.bytesPerElement=16,Bt("StructArrayLayout4f16",Oi);class EA extends He{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}EA.prototype.size=40;class vi extends dn{get(e){return new EA(this,e)}}Bt("CollisionBoxArray",vi);class xs extends He{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}xs.prototype.size=60;class Bd extends Wo{get(e){return new xs(this,e)}}Bt("PlacedSymbolArray",Bd);class bl extends He{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}bl.prototype.size=76;class Ba extends To{get(e){return new bl(this,e)}}Bt("SymbolInstanceArray",Ba);class bd extends Mr{getoffsetX(e){return this.float32[1*e+0]}}Bt("GlyphOffsetArray",bd);class FA extends Yr{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Bt("SymbolLineVertexArray",FA);class Cl extends He{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Cl.prototype.size=12;class m0 extends Ar{get(e){return new Cl(this,e)}}Bt("FeatureIndexArray",m0);class g0 extends He{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}g0.prototype.size=4;class y0 extends Or{get(e){return new g0(this,e)}}Bt("FillExtrusionCentroidArray",y0);const UC=Qe([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),SC=Qe([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var _0=Gi(function(n){n.exports=function(e,i){var A,h,f,g,v,w,C,I;for(h=e.length-(A=3&e.length),f=i,v=3432918353,w=461845907,I=0;I<h;)C=255&e.charCodeAt(I)|(255&e.charCodeAt(++I))<<8|(255&e.charCodeAt(++I))<<16|(255&e.charCodeAt(++I))<<24,++I,f=27492+(65535&(g=5*(65535&(f=(f^=C=(65535&(C=(C=(65535&C)*v+(((C>>>16)*v&65535)<<16)&4294967295)<<15|C>>>17))*w+(((C>>>16)*w&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(C=0,A){case 3:C^=(255&e.charCodeAt(I+2))<<16;case 2:C^=(255&e.charCodeAt(I+1))<<8;case 1:f^=C=(65535&(C=(C=(65535&(C^=255&e.charCodeAt(I)))*v+(((C>>>16)*v&65535)<<16)&4294967295)<<15|C>>>17))*w+(((C>>>16)*w&65535)<<16)&4294967295}return f^=e.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0}}),QC=Gi(function(n){n.exports=function(e,i){for(var A,h=e.length,f=i^h,g=0;h>=4;)A=1540483477*(65535&(A=255&e.charCodeAt(g)|(255&e.charCodeAt(++g))<<8|(255&e.charCodeAt(++g))<<16|(255&e.charCodeAt(++g))<<24))+((1540483477*(A>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(A=1540483477*(65535&(A^=A>>>24))+((1540483477*(A>>>16)&65535)<<16)),h-=4,++g;switch(h){case 3:f^=(255&e.charCodeAt(g+2))<<16;case 2:f^=(255&e.charCodeAt(g+1))<<8;case 1:f=1540483477*(65535&(f^=255&e.charCodeAt(g)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0}}),nu=_0,MC=QC;nu.murmur3=_0,nu.murmur2=MC;class Cd{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,A,h){this.ids.push(v0(e)),this.positions.push(i,A,h)}getPositions(e){const i=v0(e);let A=0,h=this.ids.length-1;for(;A<h;){const g=A+h>>1;this.ids[g]>=i?h=g:A=g+1}const f=[];for(;this.ids[A]===i;)f.push({index:this.positions[3*A],start:this.positions[3*A+1],end:this.positions[3*A+2]}),A++;return f}static serialize(e,i){const A=new Float64Array(e.ids),h=new Uint32Array(e.positions);return mm(A,h,0,A.length-1),i&&i.push(A.buffer,h.buffer),{ids:A,positions:h}}static deserialize(e){const i=new Cd;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function v0(n){const e=+n;return!isNaN(e)&&e<=ie?e:nu(String(n))}function mm(n,e,i,A){for(;i<A;){const h=n[i+A>>1];let f=i-1,g=A+1;for(;;){do f++;while(n[f]<h);do g--;while(n[g]>h);if(f>=g)break;Ed(n,f,g),Ed(e,3*f,3*g),Ed(e,3*f+1,3*g+1),Ed(e,3*f+2,3*g+2)}g-i<A-g?(mm(n,e,i,g),i=g+1):(mm(n,e,g+1,A),A=g)}}function Ed(n,e,i){const A=n[e];n[e]=n[i],n[i]=A}Bt("FeaturePositionMap",Cd);class Ks{constructor(e,i){this.gl=e.gl,this.location=i}}class Fd extends Ks{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class x0 extends Ks{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class w0 extends Ks{constructor(e,i){super(e,i),this.current=rr.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const LC=new Float32Array(16),DC=new Float32Array(9),kC=new Float32Array(4);function gm(n){return[Ge(255*n.r,255*n.g),Ge(255*n.b,255*n.a)]}class iu{constructor(e,i,A){this.value=e,this.uniformNames=i.map(h=>`u_${h}`),this.type=A}setUniform(e,i,A){e.set(A.constantOr(this.value))}getBinding(e,i,A){return this.type==="color"?new w0(e,i):new Fd(e,i)}}class El{constructor(e,i){this.uniformNames=i.map(A=>`u_${A}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=i.tl.concat(i.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,i,A,h){const f=h==="u_pattern_to"||h==="u_dash_to"?this.patternTo:h==="u_pattern_from"||h==="u_dash_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)}getBinding(e,i,A){return A==="u_pattern_from"||A==="u_pattern_to"||A==="u_dash_from"||A==="u_dash_to"?new x0(e,i):new Fd(e,i)}}class Gs{constructor(e,i,A,h){this.expression=e,this.type=A,this.maxValue=0,this.paintVertexAttributes=i.map(f=>({name:`a_${f}`,type:"Float32",components:A==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,i,A,h,f,g){const v=this.paintVertexArray.length,w=this.expression.evaluate(new P(0),i,{},f,h,g);this.paintVertexArray.resize(e),this._setPaintValue(v,e,w)}updatePaintArray(e,i,A,h,f){const g=this.expression.evaluate({zoom:0},A,h,void 0,f);this._setPaintValue(e,i,g)}_setPaintValue(e,i,A){if(this.type==="color"){const h=gm(A);for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,h[0],h[1])}else{for(let h=e;h<i;h++)this.paintVertexArray.emplace(h,A);this.maxValue=Math.max(this.maxValue,Math.abs(A))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class $o{constructor(e,i,A,h,f,g){this.expression=e,this.uniformNames=i.map(v=>`u_${v}_t`),this.type=A,this.useIntegerZoom=h,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=i.map(v=>({name:`a_${v}`,type:"Float32",components:A==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(e,i,A,h,f,g){const v=this.expression.evaluate(new P(this.zoom),i,{},f,h,g),w=this.expression.evaluate(new P(this.zoom+1),i,{},f,h,g),C=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(C,e,v,w)}updatePaintArray(e,i,A,h,f){const g=this.expression.evaluate({zoom:this.zoom},A,h,void 0,f),v=this.expression.evaluate({zoom:this.zoom+1},A,h,void 0,f);this._setPaintValue(e,i,g,v)}_setPaintValue(e,i,A,h){if(this.type==="color"){const f=gm(A),g=gm(h);for(let v=e;v<i;v++)this.paintVertexArray.emplace(v,f[0],f[1],g[0],g[1])}else{for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,A,h);this.maxValue=Math.max(this.maxValue,Math.abs(A),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const A=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,h=Ue(this.expression.interpolationFactor(A,this.zoom,this.zoom+1),0,1);e.set(h)}getBinding(e,i,A){return new Fd(e,i)}}class ba{constructor(e,i,A,h,f,g,v){this.expression=e,this.type=A,this.useIntegerZoom=h,this.zoom=f,this.layerId=v,this.paintVertexAttributes=(A==="array"?SC:UC).members;for(let w=0;w<i.length;++w);this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(e,i,A){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,i.patterns&&i.patterns[this.layerId],A)}updatePaintArray(e,i,A,h,f,g){this._setPaintValues(e,i,A.patterns&&A.patterns[this.layerId],g)}_setPaintValues(e,i,A,h){if(!h||!A)return;const{min:f,mid:g,max:v}=A,w=h[f],C=h[g],I=h[v];if(w&&C&&I)for(let T=e;T<i;T++)this._setPaintValue(this.zoomInPaintVertexArray,T,C,w),this._setPaintValue(this.zoomOutPaintVertexArray,T,C,I)}_setPaintValue(e,i,A,h){e.emplace(i,A.tl[0],A.tl[1],A.br[0],A.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],A.pixelRatio,h.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class js{constructor(e,i,A=()=>!0){this.binders={},this._buffers=[];const h=[];for(const f in e.paint._values){if(!A(f))continue;const g=e.paint.get(f);if(!(g instanceof Ae&&ps(g.property.specification)))continue;const v=OC(f,e.type),w=g.value,C=g.property.specification.type,I=g.property.useIntegerZoom,T=g.property.specification["property-type"],S=T==="cross-faded"||T==="cross-faded-data-driven",R=String(f)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(w.kind!=="constant"||R)if(w.kind==="source"||R||S){const H=B0(f,C,"source");this.binders[f]=S?new ba(w,v,C,I,i,H,e.id):new Gs(w,v,C,H),h.push(`/a_${f}`)}else{const H=B0(f,C,"composite");this.binders[f]=new $o(w,v,C,I,i,H),h.push(`/z_${f}`)}else this.binders[f]=S?new El(w.value,v):new iu(w.value,v,C),h.push(`/u_${f}`)}this.cacheKey=h.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Gs||i instanceof $o?i.maxValue:0}populatePaintArrays(e,i,A,h,f,g){for(const v in this.binders){const w=this.binders[v];(w instanceof Gs||w instanceof $o||w instanceof ba)&&w.populatePaintArray(e,i,A,h,f,g)}}setConstantPatternPositions(e,i){for(const A in this.binders){const h=this.binders[A];h instanceof El&&h.setConstantPatternPositions(e,i)}}updatePaintArrays(e,i,A,h,f,g){let v=!1;for(const w in e){const C=i.getPositions(w);for(const I of C){const T=A.feature(I.index);for(const S in this.binders){const R=this.binders[S];if((R instanceof Gs||R instanceof $o||R instanceof ba)&&R.expression.isStateDependent===!0){const H=h.paint.get(S);R.expression=H.value,R.updatePaintArray(I.start,I.end,T,e[w],f,g),v=!0}}}}return v}defines(){const e=[];for(const i in this.binders){const A=this.binders[i];(A instanceof iu||A instanceof El)&&e.push(...A.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const A=this.binders[i];if(A instanceof Gs||A instanceof $o||A instanceof ba)for(let h=0;h<A.paintVertexAttributes.length;h++)e.push(A.paintVertexAttributes[h].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const A=this.binders[i];if(A instanceof iu||A instanceof El||A instanceof $o)for(const h of A.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const A=[];for(const h in this.binders){const f=this.binders[h];if(f instanceof iu||f instanceof El||f instanceof $o){for(const g of f.uniformNames)if(i[g]){const v=f.getBinding(e,i[g],g);A.push({name:g,property:h,binding:v})}}}return A}setUniforms(e,i,A,h){for(const{name:f,property:g,binding:v}of i)this.binders[g].setUniform(v,h,A.get(g),f)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const A=this.binders[i];if(e&&A instanceof ba){const h=e.fromScale===2?A.zoomInPaintVertexBuffer:A.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(A instanceof Gs||A instanceof $o)&&A.paintVertexBuffer&&this._buffers.push(A.paintVertexBuffer)}}upload(e){for(const i in this.binders){const A=this.binders[i];(A instanceof Gs||A instanceof $o||A instanceof ba)&&A.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Gs||i instanceof $o||i instanceof ba)&&i.destroy()}}}class IA{constructor(e,i,A=()=>!0){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new js(h,i,A);this.needsUpload=!1,this._featureMap=new Cd,this._bufferOffset=0}populatePaintArrays(e,i,A,h,f,g,v){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(e,i,h,f,g,v);i.id!==void 0&&this._featureMap.add(i.id,A,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,A,h,f){for(const g of A)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(e,this._featureMap,i,g,h,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const PC={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function OC(n,e){return PC[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}const RC={"line-pattern":{source:Gt,composite:Gt},"fill-pattern":{source:Gt,composite:Gt},"fill-extrusion-pattern":{source:Gt,composite:Gt},"line-dasharray":{source:kt,composite:kt}},zC={color:{source:Lr,composite:Oi},number:{source:Mr,composite:Lr}};function B0(n,e,i){const A=RC[n];return A&&A[i]||zC[e][i]}Bt("ConstantBinder",iu),Bt("CrossFadedConstantBinder",El),Bt("SourceExpressionBinder",Gs),Bt("CrossFadedCompositeBinder",ba),Bt("CompositeExpressionBinder",$o),Bt("ProgramConfiguration",js,{omit:["_buffers"]}),Bt("ProgramConfigurationSet",IA);const Id="-transition";class qo extends ut{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new W(i.layout)),i.paint)){this._transitionablePaint=new ee(i.paint);for(const A in e.paint)this.setPaintProperty(A,e.paint[A],{validate:!1});for(const A in e.layout)this.setLayoutProperty(A,e.layout[A],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ue(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,A={}){i!=null&&this._validate(ad,`layers.${this.id}.layout.${e}`,e,i,A)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return Ut(e,Id)?this._transitionablePaint.getTransition(e.slice(0,-Id.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,A={}){if(i!=null&&this._validate(yl,`layers.${this.id}.paint.${e}`,e,i,A))return!1;if(Ut(e,Id))return this._transitionablePaint.setTransition(e.slice(0,-Id.length),i||void 0),!1;{const h=this._transitionablePaint._values[e],f=h.property.specification["property-type"]==="cross-faded-data-driven",g=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const w=this._transitionablePaint._values[e].value;return w.isDataDriven()||g||f||this._handleOverridablePaintPropertyUpdate(e,v,w)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,i,A){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Vt(e,(i,A)=>!(i===void 0||A==="layout"&&!Object.keys(i).length||A==="paint"&&!Object.keys(i).length))}_validate(e,i,A,h,f={}){return(!f||f.validate!==!1)&&Ad(this,e.call(Vs,{key:i,layerType:this.type,objectKey:A,value:h,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof Ae&&ps(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=fA(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const HC=Qe([{name:"a_pos",components:2,type:"Int16"}],4),{members:NC}=HC;class Vn{constructor(e=[]){this.segments=e}prepareSegment(e,i,A,h){let f=this.segments[this.segments.length-1];return e>Vn.MAX_VERTEX_ARRAY_LENGTH&&ke(`Max vertices per segment is ${Vn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>Vn.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==h)&&(f={vertexOffset:i.length,primitiveOffset:A.length,vertexLength:0,primitiveLength:0},h!==void 0&&(f.sortKey=h),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,A,h){return new Vn([{vertexOffset:e,primitiveOffset:i,vertexLength:A,primitiveLength:h,vaos:{},sortKey:0}])}}Vn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Bt("SegmentVector",Vn);var lr=8192;class TA{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof _r?new _r(e.lng,e.lat):_r.convert(e),this}setSouthWest(e){return this._sw=e instanceof _r?new _r(e.lng,e.lat):_r.convert(e),this}extend(e){const i=this._sw,A=this._ne;let h,f;if(e instanceof _r)h=e,f=e;else{if(!(e instanceof TA))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(TA.convert(e)):this.extend(_r.convert(e)):this;if(h=e._sw,f=e._ne,!h||!f)return this}return i||A?(i.lng=Math.min(h.lng,i.lng),i.lat=Math.min(h.lat,i.lat),A.lng=Math.max(f.lng,A.lng),A.lat=Math.max(f.lat,A.lat)):(this._sw=new _r(h.lng,h.lat),this._ne=new _r(f.lng,f.lat)),this}getCenter(){return new _r((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new _r(this.getWest(),this.getNorth())}getSouthEast(){return new _r(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:A}=_r.convert(e);let h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=A&&A<=this._ne.lat&&h}static convert(e){return!e||e instanceof TA?e:new TA(e)}}const b0=63710088e-1;class _r{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new _r(Ke(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,A=this.lat*i,h=e.lat*i,f=Math.sin(A)*Math.sin(h)+Math.cos(A)*Math.cos(h)*Math.cos((e.lng-this.lng)*i);return b0*Math.acos(Math.min(f,1))}toBounds(e=0){const i=360*e/40075017,A=i/Math.cos(Math.PI/180*this.lat);return new TA(new _r(this.lng-A,this.lat-i),new _r(this.lng+A,this.lat+i))}static convert(e){if(e instanceof _r)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new _r(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new _r(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const C0=2*Math.PI*b0;function E0(n){return C0*Math.cos(n*Math.PI/180)}function ym(n){return(180+n)/360}function _m(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function vm(n,e){return n/E0(e)}function UA(n){return 360*n-180}function ws(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function xm(n,e){return n*E0(ws(e))}const Ca=85.051129;class Td{constructor(e,i,A=0){this.x=+e,this.y=+i,this.z=+A}static fromLngLat(e,i=0){const A=_r.convert(e);return new Td(ym(A.lng),_m(A.lat),vm(i,A.lat))}toLngLat(){return new _r(UA(this.x),ws(this.y))}toAltitude(){return xm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/C0*(e=ws(this.y),1/Math.cos(e*Math.PI/180));var e}}function wm(n,e,i,A,h,f,g,v,w){const C=(e+A)/2,I=(i+h)/2,T=new L(C,I);v(T),function(S,R,H,Z,te,ce){const fe=H-te,ve=Z-ce;return Math.abs((Z-R)*fe-(H-S)*ve)/Math.hypot(fe,ve)}(T.x,T.y,f.x,f.y,g.x,g.y)>=w?(wm(n,e,i,C,I,f,T,v,w),wm(n,C,I,A,h,T,g,v,w)):n.push(g)}function VC(n,e,i){const A=[];let h,f,g;for(const v of n){const{x:w,y:C}=v;e(v),g?wm(A,h,f,w,C,g,v,e,i):A.push(v),h=w,f=C,g=v}return A}const Bm=Math.pow(2,14)-1,F0=-Bm-1;function KC(n,e){const i=Math.round(n.x*e),A=Math.round(n.y*e);return n.x=Ue(i,F0,Bm),n.y=Ue(A,F0,Bm),(i<n.x||i>n.x+1||A<n.y||A>n.y+1)&&ke("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function Zs(n,e,i){const A=n.loadGeometry(),h=n.extent,f=lr/h;if(e&&i&&i.projection.name!=="mercator"){const g=1<<e.z,{scale:v,x:w,y:C,projection:I}=i,T=S=>{const R=UA((e.x+S.x/h)/g),H=ws((e.y+S.y/h)/g),Z=I.project(R,H);S.x=(Z.x*v-w)*h,S.y=(Z.y*v-C)*h};for(let S=0;S<A.length;S++)if(n.type!==1)A[S]=VC(A[S],T,1);else{const R=[];for(const H of A[S])H.x<0||H.x>=h||H.y<0||H.y>=h||(T(H),R.push(H));A[S]=R}}for(const g of A)for(const v of g)KC(v,f);return A}function SA(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?Zs(n):[]}}function Ud(n,e,i,A,h){n.emplaceBack(2*e+(A+1)/2,2*i+(h+1)/2)}class bm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new bt,this.indexArray=new fn,this.segments=new Vn,this.programConfigurations=new IA(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,A,h){const f=this.layers[0],g=[];let v=null;f.type==="circle"&&(v=f.layout.get("circle-sort-key"));for(const{feature:w,id:C,index:I,sourceLayerIndex:T}of e){const S=this.layers[0]._featureFilter.needGeometry,R=SA(w,S);if(!this.layers[0]._featureFilter.filter(new P(this.zoom),R,A))continue;const H=v?v.evaluate(R,{},A):void 0,Z={id:C,properties:w.properties,type:w.type,sourceLayerIndex:T,index:I,geometry:S?R.geometry:Zs(w,A,h),patterns:{},sortKey:H};g.push(Z)}v&&g.sort((w,C)=>w.sortKey-C.sortKey);for(const w of g){const{geometry:C,index:I,sourceLayerIndex:T}=w,S=e[I].feature;this.addFeature(w,C,I,i.availableImages,A),i.featureIndex.insert(S,C,I,T,this.index)}}update(e,i,A,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,A,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,NC),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,A,h,f){for(const g of i)for(const v of g){const w=v.x,C=v.y;if(w<0||w>=lr||C<0||C>=lr)continue;const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),T=I.vertexLength;Ud(this.layoutVertexArray,w,C,-1,-1),Ud(this.layoutVertexArray,w,C,1,-1),Ud(this.layoutVertexArray,w,C,1,1),Ud(this.layoutVertexArray,w,C,-1,1),this.indexArray.emplaceBack(T,T+1,T+2),this.indexArray.emplaceBack(T,T+3,T+2),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,A,{},h,f)}}function I0(n,e){for(let i=0;i<n.length;i++)if(Fl(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(Fl(n,e[i]))return!0;return!!Cm(n,e)}function GC(n,e,i){return!!Fl(n,e)||!!Em(e,n,i)}function T0(n,e){if(n.length===1)return S0(e,n[0]);for(let i=0;i<e.length;i++){const A=e[i];for(let h=0;h<A.length;h++)if(Fl(n,A[h]))return!0}for(let i=0;i<n.length;i++)if(S0(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(Cm(n,e[i]))return!0;return!1}function jC(n,e,i){if(n.length>1){if(Cm(n,e))return!0;for(let A=0;A<e.length;A++)if(Em(e[A],n,i))return!0}for(let A=0;A<n.length;A++)if(Em(n[A],e,i))return!0;return!1}function Cm(n,e){if(n.length===0||e.length===0)return!1;for(let i=0;i<n.length-1;i++){const A=n[i],h=n[i+1];for(let f=0;f<e.length-1;f++)if(ZC(A,h,e[f],e[f+1]))return!0}return!1}function ZC(n,e,i,A){return xt(n,i,A)!==xt(e,i,A)&&xt(n,e,i)!==xt(n,e,A)}function Em(n,e,i){const A=i*i;if(e.length===1)return n.distSqr(e[0])<A;for(let h=1;h<e.length;h++)if(U0(n,e[h-1],e[h])<A)return!0;return!1}function U0(n,e,i){const A=e.distSqr(i);if(A===0)return n.distSqr(e);const h=((n.x-e.x)*(i.x-e.x)+(n.y-e.y)*(i.y-e.y))/A;return n.distSqr(h<0?e:h>1?i:i.sub(e)._mult(h)._add(e))}function S0(n,e){let i,A,h,f=!1;for(let g=0;g<n.length;g++){i=n[g];for(let v=0,w=i.length-1;v<i.length;w=v++)A=i[v],h=i[w],A.y>e.y!=h.y>e.y&&e.x<(h.x-A.x)*(e.y-A.y)/(h.y-A.y)+A.x&&(f=!f)}return f}function Fl(n,e){let i=!1;for(let A=0,h=n.length-1;A<n.length;h=A++){const f=n[A],g=n[h];f.y>e.y!=g.y>e.y&&e.x<(g.x-f.x)*(e.y-f.y)/(g.y-f.y)+f.x&&(i=!i)}return i}function Q0(n,e,i,A,h){for(const g of n)if(e<=g.x&&i<=g.y&&A>=g.x&&h>=g.y)return!0;const f=[new L(e,i),new L(e,h),new L(A,h),new L(A,i)];if(n.length>2){for(const g of f)if(Fl(n,g))return!0}for(let g=0;g<n.length-1;g++)if(XC(n[g],n[g+1],f))return!0;return!1}function XC(n,e,i){const A=i[0],h=i[2];if(n.x<A.x&&e.x<A.x||n.x>h.x&&e.x>h.x||n.y<A.y&&e.y<A.y||n.y>h.y&&e.y>h.y)return!1;const f=xt(n,e,i[0]);return f!==xt(n,e,i[1])||f!==xt(n,e,i[2])||f!==xt(n,e,i[3])}function Il(n,e,i){const A=e.paint.get(n).value;return A.kind==="constant"?A.value:i.programConfigurations.get(e.id).getMaxValue(n)}function Sd(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function M0(n,e,i,A,h){if(!e[0]&&!e[1])return n;const f=L.convert(e)._mult(h);i==="viewport"&&f._rotate(-A);const g=[];for(let v=0;v<n.length;v++)g.push(n[v].sub(f));return g}function L0(n,e,i,A){const h=L.convert(n)._mult(A);return e==="viewport"&&h._rotate(-i),h}Bt("CircleBucket",bm,{omit:["layers"]});const WC=new Ve({"circle-sort-key":new he(xe.layout_circle["circle-sort-key"])});var $C={paint:new Ve({"circle-radius":new he(xe.paint_circle["circle-radius"]),"circle-color":new he(xe.paint_circle["circle-color"]),"circle-blur":new he(xe.paint_circle["circle-blur"]),"circle-opacity":new he(xe.paint_circle["circle-opacity"]),"circle-translate":new J(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new J(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new J(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new J(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new he(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new he(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new he(xe.paint_circle["circle-stroke-opacity"])}),layout:WC},xi=typeof Float32Array<"u"?Float32Array:Array;function D0(){var n=new xi(9);return xi!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function Fm(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function k0(n,e,i){var A=e[0],h=e[1],f=e[2],g=e[3],v=e[4],w=e[5],C=e[6],I=e[7],T=e[8],S=e[9],R=e[10],H=e[11],Z=e[12],te=e[13],ce=e[14],fe=e[15],ve=i[0],be=i[1],Be=i[2],Ie=i[3];return n[0]=ve*A+be*v+Be*T+Ie*Z,n[1]=ve*h+be*w+Be*S+Ie*te,n[2]=ve*f+be*C+Be*R+Ie*ce,n[3]=ve*g+be*I+Be*H+Ie*fe,n[4]=(ve=i[4])*A+(be=i[5])*v+(Be=i[6])*T+(Ie=i[7])*Z,n[5]=ve*h+be*w+Be*S+Ie*te,n[6]=ve*f+be*C+Be*R+Ie*ce,n[7]=ve*g+be*I+Be*H+Ie*fe,n[8]=(ve=i[8])*A+(be=i[9])*v+(Be=i[10])*T+(Ie=i[11])*Z,n[9]=ve*h+be*w+Be*S+Ie*te,n[10]=ve*f+be*C+Be*R+Ie*ce,n[11]=ve*g+be*I+Be*H+Ie*fe,n[12]=(ve=i[12])*A+(be=i[13])*v+(Be=i[14])*T+(Ie=i[15])*Z,n[13]=ve*h+be*w+Be*S+Ie*te,n[14]=ve*f+be*C+Be*R+Ie*ce,n[15]=ve*g+be*I+Be*H+Ie*fe,n}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var qC=k0;function Qd(){var n=new xi(3);return xi!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function P0(n){return Math.hypot(n[0],n[1],n[2])}function Tl(n,e,i){var A=new xi(3);return A[0]=n,A[1]=e,A[2]=i,A}function O0(n,e,i){return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],n}function R0(n,e,i){return n[0]=e[0]*i[0],n[1]=e[1]*i[1],n[2]=e[2]*i[2],n}function z0(n,e,i,A){return n[0]=e[0]+i[0]*A,n[1]=e[1]+i[1]*A,n[2]=e[2]+i[2]*A,n}function H0(n,e){var i=e[0],A=e[1],h=e[2],f=i*i+A*A+h*h;return f>0&&(f=1/Math.sqrt(f)),n[0]=e[0]*f,n[1]=e[1]*f,n[2]=e[2]*f,n}function N0(n,e,i){var A=i[0],h=i[1],f=i[2],g=e[0],v=e[1],w=e[2],C=h*w-f*v,I=f*g-A*w,T=A*v-h*g,S=h*T-f*I,R=f*C-A*T,H=A*I-h*C,Z=2*i[3];return I*=Z,T*=Z,R*=2,H*=2,n[0]=g+(C*=Z)+(S*=2),n[1]=v+I+R,n[2]=w+T+H,n}var ou,JC=O0,YC=R0,eE=P0;function su(n,e,i){var A=e[0],h=e[1],f=e[2],g=e[3];return n[0]=i[0]*A+i[4]*h+i[8]*f+i[12]*g,n[1]=i[1]*A+i[5]*h+i[9]*f+i[13]*g,n[2]=i[2]*A+i[6]*h+i[10]*f+i[14]*g,n[3]=i[3]*A+i[7]*h+i[11]*f+i[15]*g,n}function Im(){var n=new xi(4);return xi!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function V0(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function K0(n,e,i){i*=.5;var A=e[0],h=e[1],f=e[2],g=e[3],v=Math.sin(i),w=Math.cos(i);return n[0]=A*w+g*v,n[1]=h*w+f*v,n[2]=f*w-h*v,n[3]=g*w-A*v,n}function G0(n,e){return n[0]===e[0]&&n[1]===e[1]}function j0(n,e,i,A,h,f,g,v,w){if(f&&n.queryGeometry.isAboveHorizon)return!1;f&&(w*=n.pixelToTileUnitsFactor);for(const C of e)for(const I of C){const T=I.add(v),S=h&&i.elevation?i.elevation.exaggeration()*h.getElevationAt(T.x,T.y,!0):0,R=f?T:tE(T,S,A),H=f?n.tilespaceRays.map(te=>nE(te,S)):n.queryGeometry.screenGeometry,Z=su([],[I.x,I.y,S,1],A);if(!g&&f?w*=Z[3]/i.cameraToCenterDistance:g&&!f&&(w*=i.cameraToCenterDistance/Z[3]),GC(H,R,w))return!0}return!1}function tE(n,e,i){const A=su([],[n.x,n.y,e,1],i);return new L(A[0]/A[3],A[1]/A[3])}Qd(),ou=new xi(4),xi!=Float32Array&&(ou[0]=0,ou[1]=0,ou[2]=0,ou[3]=0),Qd(),Tl(1,0,0),Tl(0,1,0),Im(),Im(),D0(),function(){var n;n=new xi(2),xi!=Float32Array&&(n[0]=0,n[1]=0)}();const Z0=Tl(0,0,0),rE=Tl(0,0,1);function nE(n,e){const i=Qd();return Z0[2]=e,n.intersectsPlane(Z0,rE,i),new L(i[0],i[1])}class X0 extends bm{}function Tm(n,{width:e,height:i},A,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*i*A)throw new RangeError("mismatched image size")}else h=new Uint8Array(e*i*A);return n.width=e,n.height=i,n.data=h,n}function W0(n,{width:e,height:i},A){if(e===n.width&&i===n.height)return;const h=Tm({},{width:e,height:i},A);Um(n,h,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,e),height:Math.min(n.height,i)},A),n.width=e,n.height=i,n.data=h.data}function Um(n,e,i,A,h,f){if(h.width===0||h.height===0)return e;if(h.width>n.width||h.height>n.height||i.x>n.width-h.width||i.y>n.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||A.x>e.width-h.width||A.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const g=n.data,v=e.data;for(let w=0;w<h.height;w++){const C=((i.y+w)*n.width+i.x)*f,I=((A.y+w)*e.width+A.x)*f;for(let T=0;T<h.width*f;T++)v[I+T]=g[C+T]}return e}Bt("HeatmapBucket",X0,{omit:["layers"]});class Ea{constructor(e,i){Tm(this,e,1,i)}resize(e){W0(this,e,1)}clone(){return new Ea({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,A,h,f){Um(e,i,A,h,f,1)}}class co{constructor(e,i){Tm(this,e,4,i)}resize(e){W0(this,e,4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new co({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,A,h,f){Um(e,i,A,h,f,4)}}Bt("AlphaImage",Ea),Bt("RGBAImage",co);var iE={paint:new Ve({"heatmap-radius":new he(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new he(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new J(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Le(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new J(xe.paint_heatmap["heatmap-opacity"])})};function Sm(n){const e={},i=n.resolution||256,A=n.clips?n.clips.length:1,h=n.image||new co({width:i,height:A}),f=(g,v,w)=>{e[n.evaluationKey]=w;const C=n.expression.evaluate(e);h.data[g+v+0]=Math.floor(255*C.r/C.a),h.data[g+v+1]=Math.floor(255*C.g/C.a),h.data[g+v+2]=Math.floor(255*C.b/C.a),h.data[g+v+3]=Math.floor(255*C.a)};if(n.clips)for(let g=0,v=0;g<A;++g,v+=4*i)for(let w=0,C=0;w<i;w++,C+=4){const I=w/(i-1),{start:T,end:S}=n.clips[g];f(v,C,T*(1-I)+S*I)}else for(let g=0,v=0;g<i;g++,v+=4)f(0,v,g/(i-1));return h}var oE={paint:new Ve({"hillshade-illumination-direction":new J(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new J(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new J(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new J(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new J(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new J(xe.paint_hillshade["hillshade-accent-color"])})};const sE=Qe([{name:"a_pos",components:2,type:"Int16"}],4),{members:aE}=sE;var Md=Ld,AE=Ld;function Ld(n,e,i){i=i||2;var A,h,f,g,v,w,C,I=e&&e.length,T=I?e[0]*i:n.length,S=$0(n,0,T,i,!0),R=[];if(!S||S.next===S.prev)return R;if(I&&(S=function(Z,te,ce,fe){var ve,be,Be,Ie=[];for(ve=0,be=te.length;ve<be;ve++)(Be=$0(Z,te[ve]*fe,ve<be-1?te[ve+1]*fe:Z.length,fe,!1))===Be.next&&(Be.steiner=!0),Ie.push(mE(Be));for(Ie.sort(dE),ve=0;ve<Ie.length;ve++)ce=Fa(ce=fE(Ie[ve],ce),ce.next);return ce}(n,e,S,i)),n.length>80*i){A=f=n[0],h=g=n[1];for(var H=i;H<T;H+=i)(v=n[H])<A&&(A=v),(w=n[H+1])<h&&(h=w),v>f&&(f=v),w>g&&(g=w);C=(C=Math.max(f-A,g-h))!==0?1/C:0}return au(S,R,i,A,h,C),R}function $0(n,e,i,A,h){var f,g;if(h===Lm(n,e,i,A)>0)for(f=e;f<i;f+=A)g=Y0(f,n[f],n[f+1],g);else for(f=i-A;f>=e;f-=A)g=Y0(f,n[f],n[f+1],g);return g&&Dd(g,g.next)&&(lu(g),g=g.next),g}function Fa(n,e){if(!n)return n;e||(e=n);var i,A=n;do if(i=!1,A.steiner||!Dd(A,A.next)&&sn(A.prev,A,A.next)!==0)A=A.next;else{if(lu(A),(A=e=A.prev)===A.next)break;i=!0}while(i||A!==e);return e}function au(n,e,i,A,h,f,g){if(n){!g&&f&&function(I,T,S,R){var H=I;do H.z===null&&(H.z=Qm(H.x,H.y,T,S,R)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next;while(H!==I);H.prevZ.nextZ=null,H.prevZ=null,function(Z){var te,ce,fe,ve,be,Be,Ie,je,Oe=1;do{for(ce=Z,Z=null,be=null,Be=0;ce;){for(Be++,fe=ce,Ie=0,te=0;te<Oe&&(Ie++,fe=fe.nextZ);te++);for(je=Oe;Ie>0||je>0&&fe;)Ie!==0&&(je===0||!fe||ce.z<=fe.z)?(ve=ce,ce=ce.nextZ,Ie--):(ve=fe,fe=fe.nextZ,je--),be?be.nextZ=ve:Z=ve,ve.prevZ=be,be=ve;ce=fe}be.nextZ=null,Oe*=2}while(Be>1)}(H)}(n,A,h,f);for(var v,w,C=n;n.prev!==n.next;)if(v=n.prev,w=n.next,f?cE(n,A,h,f):lE(n))e.push(v.i/i),e.push(n.i/i),e.push(w.i/i),lu(n),n=w.next,C=w.next;else if((n=w)===C){g?g===1?au(n=uE(Fa(n),e,i),e,i,A,h,f,2):g===2&&hE(n,e,i,A,h,f):au(Fa(n),e,i,A,h,f,1);break}}}function lE(n){var e=n.prev,i=n,A=n.next;if(sn(e,i,A)>=0)return!1;for(var h=n.next.next;h!==n.prev;){if(Ul(e.x,e.y,i.x,i.y,A.x,A.y,h.x,h.y)&&sn(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function cE(n,e,i,A){var h=n.prev,f=n,g=n.next;if(sn(h,f,g)>=0)return!1;for(var v=h.x>f.x?h.x>g.x?h.x:g.x:f.x>g.x?f.x:g.x,w=h.y>f.y?h.y>g.y?h.y:g.y:f.y>g.y?f.y:g.y,C=Qm(h.x<f.x?h.x<g.x?h.x:g.x:f.x<g.x?f.x:g.x,h.y<f.y?h.y<g.y?h.y:g.y:f.y<g.y?f.y:g.y,e,i,A),I=Qm(v,w,e,i,A),T=n.prevZ,S=n.nextZ;T&&T.z>=C&&S&&S.z<=I;){if(T!==n.prev&&T!==n.next&&Ul(h.x,h.y,f.x,f.y,g.x,g.y,T.x,T.y)&&sn(T.prev,T,T.next)>=0||(T=T.prevZ,S!==n.prev&&S!==n.next&&Ul(h.x,h.y,f.x,f.y,g.x,g.y,S.x,S.y)&&sn(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;T&&T.z>=C;){if(T!==n.prev&&T!==n.next&&Ul(h.x,h.y,f.x,f.y,g.x,g.y,T.x,T.y)&&sn(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;S&&S.z<=I;){if(S!==n.prev&&S!==n.next&&Ul(h.x,h.y,f.x,f.y,g.x,g.y,S.x,S.y)&&sn(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function uE(n,e,i){var A=n;do{var h=A.prev,f=A.next.next;!Dd(h,f)&&q0(h,A,A.next,f)&&Au(h,f)&&Au(f,h)&&(e.push(h.i/i),e.push(A.i/i),e.push(f.i/i),lu(A),lu(A.next),A=n=f),A=A.next}while(A!==n);return Fa(A)}function hE(n,e,i,A,h,f){var g=n;do{for(var v=g.next.next;v!==g.prev;){if(g.i!==v.i&&gE(g,v)){var w=J0(g,v);return g=Fa(g,g.next),w=Fa(w,w.next),au(g,e,i,A,h,f),void au(w,e,i,A,h,f)}v=v.next}g=g.next}while(g!==n)}function dE(n,e){return n.x-e.x}function fE(n,e){var i=function(f,g){var v,w=g,C=f.x,I=f.y,T=-1/0;do{if(I<=w.y&&I>=w.next.y&&w.next.y!==w.y){var S=w.x+(I-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(S<=C&&S>T){if(T=S,S===C){if(I===w.y)return w;if(I===w.next.y)return w.next}v=w.x<w.next.x?w:w.next}}w=w.next}while(w!==g);if(!v)return null;if(C===T)return v;var R,H=v,Z=v.x,te=v.y,ce=1/0;w=v;do C>=w.x&&w.x>=Z&&C!==w.x&&Ul(I<te?C:T,I,Z,te,I<te?T:C,I,w.x,w.y)&&(R=Math.abs(I-w.y)/(C-w.x),Au(w,f)&&(R<ce||R===ce&&(w.x>v.x||w.x===v.x&&pE(v,w)))&&(v=w,ce=R)),w=w.next;while(w!==H);return v}(n,e);if(!i)return e;var A=J0(i,n),h=Fa(i,i.next);return Fa(A,A.next),e===i?h:e}function pE(n,e){return sn(n.prev,n,e.prev)<0&&sn(e.next,n,n.next)<0}function Qm(n,e,i,A,h){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-i)*h)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-A)*h)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function mE(n){var e=n,i=n;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==n);return i}function Ul(n,e,i,A,h,f,g,v){return(h-g)*(e-v)-(n-g)*(f-v)>=0&&(n-g)*(A-v)-(i-g)*(e-v)>=0&&(i-g)*(f-v)-(h-g)*(A-v)>=0}function gE(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(i,A){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==A.i&&h.next.i!==A.i&&q0(h,h.next,i,A))return!0;h=h.next}while(h!==i);return!1}(n,e)&&(Au(n,e)&&Au(e,n)&&function(i,A){var h=i,f=!1,g=(i.x+A.x)/2,v=(i.y+A.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&g<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(f=!f),h=h.next;while(h!==i);return f}(n,e)&&(sn(n.prev,n,e.prev)||sn(n,e.prev,e))||Dd(n,e)&&sn(n.prev,n,n.next)>0&&sn(e.prev,e,e.next)>0)}function sn(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function Dd(n,e){return n.x===e.x&&n.y===e.y}function q0(n,e,i,A){var h=Pd(sn(n,e,i)),f=Pd(sn(n,e,A)),g=Pd(sn(i,A,n)),v=Pd(sn(i,A,e));return h!==f&&g!==v||!(h!==0||!kd(n,i,e))||!(f!==0||!kd(n,A,e))||!(g!==0||!kd(i,n,A))||!(v!==0||!kd(i,e,A))}function kd(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function Pd(n){return n>0?1:n<0?-1:0}function Au(n,e){return sn(n.prev,n,n.next)<0?sn(n,e,n.next)>=0&&sn(n,n.prev,e)>=0:sn(n,e,n.prev)<0||sn(n,n.next,e)<0}function J0(n,e){var i=new Mm(n.i,n.x,n.y),A=new Mm(e.i,e.x,e.y),h=n.next,f=e.prev;return n.next=e,e.prev=n,i.next=h,h.prev=i,A.next=i,i.prev=A,f.next=A,A.prev=f,A}function Y0(n,e,i,A){var h=new Mm(n,e,i);return A?(h.next=A.next,h.prev=A,A.next.prev=h,A.next=h):(h.prev=h,h.next=h),h}function lu(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Mm(n,e,i){this.i=n,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Lm(n,e,i,A){for(var h=0,f=e,g=i-A;f<i;f+=A)h+=(n[g]-n[f])*(n[f+1]+n[g+1]),g=f;return h}function yE(n,e,i,A,h){ev(n,e,i||0,A||n.length-1,h||_E)}function ev(n,e,i,A,h){for(;A>i;){if(A-i>600){var f=A-i+1,g=e-i+1,v=Math.log(f),w=.5*Math.exp(2*v/3),C=.5*Math.sqrt(v*w*(f-w)/f)*(g-f/2<0?-1:1);ev(n,e,Math.max(i,Math.floor(e-g*w/f+C)),Math.min(A,Math.floor(e+(f-g)*w/f+C)),h)}var I=n[e],T=i,S=A;for(cu(n,i,e),h(n[A],I)>0&&cu(n,i,A);T<S;){for(cu(n,T,S),T++,S--;h(n[T],I)<0;)T++;for(;h(n[S],I)>0;)S--}h(n[i],I)===0?cu(n,i,S):cu(n,++S,A),S<=e&&(i=S+1),e<=S&&(A=S-1)}}function cu(n,e,i){var A=n[e];n[e]=n[i],n[i]=A}function _E(n,e){return n<e?-1:n>e?1:0}function Dm(n,e){const i=n.length;if(i<=1)return[n];const A=[];let h,f;for(let g=0;g<i;g++){const v=Se(n[g]);v!==0&&(n[g].area=Math.abs(v),f===void 0&&(f=v<0),f===v<0?(h&&A.push(h),h=[n[g]]):h.push(n[g]))}if(h&&A.push(h),e>1)for(let g=0;g<A.length;g++)A[g].length<=e||(yE(A[g],e,1,A[g].length-1,vE),A[g]=A[g].slice(0,e));return A}function vE(n,e){return e.area-n.area}function km(n,e,i){const A=i.patternDependencies;let h=!1;for(const f of e){const g=f.paint.get(`${n}-pattern`);g.isConstant()||(h=!0);const v=g.constantOr(null);v&&(h=!0,A[v.to]=!0,A[v.from]=!0)}return h}function Pm(n,e,i,A,h){const f=h.patternDependencies;for(const g of e){const v=g.paint.get(`${n}-pattern`).value;if(v.kind!=="constant"){let w=v.evaluate({zoom:A-1},i,{},h.availableImages),C=v.evaluate({zoom:A},i,{},h.availableImages),I=v.evaluate({zoom:A+1},i,{},h.availableImages);w=w&&w.name?w.name:w,C=C&&C.name?C.name:C,I=I&&I.name?I.name:I,f[w]=!0,f[C]=!0,f[I]=!0,i.patterns[g.id]={min:w,mid:C,max:I}}}return i}Ld.deviation=function(n,e,i,A){var h=e&&e.length,f=Math.abs(Lm(n,0,h?e[0]*i:n.length,i));if(h)for(var g=0,v=e.length;g<v;g++)f-=Math.abs(Lm(n,e[g]*i,g<v-1?e[g+1]*i:n.length,i));var w=0;for(g=0;g<A.length;g+=3){var C=A[g]*i,I=A[g+1]*i,T=A[g+2]*i;w+=Math.abs((n[C]-n[T])*(n[I+1]-n[C+1])-(n[C]-n[I])*(n[T+1]-n[C+1]))}return f===0&&w===0?0:Math.abs((w-f)/f)},Ld.flatten=function(n){for(var e=n[0][0].length,i={vertices:[],holes:[],dimensions:e},A=0,h=0;h<n.length;h++){for(var f=0;f<n[h].length;f++)for(var g=0;g<e;g++)i.vertices.push(n[h][f][g]);h>0&&i.holes.push(A+=n[h-1].length)}return i},Md.default=AE;class Od{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new bt,this.indexArray=new fn,this.indexArray2=new Or,this.programConfigurations=new IA(e.layers,e.zoom),this.segments=new Vn,this.segments2=new Vn,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,A,h){this.hasPattern=km("fill",this.layers,i);const f=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:v,id:w,index:C,sourceLayerIndex:I}of e){const T=this.layers[0]._featureFilter.needGeometry,S=SA(v,T);if(!this.layers[0]._featureFilter.filter(new P(this.zoom),S,A))continue;const R=f?f.evaluate(S,{},A,i.availableImages):void 0,H={id:w,properties:v.properties,type:v.type,sourceLayerIndex:I,index:C,geometry:T?S.geometry:Zs(v,A,h),patterns:{},sortKey:R};g.push(H)}f&&g.sort((v,w)=>v.sortKey-w.sortKey);for(const v of g){const{geometry:w,index:C,sourceLayerIndex:I}=v;if(this.hasPattern){const T=Pm("fill",this.layers,v,this.zoom,i);this.patternFeatures.push(T)}else this.addFeature(v,w,C,A,{},i.availableImages);i.featureIndex.insert(e[C].feature,w,C,I,this.index)}}update(e,i,A,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,A,h)}addFeatures(e,i,A,h){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,i,A,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,aE),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,A,h,f,g=[]){for(const v of Dm(i,500)){let w=0;for(const H of v)w+=H.length;const C=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),I=C.vertexLength,T=[],S=[];for(const H of v){if(H.length===0)continue;H!==v[0]&&S.push(T.length/2);const Z=this.segments2.prepareSegment(H.length,this.layoutVertexArray,this.indexArray2),te=Z.vertexLength;this.layoutVertexArray.emplaceBack(H[0].x,H[0].y),this.indexArray2.emplaceBack(te+H.length-1,te),T.push(H[0].x),T.push(H[0].y);for(let ce=1;ce<H.length;ce++)this.layoutVertexArray.emplaceBack(H[ce].x,H[ce].y),this.indexArray2.emplaceBack(te+ce-1,te+ce),T.push(H[ce].x),T.push(H[ce].y);Z.vertexLength+=H.length,Z.primitiveLength+=H.length}const R=Md(T,S);for(let H=0;H<R.length;H+=3)this.indexArray.emplaceBack(I+R[H],I+R[H+1],I+R[H+2]);C.vertexLength+=w,C.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,A,f,g,h)}}Bt("FillBucket",Od,{omit:["layers","patternFeatures"]});const xE=new Ve({"fill-sort-key":new he(xe.layout_fill["fill-sort-key"])});var wE={paint:new Ve({"fill-antialias":new J(xe.paint_fill["fill-antialias"]),"fill-opacity":new he(xe.paint_fill["fill-opacity"]),"fill-color":new he(xe.paint_fill["fill-color"]),"fill-outline-color":new he(xe.paint_fill["fill-outline-color"]),"fill-translate":new J(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new J(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new ye(xe.paint_fill["fill-pattern"])}),layout:xE};const BE=Qe([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),bE=Qe([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:CE}=BE;var tv=Sl;function Sl(n,e,i,A,h){this.properties={},this.extent=i,this.type=0,this._pbf=n,this._geometry=-1,this._keys=A,this._values=h,n.readFields(EE,this,e)}function EE(n,e,i){n==1?e.id=i.readVarint():n==2?function(A,h){for(var f=A.readVarint()+A.pos;A.pos<f;){var g=h._keys[A.readVarint()],v=h._values[A.readVarint()];h.properties[g]=v}}(i,e):n==3?e.type=i.readVarint():n==4&&(e._geometry=i.pos)}function FE(n){for(var e,i,A=0,h=0,f=n.length,g=f-1;h<f;g=h++)A+=((i=n[g]).x-(e=n[h]).x)*(e.y+i.y);return A}Sl.types=["Unknown","Point","LineString","Polygon"],Sl.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,i=n.readVarint()+n.pos,A=1,h=0,f=0,g=0,v=[];n.pos<i;){if(h<=0){var w=n.readVarint();A=7&w,h=w>>3}if(h--,A===1||A===2)f+=n.readSVarint(),g+=n.readSVarint(),A===1&&(e&&v.push(e),e=[]),e.push(new L(f,g));else{if(A!==7)throw new Error("unknown command "+A);e&&e.push(e[0].clone())}}return e&&v.push(e),v},Sl.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,i=1,A=0,h=0,f=0,g=1/0,v=-1/0,w=1/0,C=-1/0;n.pos<e;){if(A<=0){var I=n.readVarint();i=7&I,A=I>>3}if(A--,i===1||i===2)(h+=n.readSVarint())<g&&(g=h),h>v&&(v=h),(f+=n.readSVarint())<w&&(w=f),f>C&&(C=f);else if(i!==7)throw new Error("unknown command "+i)}return[g,w,v,C]},Sl.prototype.toGeoJSON=function(n,e,i){var A,h,f=this.extent*Math.pow(2,i),g=this.extent*n,v=this.extent*e,w=this.loadGeometry(),C=Sl.types[this.type];function I(R){for(var H=0;H<R.length;H++){var Z=R[H];R[H]=[360*(Z.x+g)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(Z.y+v)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var T=[];for(A=0;A<w.length;A++)T[A]=w[A][0];I(w=T);break;case 2:for(A=0;A<w.length;A++)I(w[A]);break;case 3:for(w=function(R){var H=R.length;if(H<=1)return[R];for(var Z,te,ce=[],fe=0;fe<H;fe++){var ve=FE(R[fe]);ve!==0&&(te===void 0&&(te=ve<0),te===ve<0?(Z&&ce.push(Z),Z=[R[fe]]):Z.push(R[fe]))}return Z&&ce.push(Z),ce}(w),A=0;A<w.length;A++)for(h=0;h<w[A].length;h++)I(w[A][h])}w.length===1?w=w[0]:C="Multi"+C;var S={type:"Feature",geometry:{type:C,coordinates:w},properties:this.properties};return"id"in this&&(S.id=this.id),S};var rv=nv;function nv(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(IE,this,e),this.length=this._features.length}function IE(n,e,i){n===15?e.version=i.readVarint():n===1?e.name=i.readString():n===5?e.extent=i.readVarint():n===2?e._features.push(i.pos):n===3?e._keys.push(i.readString()):n===4&&e._values.push(function(A){for(var h=null,f=A.readVarint()+A.pos;A.pos<f;){var g=A.readVarint()>>3;h=g===1?A.readString():g===2?A.readFloat():g===3?A.readDouble():g===4?A.readVarint64():g===5?A.readVarint():g===6?A.readSVarint():g===7?A.readBoolean():null}return h}(i))}function TE(n,e,i){if(n===3){var A=new rv(i,i.readVarint()+i.pos);A.length&&(e[A.name]=A)}}nv.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new tv(this._pbf,e,this.extent,this._keys,this._values)};var QA={VectorTile:function(n,e){this.layers=n.readFields(TE,{},e)},VectorTileFeature:tv,VectorTileLayer:rv};const UE=QA.VectorTileFeature.types,SE=Math.pow(2,13);function uu(n,e,i,A,h,f,g,v){n.emplaceBack((e<<1)+g,(i<<1)+f,(Math.floor(A*SE)<<1)+h,Math.round(v))}class iv{constructor(){this.acc=new L(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new L(e.x,e.y),this.max=new L(e.x,e.y))}append(e,i){this.currentPolyCount.edges++,this.acc._add(e);let A=!!this.borders;const h=this.min,f=this.max;e.x<h.x?(h.x=e.x,A=!0):e.x>f.x&&(f.x=e.x,A=!0),e.y<h.y?(h.y=e.y,A=!0):e.y>f.y&&(f.y=e.y,A=!0),((e.x===0||e.x===lr)&&e.x===i.x)!=((e.y===0||e.y===lr)&&e.y===i.y)&&this.processBorderOverlap(e,i),A&&this.checkBorderIntersection(e,i)}checkBorderIntersection(e,i){i.x<0!=e.x<0&&this.addBorderIntersection(0,Xt(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>lr!=e.x>lr&&this.addBorderIntersection(1,Xt(i.y,e.y,(lr-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,Xt(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>lr!=e.y>lr&&this.addBorderIntersection(3,Xt(i.x,e.x,(lr-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const A=this.borders[e];i<A[0]&&(A[0]=i),i>A[1]&&(A[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const A=e.x===0?0:1;this.addBorderIntersection(A,i.y),this.addBorderIntersection(A,e.y)}else{const A=e.y===0?2:3;this.addBorderIntersection(A,i.x),this.addBorderIntersection(A,e.x)}}centroid(){const e=this.polyCount.reduce((i,A)=>i+A.edges,0);return e!==0?this.acc.div(e)._round():new L(0,0)}span(){return new L(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0)}}class Om{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Pt,this.centroidVertexArray=new y0,this.indexArray=new fn,this.programConfigurations=new IA(e.layers,e.zoom),this.segments=new Vn,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=e.enableTerrain}populate(e,i,A,h){this.features=[],this.hasPattern=km("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(f){const g=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*g/(g*g+1)/lr/(1<<f.z)}(A);for(const{feature:f,id:g,index:v,sourceLayerIndex:w}of e){const C=this.layers[0]._featureFilter.needGeometry,I=SA(f,C);if(!this.layers[0]._featureFilter.filter(new P(this.zoom),I,A))continue;const T={id:g,sourceLayerIndex:w,index:v,geometry:C?I.geometry:Zs(f,A,h),properties:f.properties,type:f.type,patterns:{}},S=this.layoutVertexArray.length;this.hasPattern?this.features.push(Pm("fill-extrusion",this.layers,T,this.zoom,i)):this.addFeature(T,T.geometry,v,A,{},i.availableImages),i.featureIndex.insert(f,T.geometry,v,w,this.index,S)}this.sortBorders()}addFeatures(e,i,A,h){for(const f of this.features){const{geometry:g}=f;this.addFeature(f,g,f.index,i,A,h)}this.sortBorders()}update(e,i,A,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,A,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,CE),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,bE.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,A,h,f,g){const v=this.enableTerrain?new iv:null;for(const C of Dm(i,500)){let I=0,T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(C.length===0||(w=C[0]).every(te=>te.x<=0)||w.every(te=>te.x>=lr)||w.every(te=>te.y<=0)||w.every(te=>te.y>=lr))continue;for(let te=0;te<C.length;te++){const ce=C[te];if(ce.length===0)continue;I+=ce.length;let fe=0;v&&v.startRing(ce[0]);for(let ve=0;ve<ce.length;ve++){const be=ce[ve];if(ve>=1){const Be=ce[ve-1];if(!QE(be,Be)){v&&v.append(be,Be),T.vertexLength+4>Vn.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ie=be.sub(Be)._perp(),je=Ie.x/(Math.abs(Ie.x)+Math.abs(Ie.y)),Oe=Ie.y>0?1:0,pt=Be.dist(be);fe+pt>32768&&(fe=0),uu(this.layoutVertexArray,be.x,be.y,je,Oe,0,0,fe),uu(this.layoutVertexArray,be.x,be.y,je,Oe,0,1,fe),fe+=pt,uu(this.layoutVertexArray,Be.x,Be.y,je,Oe,0,0,fe),uu(this.layoutVertexArray,Be.x,Be.y,je,Oe,0,1,fe);const tt=T.vertexLength;this.indexArray.emplaceBack(tt,tt+2,tt+1),this.indexArray.emplaceBack(tt+1,tt+2,tt+3),T.vertexLength+=4,T.primitiveLength+=2}}}}if(T.vertexLength+I>Vn.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),UE[e.type]!=="Polygon")continue;const S=[],R=[],H=T.vertexLength;for(let te=0;te<C.length;te++){const ce=C[te];if(ce.length!==0){ce!==C[0]&&R.push(S.length/2);for(let fe=0;fe<ce.length;fe++){const ve=ce[fe];uu(this.layoutVertexArray,ve.x,ve.y,0,0,1,1,0),S.push(ve.x),S.push(ve.y),v&&v.currentPolyCount.top++}}}const Z=Md(S,R);for(let te=0;te<Z.length;te+=3)this.indexArray.emplaceBack(H+Z[te],H+Z[te+2],H+Z[te+1]);T.primitiveLength+=Z.length/3,T.vertexLength+=I}var w;if(v&&v.polyCount.length>0){if(v.borders){v.vertexArrayOffset=this.centroidVertexArray.length;const C=v.borders,I=this.featuresOnBorder.push(v)-1;for(let T=0;T<4;T++)C[T][0]!==Number.MAX_VALUE&&this.borders[T].push(I)}this.encodeCentroid(v.borders?void 0:v.centroid(),v)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,A,f,g,h)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((i,A)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[A].borders[e][0])}encodeCentroid(e,i,A=!0){let h,f;if(e)if(e.y!==0){const v=i.span()._mult(this.tileToMeter);h=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(v.x/10)),f=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(v.y/10))}else h=Math.ceil(7*(e.x+450)),f=0;else h=0,f=+A;let g=A?this.centroidVertexArray.length:i.vertexArrayOffset;for(const v of i.polyCount){A&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*v.edges+v.top);for(let w=0;w<2*v.edges;w++)this.centroidVertexArray.emplace(g++,0,f),this.centroidVertexArray.emplace(g++,h,f);for(let w=0;w<v.top;w++)this.centroidVertexArray.emplace(g++,h,f)}}}function QE(n,e){return n.x===e.x&&(n.x<0||n.x>lr)||n.y===e.y&&(n.y<0||n.y>lr)}Bt("FillExtrusionBucket",Om,{omit:["layers","features"]}),Bt("PartMetadata",iv);var ME={paint:new Ve({"fill-extrusion-opacity":new J(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new he(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new J(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new J(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ye(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new he(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new he(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new J(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function hu(n,e){return n.x*e.x+n.y*e.y}function ov(n,e){if(n.length===1){let i=0;const A=e[i++];let h;for(;!h||A.equals(h);)if(h=e[i++],!h)return 1/0;for(;i<e.length;i++){const f=e[i],g=n[0],v=h.sub(A),w=f.sub(A),C=g.sub(A),I=hu(v,v),T=hu(v,w),S=hu(w,w),R=hu(C,v),H=hu(C,w),Z=I*S-T*T,te=(S*R-T*H)/Z,ce=(I*H-T*R)/Z,fe=A.z*(1-te-ce)+h.z*te+f.z*ce;if(isFinite(fe))return fe}return 1/0}{let i=1/0;for(const A of e)i=Math.min(i,A.z);return i}}function sv(n){const e=new L(n[0],n[1]);return e.z=n[2],e}function LE(n,e,i,A,h,f,g,v){const w=g*h.getElevationAt(n,e,!0,!0),C=f[0]!==0,I=C?f[1]===0?g*(f[0]/7-450):g*function(T,S,R){const H=Math.floor(S[0]/8),Z=Math.floor(S[1]/8),te=10*(S[0]-8*H),ce=10*(S[1]-8*Z),fe=T.getElevationAt(H,Z,!0,!0),ve=T.getMeterToDEM(R),be=Math.floor(.5*(te*ve-1)),Be=Math.floor(.5*(ce*ve-1)),Ie=T.tileCoordToPixel(H,Z),je=2*be+1,Oe=2*Be+1,pt=function(mt,wt,Jt,Cr,Nt){return[mt.getElevationAtPixel(wt,Jt,!0),mt.getElevationAtPixel(wt+Nt,Jt,!0),mt.getElevationAtPixel(wt,Jt+Nt,!0),mt.getElevationAtPixel(wt+Cr,Jt+Nt,!0)]}(T,Ie.x-be,Ie.y-Be,je,Oe),tt=Math.abs(pt[0]-pt[1]),Ze=Math.abs(pt[2]-pt[3]),rt=Math.abs(pt[0]-pt[2])+Math.abs(pt[1]-pt[3]),st=Math.min(.25,.5*ve*(tt+Ze)/je),We=Math.min(.25,.5*ve*rt/Oe);return fe+Math.max(st*te,We*ce)}(h,f,v):w;return{base:w+(i===0)?-1:i,top:C?Math.max(I+A,w+i+2):w+A}}const DE=Qe([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:kE}=DE,PE=Qe([{name:"a_packed",components:3,type:"Float32"}]),{members:OE}=PE,RE=QA.VectorTileFeature.types,zE=Math.cos(Math.PI/180*37.5);class Rd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new Ht,this.layoutVertexArray2=new Kt,this.indexArray=new fn,this.programConfigurations=new IA(e.layers,e.zoom),this.segments=new Vn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,A,h){this.hasPattern=km("line",this.layers,i);const f=this.layers[0].layout.get("line-sort-key"),g=[];for(const{feature:I,id:T,index:S,sourceLayerIndex:R}of e){const H=this.layers[0]._featureFilter.needGeometry,Z=SA(I,H);if(!this.layers[0]._featureFilter.filter(new P(this.zoom),Z,A))continue;const te=f?f.evaluate(Z,{},A):void 0,ce={id:T,properties:I.properties,type:I.type,sourceLayerIndex:R,index:S,geometry:H?Z.geometry:Zs(I,A,h),patterns:{},sortKey:te};g.push(ce)}f&&g.sort((I,T)=>I.sortKey-T.sortKey);const{lineAtlas:v,featureIndex:w}=i,C=this.addConstantDashes(v);for(const I of g){const{geometry:T,index:S,sourceLayerIndex:R}=I;if(C&&this.addFeatureDashes(I,v),this.hasPattern){const H=Pm("line",this.layers,I,this.zoom,i);this.patternFeatures.push(H)}else this.addFeature(I,T,S,A,v.positions,i.availableImages);w.insert(e[S].feature,T,S,R,this.index)}}addConstantDashes(e){let i=!1;for(const A of this.layers){const h=A.paint.get("line-dasharray").value,f=A.layout.get("line-cap").value;if(h.kind!=="constant"||f.kind!=="constant")i=!0;else{const g=f.value,v=h.value;if(!v)continue;e.addDash(v.from,g),e.addDash(v.to,g),v.other&&e.addDash(v.other,g)}}return i}addFeatureDashes(e,i){const A=this.zoom;for(const h of this.layers){const f=h.paint.get("line-dasharray").value,g=h.layout.get("line-cap").value;if(f.kind==="constant"&&g.kind==="constant")continue;let v,w,C,I,T,S;if(f.kind==="constant"){const te=f.value;if(!te)continue;v=te.other||te.to,w=te.to,C=te.from}else v=f.evaluate({zoom:A-1},e),w=f.evaluate({zoom:A},e),C=f.evaluate({zoom:A+1},e);g.kind==="constant"?I=T=S=g.value:(I=g.evaluate({zoom:A-1},e),T=g.evaluate({zoom:A},e),S=g.evaluate({zoom:A+1},e)),i.addDash(v,I),i.addDash(w,T),i.addDash(C,S);const R=i.getKey(v,I),H=i.getKey(w,T),Z=i.getKey(C,S);e.patterns[h.id]={min:R,mid:H,max:Z}}}update(e,i,A,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,A,h)}addFeatures(e,i,A,h){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,i,A,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,OE)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kE),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,A,h,f,g){const v=this.layers[0].layout,w=v.get("line-join").evaluate(e,{}),C=v.get("line-cap").evaluate(e,{}),I=v.get("line-miter-limit"),T=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const S of i)this.addLine(S,e,w,C,I,T);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,A,f,g,h)}addLine(e,i,A,h,f,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ce=0;ce<e.length-1;ce++)this.totalDistance+=e[ce].dist(e[ce+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=RE[i.type]==="Polygon";let w=e.length;for(;w>=2&&e[w-1].equals(e[w-2]);)w--;let C=0;for(;C<w-1&&e[C].equals(e[C+1]);)C++;if(w<(v?3:2))return;A==="bevel"&&(f=1.05);const I=this.overscaling<=16?122880/(512*this.overscaling):0,T=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let S,R,H,Z,te;this.e1=this.e2=-1,v&&(S=e[w-2],te=e[C].sub(S)._unit()._perp());for(let ce=C;ce<w;ce++){if(H=ce===w-1?v?e[C+1]:void 0:e[ce+1],H&&e[ce].equals(H))continue;te&&(Z=te),S&&(R=S),S=e[ce],te=H?H.sub(S)._unit()._perp():Z,Z=Z||te;let fe=Z.add(te);fe.x===0&&fe.y===0||fe._unit();const ve=Z.x*te.x+Z.y*te.y,be=fe.x*te.x+fe.y*te.y,Be=be!==0?1/be:1/0,Ie=2*Math.sqrt(2-2*be),je=be<zE&&R&&H,Oe=Z.x*te.y-Z.y*te.x>0;if(je&&ce>C){const Ze=S.dist(R);if(Ze>2*I){const rt=S.sub(S.sub(R)._mult(I/Ze)._round());this.updateDistance(R,rt),this.addCurrentVertex(rt,Z,0,0,T),R=rt}}const pt=R&&H;let tt=pt?A:v?"butt":h;if(pt&&tt==="round"&&(Be<g?tt="miter":Be<=2&&(tt="fakeround")),tt==="miter"&&Be>f&&(tt="bevel"),tt==="bevel"&&(Be>2&&(tt="flipbevel"),Be<f&&(tt="miter")),R&&this.updateDistance(R,S),tt==="miter")fe._mult(Be),this.addCurrentVertex(S,fe,0,0,T);else if(tt==="flipbevel"){if(Be>100)fe=te.mult(-1);else{const Ze=Be*Z.add(te).mag()/Z.sub(te).mag();fe._perp()._mult(Ze*(Oe?-1:1))}this.addCurrentVertex(S,fe,0,0,T),this.addCurrentVertex(S,fe.mult(-1),0,0,T)}else if(tt==="bevel"||tt==="fakeround"){const Ze=-Math.sqrt(Be*Be-1),rt=Oe?Ze:0,st=Oe?0:Ze;if(R&&this.addCurrentVertex(S,Z,rt,st,T),tt==="fakeround"){const We=Math.round(180*Ie/Math.PI/20);for(let mt=1;mt<We;mt++){let wt=mt/We;if(wt!==.5){const Cr=wt-.5;wt+=wt*Cr*(wt-1)*((1.0904+ve*(ve*(3.55645-1.43519*ve)-3.2452))*Cr*Cr+(.848013+ve*(.215638*ve-1.06021)))}const Jt=te.sub(Z)._mult(wt)._add(Z)._unit()._mult(Oe?-1:1);this.addHalfVertex(S,Jt.x,Jt.y,!1,Oe,0,T)}}H&&this.addCurrentVertex(S,te,-rt,-st,T)}else if(tt==="butt")this.addCurrentVertex(S,fe,0,0,T);else if(tt==="square"){const Ze=R?1:-1;R||this.addCurrentVertex(S,fe,Ze,Ze,T),this.addCurrentVertex(S,fe,0,0,T),R&&this.addCurrentVertex(S,fe,Ze,Ze,T)}else tt==="round"&&(R&&(this.addCurrentVertex(S,Z,0,0,T),this.addCurrentVertex(S,Z,1,1,T,!0)),H&&(this.addCurrentVertex(S,te,-1,-1,T,!0),this.addCurrentVertex(S,te,0,0,T)));if(je&&ce<w-1){const Ze=S.dist(H);if(Ze>2*I){const rt=S.add(H.sub(S)._mult(I/Ze)._round());this.updateDistance(S,rt),this.addCurrentVertex(rt,te,0,0,T),S=rt}}}}addCurrentVertex(e,i,A,h,f,g=!1){const v=i.y*h-i.x,w=-i.y-i.x*h;this.addHalfVertex(e,i.x+i.y*A,i.y-i.x*A,g,!1,A,f),this.addHalfVertex(e,v,w,g,!0,-h,f)}addHalfVertex({x:e,y:i},A,h,f,g,v,w){this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(i<<1)+(g?1:0),Math.round(63*A)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const C=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),w.primitiveLength++),g?this.e2=C:this.e1=C}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}Bt("LineBucket",Rd,{omit:["layers","patternFeatures"]});const HE=new Ve({"line-cap":new he(xe.layout_line["line-cap"]),"line-join":new he(xe.layout_line["line-join"]),"line-miter-limit":new J(xe.layout_line["line-miter-limit"]),"line-round-limit":new J(xe.layout_line["line-round-limit"]),"line-sort-key":new he(xe.layout_line["line-sort-key"])});var av={paint:new Ve({"line-opacity":new he(xe.paint_line["line-opacity"]),"line-color":new he(xe.paint_line["line-color"]),"line-translate":new J(xe.paint_line["line-translate"]),"line-translate-anchor":new J(xe.paint_line["line-translate-anchor"]),"line-width":new he(xe.paint_line["line-width"]),"line-gap-width":new he(xe.paint_line["line-gap-width"]),"line-offset":new he(xe.paint_line["line-offset"]),"line-blur":new he(xe.paint_line["line-blur"]),"line-dasharray":new ye(xe.paint_line["line-dasharray"]),"line-pattern":new ye(xe.paint_line["line-pattern"]),"line-gradient":new Le(xe.paint_line["line-gradient"])}),layout:HE};const Av=new class extends he{possiblyEvaluate(n,e){return e=new P(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(n,e)}evaluate(n,e,i,A){return e=qe({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(n,e,i,A)}}(av.paint.properties["line-width"].specification);function lv(n,e){return e>0?e+2*n:n}Av.useIntegerZoom=!0;const NE=Qe([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),VE=Qe([{name:"a_projected_pos",components:3,type:"Float32"}],4);Qe([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const KE=Qe([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),GE=Qe([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Qe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const cv=Qe([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jE=Qe([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Qe([{name:"triangle",components:3,type:"Uint16"}]),Qe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Qe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Qe([{type:"Float32",name:"offsetX"}]),Qe([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Yn=24;const Bs=128;function Rm(n,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new P(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:A,interpolationType:h}=i;let f=0;for(;f<A.length&&A[f]<=n;)f++;f=Math.max(0,f-1);let g=f;for(;g<A.length&&A[g]<n+1;)g++;g=Math.min(A.length-1,g);const v=A[f],w=A[g];return i.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:w,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:w,minSize:i.evaluate(new P(v)),maxSize:i.evaluate(new P(w)),interpolationType:h}}}function zd(n,{uSize:e,uSizeT:i},{lowerSize:A,upperSize:h}){return n.kind==="source"?A/Bs:n.kind==="composite"?Xt(A/Bs,h/Bs,i):e}function Ql(n,e){let i=0,A=0;if(n.kind==="constant")A=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:h,minZoom:f,maxZoom:g}=n,v=h?Ue(Pi.interpolationFactor(h,e,f,g),0,1):0;n.kind==="camera"?A=Xt(n.minSize,n.maxSize,v):i=v}return{uSizeT:i,uSize:A}}var ZE=Object.freeze({__proto__:null,getSizeData:Rm,evaluateSizeForFeature:zd,evaluateSizeForZoom:Ql,SIZE_PACK_FACTOR:Bs});function XE(n,e,i){return n.sections.forEach(A=>{A.text=function(h,f,g){const v=f.layout.get("text-transform").evaluate(g,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),k.applyArabicShaping&&(h=k.applyArabicShaping(h)),h}(A.text,e,i)}),n}const du={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function WE(n){return n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""}function $E(n){return n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""}var uv=function(n,e,i,A,h){var f,g,v=8*h-A-1,w=(1<<v)-1,C=w>>1,I=-7,T=i?h-1:0,S=i?-1:1,R=n[e+T];for(T+=S,f=R&(1<<-I)-1,R>>=-I,I+=v;I>0;f=256*f+n[e+T],T+=S,I-=8);for(g=f&(1<<-I)-1,f>>=-I,I+=A;I>0;g=256*g+n[e+T],T+=S,I-=8);if(f===0)f=1-C;else{if(f===w)return g?NaN:1/0*(R?-1:1);g+=Math.pow(2,A),f-=C}return(R?-1:1)*g*Math.pow(2,f-A)},hv=function(n,e,i,A,h,f){var g,v,w,C=8*f-h-1,I=(1<<C)-1,T=I>>1,S=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=A?0:f-1,H=A?1:-1,Z=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,g=I):(g=Math.floor(Math.log(e)/Math.LN2),e*(w=Math.pow(2,-g))<1&&(g--,w*=2),(e+=g+T>=1?S/w:S*Math.pow(2,1-T))*w>=2&&(g++,w/=2),g+T>=I?(v=0,g=I):g+T>=1?(v=(e*w-1)*Math.pow(2,h),g+=T):(v=e*Math.pow(2,T-1)*Math.pow(2,h),g=0));h>=8;n[i+R]=255&v,R+=H,v/=256,h-=8);for(g=g<<h|v,C+=h;C>0;n[i+R]=255&g,R+=H,g/=256,C-=8);n[i+R-H]|=128*Z},fu=Br;function Br(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}Br.Varint=0,Br.Fixed64=1,Br.Bytes=2,Br.Fixed32=5;var zm=4294967296,dv=1/zm,fv=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Xs(n){return n.type===Br.Bytes?n.readVarint()+n.pos:n.pos+1}function Ml(n,e,i){return i?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}function pv(n,e,i){var A=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(A);for(var h=i.pos-1;h>=n;h--)i.buf[h+A]=i.buf[h]}function qE(n,e){for(var i=0;i<n.length;i++)e.writeVarint(n[i])}function JE(n,e){for(var i=0;i<n.length;i++)e.writeSVarint(n[i])}function YE(n,e){for(var i=0;i<n.length;i++)e.writeFloat(n[i])}function eF(n,e){for(var i=0;i<n.length;i++)e.writeDouble(n[i])}function tF(n,e){for(var i=0;i<n.length;i++)e.writeBoolean(n[i])}function rF(n,e){for(var i=0;i<n.length;i++)e.writeFixed32(n[i])}function nF(n,e){for(var i=0;i<n.length;i++)e.writeSFixed32(n[i])}function iF(n,e){for(var i=0;i<n.length;i++)e.writeFixed64(n[i])}function oF(n,e){for(var i=0;i<n.length;i++)e.writeSFixed64(n[i])}function Hd(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function Ll(n,e,i){n[i]=e,n[i+1]=e>>>8,n[i+2]=e>>>16,n[i+3]=e>>>24}function mv(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}function sF(n,e,i){e.glyphs=[],n===1&&i.readMessage(aF,e)}function aF(n,e,i){if(n===3){const{id:A,bitmap:h,width:f,height:g,left:v,top:w,advance:C}=i.readMessage(AF,{});e.glyphs.push({id:A,bitmap:new Ea({width:f+6,height:g+6},h),metrics:{width:f,height:g,left:v,top:w,advance:C}})}else n===4?e.ascender=i.readSVarint():n===5&&(e.descender=i.readSVarint())}function AF(n,e,i){n===1?e.id=i.readVarint():n===2?e.bitmap=i.readBytes():n===3?e.width=i.readVarint():n===4?e.height=i.readVarint():n===5?e.left=i.readSVarint():n===6?e.top=i.readSVarint():n===7&&(e.advance=i.readVarint())}function Hm(n){let e=0,i=0;for(const g of n)e+=g.w*g.h,i=Math.max(i,g.w);n.sort((g,v)=>v.h-g.h);const A=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let h=0,f=0;for(const g of n)for(let v=A.length-1;v>=0;v--){const w=A[v];if(!(g.w>w.w||g.h>w.h)){if(g.x=w.x,g.y=w.y,f=Math.max(f,g.y+g.h),h=Math.max(h,g.x+g.w),g.w===w.w&&g.h===w.h){const C=A.pop();v<A.length&&(A[v]=C)}else g.h===w.h?(w.x+=g.w,w.w-=g.w):g.w===w.w?(w.y+=g.h,w.h-=g.h):(A.push({x:w.x+g.w,y:w.y,w:w.w-g.w,h:g.h}),w.y+=g.h,w.h-=g.h);break}}return{w:h,h:f,fill:e/(h*f)||0}}Br.prototype={destroy:function(){this.buf=null},readFields:function(n,e,i){for(i=i||this.length;this.pos<i;){var A=this.readVarint(),h=A>>3,f=this.pos;this.type=7&A,n(h,e,this),this.pos===f&&this.skip(A)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=Hd(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=mv(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=Hd(this.buf,this.pos)+Hd(this.buf,this.pos+4)*zm;return this.pos+=8,n},readSFixed64:function(){var n=Hd(this.buf,this.pos)+mv(this.buf,this.pos+4)*zm;return this.pos+=8,n},readFloat:function(){var n=uv(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=uv(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,i,A=this.buf;return e=127&(i=A[this.pos++]),i<128?e:(e|=(127&(i=A[this.pos++]))<<7,i<128?e:(e|=(127&(i=A[this.pos++]))<<14,i<128?e:(e|=(127&(i=A[this.pos++]))<<21,i<128?e:function(h,f,g){var v,w,C=g.buf;if(v=(112&(w=C[g.pos++]))>>4,w<128||(v|=(127&(w=C[g.pos++]))<<3,w<128)||(v|=(127&(w=C[g.pos++]))<<10,w<128)||(v|=(127&(w=C[g.pos++]))<<17,w<128)||(v|=(127&(w=C[g.pos++]))<<24,w<128)||(v|=(1&(w=C[g.pos++]))<<31,w<128))return Ml(h,v,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=A[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&fv?function(i,A,h){return fv.decode(i.subarray(A,h))}(this.buf,e,n):function(i,A,h){for(var f="",g=A;g<h;){var v,w,C,I=i[g],T=null,S=I>239?4:I>223?3:I>191?2:1;if(g+S>h)break;S===1?I<128&&(T=I):S===2?(192&(v=i[g+1]))==128&&(T=(31&I)<<6|63&v)<=127&&(T=null):S===3?(w=i[g+2],(192&(v=i[g+1]))==128&&(192&w)==128&&((T=(15&I)<<12|(63&v)<<6|63&w)<=2047||T>=55296&&T<=57343)&&(T=null)):S===4&&(w=i[g+2],C=i[g+3],(192&(v=i[g+1]))==128&&(192&w)==128&&(192&C)==128&&((T=(15&I)<<18|(63&v)<<12|(63&w)<<6|63&C)<=65535||T>=1114112)&&(T=null)),T===null?(T=65533,S=1):T>65535&&(T-=65536,f+=String.fromCharCode(T>>>10&1023|55296),T=56320|1023&T),f+=String.fromCharCode(T),g+=S}return f}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==Br.Bytes)return n.push(this.readVarint(e));var i=Xs(this);for(n=n||[];this.pos<i;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==Br.Bytes)return n.push(this.readSVarint());var e=Xs(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==Br.Bytes)return n.push(this.readBoolean());var e=Xs(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==Br.Bytes)return n.push(this.readFloat());var e=Xs(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==Br.Bytes)return n.push(this.readDouble());var e=Xs(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==Br.Bytes)return n.push(this.readFixed32());var e=Xs(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==Br.Bytes)return n.push(this.readSFixed32());var e=Xs(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==Br.Bytes)return n.push(this.readFixed64());var e=Xs(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==Br.Bytes)return n.push(this.readSFixed64());var e=Xs(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===Br.Varint)for(;this.buf[this.pos++]>127;);else if(e===Br.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Br.Fixed32)this.pos+=4;else{if(e!==Br.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),Ll(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),Ll(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),Ll(this.buf,-1&n,this.pos),Ll(this.buf,Math.floor(n*dv),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),Ll(this.buf,-1&n,this.pos),Ll(this.buf,Math.floor(n*dv),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,i){var A,h;if(e>=0?(A=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(A=~(-e%4294967296))?A=A+1|0:(A=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(f,g,v){v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,v.buf[v.pos]=127&(f>>>=7)}(A,0,i),function(f,g){var v=(7&f)<<4;g.buf[g.pos++]|=v|((f>>>=3)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f)))))}(h,i)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(!!n)},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(A,h,f){for(var g,v,w=0;w<h.length;w++){if((g=h.charCodeAt(w))>55295&&g<57344){if(!v){g>56319||w+1===h.length?(A[f++]=239,A[f++]=191,A[f++]=189):v=g;continue}if(g<56320){A[f++]=239,A[f++]=191,A[f++]=189,v=g;continue}g=v-55296<<10|g-56320|65536,v=null}else v&&(A[f++]=239,A[f++]=191,A[f++]=189,v=null);g<128?A[f++]=g:(g<2048?A[f++]=g>>6|192:(g<65536?A[f++]=g>>12|224:(A[f++]=g>>18|240,A[f++]=g>>12&63|128),A[f++]=g>>6&63|128),A[f++]=63&g|128)}return f}(this.buf,n,this.pos);var i=this.pos-e;i>=128&&pv(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(n){this.realloc(4),hv(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),hv(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=n[i]},writeRawMessage:function(n,e){this.pos++;var i=this.pos;n(e,this);var A=this.pos-i;A>=128&&pv(i,A,this),this.pos=i-1,this.writeVarint(A),this.pos+=A},writeMessage:function(n,e,i){this.writeTag(n,Br.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,qE,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,JE,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,tF,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,YE,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,eF,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,rF,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,nF,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,iF,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,oF,e)},writeBytesField:function(n,e){this.writeTag(n,Br.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,Br.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,Br.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,Br.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,Br.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,Br.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,Br.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,Br.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,Br.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,Br.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,!!e)}};class Nm{constructor(e,{pixelRatio:i,version:A,stretchX:h,stretchY:f,content:g}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=h,this.stretchY=f,this.content=g,this.version=A}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class gv{constructor(e,i){const A={},h={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,A,f),this.addImages(i,h,f);const{w:g,h:v}=Hm(f),w=new co({width:g||1,height:v||1});for(const C in e){const I=e[C],T=A[C].paddedRect;co.copy(I.data,w,{x:0,y:0},{x:T.x+1,y:T.y+1},I.data)}for(const C in i){const I=i[C],T=h[C].paddedRect,S=T.x+1,R=T.y+1,H=I.data.width,Z=I.data.height;co.copy(I.data,w,{x:0,y:0},{x:S,y:R},I.data),co.copy(I.data,w,{x:0,y:Z-1},{x:S,y:R-1},{width:H,height:1}),co.copy(I.data,w,{x:0,y:0},{x:S,y:R+Z},{width:H,height:1}),co.copy(I.data,w,{x:H-1,y:0},{x:S-1,y:R},{width:1,height:Z}),co.copy(I.data,w,{x:0,y:0},{x:S+H,y:R},{width:1,height:Z})}this.image=w,this.iconPositions=A,this.patternPositions=h}addImages(e,i,A){for(const h in e){const f=e[h],g={x:0,y:0,w:f.data.width+2,h:f.data.height+2};A.push(g),i[h]=new Nm(g,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,i){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const A in e.updatedImages)this.patchUpdatedImage(this.iconPositions[A],e.getImage(A),i),this.patchUpdatedImage(this.patternPositions[A],e.getImage(A),i)}patchUpdatedImage(e,i,A){if(!e||!i||e.version===i.version)return;e.version=i.version;const[h,f]=e.tl;A.update(i.data,void 0,{x:h,y:f})}}Bt("ImagePosition",Nm),Bt("ImageAtlas",gv);const uo={horizontal:1,vertical:2,horizontalOnly:3};class pu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const A=new pu;return A.scale=e||1,A.fontStack=i,A}static forImage(e){const i=new pu;return i.imageName=e,i}}class Dl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const A=new Dl;for(let h=0;h<e.sections.length;h++){const f=e.sections[h];f.image?A.addImageSection(f):A.addTextSection(f,i)}return A}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(i,A){let h="";for(let f=0;f<i.length;f++){const g=i.charCodeAt(f+1)||null,v=i.charCodeAt(f-1)||null;h+=!A&&(g&&ru(g)&&!du[i[f+1]]||v&&ru(v)&&!du[i[f-1]])||!du[i[f]]?i[f]:du[i[f]]}return h}(this.text,e)}trim(){let e=0;for(let A=0;A<this.text.length&&Nd[this.text.charCodeAt(A)];A++)e++;let i=this.text.length;for(let A=this.text.length-1;A>=0&&A>=e&&Nd[this.text.charCodeAt(A)];A--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const A=new Dl;return A.text=this.text.substring(e,i),A.sectionIndex=this.sectionIndex.slice(e,i),A.sections=this.sections,A}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(pu.forText(e.scale,e.fontStack||i));const A=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(A)}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void ke("Can't add FormattedSection with an empty image.");const A=this.getNextImageSectionCharCode();A?(this.text+=String.fromCharCode(A),this.sections.push(pu.forImage(i)),this.sectionIndex.push(this.sections.length-1)):ke("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Vm(n,e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z){const te=Dl.fromFeature(n,h);let ce;T===uo.vertical&&te.verticalizePunctuation(S);const{processBidirectionalText:fe,processStyledBidirectionalText:ve}=k;if(fe&&te.sections.length===1){ce=[];const Ie=fe(te.toString(),Km(te,C,f,e,A,R,H));for(const je of Ie){const Oe=new Dl;Oe.text=je,Oe.sections=te.sections;for(let pt=0;pt<je.length;pt++)Oe.sectionIndex.push(0);ce.push(Oe)}}else if(ve){ce=[];const Ie=ve(te.text,te.sectionIndex,Km(te,C,f,e,A,R,H));for(const je of Ie){const Oe=new Dl;Oe.text=je[0],Oe.sectionIndex=je[1],Oe.sections=te.sections,ce.push(Oe)}}else ce=function(Ie,je){const Oe=[],pt=Ie.text;let tt=0;for(const Ze of je)Oe.push(Ie.substring(tt,Ze)),tt=Ze;return tt<pt.length&&Oe.push(Ie.substring(tt,pt.length)),Oe}(te,Km(te,C,f,e,A,R,H));const be=[],Be={positionedLines:be,text:te.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:T,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Ie,je,Oe,pt,tt,Ze,rt,st,We,mt,wt,Jt){let Cr=0,Nt=0,pr=0;const gt=st==="right"?1:st==="left"?0:.5;let Er=!1;for(const vr of tt){const mr=vr.getSections();for(const Hr of mr){if(Hr.imageName)continue;const ei=je[Hr.fontStack];if(ei&&(Er=ei.ascender!==void 0&&ei.descender!==void 0,!Er))break}if(!Er)break}let ur=0;for(const vr of tt){vr.trim();const mr=vr.getMaxScale(),Hr=(mr-1)*Yn,ei={positionedGlyphs:[],lineOffset:0};Ie.positionedLines[ur]=ei;const gn=ei.positionedGlyphs;let Sn=0;if(!vr.length()){Nt+=Ze,++ur;continue}let ti=0,Zr=0;for(let Fr=0;Fr<vr.length();Fr++){const yn=vr.getSection(Fr),_n=vr.getSectionIndex(Fr),an=vr.getCharCode(Fr);let en=yn.scale,Cn=null,Ir=null,li=null,Yo=Yn,ho=0;const So=!(We===uo.horizontal||!wt&&!tu(an)||wt&&(Nd[an]||(pn=an,hd(pn)||dd(pn)||fd(pn)||_s(pn)||Yc(pn))));if(yn.imageName){const fo=pt[yn.imageName];if(!fo)continue;li=yn.imageName,Ie.iconsInText=Ie.iconsInText||!0,Ir=fo.paddedRect;const ci=fo.displaySize;en=en*Yn/Jt,Cn={width:ci[0],height:ci[1],left:1,top:-3,advance:So?ci[1]:ci[0],localGlyph:!1},ho=Er?-Cn.height*en:mr*Yn-17-ci[1]*en,Yo=Cn.advance;const Ws=(So?ci[0]:ci[1])*en-Yn*mr;Ws>0&&Ws>Sn&&(Sn=Ws)}else{const fo=Oe[yn.fontStack];if(!fo)continue;fo[an]&&(Ir=fo[an]);const ci=je[yn.fontStack];if(!ci)continue;const Ws=ci.glyphs[an];if(!Ws)continue;if(Cn=Ws.metrics,Yo=an!==8203?Yn:0,Er){const zl=ci.ascender!==void 0?Math.abs(ci.ascender):0,Hl=ci.descender!==void 0?Math.abs(ci.descender):0,Nl=(zl+Hl)*en;ti<Nl&&(ti=Nl,Zr=(zl-Hl)/2*en),ho=-zl*en}else ho=(mr-en)*Yn-17}So?(Ie.verticalizable=!0,gn.push({glyph:an,imageName:li,x:Cr,y:Nt+ho,vertical:So,scale:en,localGlyph:Cn.localGlyph,fontStack:yn.fontStack,sectionIndex:_n,metrics:Cn,rect:Ir}),Cr+=Yo*en+mt):(gn.push({glyph:an,imageName:li,x:Cr,y:Nt+ho,vertical:So,scale:en,localGlyph:Cn.localGlyph,fontStack:yn.fontStack,sectionIndex:_n,metrics:Cn,rect:Ir}),Cr+=Cn.advance*en+mt)}gn.length!==0&&(pr=Math.max(Cr-mt,pr),Er?wv(gn,gt,Sn,Zr,Ze*mr/2):wv(gn,gt,Sn,0,Ze/2)),Cr=0;const zi=Ze*mr+Sn;ei.lineOffset=Math.max(Sn,Hr),Nt+=zi,++ur}var pn;const mn=Nt,{horizontalAlign:bn,verticalAlign:Kn}=Gm(rt);(function(vr,mr,Hr,ei,gn,Sn){const ti=(mr-Hr)*gn,Zr=-Sn*ei;for(const zi of vr)for(const Fr of zi.positionedGlyphs)Fr.x+=ti,Fr.y+=Zr})(Ie.positionedLines,gt,bn,Kn,pr,mn),Ie.top+=-Kn*mn,Ie.bottom=Ie.top+mn,Ie.left+=-bn*pr,Ie.right=Ie.left+pr,Ie.hasBaseline=Er}(Be,e,i,A,ce,g,v,w,T,C,S,Z),!function(Ie){for(const je of Ie)if(je.positionedGlyphs.length!==0)return!1;return!0}(be)&&Be}const Nd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},lF={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function yv(n,e,i,A,h,f){if(e.imageName){const g=A[e.imageName];return g?g.displaySize[0]*e.scale*Yn/f+h:0}{const g=i[e.fontStack],v=g&&g.glyphs[n];return v?v.metrics.advance*e.scale+h:0}}function _v(n,e,i,A){const h=Math.pow(n-e,2);return A?n<e?h/2:2*h:h+Math.abs(i)*i}function cF(n,e,i){let A=0;return n===10&&(A-=1e4),i&&(A+=150),n!==40&&n!==65288||(A+=50),e!==41&&e!==65289||(A+=50),A}function vv(n,e,i,A,h,f){let g=null,v=_v(e,i,h,f);for(const w of A){const C=_v(e-w.x,i,h,f)+w.badness;C<=v&&(g=w,v=C)}return{index:n,x:e,priorBreak:g,badness:v}}function xv(n){return n?xv(n.priorBreak).concat(n.index):[]}function Km(n,e,i,A,h,f,g){if(f!=="point")return[];if(!n)return[];const v=[],w=function(S,R,H,Z,te,ce){let fe=0;for(let ve=0;ve<S.length();ve++){const be=S.getSection(ve);fe+=yv(S.getCharCode(ve),be,Z,te,R,ce)}return fe/Math.max(1,Math.ceil(fe/H))}(n,e,i,A,h,g),C=n.text.indexOf("")>=0;let I=0;for(let S=0;S<n.length();S++){const R=n.getSection(S),H=n.getCharCode(S);if(Nd[H]||(I+=yv(H,R,A,h,e,g)),S<n.length()-1){const Z=!((T=H)<11904||!(gd(T)||Xc(T)||bA(T)||vd(T)||Jc(T)||pd(T)||Wc(T)||vl(T)||wl(T)||wA(T)||qc(T)||eu(T)||va(T)||md(T)||xA(T)||$c(T)||xl(T)||xd(T)||_d(T)||yd(T)));(lF[H]||Z||R.imageName)&&v.push(vv(S+1,I,w,v,cF(H,n.getCharCode(S+1),Z&&C),!1))}}var T;return xv(vv(n.length(),I,w,v,0,!0))}function Gm(n){let e=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function wv(n,e,i,A,h){if(!(e||i||A||h))return;const f=n.length-1,g=n[f],v=(g.x+g.metrics.advance*g.scale)*e;for(let w=0;w<=f;w++)n[w].x-=v,n[w].y+=i+A+h}function uF(n,e,i){const{horizontalAlign:A,verticalAlign:h}=Gm(i),f=e[0]-n.displaySize[0]*A,g=e[1]-n.displaySize[1]*h;return{image:n,top:g,bottom:g+n.displaySize[1],left:f,right:f+n.displaySize[0]}}function Bv(n,e,i,A,h,f){const g=n.image;let v;if(g.content){const te=g.content,ce=g.pixelRatio||1;v=[te[0]/ce,te[1]/ce,g.displaySize[0]-te[2]/ce,g.displaySize[1]-te[3]/ce]}const w=e.left*f,C=e.right*f;let I,T,S,R;i==="width"||i==="both"?(R=h[0]+w-A[3],T=h[0]+C+A[1]):(R=h[0]+(w+C-g.displaySize[0])/2,T=R+g.displaySize[0]);const H=e.top*f,Z=e.bottom*f;return i==="height"||i==="both"?(I=h[1]+H-A[0],S=h[1]+Z+A[2]):(I=h[1]+(H+Z-g.displaySize[1])/2,S=I+g.displaySize[1]),{image:g,top:I,right:T,bottom:S,left:R,collisionPadding:v}}class Ia extends L{constructor(e,i,A,h,f){super(e,i),this.angle=h,this.z=A,f!==void 0&&(this.segment=f)}clone(){return new Ia(this.x,this.y,this.z,this.angle,this.segment)}}function bv(n,e,i,A,h){if(e.segment===void 0)return!0;let f=e,g=e.segment+1,v=0;for(;v>-i/2;){if(g--,g<0)return!1;v-=n[g].dist(f),f=n[g]}v+=n[g].dist(n[g+1]),g++;const w=[];let C=0;for(;v<i/2;){const I=n[g],T=n[g+1];if(!T)return!1;let S=n[g-1].angleTo(I)-I.angleTo(T);for(S=Math.abs((S+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:v,angleDelta:S}),C+=S;v-w[0].distance>A;)C-=w.shift().angleDelta;if(C>h)return!1;g++,v+=I.dist(T)}return!0}function Cv(n){let e=0;for(let i=0;i<n.length-1;i++)e+=n[i].dist(n[i+1]);return e}function Ev(n,e,i){return n?.6*e*i:0}function Fv(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function hF(n,e,i,A,h,f){const g=Ev(i,h,f),v=Fv(i,A)*f;let w=0;const C=Cv(n)/2;for(let I=0;I<n.length-1;I++){const T=n[I],S=n[I+1],R=T.dist(S);if(w+R>C){const H=(C-w)/R,Z=Xt(T.x,S.x,H),te=Xt(T.y,S.y,H),ce=new Ia(Z,te,0,S.angleTo(T),I);return!g||bv(n,ce,v,g,e)?ce:void 0}w+=R}}function dF(n,e,i,A,h,f,g,v,w){const C=Ev(A,f,g),I=Fv(A,h),T=I*g,S=n[0].x===0||n[0].x===w||n[0].y===0||n[0].y===w;return e-T<e/4&&(e=T+e/4),Iv(n,S?e/2*v%e:(I/2+2*f)*g*v%e,e,C,i,T,S,!1,w)}function Iv(n,e,i,A,h,f,g,v,w){const C=f/2,I=Cv(n);let T=0,S=e-i,R=[];for(let H=0;H<n.length-1;H++){const Z=n[H],te=n[H+1],ce=Z.dist(te),fe=te.angleTo(Z);for(;S+i<T+ce;){S+=i;const ve=(S-T)/ce,be=Xt(Z.x,te.x,ve),Be=Xt(Z.y,te.y,ve);if(be>=0&&be<w&&Be>=0&&Be<w&&S-C>=0&&S+C<=I){const Ie=new Ia(be,Be,0,fe,H);Ie._round(),A&&!bv(n,Ie,f,A,h)||R.push(Ie)}}T+=ce}return v||R.length||g||(R=Iv(n,T/2,i,A,h,f,g,!0,w)),R}function Tv(n,e,i,A,h){const f=[];for(let g=0;g<n.length;g++){const v=n[g];let w;for(let C=0;C<v.length-1;C++){let I=v[C],T=v[C+1];I.x<e&&T.x<e||(I.x<e?I=new L(e,I.y+(e-I.x)/(T.x-I.x)*(T.y-I.y))._round():T.x<e&&(T=new L(e,I.y+(e-I.x)/(T.x-I.x)*(T.y-I.y))._round()),I.y<i&&T.y<i||(I.y<i?I=new L(I.x+(i-I.y)/(T.y-I.y)*(T.x-I.x),i)._round():T.y<i&&(T=new L(I.x+(i-I.y)/(T.y-I.y)*(T.x-I.x),i)._round()),I.x>=A&&T.x>=A||(I.x>=A?I=new L(A,I.y+(A-I.x)/(T.x-I.x)*(T.y-I.y))._round():T.x>=A&&(T=new L(A,I.y+(A-I.x)/(T.x-I.x)*(T.y-I.y))._round()),I.y>=h&&T.y>=h||(I.y>=h?I=new L(I.x+(h-I.y)/(T.y-I.y)*(T.x-I.x),h)._round():T.y>=h&&(T=new L(I.x+(h-I.y)/(T.y-I.y)*(T.x-I.x),h)._round()),w&&I.equals(w[w.length-1])||(w=[I],f.push(w)),w.push(T)))))}}return f}Bt("Anchor",Ia);const mu=1e20;function Uv(n,e,i,A,h,f,g,v,w){for(let C=e;C<e+A;C++)Sv(n,i*f+C,f,h,g,v,w);for(let C=i;C<i+h;C++)Sv(n,C*f+e,1,A,g,v,w)}function Sv(n,e,i,A,h,f,g){f[0]=0,g[0]=-mu,g[1]=mu,h[0]=n[e];for(let v=1,w=0,C=0;v<A;v++){h[v]=n[e+v*i];const I=v*v;do{const T=f[w];C=(h[v]-h[T]+I-T*T)/(v-T)/2}while(C<=g[w]&&--w>-1);w++,f[w]=v,g[w]=C,g[w+1]=mu}for(let v=0,w=0;v<A;v++){for(;g[w+1]<v;)w++;const C=f[w],I=v-C;n[e+v*i]=h[C]+I*I}}const jm={none:0,ideographs:1,all:2};class kl{constructor(e,i,A){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=A,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const A=[];for(const h in e)for(const f of e[h])A.push({stack:h,id:f});Me(A,({stack:h,id:f},g)=>{let v=this.entries[h];v||(v=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=v.glyphs[f];if(w!==void 0)return void g(null,{stack:h,id:f,glyph:w});if(w=this._tinySDF(v,h,f),w)return v.glyphs[f]=w,void g(null,{stack:h,id:f,glyph:w});const C=Math.floor(f/256);if(256*C>65535)return void g(new Error("glyphs > 65535 not supported"));if(v.ranges[C])return void g(null,{stack:h,id:f,glyph:w});let I=v.requests[C];I||(I=v.requests[C]=[],kl.loadGlyphRange(h,C,this.url,this.requestManager,(T,S)=>{if(S){v.ascender=S.ascender,v.descender=S.descender;for(const R in S.glyphs)this._doesCharSupportLocalGlyph(+R)||(v.glyphs[+R]=S.glyphs[+R]);v.ranges[C]=!0}for(const R of I)R(T,S);delete v.requests[C]})),I.push((T,S)=>{T?g(T):S&&g(null,{stack:h,id:f,glyph:S.glyphs[f]||null})})},(h,f)=>{if(h)i(h);else if(f){const g={};for(const{stack:v,id:w,glyph:C}of f)g[v]===void 0&&(g[v]={}),g[v].glyphs===void 0&&(g[v].glyphs={}),g[v].glyphs[w]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics},g[v].ascender=this.entries[v].ascender,g[v].descender=this.entries[v].descender;i(null,g)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==jm.none&&(this.localGlyphMode===jm.all?!!this.localFontFamily:!!this.localFontFamily&&(wA(e)||BA(e)||va(e)||xl(e))||vl(e))}_tinySDF(e,i,A){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(A))return;let f=e.tinySDF;if(!f){let Z="400";/bold/i.test(i)?Z="900":/medium/i.test(i)?Z="500":/light/i.test(i)&&(Z="200"),f=e.tinySDF=new kl.TinySDF({fontFamily:h,fontWeight:Z,fontSize:48,buffer:6,radius:16}),f.fontWeight=Z}if(this.localGlyphs[f.fontWeight][A])return this.localGlyphs[f.fontWeight][A];const g=String.fromCharCode(A),{data:v,width:w,height:C,glyphWidth:I,glyphHeight:T,glyphLeft:S,glyphTop:R,glyphAdvance:H}=f.draw(g);return this.localGlyphs[f.fontWeight][A]={id:A,bitmap:new Ea({width:w,height:C},v),metrics:{width:I/2,height:T/2,left:S/2,top:R/2-27,advance:H/2,localGlyph:!0}}}}function Qv(n,e,i,A){const h=[],f=n.image,g=f.pixelRatio,v=f.paddedRect.w-2,w=f.paddedRect.h-2,C=n.right-n.left,I=n.bottom-n.top,T=f.stretchX||[[0,v]],S=f.stretchY||[[0,w]],R=(Ze,rt)=>Ze+rt[1]-rt[0],H=T.reduce(R,0),Z=S.reduce(R,0),te=v-H,ce=w-Z;let fe=0,ve=H,be=0,Be=Z,Ie=0,je=te,Oe=0,pt=ce;if(f.content&&A){const Ze=f.content;fe=Vd(T,0,Ze[0]),be=Vd(S,0,Ze[1]),ve=Vd(T,Ze[0],Ze[2]),Be=Vd(S,Ze[1],Ze[3]),Ie=Ze[0]-fe,Oe=Ze[1]-be,je=Ze[2]-Ze[0]-ve,pt=Ze[3]-Ze[1]-Be}const tt=(Ze,rt,st,We)=>{const mt=Kd(Ze.stretch-fe,ve,C,n.left),wt=Gd(Ze.fixed-Ie,je,Ze.stretch,H),Jt=Kd(rt.stretch-be,Be,I,n.top),Cr=Gd(rt.fixed-Oe,pt,rt.stretch,Z),Nt=Kd(st.stretch-fe,ve,C,n.left),pr=Gd(st.fixed-Ie,je,st.stretch,H),gt=Kd(We.stretch-be,Be,I,n.top),Er=Gd(We.fixed-Oe,pt,We.stretch,Z),ur=new L(mt,Jt),pn=new L(Nt,Jt),mn=new L(Nt,gt),bn=new L(mt,gt),Kn=new L(wt/g,Cr/g),vr=new L(pr/g,Er/g),mr=e*Math.PI/180;if(mr){const gn=Math.sin(mr),Sn=Math.cos(mr),ti=[Sn,-gn,gn,Sn];ur._matMult(ti),pn._matMult(ti),bn._matMult(ti),mn._matMult(ti)}const Hr=Ze.stretch+Ze.fixed,ei=rt.stretch+rt.fixed;return{tl:ur,tr:pn,bl:bn,br:mn,tex:{x:f.paddedRect.x+1+Hr,y:f.paddedRect.y+1+ei,w:st.stretch+st.fixed-Hr,h:We.stretch+We.fixed-ei},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Kn,pixelOffsetBR:vr,minFontScaleX:je/g/C,minFontScaleY:pt/g/I,isSDF:i}};if(A&&(f.stretchX||f.stretchY)){const Ze=Mv(T,te,H),rt=Mv(S,ce,Z);for(let st=0;st<Ze.length-1;st++){const We=Ze[st],mt=Ze[st+1];for(let wt=0;wt<rt.length-1;wt++)h.push(tt(We,rt[wt],mt,rt[wt+1]))}}else h.push(tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:w+1}));return h}function Vd(n,e,i){let A=0;for(const h of n)A+=Math.max(e,Math.min(i,h[1]))-Math.max(e,Math.min(i,h[0]));return A}function Mv(n,e,i){const A=[{fixed:-1,stretch:0}];for(const[h,f]of n){const g=A[A.length-1];A.push({fixed:h-g.stretch,stretch:g.stretch}),A.push({fixed:h-g.stretch,stretch:g.stretch+(f-h)})}return A.push({fixed:e+1,stretch:i}),A}function Kd(n,e,i,A){return n/e*i+A}function Gd(n,e,i,A){return n-e*i/A}function fF(n,e,i,A){const h=e+n.positionedLines[A].lineOffset;return A===0?i+h/2:i+(h+(e+n.positionedLines[A-1].lineOffset))/2}kl.loadGlyphRange=function(n,e,i,A,h){const f=256*e,g=f+255,v=A.transformRequest(A.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",`${f}-${g}`),Li.Glyphs);N(v,(w,C)=>{if(w)h(w);else if(C){const I={},T=function(S){return new fu(S).readFields(sF,{})}(C);for(const S of T.glyphs)I[S.id]=S;h(null,{glyphs:I,ascender:T.ascender,descender:T.descender})}})},kl.TinySDF=class{constructor({fontSize:n=24,buffer:e=3,radius:i=8,cutoff:A=.25,fontFamily:h="sans-serif",fontWeight:f="normal",fontStyle:g="normal"}){this.buffer=e,this.cutoff=A,this.radius=i;const v=this.size=n+4*e,w=this._createCanvas(v),C=this.ctx=w.getContext("2d",{willReadFrequently:!0});C.font=`${g} ${f} ${n}px ${h}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}_createCanvas(n){const e=document.createElement("canvas");return e.width=e.height=n,e}draw(n){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:A,actualBoundingBoxLeft:h,actualBoundingBoxRight:f}=this.ctx.measureText(n),g=Math.floor(i),v=Math.min(this.size-this.buffer,Math.ceil(f-h)),w=Math.min(this.size-this.buffer,Math.ceil(i)+Math.ceil(A)),C=v+2*this.buffer,I=w+2*this.buffer,T=C*I,S=new Uint8ClampedArray(T),R={data:S,width:C,height:I,glyphWidth:v,glyphHeight:w,glyphTop:g,glyphLeft:0,glyphAdvance:e};if(v===0||w===0)return R;const{ctx:H,buffer:Z,gridInner:te,gridOuter:ce}=this;H.clearRect(Z,Z,v,w),H.fillText(n,Z,Z+g+1);const fe=H.getImageData(Z,Z,v,w);ce.fill(mu,0,T),te.fill(0,0,T);for(let ve=0;ve<w;ve++)for(let be=0;be<v;be++){const Be=fe.data[4*(ve*v+be)+3]/255;if(Be===0)continue;const Ie=(ve+Z)*C+be+Z;if(Be===1)ce[Ie]=0,te[Ie]=mu;else{const je=.5-Be;ce[Ie]=je>0?je*je:0,te[Ie]=je<0?je*je:0}}Uv(ce,0,0,C,I,C,this.f,this.v,this.z),Uv(te,Z,Z,v,w,C,this.f,this.v,this.z);for(let ve=0;ve<T;ve++){const be=Math.sqrt(ce[ve])-Math.sqrt(te[ve]);S[ve]=Math.round(255-255*(be/this.radius+this.cutoff))}return R}};class pF{constructor(e=[],i=mF){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let A=(this.length>>1)-1;A>=0;A--)this._down(A)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:A}=this,h=i[e];for(;e>0;){const f=e-1>>1,g=i[f];if(A(h,g)>=0)break;i[e]=g,e=f}i[e]=h}_down(e){const{data:i,compare:A}=this,h=this.length>>1,f=i[e];for(;e<h;){let g=1+(e<<1),v=i[g];const w=g+1;if(w<this.length&&A(i[w],v)<0&&(g=w,v=i[w]),A(v,f)>=0)break;i[e]=v,e=g}i[e]=f}}function mF(n,e){return n<e?-1:n>e?1:0}function gF(n,e=1,i=!1){let A=1/0,h=1/0,f=-1/0,g=-1/0;const v=n[0];for(let R=0;R<v.length;R++){const H=v[R];(!R||H.x<A)&&(A=H.x),(!R||H.y<h)&&(h=H.y),(!R||H.x>f)&&(f=H.x),(!R||H.y>g)&&(g=H.y)}const w=Math.min(f-A,g-h);let C=w/2;const I=new pF([],yF);if(w===0)return new L(A,h);for(let R=A;R<f;R+=w)for(let H=h;H<g;H+=w)I.push(new Pl(R+C,H+C,C,n));let T=function(R){let H=0,Z=0,te=0;const ce=R[0];for(let fe=0,ve=ce.length,be=ve-1;fe<ve;be=fe++){const Be=ce[fe],Ie=ce[be],je=Be.x*Ie.y-Ie.x*Be.y;Z+=(Be.x+Ie.x)*je,te+=(Be.y+Ie.y)*je,H+=3*je}return new Pl(Z/H,te/H,0,R)}(n),S=I.length;for(;I.length;){const R=I.pop();(R.d>T.d||!T.d)&&(T=R,i&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,S)),R.max-T.d<=e||(C=R.h/2,I.push(new Pl(R.p.x-C,R.p.y-C,C,n)),I.push(new Pl(R.p.x+C,R.p.y-C,C,n)),I.push(new Pl(R.p.x-C,R.p.y+C,C,n)),I.push(new Pl(R.p.x+C,R.p.y+C,C,n)),S+=4)}return i&&(console.log(`num probes: ${S}`),console.log(`best distance: ${T.d}`)),T.p}function yF(n,e){return e.max-n.max}function Pl(n,e,i,A){this.p=new L(n,e),this.h=i,this.d=function(h,f){let g=!1,v=1/0;for(let w=0;w<f.length;w++){const C=f[w];for(let I=0,T=C.length,S=T-1;I<T;S=I++){const R=C[I],H=C[S];R.y>h.y!=H.y>h.y&&h.x<(H.x-R.x)*(h.y-R.y)/(H.y-R.y)+R.x&&(g=!g),v=Math.min(v,U0(h,R,H))}}return(g?1:-1)*Math.sqrt(v)}(this.p,A),this.max=this.d+this.h*Math.SQRT2}const Zm=Number.POSITIVE_INFINITY,_F=Math.sqrt(2);function Lv(n,e){return e[1]!==Zm?function(i,A,h){let f=0,g=0;switch(A=Math.abs(A),h=Math.abs(h),i){case"top-right":case"top-left":case"top":g=h-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-h}switch(i){case"top-right":case"bottom-right":case"right":f=-A;break;case"top-left":case"bottom-left":case"left":f=A}return[f,g]}(n,e[0],e[1]):function(i,A){let h=0,f=0;A<0&&(A=0);const g=A/_F;switch(i){case"top-right":case"top-left":f=g-7;break;case"bottom-right":case"bottom-left":f=7-g;break;case"bottom":f=7-A;break;case"top":f=A-7}switch(i){case"top-right":case"bottom-right":h=-g;break;case"top-left":case"bottom-left":h=g;break;case"left":h=A;break;case"right":h=-A}return[h,f]}(n,e[0])}function vF(n,e,i,A,h,f,g,v,w){n.createArrays(),n.tilePixelRatio=lr/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const C=n.layers[0].layout,I=n.layers[0]._unevaluatedLayout._values,T={};if(n.textSizeData.kind==="composite"){const{minZoom:H,maxZoom:Z}=n.textSizeData;T.compositeTextSizes=[I["text-size"].possiblyEvaluate(new P(H),v),I["text-size"].possiblyEvaluate(new P(Z),v)]}if(n.iconSizeData.kind==="composite"){const{minZoom:H,maxZoom:Z}=n.iconSizeData;T.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new P(H),v),I["icon-size"].possiblyEvaluate(new P(Z),v)]}T.layoutTextSize=I["text-size"].possiblyEvaluate(new P(w+1),v),T.layoutIconSize=I["icon-size"].possiblyEvaluate(new P(w+1),v),T.textMaxSize=I["text-size"].possiblyEvaluate(new P(18),v);const S=C.get("text-rotation-alignment")==="map"&&C.get("symbol-placement")!=="point",R=C.get("text-size");for(const H of n.features){const Z=C.get("text-font").evaluate(H,{},v).join(","),te=R.evaluate(H,{},v),ce=T.layoutTextSize.evaluate(H,{},v),fe=(T.layoutIconSize.evaluate(H,{},v),{horizontal:{},vertical:void 0}),ve=H.text;let be,Be=[0,0];if(ve){const Oe=ve.toString(),pt=C.get("text-letter-spacing").evaluate(H,{},v)*Yn,tt=C.get("text-line-height").evaluate(H,{},v)*Yn,Ze=Bl(Oe)?pt:0,rt=C.get("text-anchor").evaluate(H,{},v),st=C.get("text-variable-anchor");if(!st){const Nt=C.get("text-radial-offset").evaluate(H,{},v);Be=Nt?Lv(rt,[Nt*Yn,Zm]):C.get("text-offset").evaluate(H,{},v).map(pr=>pr*Yn)}let We=S?"center":C.get("text-justify").evaluate(H,{},v);const mt=C.get("symbol-placement"),wt=mt==="point",Jt=mt==="point"?C.get("text-max-width").evaluate(H,{},v)*Yn:0,Cr=Nt=>{n.allowVerticalPlacement&&vs(Oe)&&(fe.vertical=Vm(ve,e,i,h,Z,Jt,tt,rt,Nt,Ze,Be,uo.vertical,!0,mt,ce,te))};if(!S&&st){const Nt=We==="auto"?st.map(gt=>Xm(gt)):[We];let pr=!1;for(let gt=0;gt<Nt.length;gt++){const Er=Nt[gt];if(!fe.horizontal[Er])if(pr)fe.horizontal[Er]=fe.horizontal[0];else{const ur=Vm(ve,e,i,h,Z,Jt,tt,"center",Er,Ze,Be,uo.horizontal,!1,mt,ce,te);ur&&(fe.horizontal[Er]=ur,pr=ur.positionedLines.length===1)}}Cr("left")}else{if(We==="auto"&&(We=Xm(rt)),wt||C.get("text-writing-mode").indexOf("horizontal")>=0||!vs(Oe)){const Nt=Vm(ve,e,i,h,Z,Jt,tt,rt,We,Ze,Be,uo.horizontal,!1,mt,ce,te);Nt&&(fe.horizontal[We]=Nt)}Cr(mt==="point"?"left":We)}}let Ie=!1;if(H.icon&&H.icon.name){const Oe=A[H.icon.name];Oe&&(be=uF(h[H.icon.name],C.get("icon-offset").evaluate(H,{},v),C.get("icon-anchor").evaluate(H,{},v)),Ie=Oe.sdf,n.sdfIcons===void 0?n.sdfIcons=Oe.sdf:n.sdfIcons!==Oe.sdf&&ke("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Oe.pixelRatio!==n.pixelRatio||C.get("icon-rotate").constantOr(1)!==0)&&(n.iconsNeedLinear=!0))}const je=kv(fe.horizontal)||fe.vertical;n.iconsInText||(n.iconsInText=!!je&&je.iconsInText),(je||be)&&xF(n,H,fe,be,A,T,ce,0,Be,Ie,g,v)}f&&n.generateCollisionDebugBuffers(w,n.collisionBoxArray)}function Xm(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function xF(n,e,i,A,h,f,g,v,w,C,I,T){let S=f.textMaxSize.evaluate(e,{},T);S===void 0&&(S=g);const R=n.layers[0].layout,H=R.get("icon-offset").evaluate(e,{},T),Z=kv(i.horizontal)||i.vertical,te=g/24,ce=n.tilePixelRatio*S/24,fe=n.tilePixelRatio*R.get("symbol-spacing"),ve=R.get("text-padding")*n.tilePixelRatio,be=R.get("icon-padding")*n.tilePixelRatio,Be=K(R.get("text-max-angle")),Ie=R.get("text-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",je=R.get("icon-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",Oe=R.get("symbol-placement"),pt=fe/2,tt=R.get("icon-text-fit");let Ze;A&&tt!=="none"&&(n.allowVerticalPlacement&&i.vertical&&(Ze=Bv(A,i.vertical,tt,R.get("icon-text-fit-padding"),H,te)),Z&&(A=Bv(A,Z,tt,R.get("icon-text-fit-padding"),H,te)));const rt=(st,We)=>{We.x<0||We.x>=lr||We.y<0||We.y>=lr||function(mt,wt,Jt,Cr,Nt,pr,gt,Er,ur,pn,mn,bn,Kn,vr,mr,Hr,ei,gn,Sn,ti,Zr,zi,Fr,yn,_n){const an=mt.addToLineVertexArray(wt,Cr);let en,Cn,Ir,li,Yo,ho,So,fo=0,ci=0,Ws=0,zl=0,Hl=-1,Nl=-1;const Fs={};let fx=nu(""),lg=0,cg=0;if(ur._unevaluatedLayout.getValue("text-radial-offset")===void 0?[lg,cg]=ur.layout.get("text-offset").evaluate(Zr,{},_n).map(Xi=>Xi*Yn):(lg=ur.layout.get("text-radial-offset").evaluate(Zr,{},_n)*Yn,cg=Zm),mt.allowVerticalPlacement&&Nt.vertical){const Xi=Nt.vertical;if(mr)ho=Wm(Xi),Er&&(So=Wm(Er));else{const Wi=ur.layout.get("text-rotate").evaluate(Zr,{},_n)+90;Ir=jd(pn,Jt,wt,mn,bn,Kn,Xi,vr,Wi,Hr),Er&&(li=jd(pn,Jt,wt,mn,bn,Kn,Er,gn,Wi))}}if(pr){const Xi=ur.layout.get("icon-rotate").evaluate(Zr,{},_n),Wi=ur.layout.get("icon-text-fit")!=="none",wu=Qv(pr,Xi,Fr,Wi),hg=Er?Qv(Er,Xi,Fr,Wi):void 0;Cn=jd(pn,Jt,wt,mn,bn,Kn,pr,gn,Xi),fo=4*wu.length;const px=mt.iconSizeData;let LA=null;px.kind==="source"?(LA=[Bs*ur.layout.get("icon-size").evaluate(Zr,{},_n)],LA[0]>Ta&&ke(`${mt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):px.kind==="composite"&&(LA=[Bs*zi.compositeIconSizes[0].evaluate(Zr,{},_n),Bs*zi.compositeIconSizes[1].evaluate(Zr,{},_n)],(LA[0]>Ta||LA[1]>Ta)&&ke(`${mt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),mt.addSymbols(mt.icon,wu,LA,ti,Sn,Zr,!1,Jt,wt,an.lineStartIndex,an.lineLength,-1,yn,_n),Hl=mt.icon.placedSymbolArray.length-1,hg&&(ci=4*hg.length,mt.addSymbols(mt.icon,hg,LA,ti,Sn,Zr,uo.vertical,Jt,wt,an.lineStartIndex,an.lineLength,-1,yn,_n),Nl=mt.icon.placedSymbolArray.length-1)}for(const Xi in Nt.horizontal){const Wi=Nt.horizontal[Xi];en||(fx=nu(Wi.text),mr?Yo=Wm(Wi):en=jd(pn,Jt,wt,mn,bn,Kn,Wi,vr,ur.layout.get("text-rotate").evaluate(Zr,{},_n),Hr));const wu=Wi.positionedLines.length===1;if(Ws+=Dv(mt,Jt,wt,Wi,gt,ur,mr,Zr,Hr,an,Nt.vertical?uo.horizontal:uo.horizontalOnly,wu?Object.keys(Nt.horizontal):[Xi],Fs,Hl,zi,yn,_n),wu)break}Nt.vertical&&(zl+=Dv(mt,Jt,wt,Nt.vertical,gt,ur,mr,Zr,Hr,an,uo.vertical,["vertical"],Fs,Nl,zi,yn,_n));let La=-1;const ug=(Xi,Wi)=>Xi?Math.max(Xi,Wi):Wi;La=ug(Yo,La),La=ug(ho,La),La=ug(So,La);const jF=La>-1?1:0;mt.glyphOffsetArray.length>=Ua.MAX_GLYPHS&&ke("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Zr.sortKey!==void 0&&mt.addToSortKeyRanges(mt.symbolInstances.length,Zr.sortKey),mt.symbolInstances.emplaceBack(Jt.x,Jt.y,Jt.z,wt.x,wt.y,Fs.right>=0?Fs.right:-1,Fs.center>=0?Fs.center:-1,Fs.left>=0?Fs.left:-1,Fs.vertical>=0?Fs.vertical:-1,Hl,Nl,fx,en!==void 0?en:mt.collisionBoxArray.length,en!==void 0?en+1:mt.collisionBoxArray.length,Ir!==void 0?Ir:mt.collisionBoxArray.length,Ir!==void 0?Ir+1:mt.collisionBoxArray.length,Cn!==void 0?Cn:mt.collisionBoxArray.length,Cn!==void 0?Cn+1:mt.collisionBoxArray.length,li||mt.collisionBoxArray.length,li?li+1:mt.collisionBoxArray.length,mn,Ws,zl,fo,ci,jF,0,lg,cg,La)}(n,We,We,st,i,A,h,Ze,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,ve,Ie,w,0,be,je,H,e,f,C,I,T)};if(Oe==="line")for(const st of Tv(e.geometry,0,0,lr,lr)){const We=dF(st,fe,Be,i.vertical||Z,A,24,ce,n.overscaling,lr);for(const mt of We){const wt=Z;wt&&wF(n,wt.text,pt,mt)||rt(st,mt)}}else if(Oe==="line-center"){for(const st of e.geometry)if(st.length>1){const We=hF(st,Be,i.vertical||Z,A,24,ce);We&&rt(st,We)}}else if(e.type==="Polygon")for(const st of Dm(e.geometry,0)){const We=gF(st,16);rt(st[0],new Ia(We.x,We.y,0,0,void 0))}else if(e.type==="LineString")for(const st of e.geometry)rt(st,new Ia(st[0].x,st[0].y,0,0,void 0));else if(e.type==="Point")for(const st of e.geometry)for(const We of st)rt([We],new Ia(We.x,We.y,0,0,void 0))}const Ta=32640;function Dv(n,e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z,te){const ce=function(be,Be,Ie,je,Oe,pt,tt,Ze){const rt=[];if(Be.positionedLines.length===0)return rt;const st=je.layout.get("text-rotate").evaluate(pt,{})*Math.PI/180,We=function(Nt){const pr=Nt[0],gt=Nt[1],Er=pr*gt;return Er>0?[pr,-gt]:Er<0?[-pr,gt]:pr===0?[gt,pr]:[gt,-pr]}(Ie);let mt=Math.abs(Be.top-Be.bottom);for(const Nt of Be.positionedLines)mt-=Nt.lineOffset;const wt=Be.positionedLines.length,Jt=mt/wt;let Cr=Be.top-Ie[1];for(let Nt=0;Nt<wt;++Nt){const pr=Be.positionedLines[Nt];Cr=fF(Be,Jt,Cr,Nt);for(const gt of pr.positionedGlyphs){if(!gt.rect)continue;const Er=gt.rect||{};let ur=4,pn=!0,mn=1,bn=0;if(gt.imageName){const Ir=tt[gt.imageName];if(!Ir)continue;if(Ir.sdf){ke("SDF images are not supported in formatted text and will be ignored.");continue}pn=!1,mn=Ir.pixelRatio,ur=1/mn}const Kn=(Oe||Ze)&&gt.vertical,vr=gt.metrics.advance*gt.scale/2,mr=gt.metrics,Hr=gt.rect;if(Hr===null)continue;Ze&&Be.verticalizable&&(bn=gt.imageName?vr-gt.metrics.width*gt.scale/2:0);const ei=Oe?[gt.x+vr,gt.y]:[0,0];let gn=[0,0],Sn=[0,0],ti=!1;Oe||(Kn?(Sn=[gt.x+vr+We[0],gt.y+We[1]-bn],ti=!0):gn=[gt.x+vr+Ie[0],gt.y+Ie[1]-bn]);const Zr=Hr.w*gt.scale/(mn*(gt.localGlyph?2:1)),zi=Hr.h*gt.scale/(mn*(gt.localGlyph?2:1));let Fr,yn,_n,an;if(Kn){const Ir=gt.y-Cr,li=new L(-vr,vr-Ir),Yo=-Math.PI/2,ho=new L(...Sn);Fr=new L(-vr+gn[0],gn[1]),Fr._rotateAround(Yo,li)._add(ho),Fr.x+=-Ir+vr,Fr.y-=(mr.left-ur)*gt.scale;const So=gt.imageName?mr.advance*gt.scale:Yn*gt.scale,fo=String.fromCharCode(gt.glyph);WE(fo)?Fr.x+=(1-ur)*gt.scale:$E(fo)?Fr.x+=So-mr.height*gt.scale+(-ur-1)*gt.scale:Fr.x+=gt.imageName||mr.width+2*ur===Hr.w&&mr.height+2*ur===Hr.h?(So-zi)/2:(So-(mr.height+2*ur)*gt.scale)/2,yn=new L(Fr.x,Fr.y-Zr),_n=new L(Fr.x+zi,Fr.y),an=new L(Fr.x+zi,Fr.y-Zr)}else{const Ir=(mr.left-ur)*gt.scale-vr+gn[0],li=(-mr.top-ur)*gt.scale+gn[1],Yo=Ir+Zr,ho=li+zi;Fr=new L(Ir,li),yn=new L(Yo,li),_n=new L(Ir,ho),an=new L(Yo,ho)}if(st){let Ir;Ir=Oe?new L(0,0):ti?new L(We[0],We[1]):new L(Ie[0],Ie[1]),Fr._rotateAround(st,Ir),yn._rotateAround(st,Ir),_n._rotateAround(st,Ir),an._rotateAround(st,Ir)}const en=new L(0,0),Cn=new L(0,0);rt.push({tl:Fr,tr:yn,bl:_n,br:an,tex:Er,writingMode:Be.writingMode,glyphOffset:ei,sectionIndex:gt.sectionIndex,isSDF:pn,pixelOffsetTL:en,pixelOffsetBR:Cn,minFontScaleX:0,minFontScaleY:0})}}return rt}(0,A,w,f,g,v,h,n.allowVerticalPlacement),fe=n.textSizeData;let ve=null;fe.kind==="source"?(ve=[Bs*f.layout.get("text-size").evaluate(v,{},te)],ve[0]>Ta&&ke(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):fe.kind==="composite"&&(ve=[Bs*H.compositeTextSizes[0].evaluate(v,{},te),Bs*H.compositeTextSizes[1].evaluate(v,{},te)],(ve[0]>Ta||ve[1]>Ta)&&ke(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,ce,ve,w,g,v,I,e,i,C.lineStartIndex,C.lineLength,R,Z,te);for(const be of T)S[be]=n.text.placedSymbolArray.length-1;return 4*ce.length}function kv(n){for(const e in n)return n[e];return null}function jd(n,e,i,A,h,f,g,v,w,C){let I=g.top,T=g.bottom,S=g.left,R=g.right;const H=g.collisionPadding;if(H&&(S-=H[0],I-=H[1],R+=H[2],T+=H[3]),w){const Z=new L(S,I),te=new L(R,I),ce=new L(S,T),fe=new L(R,T),ve=K(w);let be=new L(0,0);C&&(be=new L(C[0],C[1])),Z._rotateAround(ve,be),te._rotateAround(ve,be),ce._rotateAround(ve,be),fe._rotateAround(ve,be),S=Math.min(Z.x,te.x,ce.x,fe.x),R=Math.max(Z.x,te.x,ce.x,fe.x),I=Math.min(Z.y,te.y,ce.y,fe.y),T=Math.max(Z.y,te.y,ce.y,fe.y)}return n.emplaceBack(e.x,e.y,e.z,i.x,i.y,S,I,R,T,v,A,h,f),n.length-1}function Wm(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const e=n.bottom-n.top;return e>0?Math.max(10,e):null}function wF(n,e,i,A){const h=n.compareText;if(e in h){const f=h[e];for(let g=f.length-1;g>=0;g--)if(A.dist(f[g])<i)return!0}else h[e]=[];return h[e].push(A),!1}const BF=QA.VectorTileFeature.types,bF=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Zd(n,e,i,A,h,f,g,v,w,C,I,T,S,R,H,Z){const te=I?Math.min(Ta,Math.round(I[0])):0,ce=I?Math.min(Ta,Math.round(I[1])):0;n.emplaceBack(e,i,Math.round(32*g),Math.round(32*v),w,C,(te<<1)+(T?1:0),ce,16*S,16*R,256*H,256*Z,A,h,f,0)}function $m(n,e,i){n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i)}function CF(n){for(const e of n.sections)if(pm(e.text))return!0;return!1}class qm{constructor(e){this.layoutVertexArray=new qt,this.indexArray=new fn,this.programConfigurations=e,this.segments=new Vn,this.dynamicLayoutVertexArray=new Kt,this.opacityVertexArray=new fr,this.placedSymbolArray=new Bd}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,A,h){this.isEmpty()||(A&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,NE.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,VE.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,bF,!0),this.opacityVertexBuffer.itemSize=1),(A||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Bt("SymbolBuffers",qm);class Jm{constructor(e,i,A){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new A,this.segments=new Vn,this.collisionVertexArray=new Ai,this.collisionVertexArrayExt=new Kt}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,KE.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,GE.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Bt("CollisionBuffers",Jm);class Ua{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(g=>g.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Fm([]),this.placementViewportMatrix=Fm([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Rm(this.zoom,i["text-size"]),this.iconSizeData=Rm(this.zoom,i["icon-size"]);const A=this.layers[0].layout,h=A.get("symbol-sort-key"),f=A.get("symbol-z-order");this.canOverlap=A.get("text-allow-overlap")||A.get("icon-allow-overlap")||A.get("text-ignore-placement")||A.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=A.get("text-writing-mode").map(g=>uo[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=e.sourceID}createArrays(){this.text=new qm(new IA(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new qm(new IA(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new bd,this.lineVertexArray=new FA,this.symbolInstances=new Ba}calculateGlyphDependencies(e,i,A,h,f){for(let g=0;g<e.length;g++)if(i[e.charCodeAt(g)]=!0,h&&f){const v=du[e.charAt(g)];v&&(i[v.charCodeAt(0)]=!0)}}populate(e,i,A,h){const f=this.layers[0],g=f.layout,v=g.get("text-font"),w=g.get("text-field"),C=g.get("icon-image"),I=(w.value.kind!=="constant"||w.value.value instanceof un&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),T=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,S=g.get("symbol-sort-key");if(this.features=[],!I&&!T)return;const R=i.iconDependencies,H=i.glyphDependencies,Z=i.availableImages,te=new P(this.zoom);for(const{feature:ce,id:fe,index:ve,sourceLayerIndex:be}of e){const Be=f._featureFilter.needGeometry,Ie=SA(ce,Be);if(!f._featureFilter.filter(te,Ie,A))continue;let je,Oe;if(Be||(Ie.geometry=Zs(ce,A,h)),I){const tt=f.getValueAndResolveTokens("text-field",Ie,A,Z),Ze=un.factory(tt);CF(Ze)&&(this.hasRTLText=!0),(!this.hasRTLText||U()==="unavailable"||this.hasRTLText&&k.isParsed())&&(je=XE(Ze,f,Ie))}if(T){const tt=f.getValueAndResolveTokens("icon-image",Ie,A,Z);Oe=tt instanceof Wn?tt:Wn.fromString(tt)}if(!je&&!Oe)continue;const pt=this.sortFeaturesByKey?S.evaluate(Ie,{},A):void 0;if(this.features.push({id:fe,text:je,icon:Oe,index:ve,sourceLayerIndex:be,geometry:Ie.geometry,properties:ce.properties,type:BF[ce.type],sortKey:pt}),Oe&&(R[Oe.name]=!0),je){const tt=v.evaluate(Ie,{},A).join(","),Ze=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(uo.vertical)>=0;for(const rt of je.sections)if(rt.image)R[rt.image.name]=!0;else{const st=vs(je.toString()),We=rt.fontStack||tt,mt=H[We]=H[We]||{};this.calculateGlyphDependencies(rt.text,mt,Ze,this.allowVerticalPlacement,st)}}}g.get("symbol-placement")==="line"&&(this.features=function(ce){const fe={},ve={},be=[];let Be=0;function Ie(tt){be.push(ce[tt]),Be++}function je(tt,Ze,rt){const st=ve[tt];return delete ve[tt],ve[Ze]=st,be[st].geometry[0].pop(),be[st].geometry[0]=be[st].geometry[0].concat(rt[0]),st}function Oe(tt,Ze,rt){const st=fe[Ze];return delete fe[Ze],fe[tt]=st,be[st].geometry[0].shift(),be[st].geometry[0]=rt[0].concat(be[st].geometry[0]),st}function pt(tt,Ze,rt){const st=rt?Ze[0][Ze[0].length-1]:Ze[0][0];return`${tt}:${st.x}:${st.y}`}for(let tt=0;tt<ce.length;tt++){const Ze=ce[tt],rt=Ze.geometry,st=Ze.text?Ze.text.toString():null;if(!st){Ie(tt);continue}const We=pt(st,rt),mt=pt(st,rt,!0);if(We in ve&&mt in fe&&ve[We]!==fe[mt]){const wt=Oe(We,mt,rt),Jt=je(We,mt,be[wt].geometry);delete fe[We],delete ve[mt],ve[pt(st,be[Jt].geometry,!0)]=Jt,be[wt].geometry=null}else We in ve?je(We,mt,rt):mt in fe?Oe(We,mt,rt):(Ie(tt),fe[We]=Be-1,ve[mt]=Be-1)}return be.filter(tt=>tt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,fe)=>ce.sortKey-fe.sortKey)}update(e,i,A,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,A,h),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,A,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const A=this.lineVertexArray.length;if(e.segment!==void 0){let h=e.dist(i[e.segment+1]),f=e.dist(i[e.segment]);const g={};for(let v=e.segment+1;v<i.length;v++)g[v]={x:i[v].x,y:i[v].y,tileUnitDistanceFromAnchor:h},v<i.length-1&&(h+=i[v+1].dist(i[v]));for(let v=e.segment||0;v>=0;v--)g[v]={x:i[v].x,y:i[v].y,tileUnitDistanceFromAnchor:f},v>0&&(f+=i[v-1].dist(i[v]));for(let v=0;v<i.length;v++){const w=g[v];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:A,lineLength:this.lineVertexArray.length-A}}addSymbols(e,i,A,h,f,g,v,w,C,I,T,S,R,H){const Z=e.indexArray,te=e.layoutVertexArray,ce=e.segments.prepareSegment(4*i.length,te,Z,this.canOverlap?g.sortKey:void 0),fe=this.glyphOffsetArray.length,ve=ce.vertexLength,be=this.allowVerticalPlacement&&v===uo.vertical?Math.PI/2:0,Be=g.text&&g.text.sections;for(let Ie=0;Ie<i.length;Ie++){const{tl:je,tr:Oe,bl:pt,br:tt,tex:Ze,pixelOffsetTL:rt,pixelOffsetBR:st,minFontScaleX:We,minFontScaleY:mt,glyphOffset:wt,isSDF:Jt,sectionIndex:Cr}=i[Ie],Nt=ce.vertexLength,pr=wt[1];Zd(te,w.x,w.y,w.z,C.x,C.y,je.x,pr+je.y,Ze.x,Ze.y,A,Jt,rt.x,rt.y,We,mt),Zd(te,w.x,w.y,w.z,C.x,C.y,Oe.x,pr+Oe.y,Ze.x+Ze.w,Ze.y,A,Jt,st.x,rt.y,We,mt),Zd(te,w.x,w.y,w.z,C.x,C.y,pt.x,pr+pt.y,Ze.x,Ze.y+Ze.h,A,Jt,rt.x,st.y,We,mt),Zd(te,w.x,w.y,w.z,C.x,C.y,tt.x,pr+tt.y,Ze.x+Ze.w,Ze.y+Ze.h,A,Jt,st.x,st.y,We,mt),$m(e.dynamicLayoutVertexArray,w,be),Z.emplaceBack(Nt,Nt+1,Nt+2),Z.emplaceBack(Nt+1,Nt+2,Nt+3),ce.vertexLength+=4,ce.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(wt[0]),Ie!==i.length-1&&Cr===i[Ie+1].sectionIndex||e.programConfigurations.populatePaintArrays(te.length,g,g.index,{},R,H,Be&&Be[Cr])}e.placedSymbolArray.emplaceBack(w.x,w.y,w.z,C.x,C.y,fe,this.glyphOffsetArray.length-fe,ve,I,T,C.segment,A?A[0]:0,A?A[1]:0,h[0],h[1],v,0,!1,0,S,0)}_commitLayoutVertex(e,i,A,h,f,g,v){e.emplaceBack(i,A,h,f,g,Math.round(v.x),Math.round(v.y))}_addCollisionDebugVertices(e,i,A,h,f,g,v){const w=A.segments.prepareSegment(4,A.layoutVertexArray,A.indexArray),C=w.vertexLength,I=v.tileAnchorX,T=v.tileAnchorY;for(let R=0;R<4;R++)A.collisionVertexArray.emplaceBack(0,0,0,0);A.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),A.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),A.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),A.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(A.layoutVertexArray,h,f,g,I,T,new L(e.x1,e.y1)),this._commitLayoutVertex(A.layoutVertexArray,h,f,g,I,T,new L(e.x2,e.y1)),this._commitLayoutVertex(A.layoutVertexArray,h,f,g,I,T,new L(e.x2,e.y2)),this._commitLayoutVertex(A.layoutVertexArray,h,f,g,I,T,new L(e.x1,e.y2)),w.vertexLength+=4;const S=A.indexArray;S.emplaceBack(C,C+1),S.emplaceBack(C+1,C+2),S.emplaceBack(C+2,C+3),S.emplaceBack(C+3,C),w.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,A,h,f,g){for(let v=h;v<f;v++){const w=A.get(v),C=this.getSymbolInstanceTextSize(e,g,i,v);this._addCollisionDebugVertices(w,C,this.textCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(e,i,A,h,f,g){for(let v=h;v<f;v++){const w=A.get(v),C=this.getSymbolInstanceIconSize(e,i,v);this._addCollisionDebugVertices(w,C,this.iconCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,g)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Jm(Hn,cv.members,Or),this.iconCollisionBox=new Jm(Hn,cv.members,Or);const A=Ql(this.iconSizeData,e),h=Ql(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const g=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(h,e,i,g.textBoxStartIndex,g.textBoxEndIndex,g),this._addTextDebugCollisionBoxes(h,e,i,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._addIconDebugCollisionBoxes(A,e,i,g.iconBoxStartIndex,g.iconBoxEndIndex,g),this._addIconDebugCollisionBoxes(A,e,i,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g)}}getSymbolInstanceTextSize(e,i,A,h){const f=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:h),g=zd(this.textSizeData,e,f)/Yn;return this.tilePixelRatio*g}getSymbolInstanceIconSize(e,i,A){const h=this.icon.placedSymbolArray.get(A),f=zd(this.iconSizeData,e,h);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(e,i,A){e.emplaceBack(i,-A,-A),e.emplaceBack(i,A,-A),e.emplaceBack(i,A,A),e.emplaceBack(i,-A,A)}_updateTextDebugCollisionBoxes(e,i,A,h,f,g){for(let v=h;v<f;v++){const w=A.get(v),C=this.getSymbolInstanceTextSize(e,g,i,v);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,C,w.padding)}}_updateIconDebugCollisionBoxes(e,i,A,h,f){for(let g=h;g<f;g++){const v=A.get(g),w=this.getSymbolInstanceIconSize(e,i,g);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,w,v.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const A=Ql(this.iconSizeData,e),h=Ql(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const g=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(h,e,i,g.textBoxStartIndex,g.textBoxEndIndex,g),this._updateTextDebugCollisionBoxes(h,e,i,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._updateIconDebugCollisionBoxes(A,e,i,g.iconBoxStartIndex,g.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(A,e,i,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,A,h,f,g,v,w,C){const I={};for(let T=i;T<A;T++){const S=e.get(T);I.textBox={x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,padding:S.padding,projectedAnchorX:S.projectedAnchorX,projectedAnchorY:S.projectedAnchorY,projectedAnchorZ:S.projectedAnchorZ,tileAnchorX:S.tileAnchorX,tileAnchorY:S.tileAnchorY},I.textFeatureIndex=S.featureIndex;break}for(let T=h;T<f;T++){const S=e.get(T);I.verticalTextBox={x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,padding:S.padding,projectedAnchorX:S.projectedAnchorX,projectedAnchorY:S.projectedAnchorY,projectedAnchorZ:S.projectedAnchorZ,tileAnchorX:S.tileAnchorX,tileAnchorY:S.tileAnchorY},I.verticalTextFeatureIndex=S.featureIndex;break}for(let T=g;T<v;T++){const S=e.get(T);I.iconBox={x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,padding:S.padding,projectedAnchorX:S.projectedAnchorX,projectedAnchorY:S.projectedAnchorY,projectedAnchorZ:S.projectedAnchorZ,tileAnchorX:S.tileAnchorX,tileAnchorY:S.tileAnchorY},I.iconFeatureIndex=S.featureIndex;break}for(let T=w;T<C;T++){const S=e.get(T);I.verticalIconBox={x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,padding:S.padding,projectedAnchorX:S.projectedAnchorX,projectedAnchorY:S.projectedAnchorY,projectedAnchorZ:S.projectedAnchorZ,tileAnchorX:S.tileAnchorX,tileAnchorY:S.tileAnchorY},I.verticalIconFeatureIndex=S.featureIndex;break}return I}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const A=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,A.textBoxStartIndex,A.textBoxEndIndex,A.verticalTextBoxStartIndex,A.verticalTextBoxEndIndex,A.iconBoxStartIndex,A.iconBoxEndIndex,A.verticalIconBoxStartIndex,A.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const A=e.placedSymbolArray.get(i),h=A.vertexStartIndex+4*A.numGlyphs;for(let f=A.vertexStartIndex;f<h;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),A=Math.cos(e),h=[],f=[],g=[];for(let v=0;v<this.symbolInstances.length;++v){g.push(v);const w=this.symbolInstances.get(v);h.push(0|Math.round(i*w.tileAnchorX+A*w.tileAnchorY)),f.push(w.featureIndex)}return g.sort((v,w)=>h[v]-h[w]||f[w]-f[v]),g}addToSortKeyRanges(e,i){const A=this.sortKeyRanges[this.sortKeyRanges.length-1];A&&A.sortKey===i?A.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const A=this.symbolInstances.get(i);this.featureSortOrder.push(A.featureIndex),[A.rightJustifiedTextSymbolIndex,A.centerJustifiedTextSymbolIndex,A.leftJustifiedTextSymbolIndex].forEach((h,f,g)=>{h>=0&&g.indexOf(h)===f&&this.addIndicesForPlacedSymbol(this.text,h)}),A.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,A.verticalPlacedTextSymbolIndex),A.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,A.placedIconSymbolIndex),A.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,A.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Bt("SymbolBucket",Ua,{omit:["layers","collisionBoxArray","features","compareText"]}),Ua.MAX_GLYPHS=65535,Ua.addDynamicAttributes=$m;const EF=new Ve({"symbol-placement":new J(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new J(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new J(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new he(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new J(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new J(xe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new J(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new J(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new J(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new he(xe.layout_symbol["icon-size"]),"icon-text-fit":new J(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new J(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new he(xe.layout_symbol["icon-image"]),"icon-rotate":new he(xe.layout_symbol["icon-rotate"]),"icon-padding":new J(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new J(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new he(xe.layout_symbol["icon-offset"]),"icon-anchor":new he(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new J(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new J(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new J(xe.layout_symbol["text-rotation-alignment"]),"text-field":new he(xe.layout_symbol["text-field"]),"text-font":new he(xe.layout_symbol["text-font"]),"text-size":new he(xe.layout_symbol["text-size"]),"text-max-width":new he(xe.layout_symbol["text-max-width"]),"text-line-height":new he(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new he(xe.layout_symbol["text-letter-spacing"]),"text-justify":new he(xe.layout_symbol["text-justify"]),"text-radial-offset":new he(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new J(xe.layout_symbol["text-variable-anchor"]),"text-anchor":new he(xe.layout_symbol["text-anchor"]),"text-max-angle":new J(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new J(xe.layout_symbol["text-writing-mode"]),"text-rotate":new he(xe.layout_symbol["text-rotate"]),"text-padding":new J(xe.layout_symbol["text-padding"]),"text-keep-upright":new J(xe.layout_symbol["text-keep-upright"]),"text-transform":new he(xe.layout_symbol["text-transform"]),"text-offset":new he(xe.layout_symbol["text-offset"]),"text-allow-overlap":new J(xe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new J(xe.layout_symbol["text-ignore-placement"]),"text-optional":new J(xe.layout_symbol["text-optional"])});var Ym={paint:new Ve({"icon-opacity":new he(xe.paint_symbol["icon-opacity"]),"icon-color":new he(xe.paint_symbol["icon-color"]),"icon-halo-color":new he(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new he(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new he(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new J(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new J(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new he(xe.paint_symbol["text-opacity"]),"text-color":new he(xe.paint_symbol["text-color"],{runtimeType:kr,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new he(xe.paint_symbol["text-halo-color"]),"text-halo-width":new he(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new he(xe.paint_symbol["text-halo-blur"]),"text-translate":new J(xe.paint_symbol["text-translate"]),"text-translate-anchor":new J(xe.paint_symbol["text-translate-anchor"])}),layout:EF};class Pv{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:cn,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Bt("FormatSectionOverride",Pv,{omit:["defaultValue"]});class Xd extends qo{constructor(e){super(e,Ym)}recalculate(e,i){super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const A=this.layout.get("text-writing-mode");if(A){const h=[];for(const f of A)h.indexOf(f)<0&&h.push(f);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,A,h){const f=this.layout.get(e).evaluate(i,{},A,h),g=this._unevaluatedLayout._values[e];return g.isDataDriven()||Ao(g.value)||!f?f:function(v,w){return w.replace(/{([^{}]+)}/g,(C,I)=>I in v?String(v[I]):"")}(i.properties,f)}createBucket(e){return new Ua(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Ym.paint.overridableProperties){if(!Xd.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),A=new Pv(i),h=new Rc(A,i.property.specification);let f=null;f=i.value.kind==="constant"||i.value.kind==="source"?new ms("source",h):new cl("composite",h,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new Ae(i.property,f,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,A){return!(!this.layout||i.isDataDriven()||A.isDataDriven())&&Xd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const A=e.get("text-field"),h=Ym.paint.properties[i];let f=!1;const g=v=>{for(const w of v)if(h.overrides&&h.overrides.hasOverride(w))return void(f=!0)};if(A.value.kind==="constant"&&A.value.value instanceof un)g(A.value.value.sections);else if(A.value.kind==="source"){const v=C=>{f||(C instanceof ao&&Ur(C.value)===xo?g(C.value.sections):C instanceof Bo?g(C.sections):C.eachChild(v))},w=A.value;w._styleExpression&&v(w._styleExpression.expression)}return f}getProgramConfiguration(e){return new js(this,e)}}var FF={paint:new Ve({"background-color":new J(xe.paint_background["background-color"]),"background-pattern":new De(xe.paint_background["background-pattern"]),"background-opacity":new J(xe.paint_background["background-opacity"])})},IF={paint:new Ve({"raster-opacity":new J(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new J(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new J(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new J(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new J(xe.paint_raster["raster-saturation"]),"raster-contrast":new J(xe.paint_raster["raster-contrast"]),"raster-resampling":new J(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new J(xe.paint_raster["raster-fade-duration"])})};class TF extends qo{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var UF={paint:new Ve({"sky-type":new J(xe.paint_sky["sky-type"]),"sky-atmosphere-sun":new J(xe.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new J(xe.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new J(xe.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new J(xe.paint_sky["sky-gradient-radius"]),"sky-gradient":new Le(xe.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new J(xe.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new J(xe.paint_sky["sky-atmosphere-color"]),"sky-opacity":new J(xe.paint_sky["sky-opacity"])})};function eg(n,e,i){const A=Tl(0,0,1),h=V0(Im());return function(f,g,v){v*=.5;var w=g[0],C=g[1],I=g[2],T=g[3],S=Math.sin(v),R=Math.cos(v);f[0]=w*R-I*S,f[1]=C*R+T*S,f[2]=I*R+w*S,f[3]=T*R-C*S}(h,h,i?-K(n)+Math.PI:K(n)),K0(h,h,-K(e)),N0(A,A,h),H0(A,A)}const SF={circle:class extends qo{constructor(n){super(n,$C)}createBucket(n){return new bm(n)}queryRadius(n){const e=n;return Il("circle-radius",this,e)+Il("circle-stroke-width",this,e)+Sd(this.paint.get("circle-translate"))}queryIntersectsFeature(n,e,i,A,h,f,g,v){const w=L0(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),C=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return j0(n,A,f,g,v,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",w,C)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new js(this,n)}},heatmap:class extends qo{createBucket(n){return new X0(n)}constructor(n){super(n,iE),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Sm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return Il("heatmap-radius",this,n)}queryIntersectsFeature(n,e,i,A,h,f,g,v){const w=this.paint.get("heatmap-radius").evaluate(e,i);return j0(n,A,f,g,v,!0,!0,new L(0,0),w)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new js(this,n)}},hillshade:class extends qo{constructor(n){super(n,oE)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(n){return new js(this,n)}},fill:class extends qo{constructor(n){super(n,wE)}getProgramIds(){const n=this.paint.get("fill-pattern"),e=n&&n.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(n){return new js(this,n)}recalculate(n,e){super.recalculate(n,e);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new Od(n)}queryRadius(){return Sd(this.paint.get("fill-translate"))}queryIntersectsFeature(n,e,i,A,h,f){return!n.queryGeometry.isAboveHorizon&&T0(M0(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),A)}isTileClipped(){return!0}},"fill-extrusion":class extends qo{constructor(n){super(n,ME)}createBucket(n){return new Om(n)}queryRadius(){return Sd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new js(this,n)}queryIntersectsFeature(n,e,i,A,h,f,g,v,w){const C=L0(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),I=this.paint.get("fill-extrusion-height").evaluate(e,i),T=this.paint.get("fill-extrusion-base").evaluate(e,i),S=[0,0],R=v&&f.elevation,H=f.elevation?f.elevation.exaggeration():1;if(R){const ce=n.tile.getBucket(this).centroidVertexArray,fe=w+1;if(fe<ce.length){const ve=ce.get(fe);S[0]=ve.a_centroid_pos0,S[1]=ve.a_centroid_pos1}}if(S[0]===0&&S[1]===1)return!1;const Z=function(ce,fe,ve,be,Be,Ie,je,Oe,pt){return Ie?function(tt,Ze,rt,st,We,mt,wt,Jt,Cr){const Nt=[],pr=[],gt=[0,0,0,1];for(const Er of tt){const ur=[],pn=[];for(const mn of Er){const bn=mn.x+st.x,Kn=mn.y+st.y,vr=LE(bn,Kn,Ze,rt,mt,wt,Jt,Cr);gt[0]=bn,gt[1]=Kn,gt[2]=vr.base,gt[3]=1,su(gt,gt,We),gt[3]=Math.max(gt[3],1e-5);const mr=sv([gt[0]/gt[3],gt[1]/gt[3],gt[2]/gt[3]]);gt[0]=bn,gt[1]=Kn,gt[2]=vr.top,gt[3]=1,su(gt,gt,We),gt[3]=Math.max(gt[3],1e-5);const Hr=sv([gt[0]/gt[3],gt[1]/gt[3],gt[2]/gt[3]]);ur.push(mr),pn.push(Hr)}Nt.push(ur),pr.push(pn)}return[Nt,pr]}(ce,fe,ve,be,Be,Ie,je,Oe,pt):function(tt,Ze,rt,st,We){const mt=[],wt=[],Jt=We[8]*Ze,Cr=We[9]*Ze,Nt=We[10]*Ze,pr=We[11]*Ze,gt=We[8]*rt,Er=We[9]*rt,ur=We[10]*rt,pn=We[11]*rt;for(const mn of tt){const bn=[],Kn=[];for(const vr of mn){const mr=vr.x+st.x,Hr=vr.y+st.y,ei=We[0]*mr+We[4]*Hr+We[12],gn=We[1]*mr+We[5]*Hr+We[13],Sn=We[2]*mr+We[6]*Hr+We[14],ti=We[3]*mr+We[7]*Hr+We[15],Zr=ei+Jt,zi=gn+Cr,Fr=Sn+Nt,yn=Math.max(ti+pr,1e-5),_n=ei+gt,an=gn+Er,en=Sn+ur,Cn=Math.max(ti+pn,1e-5),Ir=new L(Zr/yn,zi/yn);Ir.z=Fr/yn,bn.push(Ir);const li=new L(_n/Cn,an/Cn);li.z=en/Cn,Kn.push(li)}mt.push(bn),wt.push(Kn)}return[mt,wt]}(ce,fe,ve,be,Be)}(A,T,I,C,g,R?v:null,S,H,f.center.lat),te=n.queryGeometry;return function(ce,fe,ve){let be=1/0;T0(ve,fe)&&(be=ov(ve,fe[0]));for(let Be=0;Be<fe.length;Be++){const Ie=fe[Be],je=ce[Be];for(let Oe=0;Oe<Ie.length-1;Oe++){const pt=Ie[Oe],tt=[pt,Ie[Oe+1],je[Oe+1],je[Oe],pt];I0(ve,tt)&&(be=Math.min(be,ov(ve,tt)))}}return be!==1/0&&be}(Z[0],Z[1],te.isPointQuery()?te.screenBounds:te.screenGeometry)}},line:class extends qo{constructor(n){super(n,av),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof wr,this.gradientVersion=(this.gradientVersion+1)%ie}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,e){super.recalculate(n,e),this.paint._values["line-floorwidth"]=Av.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new Rd(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new js(this,n)}queryRadius(n){const e=n,i=lv(Il("line-width",this,e),Il("line-gap-width",this,e)),A=Il("line-offset",this,e);return i/2+Math.abs(A)+Sd(this.paint.get("line-translate"))}queryIntersectsFeature(n,e,i,A,h,f){if(n.queryGeometry.isAboveHorizon)return!1;const g=M0(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),v=n.pixelToTileUnitsFactor/2*lv(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),w=this.paint.get("line-offset").evaluate(e,i);return w&&(A=function(C,I){const T=[],S=new L(0,0);for(let R=0;R<C.length;R++){const H=C[R],Z=[];for(let te=0;te<H.length;te++){const ce=H[te-1],fe=H[te],ve=H[te+1],be=te===0?S:fe.sub(ce)._unit()._perp(),Be=te===H.length-1?S:ve.sub(fe)._unit()._perp(),Ie=be._add(Be)._unit();Ie._mult(1/(Ie.x*Be.x+Ie.y*Be.y)),Z.push(Ie._mult(I)._add(fe))}T.push(Z)}return T}(A,w*n.pixelToTileUnitsFactor)),function(C,I,T){for(let S=0;S<I.length;S++){const R=I[S];if(C.length>=3){for(let H=0;H<R.length;H++)if(Fl(C,R[H]))return!0}if(jC(C,R,T))return!0}return!1}(g,A,v)}isTileClipped(){return!0}},symbol:Xd,background:class extends qo{constructor(n){super(n,FF)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends qo{constructor(n){super(n,IF)}getProgramIds(){return["raster"]}},sky:class extends qo{constructor(n){super(n,UF),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="sky-gradient"?this._updateColorRamp():n!=="sky-atmosphere-sun"&&n!=="sky-atmosphere-halo-color"&&n!=="sky-atmosphere-color"&&n!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Sm({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(n,e){const i=this.paint.get("sky-type");if(i==="atmosphere"){const A=this.paint.get("sky-atmosphere-sun"),h=!A,f=n.style.light,g=f.properties.get("position");return h&&f.properties.get("anchor")==="viewport"&&ke("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?eg(g.azimuthal,90-g.polar,e):eg(A[0],90-A[1],e)}if(i==="gradient"){const A=this.paint.get("sky-gradient-center");return eg(A[0],90-A[1],e)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return n==="atmosphere"?["skyboxCapture","skybox"]:n==="gradient"?["skyboxGradient"]:null}}},{HTMLImageElement:Ov,HTMLCanvasElement:Rv,HTMLVideoElement:zv,ImageData:Hv,ImageBitmap:Wd}=V;class $d{constructor(e,i,A,h){this.context=e,this.format=A,this.texture=e.gl.createTexture(),this.update(i,h)}update(e,i,A){const{width:h,height:f}=e,{context:g}=this,{gl:v}=g;if(v.bindTexture(v.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!i||i.premultiply!==!1)),A||this.size&&this.size[0]===h&&this.size[1]===f){const{x:w,y:C}=A||{x:0,y:0};e instanceof Ov||e instanceof Rv||e instanceof zv||e instanceof Hv||Wd&&e instanceof Wd?v.texSubImage2D(v.TEXTURE_2D,0,w,C,v.RGBA,v.UNSIGNED_BYTE,e):v.texSubImage2D(v.TEXTURE_2D,0,w,C,h,f,v.RGBA,v.UNSIGNED_BYTE,e.data)}else this.size=[h,f],e instanceof Ov||e instanceof Rv||e instanceof zv||e instanceof Hv||Wd&&e instanceof Wd?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,e):v.texImage2D(v.TEXTURE_2D,0,this.format,h,f,0,this.format,v.UNSIGNED_BYTE,e.data);this.useMipmap=!!(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(e,i){const{context:A}=this,{gl:h}=A;h.bindTexture(h.TEXTURE_2D,this.texture),e!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?e===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:e),this.filter=e),i!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class tg{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new Ea({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const A=this.getKey(e,i);return this.positions[A]}trim(){const e=this.width,i=this.height=At(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,A){const h=[];let f=e.length%2==1?-e[e.length-1]*A:0,g=e[0]*A,v=!0;h.push({left:f,right:g,isDash:v,zeroLength:e[0]===0});let w=e[0];for(let C=1;C<e.length;C++){v=!v;const I=e[C];f=w*A,w+=I,g=w*A,h.push({left:f,right:g,isDash:v,zeroLength:I===0})}return h}addRoundDash(e,i,A){const h=i/2;for(let f=-A;f<=A;f++){const g=this.width*(this.nextRow+A+f);let v=0,w=e[v];for(let C=0;C<this.width;C++){C/w.right>1&&(w=e[++v]);const I=Math.abs(C-w.left),T=Math.abs(C-w.right),S=Math.min(I,T);let R;const H=f/A*(h+1);if(w.isDash){const Z=h-Math.abs(H);R=Math.sqrt(S*S+Z*Z)}else R=h-Math.sqrt(S*S+H*H);this.image.data[g+C]=Math.max(0,Math.min(255,R+128))}}}addRegularDash(e,i){for(let w=e.length-1;w>=0;--w){const C=e[w],I=e[w+1];C.zeroLength?e.splice(w,1):I&&I.isDash===C.isDash&&(I.left=C.left,e.splice(w,1))}const A=e[0],h=e[e.length-1];A.isDash===h.isDash&&(A.left=h.left-this.width,h.right=A.right+this.width);const f=this.width*this.nextRow;let g=0,v=e[g];for(let w=0;w<this.width;w++){w/v.right>1&&(v=e[++g]);const C=Math.abs(w-v.left),I=Math.abs(w-v.right),T=Math.min(C,I);this.image.data[f+w]=Math.max(0,Math.min(255,(v.isDash?T:-T)+i+128))}}addDash(e,i){const A=this.getKey(e,i);if(this.positions[A])return this.positions[A];const h=i==="round",f=h?7:0,g=2*f+1;if(this.nextRow+g>this.height)return ke("LineAtlas out of space"),null;e.length===0&&e.push(1);let v=0;for(let I=0;I<e.length;I++)e[I]<0&&(ke("Negative value is found in line dasharray, replacing values with 0"),e[I]=0),v+=e[I];if(v!==0){const I=this.width/v,T=this.getDashRanges(e,this.width,I);h?this.addRoundDash(T,I,f):this.addRegularDash(T,i==="square"?.5*I:0)}const w=this.nextRow+f;this.nextRow+=g;const C={tl:[w,f],br:[v,0]};return this.positions[A]=C,C}}Bt("LineAtlas",tg);class QF{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const MF=V.performance;function Nv(n){const e=n?n.url.toString():void 0;return MF.getEntriesByName(e)}class LF{constructor(){this.tasks={},this.taskQueue=[],It(["process"],this),this.invoker=new QF(this.process),this.nextId=0}add(e,i){const A=this.nextId++,h=function({type:f,isSymbolTile:g,zoom:v}){return v=v||0,f==="message"?0:f!=="maybePrepare"||g?f!=="parseTile"||g?f==="parseTile"&&g?300-v:f==="maybePrepare"&&g?400-v:500:200-v:100-v}(i);if(h===0){ot();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[A]={fn:e,metadata:i,priority:h,id:A},this.taskQueue.push(A),this.invoker.trigger(),{cancel:()=>{delete this.tasks[A]}}}process(){ot();try{if(this.taskQueue=this.taskQueue.filter(A=>!!this.tasks[A]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let h=0;h<this.taskQueue.length;h++){const f=this.tasks[this.taskQueue[h]];f.priority<i&&(i=f.priority,e=h)}if(e===null)return null;const A=this.taskQueue[e];return this.taskQueue.splice(e,1),A}remove(){this.invoker.remove()}}function qd(n,e){const i=Math.pow(2,-n.z),A=n.x*i,h=(n.x+1)*i,f=n.y*i,g=(n.y+1)*i;if(e.name==="mercator")return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:e};const v=UA(A),w=UA(h),C=ws(f),I=ws(g),T=e.project(v,C),S=e.project(w,C),R=e.project(w,I),H=e.project(v,I);let Z=Math.min(T.x,S.x,R.x,H.x),te=Math.min(T.y,S.y,R.y,H.y),ce=Math.max(T.x,S.x,R.x,H.x),fe=Math.max(T.y,S.y,R.y,H.y);const ve=i/16;function be(Ie,je,Oe,pt,tt,Ze){const rt=(Oe+tt)/2,st=(pt+Ze)/2,We=e.project(UA(rt),ws(st)),mt=Math.max(0,Z-We.x,te-We.y,We.x-ce,We.y-fe);Z=Math.min(Z,We.x),ce=Math.max(ce,We.x),te=Math.min(te,We.y),fe=Math.max(fe,We.y),mt>ve&&(be(Ie,We,Oe,pt,rt,st),be(We,je,rt,st,tt,Ze))}be(T,S,A,f,h,f),be(S,R,h,f,h,g),be(R,H,h,g,A,g),be(H,T,A,g,A,f),Z-=ve,te-=ve,ce+=ve,fe+=ve;const Be=1/Math.max(ce-Z,fe-te);return{scale:Be,x:Z*Be,y:te*Be,x2:ce*Be,y2:fe*Be,projection:e}}function Vv(n,e,i){var A=2*Math.PI*6378137/256/Math.pow(2,i);return[n*A-2*Math.PI*6378137/2,e*A-2*Math.PI*6378137/2]}class rg{constructor(e,i,A){this.z=e,this.x=i,this.y=A,this.key=gu(0,e,e,i,A)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const A=(f=this.y,g=this.z,v=Vv(256*(h=this.x),256*(f=Math.pow(2,g)-f-1),g),w=Vv(256*(h+1),256*(f+1),g),v[0]+","+v[1]+","+w[0]+","+w[1]);var h,f,g,v,w;const C=function(I,T,S){let R,H="";for(let Z=I;Z>0;Z--)R=1<<Z-1,H+=(T&R?1:0)+(S&R?2:0);return H}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",C).replace("{bbox-epsg-3857}",A)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Kv{constructor(e,i){this.wrap=e,this.canonical=i,this.key=gu(e,i.z,i.z,i.x,i.y)}}class Ri{constructor(e,i,A,h,f){this.overscaledZ=e,this.wrap=i,this.canonical=new rg(A,+h,+f),this.key=i===0&&e===A?this.canonical.key:gu(i,e,A,h,f)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new Ri(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ri(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return gu(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const A=this.canonical.z-e;return gu(this.wrap*+i,e,e,this.canonical.x>>A,this.canonical.y>>A)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Ri(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,A=2*this.canonical.x,h=2*this.canonical.y;return[new Ri(i,this.wrap,i,A,h),new Ri(i,this.wrap,i,A+1,h),new Ri(i,this.wrap,i,A,h+1),new Ri(i,this.wrap,i,A+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ri(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ri(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Kv(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function gu(n,e,i,A,h){const f=1<<Math.min(i,22);let g=f*(h%f)+A%f;return n&&i<22&&(g+=f*f*((n<0?-2*n-1:2*n)%(1<<2*(22-i)))),16*(32*g+i)+(e-i)}Bt("CanonicalTileID",rg),Bt("OverscaledTileID",Ri,{omit:["projMatrix"]});class Gv{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const A=e[i];this._stringToNumber[A]=i,this._numberToString[i]=A}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}class jv{constructor(e,i,A,h,f){this.type="Feature",this._vectorTileFeature=e,e._z=i,e._x=A,e._y=h,this.properties=e.properties,this.id=f}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&(e[i]=this[i]);return e}}var DF=Qe([{name:"a_pos",type:"Int16",components:2}]);const Uo=32,bs=33,Sa=new Uint16Array(8184);for(let n=0;n<2046;n++){let e=n+2,i=0,A=0,h=0,f=0,g=0,v=0;for(1&e?h=f=g=Uo:i=A=v=Uo;(e>>=1)>1;){const C=i+h>>1,I=A+f>>1;1&e?(h=i,f=A,i=g,A=v):(i=h,A=f,h=g,f=v),g=C,v=I}const w=4*n;Sa[w+0]=i,Sa[w+1]=A,Sa[w+2]=h,Sa[w+3]=f}const Cs=new Uint16Array(2178),Qa=new Uint8Array(1089),Jd=new Uint16Array(1089);function Zv(n){return n===0?-.03125:n===32?.03125:0}var ng=Qe([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Xv={type:2,extent:lr,loadGeometry:()=>[[new L(0,0),new L(8193,0),new L(8193,8193),new L(0,8193),new L(0,0)]]};class Wv{constructor(e,i,A,h,f){this.tileID=e,this.uid=Xe(),this.uses=0,this.tileSize=i,this.tileZoom=A,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<dr.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=qd(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,A){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,f){const g={};if(!f)return g;for(const v of h){const w=v.layerIds.map(C=>f.getLayer(C)).filter(Boolean);if(w.length!==0){v.layers=w,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map(C=>w.filter(I=>I.id===C)[0]));for(const C of w)g[C.id]=v}}return g}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const f=this.buckets[h];if(f instanceof Ua){if(this.hasSymbolBuckets=!0,!A)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const f=this.buckets[h];if(f instanceof Ua&&f.hasRTLText){this.hasRTLText=!0,k.isLoading()||k.isLoaded()||U()!=="deferred"||D();break}}this.queryPadding=0;for(const h in this.buckets){const f=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(h).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new vi}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const A in this.buckets){const h=this.buckets[A];h.uploadPending()&&h.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new $d(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new $d(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new $d(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,A,h,f,g,v,w){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:v,transform:g,params:f,tileTransform:this.tileTransform},e,i,A):{}}querySourceFeatures(e,i){const A=this.latestFeatureIndex;if(!A||!A.rawTileData)return;const h=A.loadVTLayers(),f=i?i.sourceLayer:"",g=h._geojsonTileLayer||h[f];if(!g)return;const v=fA(i&&i.filter),{z:w,x:C,y:I}=this.tileID.canonical,T={z:w,x:C,y:I};for(let S=0;S<g.length;S++){const R=g.feature(S);if(v.needGeometry){const te=SA(R,!0);if(!v.filter(new P(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!v.filter(new P(this.tileID.overscaledZ),R))continue;const H=A.getId(R,f),Z=new jv(R,w,C,I,H);Z.tile=T,e.push(Z)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const A=vt(e.cacheControl);A["max-age"]&&(this.expirationTime=Date.now()+1e3*A["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const A=Date.now();let h=!1;if(this.expirationTime>A)h=!1;else if(i)if(this.expirationTime<i)h=!0;else{const f=this.expirationTime-i;f?this.expirationTime=A+Math.max(f,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!i)return;const A=this.latestFeatureIndex.loadVTLayers(),h=i.style.listImages();for(const f in this.buckets){if(!i.style.hasLayer(f))continue;const g=this.buckets[f],v=g.layers[0].sourceLayer||"_geojsonTileLayer",w=A[v],C=e[v];if(!w||!C||Object.keys(C).length===0)continue;if(g.update(C,w,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),g instanceof Rd||g instanceof Od){const T=i.style._getSourceCache(g.layers[0].source);i._terrain&&i._terrain.enabled&&T&&g.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(T.id,this.tileID)}const I=i&&i.style&&i.style.getLayer(f);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<dr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=dr.now()+e}setDependencies(e,i){const A={};for(const h of i)A[h]=!0;this.dependencies[e]=A}hasDependency(e,i){for(const A of e){const h=this.dependencies[A];if(h){for(const f of i)if(h[f])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const A=Zs(Xv,this.tileID.canonical,this.tileTransform)[0],h=new bt,f=new Nn;for(let g=0;g<A.length;g++){const{x:v,y:w}=A[g];h.emplaceBack(v,w),f.emplaceBack(g)}f.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(h,ng.members),this._tileDebugSegments=Vn.simpleSegment(0,0,h.length,f.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const A=Zs(Xv,this.tileID.canonical,this.tileTransform)[0];let h,f;if(this.isRaster){const g=function(v,w){const C=qd(v,w),I=Math.pow(2,v.z);for(let te=0;te<bs;te++)for(let ce=0;ce<bs;ce++){const fe=UA((v.x+(ce+Zv(ce))/Uo)/I),ve=ws((v.y+(te+Zv(te))/Uo)/I),be=w.project(fe,ve),Be=te*bs+ce;Cs[2*Be+0]=Math.round((be.x*C.scale-C.x)*lr),Cs[2*Be+1]=Math.round((be.y*C.scale-C.y)*lr)}Qa.fill(0),Jd.fill(0);for(let te=2045;te>=0;te--){const ce=4*te,fe=Sa[ce+0],ve=Sa[ce+1],be=Sa[ce+2],Be=Sa[ce+3],Ie=fe+be>>1,je=ve+Be>>1,Oe=Ie+je-ve,pt=je+fe-Ie,tt=ve*bs+fe,Ze=Be*bs+be,rt=je*bs+Ie,st=Math.hypot((Cs[2*tt+0]+Cs[2*Ze+0])/2-Cs[2*rt+0],(Cs[2*tt+1]+Cs[2*Ze+1])/2-Cs[2*rt+1])>=16;if(Qa[rt]=Qa[rt]||(st?1:0),te<1022){const We=(ve+pt>>1)*bs+(fe+Oe>>1),mt=(Be+pt>>1)*bs+(be+Oe>>1);Qa[rt]=Qa[rt]||Qa[We]||Qa[mt]}}const T=new Pt,S=new fn;let R=0;function H(te,ce){const fe=ce*bs+te;return Jd[fe]===0&&(T.emplaceBack(Cs[2*fe+0],Cs[2*fe+1],te*lr/Uo,ce*lr/Uo),Jd[fe]=++R),Jd[fe]-1}function Z(te,ce,fe,ve,be,Be){const Ie=te+fe>>1,je=ce+ve>>1;if(Math.abs(te-be)+Math.abs(ce-Be)>1&&Qa[je*bs+Ie])Z(be,Be,te,ce,Ie,je),Z(fe,ve,be,Be,Ie,je);else{const Oe=H(te,ce),pt=H(fe,ve),tt=H(be,Be);S.emplaceBack(Oe,pt,tt)}}return Z(0,0,Uo,Uo,Uo,0),Z(Uo,Uo,0,0,0,Uo),{vertices:T,indices:S}}(this.tileID.canonical,i);h=g.vertices,f=g.indices}else{h=new Pt,f=new fn;for(const{x:v,y:w}of A)h.emplaceBack(v,w,0,0);const g=Md(h.int16,void 0,4);for(let v=0;v<g.length;v+=3)f.emplaceBack(g[v],g[v+1],g[v+2])}this._tileBoundsBuffer=e.createVertexBuffer(h,ng.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(f),this._tileBoundsSegments=Vn.simpleSegment(0,0,h.length,f.length)}}class kF{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,A){const h=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},qe(this.stateChanges[e][h],A),this.deletedStates[e]===null){this.deletedStates[e]={};for(const f in this.state[e])f!==h&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const f in this.state[e][h])A[f]||(this.deletedStates[e][h][f]=null)}else for(const f in A)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][f]===null&&delete this.deletedStates[e][h][f]}removeFeatureState(e,i,A){if(this.deletedStates[e]===null)return;const h=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},A&&i!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][A]=null);else if(i!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(A in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][A]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,i){const A=String(i),h=qe({},(this.state[e]||{})[A],(this.stateChanges[e]||{})[A]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const f=this.deletedStates[e][i];if(f===null)return{};for(const g in f)delete h[g]}return h}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const A={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const f={};for(const g in this.stateChanges[h])this.state[h][g]||(this.state[h][g]={}),qe(this.state[h][g],this.stateChanges[h][g]),f[g]=this.state[h][g];A[h]=f}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const f={};if(this.deletedStates[h]===null)for(const g in this.state[h])f[g]={},this.state[h][g]={};else for(const g in this.deletedStates[h]){if(this.deletedStates[h][g]===null)this.state[h][g]={};else for(const v of Object.keys(this.deletedStates[h][g]))delete this.state[h][g][v];f[g]=this.state[h][g]}A[h]=A[h]||{},qe(A[h],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(A).length!==0)for(const h in e)e[h].setFeatureState(A,i)}}class $v{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const A=this.toIdx(e,i);return{min:this.minimums[A],max:this.maximums[A]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function qv(n,e,i,A){let h=0,f=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(A[g])<1e-15){if(i[g]<n[g]||i[g]>e[g])return null}else{const v=1/A[g];let w=(n[g]-i[g])*v,C=(e[g]-i[g])*v;if(w>C){const I=w;w=C,C=I}if(w>h&&(h=w),C<f&&(f=C),h>f)return null}return h}function Jv(n,e,i,A,h,f,g,v,w,C,I){const T=A-n,S=h-e,R=f-i,H=g-n,Z=v-e,te=w-i,ce=I[1]*te-I[2]*Z,fe=I[2]*H-I[0]*te,ve=I[0]*Z-I[1]*H,be=T*ce+S*fe+R*ve;if(Math.abs(be)<1e-15)return null;const Be=1/be,Ie=C[0]-n,je=C[1]-e,Oe=C[2]-i,pt=(Ie*ce+je*fe+Oe*ve)*Be;if(pt<0||pt>1)return null;const tt=je*R-Oe*S,Ze=Oe*T-Ie*R,rt=Ie*S-je*T,st=(I[0]*tt+I[1]*Ze+I[2]*rt)*Be;return st<0||pt+st>1?null:(H*tt+Z*Ze+te*rt)*Be}function Yv(n,e,i){return(n-e)/(i-e)}function ex(n,e,i,A,h,f,g,v,w){const C=1<<i,I=f-A,T=g-h,S=(n+1)/C*I+A,R=(e+0)/C*T+h,H=(e+1)/C*T+h;v[0]=(n+0)/C*I+A,v[1]=R,w[0]=S,w[1]=H}class tx{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(f){const g=Math.ceil(Math.log2(f.dim/8)),v=[];let w=Math.ceil(Math.pow(2,g));const C=1/w,I=(R,H,Z,te,ce)=>{const fe=te?1:0,ve=(R+1)*Z-fe,be=H*Z,Be=(H+1)*Z-fe;ce[0]=R*Z,ce[1]=be,ce[2]=ve,ce[3]=Be};let T=new $v(w);const S=[];for(let R=0;R<w*w;R++){I(R%w,Math.floor(R/w),C,!1,S);const H=Ma(S[0],S[1],f),Z=Ma(S[2],S[1],f),te=Ma(S[2],S[3],f),ce=Ma(S[0],S[3],f);T.minimums.push(Math.min(H,Z,te,ce)),T.maximums.push(Math.max(H,Z,te,ce)),T.leaves.push(1)}for(v.push(T),w/=2;w>=1;w/=2){const R=v[v.length-1];T=new $v(w);for(let H=0;H<w*w;H++){I(H%w,Math.floor(H/w),2,!0,S);const Z=R.getElevation(S[0],S[1]),te=R.getElevation(S[2],S[1]),ce=R.getElevation(S[2],S[3]),fe=R.getElevation(S[0],S[3]),ve=R.isLeaf(S[0],S[1]),be=R.isLeaf(S[2],S[1]),Be=R.isLeaf(S[2],S[3]),Ie=R.isLeaf(S[0],S[3]),je=Math.min(Z.min,te.min,ce.min,fe.min),Oe=Math.max(Z.max,te.max,ce.max,fe.max),pt=ve&&be&&Be&&Ie;T.maximums.push(Oe),T.minimums.push(je),T.leaves.push(Oe-je<=5&&pt?1:0)}v.push(T)}return v}(this.dem),A=i.length-1,h=i[A];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(i,0,0,A,0)}raycastRoot(e,i,A,h,f,g,v=1){return qv([e,i,-100],[A,h,this.maximums[0]*v],f,g)}raycast(e,i,A,h,f,g,v=1){if(!this.nodeCount)return null;const w=this.raycastRoot(e,i,A,h,f,g,v);if(w==null)return null;const C=[],I=[],T=[],S=[],R=[{idx:0,t:w,nodex:0,nodey:0,depth:0}];for(;R.length>0;){const{idx:H,t:Z,nodex:te,nodey:ce,depth:fe}=R.pop();if(this.leaves[H]){ex(te,ce,fe,e,i,A,h,T,S);const be=1<<fe,Be=(te+0)/be,Ie=(te+1)/be,je=(ce+0)/be,Oe=(ce+1)/be,pt=Ma(Be,je,this.dem)*v,tt=Ma(Ie,je,this.dem)*v,Ze=Ma(Ie,Oe,this.dem)*v,rt=Ma(Be,Oe,this.dem)*v,st=Jv(T[0],T[1],pt,S[0],T[1],tt,S[0],S[1],Ze,f,g),We=Jv(S[0],S[1],Ze,T[0],S[1],rt,T[0],T[1],pt,f,g),mt=Math.min(st!==null?st:Number.MAX_VALUE,We!==null?We:Number.MAX_VALUE);if(mt!==Number.MAX_VALUE)return mt;{const wt=z0([],f,g,Z);if(rx(pt,tt,rt,Ze,Yv(wt[0],T[0],S[0]),Yv(wt[1],T[1],S[1]))>=wt[2])return Z}continue}let ve=0;for(let be=0;be<this._siblingOffset.length;be++){ex((te<<1)+this._siblingOffset[be][0],(ce<<1)+this._siblingOffset[be][1],fe+1,e,i,A,h,T,S),T[2]=-100,S[2]=this.maximums[this.childOffsets[H]+be]*v;const Be=qv(T,S,f,g);if(Be!=null){const Ie=Be;C[be]=Ie;let je=!1;for(let Oe=0;Oe<ve&&!je;Oe++)Ie>=C[I[Oe]]&&(I.splice(Oe,0,be),je=!0);je||(I[ve]=be),ve++}}for(let be=0;be<ve;be++){const Be=I[be];R.push({idx:this.childOffsets[H]+Be,t:C[Be],nodex:(te<<1)+this._siblingOffset[Be][0],nodey:(ce<<1)+this._siblingOffset[Be][1],depth:fe+1})}}return null}_addNode(e,i,A){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(A),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,A,h,f){if(e[h].isLeaf(i,A)===1)return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const g=h-1,v=e[g];let w,C=0;for(let I=0;I<this._siblingOffset.length;I++){const T=2*i+this._siblingOffset[I][0],S=2*A+this._siblingOffset[I][1],R=v.getElevation(T,S),H=v.isLeaf(T,S),Z=this._addNode(R.min,R.max,H);H&&(C|=1<<I),w||(w=Z)}for(let I=0;I<this._siblingOffset.length;I++)C&1<<I||this._construct(e,2*i+this._siblingOffset[I][0],2*A+this._siblingOffset[I][1],g,w+I)}}function rx(n,e,i,A,h,f){return Xt(Xt(n,i,f),Xt(e,A,f),h)}function Ma(n,e,i){const A=i.dim,h=Ue(n*A-.5,0,A-1),f=Ue(e*A-.5,0,A-1),g=Math.floor(h),v=Math.floor(f),w=Math.min(g+1,A-1),C=Math.min(v+1,A-1);return rx(i.get(g,v),i.get(w,v),i.get(g,C),i.get(w,C),h-g,f-v)}const nx={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Yd{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,A,h=!1,f=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(A&&A!=="mapbox"&&A!=="terrarium")return ke(`"${A}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const g=this.dim=i.height-2;if(this.data=new Uint32Array(i.data.buffer),this.encoding=A||"mapbox",this.borderReady=h,!h){for(let v=0;v<g;v++)this.data[this._idx(-1,v)]=this.data[this._idx(0,v)],this.data[this._idx(g,v)]=this.data[this._idx(g-1,v)],this.data[this._idx(v,-1)]=this.data[this._idx(v,0)],this.data[this._idx(v,g)]=this.data[this._idx(v,g-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(g,-1)]=this.data[this._idx(g-1,0)],this.data[this._idx(-1,g)]=this.data[this._idx(0,g-1)],this.data[this._idx(g,g)]=this.data[this._idx(g-1,g-1)],f&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new tx(this)}get(e,i,A=!1){const h=new Uint8Array(this.data.buffer);A&&(e=Ue(e,-1,this.dim),i=Ue(i,-1,this.dim));const f=4*this._idx(e,i);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(h[f],h[f+1],h[f+2])}static getUnpackVector(e){return nx[e]}get unpackVector(){return nx[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}_unpackMapbox(e,i,A){return(256*e*256+256*i+A)/10-1e4}_unpackTerrarium(e,i,A){return 256*e+i+A/256-32768}static pack(e,i){const A=[0,0,0,0],h=Yd.getUnpackVector(i);let f=Math.floor((e+h[3])/h[2]);return A[2]=f%256,f=Math.floor(f/256),A[1]=f%256,f=Math.floor(f/256),A[0]=f,A}getPixels(){return new co({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,i,A){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=i*this.dim,f=i*this.dim+this.dim,g=A*this.dim,v=A*this.dim+this.dim;switch(i){case-1:h=f-1;break;case 1:f=h+1}switch(A){case-1:g=v-1;break;case 1:v=g+1}const w=-i*this.dim,C=-A*this.dim;for(let I=g;I<v;I++)for(let T=h;T<f;T++)this.data[this._idx(T,I)]=e.data[this._idx(T+w,I+C)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}Bt("DEMData",Yd),Bt("DemMinMaxQuadTree",tx,{omit:["dem"]});class PF{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,A){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const f={value:i,timeout:void 0};if(A!==void 0&&(f.timeout=setTimeout(()=>{this.remove(e,f)},A)),this.data[h].push(f),this.order.push(h),this.order.length>this.max){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const A=e.wrapped().key,h=i===void 0?0:this.data[A].indexOf(i),f=this.data[A][h];return this.data[A].splice(h,1),f.timeout&&clearTimeout(f.timeout),this.data[A].length===0&&delete this.data[A],this.onRemove(f.value),this.order.splice(this.order.indexOf(A),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const A in this.data)for(const h of this.data[A])e(h.value)||i.push(h);for(const A of i)this.remove(A.value.tileID,A)}}class Ol{constructor(e,i,A){this.func=e,this.mask=i,this.range=A}}Ol.ReadOnly=!1,Ol.ReadWrite=!0,Ol.disabled=new Ol(519,Ol.ReadOnly,[0,1]);const ig=7680;class og{constructor(e,i,A,h,f,g){this.test=e,this.ref=i,this.mask=A,this.fail=h,this.depthFail=f,this.pass=g}}og.disabled=new og({func:519,mask:0},0,0,ig,ig,ig);class Es{constructor(e,i,A){this.blendFunction=e,this.blendColor=i,this.mask=A}}Es.Replace=[1,0],Es.disabled=new Es(Es.Replace,rr.transparent,[!1,!1,!1,!1]),Es.unblended=new Es(Es.Replace,rr.transparent,[!0,!0,!0,!0]),Es.alphaBlended=new Es([1,771],rr.transparent,[!0,!0,!0,!0]);const sg=1029,ag=2305;class Jo{constructor(e,i,A){this.enable=e,this.mode=i,this.frontFace=A}}Jo.disabled=new Jo(!1,sg,ag),Jo.backCCW=new Jo(!0,sg,ag),Jo.backCW=new Jo(!0,sg,2304),Jo.frontCW=new Jo(!0,1028,2304),Jo.frontCCW=new Jo(!0,1028,ag);class MA extends ut{constructor(e,i,A){super(),this.id=e,this._onlySymbols=A,i.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new PF(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new kF}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const A=this._tiles[i];A.upload(e),A.prepare(this.map.style.imageManager)}}getIds(){return et(this._tiles).map(e=>e.tileID).sort(ix).map(e=>e.key)}getRenderableIds(e){const i=[];for(const A in this._tiles)this._isIdRenderable(+A,e)&&i.push(this._tiles[A]);return e?i.sort((A,h)=>{const f=A.tileID,g=h.tileID,v=new L(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),w=new L(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-g.overscaledZ||w.y-v.y||w.x-v.x}).map(A=>A.tileID.key):i.map(A=>A.tileID).sort(ix).map(A=>A.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const A=this._tiles[e];A&&(A.state!=="loading"&&(A.state=i),this._loadTile(A,this._tileLoaded.bind(this,A,e,i)))}_tileLoaded(e,i,A,h){if(h)return e.state="errored",void(h.status!==404?this._source.fire(new St(h,{tile:e})):this.update(this.transform));e.timeAdded=dr.now(),A==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new $e("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let h=0;h<i.length;h++){const f=i[h];if(e.neighboringTiles&&e.neighboringTiles[f]){const g=this.getTileByID(f);A(e,g),A(g,e)}}function A(h,f){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let g=f.tileID.canonical.x-h.tileID.canonical.x;const v=f.tileID.canonical.y-h.tileID.canonical.y,w=Math.pow(2,h.tileID.canonical.z),C=f.tileID.key;g===0&&v===0||Math.abs(v)>1||(Math.abs(g)>1&&(Math.abs(g+w)===1?g+=w:Math.abs(g-w)===1&&(g-=w)),f.dem&&h.dem&&(h.dem.backfillBorder(f.dem,g,v),h.neighboringTiles&&h.neighboringTiles[C]&&(h.neighboringTiles[C].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,A,h){for(const f in this._tiles){let g=this._tiles[f];if(h[f]||!g.hasData()||g.tileID.overscaledZ<=i||g.tileID.overscaledZ>A)continue;let v=g.tileID;for(;g&&g.tileID.overscaledZ>i+1;){const C=g.tileID.scaledTo(g.tileID.overscaledZ-1);g=this._tiles[C.key],g&&g.hasData()&&(v=C)}let w=v;for(;w.overscaledZ>i;)if(w=w.scaledTo(w.overscaledZ-1),e[w.key]){h[v.key]=v;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const A=this._loadedParentTiles[e.key];return A&&A.tileID.overscaledZ>=i?A:null}for(let A=e.overscaledZ-1;A>=i;A--){const h=e.scaledTo(A),f=this._getLoadedTile(h);if(f)return f}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const A=Math.ceil(e.width/i)+1,h=Math.ceil(e.height/i)+1,f=Math.floor(A*h*5),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(g)}handleWrapJump(e){const i=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,i){const A={};for(const h in this._tiles){const f=this._tiles[h];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+i),A[f.tileID.key]=f}this._tiles=A;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(e,i,A){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!A)return;let h;this.updateCacheSize(e,i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new Ri(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(h=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!A,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(v=>this._source.hasTile(v)))):h=[];const f=this._updateRetainedTiles(h);if(ox(this._source.type)&&h.length!==0){const v={},w={},C=Object.keys(f);for(const T of C){const S=f[T],R=this._tiles[T];if(!R||R.fadeEndTime&&R.fadeEndTime<=dr.now())continue;const H=this.findLoadedParent(S,Math.max(S.overscaledZ-MA.maxOverzooming,this._source.minzoom));H&&(this._addTile(H.tileID),v[H.tileID.key]=H.tileID),w[T]=S}const I=h[h.length-1].overscaledZ;for(const T in this._tiles){const S=this._tiles[T];if(f[T]||!S.hasData())continue;let R=S.tileID;for(;R.overscaledZ>I;){R=R.scaledTo(R.overscaledZ-1);const H=this._tiles[R.key];if(H&&H.hasData()&&w[R.key]){f[T]=S.tileID;break}}}for(const T in v)f[T]||(this._coveredTiles[T]=!0,f[T]=v[T])}for(const v in f)this._tiles[v].clearFadeHold();const g=function(v,w){const C=[];for(const I in v)I in w||C.push(I);return C}(this._tiles,f);for(const v of g){const w=this._tiles[v];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(e.length===0)return i;const A={},h=e.reduce((C,I)=>Math.min(C,I.overscaledZ),1/0),f=e[0].overscaledZ,g=Math.max(f-MA.maxOverzooming,this._source.minzoom),v=Math.max(f+MA.maxUnderzooming,this._source.minzoom),w={};for(const C of e){const I=this._addTile(C);i[C.key]=C,I.hasData()||h<this._source.maxzoom&&(w[C.key]=C)}this._retainLoadedChildren(w,h,v,i);for(const C of e){let I=this._tiles[C.key];if(I.hasData())continue;if(C.canonical.z>=this._source.maxzoom){const S=C.children(this._source.maxzoom)[0],R=this.getTile(S);if(R&&R.hasData()){i[S.key]=S;continue}}else{const S=C.children(this._source.maxzoom);if(i[S[0].key]&&i[S[1].key]&&i[S[2].key]&&i[S[3].key])continue}let T=I.wasRequested();for(let S=C.overscaledZ-1;S>=g;--S){const R=C.scaledTo(S);if(A[R.key]||(A[R.key]=!0,I=this.getTile(R),!I&&T&&(I=this._addTile(R)),I&&(i[R.key]=R,T=I.wasRequested(),I.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let A,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){A=this._loadedParentTiles[h.key];break}i.push(h.key);const f=h.scaledTo(h.overscaledZ-1);if(A=this._getLoadedTile(f),A)break;h=f}for(const f of i)this._loadedParentTiles[f]=A}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const A=!!i;if(!A){const h=this.map?this.map.painter:null;i=new Wv(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,h,this._source.type==="raster"||this._source.type==="raster-dem"),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,A||this._source.fire(new $e("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const A=i.getExpiryTimeout();A&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},A))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset()}tilesIn(e,i,A){const h=[],f=this.transform;if(!f)return h;for(const g in this._tiles){const v=this._tiles[g];if(A&&v.clearQueryDebugViz(),v.holdingForFade())continue;const w=e.containsTile(v,f,i);w&&h.push(w)}return h}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(A=>this._tiles[A].tileID);for(const A of i)A.projMatrix=this.transform.calculateProjMatrix(A.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(ox(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=dr.now())return!0}return!1}setFeatureState(e,i,A){this._state.updateState(e=e||"_geojsonTileLayer",i,A)}removeFeatureState(e,i,A){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,A)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,A){const h=this._tiles[e];h&&h.setDependencies(i,A)}reloadTilesForDependencies(e,i){for(const A in this._tiles)this._tiles[A].hasDependency(e,i)&&this._reloadTile(+A,"reloading");this._cache.filter(A=>!A.hasDependency(e,i))}}function ix(n,e){const i=Math.abs(2*n.wrap)-+(n.wrap<0),A=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||A-i||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x}function ox(n){return n==="raster"||n==="image"||n==="video"}MA.maxOverzooming=10,MA.maxUnderzooming=3;class ef{constructor(e,i,A){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=A}static create(e,i,A){const h=A||e.findDEMTileFor(i);if(!h||!h.dem)return;const f=h.dem,g=h.tileID,v=1<<i.canonical.z-g.canonical.z;return new ef(h,h.tileSize/lr/v,[(i.canonical.x/v-g.canonical.x)*f.dim,(i.canonical.y/v-g.canonical.y)*f.dim])}tileCoordToPixel(e,i){const A=i*this._scale+this._offset[1],h=Math.floor(e*this._scale+this._offset[0]),f=Math.floor(A);return new L(h,f)}getElevationAt(e,i,A,h){const f=e*this._scale+this._offset[0],g=i*this._scale+this._offset[1],v=Math.floor(f),w=Math.floor(g),C=this._dem;return h=!!h,A?Xt(Xt(C.get(v,w,h),C.get(v,w+1,h),g-w),Xt(C.get(v+1,w,h),C.get(v+1,w+1,h),g-w),f-v):C.get(v,w,h)}getElevationAtPixel(e,i,A){return this._dem.get(e,i,!!A)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*vm(1,e)*this._dem.stride}}class sx{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new _a(lr,16,0),this.featureIndexArray=new m0,this.promoteId=i}insert(e,i,A,h,f,g=0){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(A,h,f,g);const w=this.grid;for(let C=0;C<i.length;C++){const I=i[C],T=[1/0,1/0,-1/0,-1/0];for(let S=0;S<I.length;S++){const R=I[S];T[0]=Math.min(T[0],R.x),T[1]=Math.min(T[1],R.y),T[2]=Math.max(T[2],R.x),T[3]=Math.max(T[3],R.y)}T[0]<lr&&T[1]<lr&&T[2]>=0&&T[3]>=0&&w.insert(v,T[0],T[1],T[2],T[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new QA.VectorTile(new fu(this.rawTileData)).layers,this.sourceLayerCoder=new Gv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,A,h){this.loadVTLayers();const f=e.params||{},g=fA(f.filter),v=e.tileResult,w=e.transform,C=v.bufferedTilespaceBounds,I=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(H,Z,te,ce)=>Q0(v.bufferedTilespaceGeometry,H,Z,te,ce));I.sort(OF);let T=null;w.elevation&&I.length>0&&(T=ef.create(w.elevation,this.tileID));const S={};let R;for(let H=0;H<I.length;H++){const Z=I[H];if(Z===R)continue;R=Z;const te=this.featureIndexArray.get(Z);let ce=null;this.loadMatchingFeature(S,te,g,f.layers,f.availableImages,i,A,h,(fe,ve,be,Be=0)=>(ce||(ce=Zs(fe,this.tileID.canonical,e.tileTransform)),ve.queryIntersectsFeature(v,fe,be,ce,this.z,e.transform,e.pixelPosMatrix,T,Be)))}return S}loadMatchingFeature(e,i,A,h,f,g,v,w,C){const{featureIndex:I,bucketIndex:T,sourceLayerIndex:S,layoutVertexArrayOffset:R}=i,H=this.bucketLayerIDs[T];if(h&&!function(fe,ve){for(let be=0;be<fe.length;be++)if(ve.indexOf(fe[be])>=0)return!0;return!1}(h,H))return;const Z=this.sourceLayerCoder.decode(S),te=this.vtLayers[Z].feature(I);if(A.needGeometry){const fe=SA(te,!0);if(!A.filter(new P(this.tileID.overscaledZ),fe,this.tileID.canonical))return}else if(!A.filter(new P(this.tileID.overscaledZ),te))return;const ce=this.getId(te,Z);for(let fe=0;fe<H.length;fe++){const ve=H[fe];if(h&&h.indexOf(ve)<0)continue;const be=g[ve];if(!be)continue;let Be={};ce!==void 0&&w&&(Be=w.getState(be.sourceLayer||"_geojsonTileLayer",ce));const Ie=qe({},v[ve]);Ie.paint=ax(Ie.paint,be.paint,te,Be,f),Ie.layout=ax(Ie.layout,be.layout,te,Be,f);const je=!C||C(te,be,Be,R);if(!je)continue;const Oe=new jv(te,this.z,this.x,this.y,ce);Oe.layer=Ie;let pt=e[ve];pt===void 0&&(pt=e[ve]=[]),pt.push({featureIndex:I,feature:Oe,intersectionZ:je})}}lookupSymbolFeatures(e,i,A,h,f,g,v,w){const C={};this.loadVTLayers();const I=fA(f);for(const T of e)this.loadMatchingFeature(C,{bucketIndex:A,sourceLayerIndex:h,featureIndex:T,layoutVertexArrayOffset:0},I,g,v,w,i);return C}loadFeature(e){const{featureIndex:i,sourceLayerIndex:A}=e;this.loadVTLayers();const h=this.sourceLayerCoder.decode(A),f=this.vtFeatures[h];if(f[i])return f[i];const g=this.vtLayers[h].feature(i);return f[i]=g,g}hasLayer(e){for(const i of this.bucketLayerIDs)for(const A of i)if(e===A)return!0;return!1}getId(e,i){let A=e.id;return this.promoteId&&(A=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof A=="boolean"&&(A=Number(A))),A}}function ax(n,e,i,A,h){return Dt(n,(f,g)=>{const v=e instanceof ue?e.get(g):null;return v&&v.evaluate?v.evaluate(i,A,h):v})}function OF(n,e){return e-n}Bt("FeatureIndex",sx,{omit:["rawTileData","sourceLayerCoder"]});class Ax{constructor(e){const i={},A=[];for(const v in e){const w=e[v],C=i[v]={};for(const I in w.glyphs){const T=w.glyphs[+I];if(!T||T.bitmap.width===0||T.bitmap.height===0)continue;const S=T.metrics.localGlyph?2:1,R={x:0,y:0,w:T.bitmap.width+2*S,h:T.bitmap.height+2*S};A.push(R),C[I]=R}}const{w:h,h:f}=Hm(A),g=new Ea({width:h||1,height:f||1});for(const v in e){const w=e[v];for(const C in w.glyphs){const I=w.glyphs[+C];if(!I||I.bitmap.width===0||I.bitmap.height===0)continue;const T=i[v][C],S=I.metrics.localGlyph?2:1;Ea.copy(I.bitmap,g,{x:0,y:0},{x:T.x+S,y:T.y+S},I.bitmap)}}this.image=g,this.positions=i}}Bt("GlyphAtlas",Ax);class RF{constructor(e){this.tileID=new Ri(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,e.projection&&(this.tileTransform=qd(e.tileID.canonical,e.projection))}parse(e,i,A,h,f){this.status="parsing",this.data=e,this.collisionBoxArray=new vi;const g=new Gv(Object.keys(e.layers).sort()),v=new sx(this.tileID,this.promoteId);v.bucketLayerIDs=[];const w={},C=new tg(256,256),I={featureIndex:v,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:C,availableImages:A},T=i.familiesBySource[this.source];for(const Be in T){const Ie=e.layers[Be];if(!Ie)continue;let je=!1,Oe=!1;for(const Ze of T[Be])Ze[0].type==="symbol"?je=!0:Oe=!0;if(this.isSymbolTile===!0&&!je||this.isSymbolTile===!1&&!Oe)continue;Ie.version===1&&ke(`Vector tile source "${this.source}" layer "${Be}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const pt=g.encode(Be),tt=[];for(let Ze=0;Ze<Ie.length;Ze++){const rt=Ie.feature(Ze),st=v.getId(rt,Be);tt.push({feature:rt,id:st,index:Ze,sourceLayerIndex:pt})}for(const Ze of T[Be]){const rt=Ze[0];this.isSymbolTile!==void 0&&rt.type==="symbol"!==this.isSymbolTile||rt.minzoom&&this.zoom<Math.floor(rt.minzoom)||rt.maxzoom&&this.zoom>=rt.maxzoom||rt.visibility!=="none"&&(Ag(Ze,this.zoom,A),(w[rt.id]=rt.createBucket({index:v.bucketLayerIDs.length,layers:Ze,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pt,sourceID:this.source,enableTerrain:this.enableTerrain,availableImages:A})).populate(tt,I,this.tileID.canonical,this.tileTransform),v.bucketLayerIDs.push(Ze.map(st=>st.id)))}}let S,R,H,Z;C.trim();const te={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ce=Dt(I.glyphDependencies,Be=>Object.keys(Be).map(Number));Object.keys(ce).length?h.send("getGlyphs",{uid:this.uid,stacks:ce},(Be,Ie)=>{S||(S=Be,R=Ie,be.call(this))},void 0,!1,te):R={};const fe=Object.keys(I.iconDependencies);fe.length?h.send("getImages",{icons:fe,source:this.source,tileID:this.tileID,type:"icons"},(Be,Ie)=>{S||(S=Be,H=Ie,be.call(this))},void 0,!1,te):H={};const ve=Object.keys(I.patternDependencies);function be(){if(S)return f(S);if(R&&H&&Z){const Be=new Ax(R),Ie=new gv(H,Z);for(const je in w){const Oe=w[je];Oe instanceof Ua?(Ag(Oe.layers,this.zoom,A),vF(Oe,R,Be.positions,H,Ie.iconPositions,this.showCollisionBoxes,A,this.tileID.canonical,this.tileZoom)):Oe.hasPattern&&(Oe instanceof Rd||Oe instanceof Od||Oe instanceof Om)&&(Ag(Oe.layers,this.zoom,A),Oe.addFeatures(I,this.tileID.canonical,Ie.patternPositions,A))}this.status="done",f(null,{buckets:et(w).filter(je=>!je.isEmpty()),featureIndex:v,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Be.image,lineAtlas:C,imageAtlas:Ie,glyphMap:this.returnDependencies?R:null,iconMap:this.returnDependencies?H:null,glyphPositions:this.returnDependencies?Be.positions:null})}}ve.length?h.send("getImages",{icons:ve,source:this.source,tileID:this.tileID,type:"patterns"},(Be,Ie)=>{S||(S=Be,Z=Ie,be.call(this))},void 0,!1,te):Z={},be.call(this)}}function Ag(n,e,i){const A=new P(e);for(const h of n)h.recalculate(A,i)}class lx{constructor(e){this.entries={},this.scheduler=e}request(e,i,A,h){const f=this.entries[e]=this.entries[e]||{callbacks:[]};if(f.result){const[g,v]=f.result;return this.scheduler?this.scheduler.add(()=>{h(g,v)},i):h(g,v),()=>{}}return f.callbacks.push(h),f.cancel||(f.cancel=A((g,v)=>{f.result=[g,v];for(const w of f.callbacks)this.scheduler?this.scheduler.add(()=>{w(g,v)},i):w(g,v);setTimeout(()=>delete this.entries[e],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(g=>g!==h),f.callbacks.length||(f.cancel(),delete this.entries[e]))}}}function cx(n,e,i){const A=JSON.stringify(n.request);return n.data&&(this.deduped.entries[A]={result:[null,n.data]}),this.deduped.request(A,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},h=>{const f=N(n.request,(g,v,w,C)=>{g?h(g):v&&h(null,{vectorTile:i?void 0:new QA.VectorTile(new fu(v)),rawData:v,cacheControl:w,expires:C})});return()=>{f.cancel(),h()}},e)}var zF={name:"albers",range:[4,7],center:[-96,37.5],parallels:[29.5,45.5],conic:!0,initializeConstants(){if(this.constants&&G0(this.parallels,this.constants.parallels))return;const n=Math.sin(K(this.parallels[0])),e=(n+Math.sin(K(this.parallels[1])))/2,i=1+n*(2*e-n),A=Math.sqrt(i)/e;this.constants={n:e,c:i,r0:A,parallels:this.parallels}},project(n,e){this.initializeConstants();const i=K(n-this.center[0]),A=K(e),{n:h,c:f,r0:g}=this.constants,v=Math.sqrt(f-2*h*Math.sin(A))/h;return{x:v*Math.sin(i*h),y:v*Math.cos(i*h)-g}},unproject(n,e){this.initializeConstants();const{n:i,c:A,r0:h}=this.constants,f=h+e;let g=Math.atan2(n,Math.abs(f))*Math.sign(f);f*i<0&&(g-=Math.PI*Math.sign(n)*Math.sign(f));const v=K(this.center[0])*i;g=Ke(g,-Math.PI-v,Math.PI-v);const w=G(g/i)+this.center[0],C=Math.asin(Ue((A-(n*n+f*f)*i*i)/(2*i),-1,1)),I=Ue(G(C),-85.051129,Ca);return new _r(w,I)}};const yu=1.340264,_u=-.081106,vu=893e-6,xu=.003796,tf=Math.sqrt(3)/2;var HF={name:"equalEarth",center:[0,0],range:[3.5,7],project(n,e){e=e/180*Math.PI,n=n/180*Math.PI;const i=Math.asin(tf*Math.sin(e)),A=i*i,h=A*A*A;return{x:.5*(n*Math.cos(i)/(tf*(yu+3*_u*A+h*(7*vu+9*xu*A)))/Math.PI+.5),y:1-.5*(i*(yu+_u*A+h*(vu+xu*A))/Math.PI+1)}},unproject(n,e){n=(2*n-.5)*Math.PI;let i=e=(2*(1-e)-1)*Math.PI,A=i*i,h=A*A*A;for(let C,I,T,S=0;S<12&&(I=i*(yu+_u*A+h*(vu+xu*A))-e,T=yu+3*_u*A+h*(7*vu+9*xu*A),C=I/T,i=Ue(i-C,-Math.PI/3,Math.PI/3),A=i*i,h=A*A*A,!(Math.abs(C)<1e-12));++S);const f=tf*n*(yu+3*_u*A+h*(7*vu+9*xu*A))/Math.cos(i),g=Math.asin(Math.sin(i)/tf),v=Ue(180*f/Math.PI,-180,180),w=Ue(180*g/Math.PI,-85.051129,Ca);return new _r(v,w)}},NF={name:"equirectangular",wrap:!0,center:[0,0],range:[3.5,7],project:(n,e)=>({x:.5+n/360,y:.5-e/360}),unproject(n,e){const i=360*(n-.5),A=Ue(360*(.5-e),-85.051129,Ca);return new _r(i,A)}};const Rl=Math.PI/2;function rf(n){return Math.tan((Rl+n)/2)}var VF={name:"lambertConformalConic",range:[3.5,7],center:[0,30],parallels:[30,30],conic:!0,initializeConstants(){if(this.constants&&G0(this.parallels,this.constants.parallels))return;const n=K(this.parallels[0]),e=K(this.parallels[1]),i=Math.cos(n),A=n===e?Math.sin(n):Math.log(i/Math.cos(e))/Math.log(rf(e)/rf(n)),h=i*Math.pow(rf(n),A)/A;this.constants={n:A,f:h,parallels:this.parallels}},project(n,e){this.initializeConstants(),e=K(e),n=K(n-this.center[0]);const i=1e-6,{n:A,f:h}=this.constants;h>0?e<-Rl+i&&(e=-Rl+i):e>Rl-i&&(e=Rl-i);const f=h/Math.pow(rf(e),A),g=f*Math.sin(A*n),v=h-f*Math.cos(A*n);return{x:.5*(g/Math.PI+.5),y:1-.5*(v/Math.PI+.5)}},unproject(n,e){this.initializeConstants(),n=(2*n-.5)*Math.PI,e=(2*(1-e)-.5)*Math.PI;const{n:i,f:A}=this.constants,h=A-e,f=Math.sign(h),g=Math.sign(i)*Math.sqrt(n*n+h*h);let v=Math.atan2(n,Math.abs(h))*f;h*i<0&&(v-=Math.PI*Math.sign(n)*f);const w=Ue(G(v/i)+this.center[0],-180,180),C=Ue(G(2*Math.atan(Math.pow(A/g,1/i))-Rl),-85.051129,Ca);return new _r(w,C)}},KF={name:"mercator",wrap:!0,center:[0,0],project:(n,e)=>({x:ym(n),y:_m(e)}),unproject(n,e){const i=UA(n),A=ws(e);return new _r(i,A)}};const ux=K(Ca);var GF={name:"naturalEarth",center:[0,0],range:[3.5,7],project(n,e){const i=(e=K(e))*e,A=i*i;return{x:.5*((n=K(n))*(.8707-.131979*i+A*(A*(.003971*i-.001529*A)-.013791))/Math.PI+.5),y:1-.5*(e*(1.007226+i*(.015085+A*(.028874*i-.044475-.005916*A)))/Math.PI+1)}},unproject(n,e){n=(2*n-.5)*Math.PI;let i=e=(2*(1-e)-1)*Math.PI,A=25,h=0,f=i*i;do{f=i*i;const w=f*f;h=(i*(1.007226+f*(.015085+w*(.028874*f-.044475-.005916*w)))-e)/(1.007226+f*(.045255+w*(.259866*f-.311325-.005916*11*w))),i=Ue(i-h,-ux,ux)}while(Math.abs(h)>1e-6&&--A>0);f=i*i;const g=Ue(G(n/(.8707+f*(f*(f*f*f*(.003971-.001529*f)-.013791)-.131979))),-180,180),v=G(i);return new _r(g,v)}};const hx=K(Ca),dx={albers:zF,equalEarth:HF,equirectangular:NF,lambertConformalConic:VF,mercator:KF,naturalEarth:GF,winkelTripel:{name:"winkelTripel",center:[0,0],range:[3.5,7],project(n,e){e=K(e),n=K(n);const i=Math.cos(e),A=2/Math.PI,h=Math.acos(i*Math.cos(n/2)),f=Math.sin(h)/h,g=.5*(n*A+2*i*Math.sin(n/2)/f)||0,v=.5*(e+Math.sin(e)/f)||0;return{x:.5*(g/Math.PI+.5),y:1-.5*(v/Math.PI+1)}},unproject(n,e){let i=n=(2*n-.5)*Math.PI,A=e=(2*(1-e)-1)*Math.PI,h=25;const f=1e-6;let g=0,v=0;do{const w=Math.cos(A),C=Math.sin(A),I=2*C*w,T=C*C,S=w*w,R=Math.cos(i/2),H=Math.sin(i/2),Z=2*R*H,te=H*H,ce=1-S*R*R,fe=ce?1/ce:0,ve=ce?Math.acos(w*R)*Math.sqrt(1/ce):0,be=.5*(2*ve*w*H+2*i/Math.PI)-n,Be=.5*(ve*C+A)-e,Ie=.5*fe*(S*te+ve*w*R*T)+1/Math.PI,je=fe*(Z*I/4-ve*C*H),Oe=.125*fe*(I*H-ve*C*S*Z),pt=.5*fe*(T*R+ve*te*w)+.5,tt=je*Oe-pt*Ie;g=(Be*je-be*pt)/tt,v=(be*Oe-Be*Ie)/tt,i=Ue(i-g,-Math.PI,Math.PI),A=Ue(A-v,-hx,hx)}while((Math.abs(g)>f||Math.abs(v)>f)&&--h>0);return new _r(G(i),G(A))}}};s.ARRAY_TYPE=xi,s.AUTH_ERR_MSG=Ki,s.Actor=class{constructor(n,e,i){this.target=n,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},It(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=ot()?n:V,this.scheduler=new LF}send(n,e,i,A,h=!1,f){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=f,this.callbacks[g]=i);const v=Dr(this.globalScope)?void 0:[];return this.target.postMessage({id:g,type:n,hasCallback:!!i,targetMapId:A,mustQueue:h,sourceMapId:this.mapId,data:_A(e,v)},v),{cancel:()=>{i&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:A,sourceMapId:this.mapId})}}}receive(n){const e=n.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const A=this.cancelCallbacks[i];delete this.cancelCallbacks[i],A&&A.cancel()}else if(e.mustQueue||ot()){const A=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),A&&A.metadata||{type:"message"})}else this.processTask(i,e)}processTask(n,e){if(e.type==="<response>"){const i=this.callbacks[n];delete this.callbacks[n],i&&(e.error?i(vA(e.error)):i(null,vA(e.data)))}else{const i=Dr(this.globalScope)?void 0:[],A=e.hasCallback?(f,g)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:f?_A(f):null,data:_A(g,i)},i)}:f=>{},h=vA(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,h,A);else if(this.parent.getWorkerSource){const f=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,f[0],h.source)[f[1]](h,A)}else A(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=rg,s.Color=rr,s.ColorMode=Es,s.CullFaceMode=Jo,s.DEMData=Yd,s.DataConstantProperty=J,s.DedupedRequest=lx,s.DepthMode=Ol,s.EXTENT=lr,s.Elevation=class{getAtPointOrZero(n,e=0){return this.getAtPoint(n,e)||0}getAtPoint(n,e,i=!0){e==null&&(e=null);const A=this._source();if(!A||n.y<0||n.y>1)return e;const h=A.getSource().maxzoom,f=1<<h,g=Math.floor(n.x),v=n.x-g,w=new Ri(h,g,h,Math.floor(v*f),Math.floor(n.y*f)),C=this.findDEMTileFor(w);if(!C||!C.dem)return e;const I=C.dem,T=1<<C.tileID.canonical.z,S=(v*T-C.tileID.canonical.x)*I.dim,R=(n.y*T-C.tileID.canonical.y)*I.dim,H=Math.floor(S),Z=Math.floor(R);return(i?this.exaggeration():1)*Xt(Xt(I.get(H,Z),I.get(H,Z+1),R-Z),Xt(I.get(H+1,Z),I.get(H+1,Z+1),R-Z),S-H)}getAtTileOffset(n,e,i){const A=1<<n.canonical.z;return this.getAtPointOrZero(new Td(n.wrap+(n.canonical.x+e/lr)/A,(n.canonical.y+i/lr)/A))}getForTilePoints(n,e,i,A){const h=ef.create(this,n,A);return!!h&&(e.forEach(f=>{f[2]=this.exaggeration()*h.getElevationAt(f[0],f[1],i)}),!0)}getMinMaxForTile(n){const e=this.findDEMTileFor(n);if(!e||!e.dem)return null;const i=e.dem.tree,A=e.tileID,h=1<<n.canonical.z-A.canonical.z;let f=n.canonical.x/h-A.canonical.x,g=n.canonical.y/h-A.canonical.y,v=0;for(let w=0;w<n.canonical.z-A.canonical.z&&!i.leaves[v];w++){f*=2,g*=2;const C=2*Math.floor(g)+Math.floor(f);v=i.childOffsets[v]+C,f%=1,g%=1}return{min:this.exaggeration()*i.minimums[v],max:this.exaggeration()*i.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=St,s.EvaluationParameters=P,s.Event=$e,s.Evented=ut,s.GlyphManager=kl,s.ImagePosition=Nm,s.LineAtlas=tg,s.LngLat=_r,s.LngLatBounds=TA,s.LocalGlyphMode=jm,s.MAX_MERCATOR_LATITUDE=Ca,s.MAX_SAFE_INTEGER=ie,s.MercatorCoordinate=Td,s.ONE_EM=Yn,s.OverscaledTileID=Ri,s.Properties=Ve,s.RGBAImage=co,s.RequestManager=class{constructor(n,e,i){this._transformRequestFn=n,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const n=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ro,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,e){return this._transformRequestFn&&this._transformRequestFn(n,e)||{url:n}}normalizeStyleURL(n,e){if(!Mn(n))return n;const i=Ln(n);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(n,e){if(!Mn(n))return n;const i=Ln(n);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(n,e){if(!Mn(n))return n;const i=Ln(n);return i.path=`/v4/${i.authority}.json`,i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||e)}normalizeSpriteURL(n,e,i,A){const h=Ln(n);return Mn(n)?(h.path=`/styles/v1${h.path}/sprite${e}${i}`,this._makeAPIURL(h,this._customAccessToken||A)):(h.path+=`${e}${i}`,wn(h))}normalizeTileURL(n,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!Mn(n))return n;const A=Ln(n);A.path=A.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&A.authority!=="raster"&&i===512?"@2x":""}${mi.supported?".webp":"$1"}`),A.authority==="raster"?A.path=`/${Ct.RASTER_URL_PREFIX}${A.path}`:(A.path=A.path.replace(/^.+\/v4\//,"/"),A.path=`/${Ct.TILE_URL_VERSION}${A.path}`);const h=this._customAccessToken||function(f){for(const g of f){const v=g.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(A.params)||Ct.ACCESS_TOKEN;return Ct.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&A.params.push(`sku=${this._skuToken}`),this._makeAPIURL(A,h)}canonicalizeTileURL(n,e){const i=Ln(n);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return n;let A="mapbox://";i.path.match(/^\/raster\/v1\//)?A+=`raster/${i.path.replace(`/${Ct.RASTER_URL_PREFIX}/`,"")}`:A+=`tiles/${i.path.replace(`/${Ct.TILE_URL_VERSION}/`,"")}`;let h=i.params;return e&&(h=h.filter(f=>!f.match(/^access_token=/))),h.length&&(A+=`?${h.join("&")}`),A}canonicalizeTileset(n,e){const i=!!e&&Mn(e),A=[];for(const h of n.tiles||[])Ti(h)?A.push(this.canonicalizeTileURL(h,i)):A.push(h);return A}_makeAPIURL(n,e){const i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",A=Ln(Ct.API_URL);if(n.protocol=A.protocol,n.authority=A.authority,n.protocol==="http"){const h=n.params.indexOf("secure");h>=0&&n.params.splice(h,1)}if(A.path!=="/"&&(n.path=`${A.path}${n.path}`),!Ct.REQUIRE_ACCESS_TOKEN)return wn(n);if(e=e||Ct.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return n.params=n.params.filter(h=>h.indexOf("access_token")===-1),n.params.push(`access_token=${e||""}`),wn(n)}},s.ResourceType=Li,s.SegmentVector=Vn,s.SourceCache=MA,s.StencilMode=og,s.StructArrayLayout1ui2=Nn,s.StructArrayLayout2f1f2i16=Jn,s.StructArrayLayout2i4=bt,s.StructArrayLayout2ui4=Or,s.StructArrayLayout3f12=Kt,s.StructArrayLayout3ui6=fn,s.StructArrayLayout4i8=Pt,s.Texture=$d,s.Tile=Wv,s.Transitionable=ee,s.Uniform1f=Fd,s.Uniform1i=class extends Ks{constructor(n,e){super(n,e),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},s.Uniform2f=class extends Ks{constructor(n,e){super(n,e),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},s.Uniform3f=class extends Ks{constructor(n,e){super(n,e),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},s.Uniform4f=x0,s.UniformColor=w0,s.UniformMatrix2f=class extends Ks{constructor(n,e){super(n,e),this.current=kC}set(n){for(let e=0;e<4;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}},s.UniformMatrix3f=class extends Ks{constructor(n,e){super(n,e),this.current=DC}set(n){for(let e=0;e<9;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}},s.UniformMatrix4f=class extends Ks{constructor(n,e){super(n,e),this.current=LC}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},s.UnwrappedTileID=Kv,s.ValidationError=Pe,s.VectorTileWorkerSource=class extends ut{constructor(n,e,i,A,h){super(),this.actor=n,this.layerIndex=e,this.availableImages=i,this.loadVectorData=h||cx,this.loading={},this.loaded={},this.deduped=new lx(n.scheduler),this.isSpriteLoaded=A,this.scheduler=n.scheduler}loadTile(n,e){const i=n.uid,A=n&&n.request,h=A&&A.collectResourceTiming,f=this.loading[i]=new RF(n);f.abort=this.loadVectorData(n,(g,v)=>{const w=!this.loading[i];if(delete this.loading[i],w||g||!v)return f.status="done",w||(this.loaded[i]=f),e(g);const C=v.rawData,I={};v.expires&&(I.expires=v.expires),v.cacheControl&&(I.cacheControl=v.cacheControl),f.vectorTile=v.vectorTile||new QA.VectorTile(new fu(C));const T=()=>{f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,(S,R)=>{if(S||!R)return e(S);const H={};if(h){const Z=Nv(A);Z.length>0&&(H.resourceTiming=JSON.parse(JSON.stringify(Z)))}e(null,qe({rawTileData:C.slice(0)},R,I,H))})};this.isSpriteLoaded?T():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(T,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):T()}),this.loaded=this.loaded||{},this.loaded[i]=f})}reloadTile(n,e){const i=this.loaded,A=n.uid,h=this;if(i&&i[A]){const f=i[A];f.showCollisionBoxes=n.showCollisionBoxes,f.enableTerrain=!!n.enableTerrain;const g=(v,w)=>{const C=f.reloadCallback;C&&(delete f.reloadCallback,f.parse(f.vectorTile,h.layerIndex,this.availableImages,h.actor,C)),e(v,w)};f.status==="parsing"?f.reloadCallback=g:f.status==="done"&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,g):g())}}abortTile(n,e){const i=n.uid,A=this.loading[i];A&&(A.abort&&A.abort(),delete this.loading[i]),e()}removeTile(n,e){const i=this.loaded,A=n.uid;i&&i[A]&&delete i[A],e()}},s.WritingMode=uo,s.ZoomHistory=ud,s.add=function(n,e,i){return n[0]=e[0]+i[0],n[1]=e[1]+i[1],n[2]=e[2]+i[2],n},s.addDynamicAttributes=$m,s.altitudeFromMercatorZ=xm,s.asyncAll=Me,s.bezier=we,s.bindAll=It,s.boundsAttributes=ng,s.bufferConvexPolygon=function(n,e){const i=[];for(let A=0;A<n.length;A++){const h=Ke(A-1,-1,n.length-1),f=Ke(A+1,-1,n.length-1),g=n[A],v=n[f],w=n[h].sub(g).unit(),C=v.sub(g).unit(),I=C.angleWithSep(w.x,w.y),T=w.add(C).unit().mult(-1*e/Math.sin(I/2));i.push(g.add(T))}return i},s.cacheEntryPossiblyAdded=function(n){Ko++,Ko>Dn&&(n.getActor().send("enforceCacheSizeLimit",as),Ko=0)},s.clamp=Ue,s.clearTileCache=function(n){const e=V.caches.delete(qr);n&&e.catch(n).then(()=>n())},s.clipLine=Tv,s.clone=function(n){var e=new xi(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e},s.clone$1=function(n){var e=new xi(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},s.clone$2=Je,s.collisionCircleLayout=jE,s.config=Ct,s.conjugate=function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n},s.copy=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n},s.create=Qd,s.create$1=function(){var n=new xi(16);return xi!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},s.create$2=D0,s.createExpression=fa,s.createLayout=Qe,s.createStyleLayer=function(n){return n.type==="custom"?new TF(n):new SF[n.type](n)},s.cross=function(n,e,i){var A=e[0],h=e[1],f=e[2],g=i[0],v=i[1],w=i[2];return n[0]=h*w-f*v,n[1]=f*g-A*w,n[2]=A*v-h*g,n},s.degToRad=K,s.div=function(n,e,i){return n[0]=e[0]/i[0],n[1]=e[1]/i[1],n[2]=e[2]/i[2],n},s.dot=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]},s.dot$1=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]},s.ease=ge,s.easeCubicInOut=oe,s.emitValidationErrors=Ad,s.endsWith=Ut,s.enforceCacheSizeLimit=function(n){oi(),Tn&&Tn.then(e=>{e.keys().then(i=>{for(let A=0;A<i.length-n;A++)e.delete(i[A])})})},s.evaluateSizeForFeature=zd,s.evaluateSizeForZoom=Ql,s.evaluateVariableOffset=Lv,s.evented=E,s.exactEquals=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]},s.exactEquals$1=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]},s.exported=dr,s.exported$1=mi,s.extend=qe,s.filterObject=Vt,s.fromMat4=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n},s.fromQuat=function(n,e){var i=e[0],A=e[1],h=e[2],f=e[3],g=i+i,v=A+A,w=h+h,C=i*g,I=A*g,T=A*v,S=h*g,R=h*v,H=h*w,Z=f*g,te=f*v,ce=f*w;return n[0]=1-T-H,n[1]=I+ce,n[2]=S-te,n[3]=0,n[4]=I-ce,n[5]=1-C-H,n[6]=R+Z,n[7]=0,n[8]=S+te,n[9]=R-Z,n[10]=1-C-T,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},s.fromRotation=function(n,e){var i=Math.sin(e),A=Math.cos(e);return n[0]=A,n[1]=i,n[2]=0,n[3]=-i,n[4]=A,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},s.fromScaling=function(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},s.furthestTileCorner=function(n){const e=Math.round((n+45+360)%360/90)%4;return ne[e]},s.getAABBPointSquareDist=function(n,e,i){let A=0;for(let h=0;h<2;++h){const f=i?i[h]:0;n[h]>f&&(A+=(n[h]-f)*(n[h]-f)),e[h]<f&&(A+=(f-e[h])*(f-e[h]))}return A},s.getAnchorAlignment=Gm,s.getAnchorJustification=Xm,s.getBounds=function(n){let e=1/0,i=1/0,A=-1/0,h=-1/0;for(const f of n)e=Math.min(e,f.x),i=Math.min(i,f.y),A=Math.max(A,f.x),h=Math.max(h,f.y);return{min:new L(e,i),max:new L(A,h)}},s.getImage=Te,s.getJSON=function(n,e){return O(qe(n,{type:"json"}),e)},s.getMapSessionAPI=vo,s.getPerformanceMeasurement=Nv,s.getProjection=function(n){const e=dx[n.name];if(!e)throw new Error(`Invalid projection name: ${n.name}`);return e.conic?function(i,A){if(A.parallels&&Math.abs(A.parallels[0]+A.parallels[1])<.01){let h=function(f){const g=Math.max(.01,Math.cos(K(f))),v=1/(2*Math.max(Math.PI*g,1/g));return{wrap:!0,project(w,C){const I=K(w)*g,T=Math.sin(K(C))/g;return{x:I*v+.5,y:-T*v+.5}},unproject(w,C){const I=-(C-.5)/v,T=Ue(G((w-.5)/v)/g,-180,180),S=Math.asin(Ue(I*g,-1,1)),R=Ue(G(S),-85.051129,Ca);return new _r(T,R)}}}(A.parallels[0]);if(A.name==="lambertConformalConic"){const{project:f,unproject:g}=dx.mercator;h={wrap:!0,project:f,unproject:g}}return qe({},i,A,h)}return qe({},i,A)}(e,n):e},s.getRTLTextPluginStatus=U,s.getReferrer=Y,s.getTilePoint=function(n,{x:e,y:i},A=0){return new L(((e-A)*n.scale-n.x)*lr,(i*n.scale-n.y)*lr)},s.getTileVec3=function(n,e,i=0){return Tl(((e.x-i)*n.scale-n.x)*lr,(e.y*n.scale-n.y)*lr,xm(e.z,e.y))},s.getVideo=function(n,e){const i=V.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let A=0;A<n.length;A++){const h=V.document.createElement("source");pe(n[A])||(i.crossOrigin="Anonymous"),h.src=n[A],i.appendChild(h)}return{cancel:()=>{}}},s.identity=Fm,s.identity$1=V0,s.invert=function(n,e){var i=e[0],A=e[1],h=e[2],f=e[3],g=e[4],v=e[5],w=e[6],C=e[7],I=e[8],T=e[9],S=e[10],R=e[11],H=e[12],Z=e[13],te=e[14],ce=e[15],fe=i*v-A*g,ve=i*w-h*g,be=i*C-f*g,Be=A*w-h*v,Ie=A*C-f*v,je=h*C-f*w,Oe=I*Z-T*H,pt=I*te-S*H,tt=I*ce-R*H,Ze=T*te-S*Z,rt=T*ce-R*Z,st=S*ce-R*te,We=fe*st-ve*rt+be*Ze+Be*tt-Ie*pt+je*Oe;return We?(n[0]=(v*st-w*rt+C*Ze)*(We=1/We),n[1]=(h*rt-A*st-f*Ze)*We,n[2]=(Z*je-te*Ie+ce*Be)*We,n[3]=(S*Ie-T*je-R*Be)*We,n[4]=(w*tt-g*st-C*pt)*We,n[5]=(i*st-h*tt+f*pt)*We,n[6]=(te*be-H*je-ce*ve)*We,n[7]=(I*je-S*be+R*ve)*We,n[8]=(g*rt-v*tt+C*Oe)*We,n[9]=(A*tt-i*rt-f*Oe)*We,n[10]=(H*Ie-Z*be+ce*fe)*We,n[11]=(T*be-I*Ie-R*fe)*We,n[12]=(v*pt-g*Ze-w*Oe)*We,n[13]=(i*Ze-A*pt+h*Oe)*We,n[14]=(Z*ve-H*Be-te*fe)*We,n[15]=(I*Be-T*ve+S*fe)*We,n):null},s.isMapAuthenticated=function(n){return Zn.has(n)},s.isMapboxURL=Mn,s.latFromMercatorY=ws,s.len=eE,s.length=P0,s.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},s.loadVectorTile=cx,s.makeRequest=O,s.mercatorXfromLng=ym,s.mercatorYfromLat=_m,s.mercatorZfromAltitude=vm,s.mul=function(n,e,i){return n[0]=e[0]*i[0],n[1]=e[1]*i[1],n[2]=e[2]*i[2],n[3]=e[3]*i[3],n},s.mul$1=qC,s.mul$2=YC,s.multiply=k0,s.multiply$1=R0,s.nextPowerOfTwo=At,s.normalize=H0,s.normalize$1=function(n,e){var i=e[0],A=e[1],h=e[2],f=e[3],g=i*i+A*A+h*h+f*f;return g>0&&(g=1/Math.sqrt(g)),n[0]=i*g,n[1]=A*g,n[2]=h*g,n[3]=f*g,n},s.number=Xt,s.ortho=function(n,e,i,A,h,f,g){var v=1/(e-i),w=1/(A-h),C=1/(f-g);return n[0]=-2*v,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*w,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*C,n[11]=0,n[12]=(e+i)*v,n[13]=(h+A)*w,n[14]=(g+f)*C,n[15]=1,n},s.pbf=fu,s.perspective=function(n,e,i,A,h){var f,g=1/Math.tan(e/2);return n[0]=g/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=g,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,h!=null&&h!==1/0?(n[10]=(h+A)*(f=1/(A-h)),n[14]=2*h*A*f):(n[10]=-1,n[14]=-2*A),n},s.pick=function(n,e){const i={};for(let A=0;A<e.length;A++){const h=e[A];h in n&&(i[h]=n[h])}return i},s.plugin=k,s.pointGeometry=L,s.polygonIntersectsBox=Q0,s.polygonIntersectsPolygon=I0,s.polygonizeBounds=function(n,e,i=0,A=!0){const h=new L(i,i),f=n.sub(h),g=e.add(h),v=[f,new L(g.x,f.y),g,new L(f.x,g.y)];return A&&v.push(f),v},s.posAttributes=DF,s.postMapLoadEvent=ss,s.postTurnstileEvent=_o,s.potpack=Hm,s.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},s.radToDeg=G,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(n){return n({pluginStatus:p,pluginURL:y}),E.on("pluginStateChange",n),n},s.removeAuthState=function(n){Zn.delete(n)},s.renderColorRamp=Sm,s.rotateX=function(n,e,i){var A=Math.sin(i),h=Math.cos(i),f=e[4],g=e[5],v=e[6],w=e[7],C=e[8],I=e[9],T=e[10],S=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=f*h+C*A,n[5]=g*h+I*A,n[6]=v*h+T*A,n[7]=w*h+S*A,n[8]=C*h-f*A,n[9]=I*h-g*A,n[10]=T*h-v*A,n[11]=S*h-w*A,n},s.rotateX$1=K0,s.rotateY=function(n,e,i){var A=Math.sin(i),h=Math.cos(i),f=e[0],g=e[1],v=e[2],w=e[3],C=e[8],I=e[9],T=e[10],S=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*h-C*A,n[1]=g*h-I*A,n[2]=v*h-T*A,n[3]=w*h-S*A,n[8]=f*A+C*h,n[9]=g*A+I*h,n[10]=v*A+T*h,n[11]=w*A+S*h,n},s.rotateZ=function(n,e,i){var A=Math.sin(i),h=Math.cos(i),f=e[0],g=e[1],v=e[2],w=e[3],C=e[4],I=e[5],T=e[6],S=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*h+C*A,n[1]=g*h+I*A,n[2]=v*h+T*A,n[3]=w*h+S*A,n[4]=C*h-f*A,n[5]=I*h-g*A,n[6]=T*h-v*A,n[7]=S*h-w*A,n},s.rotateZ$1=function(n,e,i){i*=.5;var A=e[0],h=e[1],f=e[2],g=e[3],v=Math.sin(i),w=Math.cos(i);return n[0]=A*w+h*v,n[1]=h*w-A*v,n[2]=f*w+g*v,n[3]=g*w-f*v,n},s.scale=function(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n},s.scale$1=function(n,e,i){var A=i[0],h=i[1],f=i[2];return n[0]=e[0]*A,n[1]=e[1]*A,n[2]=e[2]*A,n[3]=e[3]*A,n[4]=e[4]*h,n[5]=e[5]*h,n[6]=e[6]*h,n[7]=e[7]*h,n[8]=e[8]*f,n[9]=e[9]*f,n[10]=e[10]*f,n[11]=e[11]*f,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},s.scale$2=function(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n},s.scaleAndAdd=z0,s.setCacheLimits=function(n,e){as=n,Dn=e},s.setRTLTextPlugin=function(n,e,i=!1){if(p===wa||p===d||p===r)throw new Error("setRTLTextPlugin cannot be called multiple times.");y=dr.resolveURL(n),p=wa,c=e,b(),i||D()},s.smoothstep=function(n,e,i){return(i=Ue((i-n)/(e-n),0,1))*i*(3-2*i)},s.spec=xe,s.storeAuthState=function(n,e){e?Zn.add(n):Zn.delete(n)},s.sub=JC,s.subtract=O0,s.symbolSize=ZE,s.tileTransform=qd,s.transformMat3=function(n,e,i){var A=e[0],h=e[1],f=e[2];return n[0]=A*i[0]+h*i[3]+f*i[6],n[1]=A*i[1]+h*i[4]+f*i[7],n[2]=A*i[2]+h*i[5]+f*i[8],n},s.transformMat4=su,s.transformMat4$1=function(n,e,i){var A=e[0],h=e[1],f=e[2],g=i[3]*A+i[7]*h+i[11]*f+i[15];return n[0]=(i[0]*A+i[4]*h+i[8]*f+i[12])/(g=g||1),n[1]=(i[1]*A+i[5]*h+i[9]*f+i[13])/g,n[2]=(i[2]*A+i[6]*h+i[10]*f+i[14])/g,n},s.transformQuat=N0,s.translate=function(n,e,i){var A,h,f,g,v,w,C,I,T,S,R,H,Z=i[0],te=i[1],ce=i[2];return e===n?(n[12]=e[0]*Z+e[4]*te+e[8]*ce+e[12],n[13]=e[1]*Z+e[5]*te+e[9]*ce+e[13],n[14]=e[2]*Z+e[6]*te+e[10]*ce+e[14],n[15]=e[3]*Z+e[7]*te+e[11]*ce+e[15]):(h=e[1],f=e[2],g=e[3],v=e[4],w=e[5],C=e[6],I=e[7],T=e[8],S=e[9],R=e[10],H=e[11],n[0]=A=e[0],n[1]=h,n[2]=f,n[3]=g,n[4]=v,n[5]=w,n[6]=C,n[7]=I,n[8]=T,n[9]=S,n[10]=R,n[11]=H,n[12]=A*Z+v*te+T*ce+e[12],n[13]=h*Z+w*te+S*ce+e[13],n[14]=f*Z+C*te+R*ce+e[14],n[15]=g*Z+I*te+H*ce+e[15]),n},s.triggerPluginCompletionEvent=_,s.uniqueId=Xe,s.validateCustomStyleLayer=function(n){const e=[],i=n.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),n.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},s.validateFog=jc,s.validateLight=dm,s.validateStyle=Vs,s.values=et,s.vectorTile=QA,s.version=F,s.warnOnce=ke,s.window=V,s.wrap=Ke}),x(["./shared"],function(s){function F(Y){const O=typeof Y;if(O==="number"||O==="boolean"||O==="string"||Y==null)return JSON.stringify(Y);if(Array.isArray(Y)){let le="[";for(const pe of Y)le+=`${F(pe)},`;return`${le}]`}const N=Object.keys(Y).sort();let q="{";for(let le=0;le<N.length;le++)q+=`${JSON.stringify(N[le])}:${F(Y[N[le]])},`;return`${q}}`}function M(Y){let O="";for(const N of s.refProperties)O+=`/${F(Y[N])}`;return O}class z{constructor(O){this.keyCache={},O&&this.replace(O)}replace(O){this._layerConfigs={},this._layers={},this.update(O,[])}update(O,N){for(const le of O)this._layerConfigs[le.id]=le,(this._layers[le.id]=s.createStyleLayer(le)).compileFilter(),this.keyCache[le.id]&&delete this.keyCache[le.id];for(const le of N)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};const q=function(le,pe){const Fe={};for(let me=0;me<le.length;me++){const Te=pe&&pe[le[me].id]||M(le[me]);pe&&(pe[le[me].id]=Te);let Re=Fe[Te];Re||(Re=Fe[Te]=[]),Re.push(le[me])}const Ce=[];for(const me in Fe)Ce.push(Fe[me]);return Ce}(s.values(this._layerConfigs),this.keyCache);for(const le of q){const pe=le.map(lt=>this._layers[lt.id]),Fe=pe[0];if(Fe.visibility==="none")continue;const Ce=Fe.source||"";let me=this.familiesBySource[Ce];me||(me=this.familiesBySource[Ce]={});const Te=Fe.sourceLayer||"_geojsonTileLayer";let Re=me[Te];Re||(Re=me[Te]=[]),Re.push(pe)}}}const{ImageBitmap:L}=s.window;class Q{loadTile(O,N){const{uid:q,encoding:le,rawImageData:pe,padding:Fe,buildQuadTree:Ce}=O,me=L&&pe instanceof L?this.getImageData(pe,Fe):pe;N(null,new s.DEMData(q,me,le,Fe<1,Ce))}getImageData(O,N){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(O.width,O.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=O.width,this.offscreenCanvas.height=O.height,this.offscreenCanvasContext.drawImage(O,0,0,O.width,O.height);const q=this.offscreenCanvasContext.getImageData(-N,-N,O.width+2*N,O.height+2*N);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new s.RGBAImage({width:q.width,height:q.height},q.data)}}var V=function Y(O,N){var q,le=O&&O.type;if(le==="FeatureCollection")for(q=0;q<O.features.length;q++)Y(O.features[q],N);else if(le==="GeometryCollection")for(q=0;q<O.geometries.length;q++)Y(O.geometries[q],N);else if(le==="Feature")Y(O.geometry,N);else if(le==="Polygon")ie(O.coordinates,N);else if(le==="MultiPolygon")for(q=0;q<O.coordinates.length;q++)ie(O.coordinates[q],N);return O};function ie(Y,O){if(Y.length!==0){de(Y[0],O);for(var N=1;N<Y.length;N++)de(Y[N],!O)}}function de(Y,O){for(var N=0,q=0,le=0,pe=Y.length,Fe=pe-1;le<pe;Fe=le++){var Ce=(Y[le][0]-Y[Fe][0])*(Y[Fe][1]+Y[le][1]),me=N+Ce;q+=Math.abs(N)>=Math.abs(Ce)?N-me+Ce:Ce-me+N,N=me}N+q>=0!=!!O&&Y.reverse()}const re=s.vectorTile.VectorTileFeature.prototype.toGeoJSON;class K{constructor(O){this._feature=O,this.extent=s.EXTENT,this.type=O.type,this.properties=O.tags,"id"in O&&!isNaN(O.id)&&(this.id=parseInt(O.id,10))}loadGeometry(){if(this._feature.type===1){const O=[];for(const N of this._feature.geometry)O.push([new s.pointGeometry(N[0],N[1])]);return O}{const O=[];for(const N of this._feature.geometry){const q=[];for(const le of N)q.push(new s.pointGeometry(le[0],le[1]));O.push(q)}return O}}toGeoJSON(O,N,q){return re.call(this,O,N,q)}}class G{constructor(O){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=O.length,this._features=O}feature(O){return new K(this._features[O])}}var ne=s.vectorTile.VectorTileFeature,oe=we;function we(Y,O){this.options=O||{},this.features=Y,this.length=Y.length}function ge(Y,O){this.id=typeof Y.id=="number"?Y.id:void 0,this.type=Y.type,this.rawGeometry=Y.type===1?[Y.geometry]:Y.geometry,this.properties=Y.tags,this.extent=O||4096}we.prototype.feature=function(Y){return new ge(this.features[Y],this.options.extent)},ge.prototype.loadGeometry=function(){var Y=this.rawGeometry;this.geometry=[];for(var O=0;O<Y.length;O++){for(var N=Y[O],q=[],le=0;le<N.length;le++)q.push(new s.pointGeometry(N[le][0],N[le][1]));this.geometry.push(q)}return this.geometry},ge.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Y=this.geometry,O=1/0,N=-1/0,q=1/0,le=-1/0,pe=0;pe<Y.length;pe++)for(var Fe=Y[pe],Ce=0;Ce<Fe.length;Ce++){var me=Fe[Ce];O=Math.min(O,me.x),N=Math.max(N,me.x),q=Math.min(q,me.y),le=Math.max(le,me.y)}return[O,q,N,le]},ge.prototype.toGeoJSON=ne.prototype.toGeoJSON;var Ue=Me,Ke=oe;function Me(Y){var O=new s.pbf;return function(N,q){for(var le in N.layers)q.writeMessage(3,et,N.layers[le])}(Y,O),O.finish()}function et(Y,O){var N;O.writeVarintField(15,Y.version||1),O.writeStringField(1,Y.name||""),O.writeVarintField(5,Y.extent||4096);var q={keys:[],values:[],keycache:{},valuecache:{}};for(N=0;N<Y.length;N++)q.feature=Y.feature(N),O.writeMessage(2,qe,q);var le=q.keys;for(N=0;N<le.length;N++)O.writeStringField(3,le[N]);var pe=q.values;for(N=0;N<pe.length;N++)O.writeMessage(4,Et,pe[N])}function qe(Y,O){var N=Y.feature;N.id!==void 0&&O.writeVarintField(1,N.id),O.writeMessage(2,it,Y),O.writeVarintField(3,N.type),O.writeMessage(4,At,N)}function it(Y,O){var N=Y.feature,q=Y.keys,le=Y.values,pe=Y.keycache,Fe=Y.valuecache;for(var Ce in N.properties){var me=N.properties[Ce],Te=pe[Ce];if(me!==null){Te===void 0&&(q.push(Ce),pe[Ce]=Te=q.length-1),O.writeVarint(Te);var Re=typeof me;Re!=="string"&&Re!=="boolean"&&Re!=="number"&&(me=JSON.stringify(me));var lt=Re+":"+me,$e=Fe[lt];$e===void 0&&(le.push(me),Fe[lt]=$e=le.length-1),O.writeVarint($e)}}}function Xe(Y,O){return(O<<3)+(7&Y)}function Ne(Y){return Y<<1^Y>>31}function At(Y,O){for(var N=Y.loadGeometry(),q=Y.type,le=0,pe=0,Fe=N.length,Ce=0;Ce<Fe;Ce++){var me=N[Ce],Te=1;q===1&&(Te=me.length),O.writeVarint(Xe(1,Te));for(var Re=q===3?me.length-1:me.length,lt=0;lt<Re;lt++){lt===1&&q!==1&&O.writeVarint(Xe(2,Re-1));var $e=me[lt].x-le,St=me[lt].y-pe;O.writeVarint(Ne($e)),O.writeVarint(Ne(St)),le+=$e,pe+=St}q===3&&O.writeVarint(Xe(7,1))}}function Et(Y,O){var N=typeof Y;N==="string"?O.writeStringField(1,Y):N==="boolean"?O.writeBooleanField(7,Y):N==="number"&&(Y%1!=0?O.writeDoubleField(3,Y):Y<0?O.writeSVarintField(6,Y):O.writeVarintField(5,Y))}function It(Y,O,N,q,le,pe){if(le-q<=N)return;const Fe=q+le>>1;Ut(Y,O,Fe,q,le,pe%2),It(Y,O,N,q,Fe-1,pe+1),It(Y,O,N,Fe+1,le,pe+1)}function Ut(Y,O,N,q,le,pe){for(;le>q;){if(le-q>600){const Te=le-q+1,Re=N-q+1,lt=Math.log(Te),$e=.5*Math.exp(2*lt/3),St=.5*Math.sqrt(lt*$e*(Te-$e)/Te)*(Re-Te/2<0?-1:1);Ut(Y,O,N,Math.max(q,Math.floor(N-Re*$e/Te+St)),Math.min(le,Math.floor(N+(Te-Re)*$e/Te+St)),pe)}const Fe=O[2*N+pe];let Ce=q,me=le;for(Dt(Y,O,q,N),O[2*le+pe]>Fe&&Dt(Y,O,q,le);Ce<me;){for(Dt(Y,O,Ce,me),Ce++,me--;O[2*Ce+pe]<Fe;)Ce++;for(;O[2*me+pe]>Fe;)me--}O[2*q+pe]===Fe?Dt(Y,O,q,me):(me++,Dt(Y,O,me,le)),me<=N&&(q=me+1),N<=me&&(le=me-1)}}function Dt(Y,O,N,q){Vt(Y,N,q),Vt(O,2*N,2*q),Vt(O,2*N+1,2*q+1)}function Vt(Y,O,N){const q=Y[O];Y[O]=Y[N],Y[N]=q}function Je(Y,O,N,q){const le=Y-N,pe=O-q;return le*le+pe*pe}Ue.fromVectorTileJs=Me,Ue.fromGeojsonVt=function(Y,O){O=O||{};var N={};for(var q in Y)N[q]=new oe(Y[q].features,O),N[q].name=q,N[q].version=O.version,N[q].extent=O.extent;return Me({layers:N})},Ue.GeoJSONWrapper=Ke;const yt=Y=>Y[0],ke=Y=>Y[1];class xt{constructor(O,N=yt,q=ke,le=64,pe=Float64Array){this.nodeSize=le,this.points=O;const Fe=O.length<65536?Uint16Array:Uint32Array,Ce=this.ids=new Fe(O.length),me=this.coords=new pe(2*O.length);for(let Te=0;Te<O.length;Te++)Ce[Te]=Te,me[2*Te]=N(O[Te]),me[2*Te+1]=q(O[Te]);It(Ce,me,le,0,Ce.length-1,0)}range(O,N,q,le){return function(pe,Fe,Ce,me,Te,Re,lt){const $e=[0,pe.length-1,0],St=[];let ut,xe;for(;$e.length;){const Pe=$e.pop(),zt=$e.pop(),ar=$e.pop();if(zt-ar<=lt){for(let or=ar;or<=zt;or++)ut=Fe[2*or],xe=Fe[2*or+1],ut>=Ce&&ut<=Te&&xe>=me&&xe<=Re&&St.push(pe[or]);continue}const Rt=Math.floor((ar+zt)/2);ut=Fe[2*Rt],xe=Fe[2*Rt+1],ut>=Ce&&ut<=Te&&xe>=me&&xe<=Re&&St.push(pe[Rt]);const ir=(Pe+1)%2;(Pe===0?Ce<=ut:me<=xe)&&($e.push(ar),$e.push(Rt-1),$e.push(ir)),(Pe===0?Te>=ut:Re>=xe)&&($e.push(Rt+1),$e.push(zt),$e.push(ir))}return St}(this.ids,this.coords,O,N,q,le,this.nodeSize)}within(O,N,q){return function(le,pe,Fe,Ce,me,Te){const Re=[0,le.length-1,0],lt=[],$e=me*me;for(;Re.length;){const St=Re.pop(),ut=Re.pop(),xe=Re.pop();if(ut-xe<=Te){for(let ir=xe;ir<=ut;ir++)Je(pe[2*ir],pe[2*ir+1],Fe,Ce)<=$e&&lt.push(le[ir]);continue}const Pe=Math.floor((xe+ut)/2),zt=pe[2*Pe],ar=pe[2*Pe+1];Je(zt,ar,Fe,Ce)<=$e&&lt.push(le[Pe]);const Rt=(St+1)%2;(St===0?Fe-me<=zt:Ce-me<=ar)&&(Re.push(xe),Re.push(Pe-1),Re.push(Rt)),(St===0?Fe+me>=zt:Ce+me>=ar)&&(Re.push(Pe+1),Re.push(ut),Re.push(Rt))}return lt}(this.ids,this.coords,O,N,q,this.nodeSize)}}const Se={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Y=>Y},ot=Math.fround||(vt=new Float32Array(1),Y=>(vt[0]=+Y,vt[0]));var vt;class Ot{constructor(O){this.options=Ct(Object.create(Se),O),this.trees=new Array(this.options.maxZoom+1)}load(O){const{log:N,minZoom:q,maxZoom:le,nodeSize:pe}=this.options;N&&console.time("total time");const Fe=`prepare ${O.length} points`;N&&console.time(Fe),this.points=O;let Ce=[];for(let me=0;me<O.length;me++)O[me].geometry&&Ce.push(tr(O[me],me));this.trees[le+1]=new xt(Ce,mi,Nr,pe,Float32Array),N&&console.timeEnd(Fe);for(let me=le;me>=q;me--){const Te=+Date.now();Ce=this._cluster(Ce,me),this.trees[me]=new xt(Ce,mi,Nr,pe,Float32Array),N&&console.log("z%d: %d clusters in %dms",me,Ce.length,+Date.now()-Te)}return N&&console.timeEnd("total time"),this}getClusters(O,N){let q=((O[0]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,O[1]));let pe=O[2]===180?180:((O[2]+180)%360+360)%360-180;const Fe=Math.max(-90,Math.min(90,O[3]));if(O[2]-O[0]>=360)q=-180,pe=180;else if(q>pe){const Re=this.getClusters([q,le,180,Fe],N),lt=this.getClusters([-180,le,pe,Fe],N);return Re.concat(lt)}const Ce=this.trees[this._limitZoom(N)],me=Ce.range(sr(q),dr(Fe),sr(pe),dr(le)),Te=[];for(const Re of me){const lt=Ce.points[Re];Te.push(lt.numPoints?br(lt):this.points[lt.index])}return Te}getChildren(O){const N=this._getOriginId(O),q=this._getOriginZoom(O),le="No cluster with the specified id.",pe=this.trees[q];if(!pe)throw new Error(le);const Fe=pe.points[N];if(!Fe)throw new Error(le);const Ce=this.options.radius/(this.options.extent*Math.pow(2,q-1)),me=pe.within(Fe.x,Fe.y,Ce),Te=[];for(const Re of me){const lt=pe.points[Re];lt.parentId===O&&Te.push(lt.numPoints?br(lt):this.points[lt.index])}if(Te.length===0)throw new Error(le);return Te}getLeaves(O,N,q){const le=[];return this._appendLeaves(le,O,N=N||10,q=q||0,0),le}getTile(O,N,q){const le=this.trees[this._limitZoom(O)],pe=Math.pow(2,O),{extent:Fe,radius:Ce}=this.options,me=Ce/Fe,Te=(q-me)/pe,Re=(q+1+me)/pe,lt={features:[]};return this._addTileFeatures(le.range((N-me)/pe,Te,(N+1+me)/pe,Re),le.points,N,q,pe,lt),N===0&&this._addTileFeatures(le.range(1-me/pe,Te,1,Re),le.points,pe,q,pe,lt),N===pe-1&&this._addTileFeatures(le.range(0,Te,me/pe,Re),le.points,-1,q,pe,lt),lt.features.length?lt:null}getClusterExpansionZoom(O){let N=this._getOriginZoom(O)-1;for(;N<=this.options.maxZoom;){const q=this.getChildren(O);if(N++,q.length!==1)break;O=q[0].properties.cluster_id}return N}_appendLeaves(O,N,q,le,pe){const Fe=this.getChildren(N);for(const Ce of Fe){const me=Ce.properties;if(me&&me.cluster?pe+me.point_count<=le?pe+=me.point_count:pe=this._appendLeaves(O,me.cluster_id,q,le,pe):pe<le?pe++:O.push(Ce),O.length===q)break}return pe}_addTileFeatures(O,N,q,le,pe,Fe){for(const Ce of O){const me=N[Ce],Te=me.numPoints;let Re,lt,$e;if(Te)Re=Dr(me),lt=me.x,$e=me.y;else{const xe=this.points[me.index];Re=xe.properties,lt=sr(xe.geometry.coordinates[0]),$e=dr(xe.geometry.coordinates[1])}const St={type:1,geometry:[[Math.round(this.options.extent*(lt*pe-q)),Math.round(this.options.extent*($e*pe-le))]],tags:Re};let ut;Te?ut=me.id:this.options.generateId?ut=me.index:this.points[me.index].id&&(ut=this.points[me.index].id),ut!==void 0&&(St.id=ut),Fe.features.push(St)}}_limitZoom(O){return Math.max(this.options.minZoom,Math.min(+O,this.options.maxZoom+1))}_cluster(O,N){const q=[],{radius:le,extent:pe,reduce:Fe,minPoints:Ce}=this.options,me=le/(pe*Math.pow(2,N));for(let Te=0;Te<O.length;Te++){const Re=O[Te];if(Re.zoom<=N)continue;Re.zoom=N;const lt=this.trees[N+1],$e=lt.within(Re.x,Re.y,me),St=Re.numPoints||1;let ut=St;for(const xe of $e){const Pe=lt.points[xe];Pe.zoom>N&&(ut+=Pe.numPoints||1)}if(ut>St&&ut>=Ce){let xe=Re.x*St,Pe=Re.y*St,zt=Fe&&St>1?this._map(Re,!0):null;const ar=(Te<<5)+(N+1)+this.points.length;for(const Rt of $e){const ir=lt.points[Rt];if(ir.zoom<=N)continue;ir.zoom=N;const or=ir.numPoints||1;xe+=ir.x*or,Pe+=ir.y*or,ir.parentId=ar,Fe&&(zt||(zt=this._map(Re,!0)),Fe(zt,this._map(ir)))}Re.parentId=ar,q.push(nt(xe/ut,Pe/ut,ar,ut,zt))}else if(q.push(Re),ut>1)for(const xe of $e){const Pe=lt.points[xe];Pe.zoom<=N||(Pe.zoom=N,q.push(Pe))}}return q}_getOriginId(O){return O-this.points.length>>5}_getOriginZoom(O){return(O-this.points.length)%32}_map(O,N){if(O.numPoints)return N?Ct({},O.properties):O.properties;const q=this.points[O.index].properties,le=this.options.map(q);return N&&le===q?Ct({},le):le}}function nt(Y,O,N,q,le){return{x:ot(Y),y:ot(O),zoom:1/0,id:N,parentId:-1,numPoints:q,properties:le}}function tr(Y,O){const[N,q]=Y.geometry.coordinates;return{x:ot(sr(N)),y:ot(dr(q)),zoom:1/0,index:O,parentId:-1}}function br(Y){return{type:"Feature",id:Y.id,properties:Dr(Y),geometry:{type:"Point",coordinates:[(O=Y.x,360*(O-.5)),An(Y.y)]}};var O}function Dr(Y){const O=Y.numPoints,N=O>=1e4?`${Math.round(O/1e3)}k`:O>=1e3?Math.round(O/100)/10+"k":O;return Ct(Ct({},Y.properties),{cluster:!0,cluster_id:Y.id,point_count:O,point_count_abbreviated:N})}function sr(Y){return Y/360+.5}function dr(Y){const O=Math.sin(Y*Math.PI/180),N=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return N<0?0:N>1?1:N}function An(Y){const O=(180-360*Y)*Math.PI/180;return 360*Math.atan(Math.exp(O))/Math.PI-90}function Ct(Y,O){for(const N in O)Y[N]=O[N];return Y}function mi(Y){return Y.x}function Nr(Y){return Y.y}function $r(Y,O,N,q){for(var le,pe=q,Fe=N-O>>1,Ce=N-O,me=Y[O],Te=Y[O+1],Re=Y[N],lt=Y[N+1],$e=O+3;$e<N;$e+=3){var St=to(Y[$e],Y[$e+1],me,Te,Re,lt);if(St>pe)le=$e,pe=St;else if(St===pe){var ut=Math.abs($e-Fe);ut<Ce&&(le=$e,Ce=ut)}}pe>q&&(le-O>3&&$r(Y,O,le,q),Y[le+2]=pe,N-le>3&&$r(Y,le,N,q))}function to(Y,O,N,q,le,pe){var Fe=le-N,Ce=pe-q;if(Fe!==0||Ce!==0){var me=((Y-N)*Fe+(O-q)*Ce)/(Fe*Fe+Ce*Ce);me>1?(N=le,q=pe):me>0&&(N+=Fe*me,q+=Ce*me)}return(Fe=Y-N)*Fe+(Ce=O-q)*Ce}function Ii(Y,O,N,q){var le={id:Y===void 0?null:Y,type:O,geometry:N,tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(pe){var Fe=pe.geometry,Ce=pe.type;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")gi(pe,Fe);else if(Ce==="Polygon"||Ce==="MultiLineString")for(var me=0;me<Fe.length;me++)gi(pe,Fe[me]);else if(Ce==="MultiPolygon")for(me=0;me<Fe.length;me++)for(var Te=0;Te<Fe[me].length;Te++)gi(pe,Fe[me][Te])}(le),le}function gi(Y,O){for(var N=0;N<O.length;N+=3)Y.minX=Math.min(Y.minX,O[N]),Y.minY=Math.min(Y.minY,O[N+1]),Y.maxX=Math.max(Y.maxX,O[N]),Y.maxY=Math.max(Y.maxY,O[N+1])}function ro(Y,O,N,q){if(O.geometry){var le=O.geometry.coordinates,pe=O.geometry.type,Fe=Math.pow(N.tolerance/((1<<N.maxZoom)*N.extent),2),Ce=[],me=O.id;if(N.promoteId?me=O.properties[N.promoteId]:N.generateId&&(me=q||0),pe==="Point")Ki(le,Ce);else if(pe==="MultiPoint")for(var Te=0;Te<le.length;Te++)Ki(le[Te],Ce);else if(pe==="LineString")Mn(le,Ce,Fe,!1);else if(pe==="MultiLineString"){if(N.lineMetrics){for(Te=0;Te<le.length;Te++)Mn(le[Te],Ce=[],Fe,!1),Y.push(Ii(me,"LineString",Ce,O.properties));return}Ti(le,Ce,Fe,!1)}else if(pe==="Polygon")Ti(le,Ce,Fe,!0);else{if(pe!=="MultiPolygon"){if(pe==="GeometryCollection"){for(Te=0;Te<O.geometry.geometries.length;Te++)ro(Y,{id:me,geometry:O.geometry.geometries[Te],properties:O.properties},N,q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Te=0;Te<le.length;Te++){var Re=[];Ti(le[Te],Re,Fe,!0),Ce.push(Re)}}Y.push(Ii(me,pe,Ce,O.properties))}}function Ki(Y,O){O.push(Vo(Y[0])),O.push(Ln(Y[1])),O.push(0)}function Mn(Y,O,N,q){for(var le,pe,Fe=0,Ce=0;Ce<Y.length;Ce++){var me=Vo(Y[Ce][0]),Te=Ln(Y[Ce][1]);O.push(me),O.push(Te),O.push(0),Ce>0&&(Fe+=q?(le*Te-me*pe)/2:Math.sqrt(Math.pow(me-le,2)+Math.pow(Te-pe,2))),le=me,pe=Te}var Re=O.length-3;O[2]=1,$r(O,0,Re,N),O[Re+2]=1,O.size=Math.abs(Fe),O.start=0,O.end=O.size}function Ti(Y,O,N,q){for(var le=0;le<Y.length;le++){var pe=[];Mn(Y[le],pe,N,q),O.push(pe)}}function Vo(Y){return Y/360+.5}function Ln(Y){var O=Math.sin(Y*Math.PI/180),N=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return N<0?0:N>1?1:N}function wn(Y,O,N,q,le,pe,Fe,Ce){if(q/=O,pe>=(N/=O)&&Fe<q)return Y;if(Fe<N||pe>=q)return null;for(var me=[],Te=0;Te<Y.length;Te++){var Re=Y[Te],lt=Re.geometry,$e=Re.type,St=le===0?Re.minX:Re.minY,ut=le===0?Re.maxX:Re.maxY;if(St>=N&&ut<q)me.push(Re);else if(!(ut<N||St>=q)){var xe=[];if($e==="Point"||$e==="MultiPoint")os(lt,xe,N,q,le);else if($e==="LineString")Ui(lt,xe,N,q,le,!1,Ce.lineMetrics);else if($e==="MultiLineString")_o(lt,xe,N,q,le,!1);else if($e==="Polygon")_o(lt,xe,N,q,le,!0);else if($e==="MultiPolygon")for(var Pe=0;Pe<lt.length;Pe++){var zt=[];_o(lt[Pe],zt,N,q,le,!0),zt.length&&xe.push(zt)}if(xe.length){if(Ce.lineMetrics&&$e==="LineString"){for(Pe=0;Pe<xe.length;Pe++)me.push(Ii(Re.id,$e,xe[Pe],Re.tags));continue}$e!=="LineString"&&$e!=="MultiLineString"||(xe.length===1?($e="LineString",xe=xe[0]):$e="MultiLineString"),$e!=="Point"&&$e!=="MultiPoint"||($e=xe.length===3?"Point":"MultiPoint"),me.push(Ii(Re.id,$e,xe,Re.tags))}}}return me.length?me:null}function os(Y,O,N,q,le){for(var pe=0;pe<Y.length;pe+=3){var Fe=Y[pe+le];Fe>=N&&Fe<=q&&(O.push(Y[pe]),O.push(Y[pe+1]),O.push(Y[pe+2]))}}function Ui(Y,O,N,q,le,pe,Fe){for(var Ce,me,Te=no(Y),Re=le===0?ss:Si,lt=Y.start,$e=0;$e<Y.length-3;$e+=3){var St=Y[$e],ut=Y[$e+1],xe=Y[$e+2],Pe=Y[$e+3],zt=Y[$e+4],ar=le===0?St:ut,Rt=le===0?Pe:zt,ir=!1;Fe&&(Ce=Math.sqrt(Math.pow(St-Pe,2)+Math.pow(ut-zt,2))),ar<N?Rt>N&&(me=Re(Te,St,ut,Pe,zt,N),Fe&&(Te.start=lt+Ce*me)):ar>q?Rt<q&&(me=Re(Te,St,ut,Pe,zt,q),Fe&&(Te.start=lt+Ce*me)):ln(Te,St,ut,xe),Rt<N&&ar>=N&&(me=Re(Te,St,ut,Pe,zt,N),ir=!0),Rt>q&&ar<=q&&(me=Re(Te,St,ut,Pe,zt,q),ir=!0),!pe&&ir&&(Fe&&(Te.end=lt+Ce*me),O.push(Te),Te=no(Y)),Fe&&(lt+=Ce)}var or=Y.length-3;St=Y[or],ut=Y[or+1],xe=Y[or+2],(ar=le===0?St:ut)>=N&&ar<=q&&ln(Te,St,ut,xe),or=Te.length-3,pe&&or>=3&&(Te[or]!==Te[0]||Te[or+1]!==Te[1])&&ln(Te,Te[0],Te[1],Te[2]),Te.length&&O.push(Te)}function no(Y){var O=[];return O.size=Y.size,O.start=Y.start,O.end=Y.end,O}function _o(Y,O,N,q,le,pe){for(var Fe=0;Fe<Y.length;Fe++)Ui(Y[Fe],O,N,q,le,pe,!1)}function ln(Y,O,N,q){Y.push(O),Y.push(N),Y.push(q)}function ss(Y,O,N,q,le,pe){var Fe=(pe-O)/(q-O);return Y.push(pe),Y.push(N+(le-N)*Fe),Y.push(1),Fe}function Si(Y,O,N,q,le,pe){var Fe=(pe-N)/(le-N);return Y.push(O+(q-O)*Fe),Y.push(pe),Y.push(1),Fe}function vo(Y,O){for(var N=[],q=0;q<Y.length;q++){var le,pe=Y[q],Fe=pe.type;if(Fe==="Point"||Fe==="MultiPoint"||Fe==="LineString")le=Zn(pe.geometry,O);else if(Fe==="MultiLineString"||Fe==="Polygon"){le=[];for(var Ce=0;Ce<pe.geometry.length;Ce++)le.push(Zn(pe.geometry[Ce],O))}else if(Fe==="MultiPolygon")for(le=[],Ce=0;Ce<pe.geometry.length;Ce++){for(var me=[],Te=0;Te<pe.geometry[Ce].length;Te++)me.push(Zn(pe.geometry[Ce][Te],O));le.push(me)}N.push(Ii(pe.id,Fe,le,pe.tags))}return N}function Zn(Y,O){var N=[];N.size=Y.size,Y.start!==void 0&&(N.start=Y.start,N.end=Y.end);for(var q=0;q<Y.length;q+=3)N.push(Y[q]+O,Y[q+1],Y[q+2]);return N}function qr(Y,O){if(Y.transformed)return Y;var N,q,le,pe=1<<Y.z,Fe=Y.x,Ce=Y.y;for(N=0;N<Y.features.length;N++){var me=Y.features[N],Te=me.geometry,Re=me.type;if(me.geometry=[],Re===1)for(q=0;q<Te.length;q+=2)me.geometry.push(Tn(Te[q],Te[q+1],O,pe,Fe,Ce));else for(q=0;q<Te.length;q++){var lt=[];for(le=0;le<Te[q].length;le+=2)lt.push(Tn(Te[q][le],Te[q][le+1],O,pe,Fe,Ce));me.geometry.push(lt)}}return Y.transformed=!0,Y}function Tn(Y,O,N,q,le,pe){return[Math.round(N*(Y*q-le)),Math.round(N*(O*q-pe))]}function Qi(Y,O,N,q,le){for(var pe=O===le.maxZoom?0:le.tolerance/((1<<O)*le.extent),Fe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:N,y:q,z:O,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ce=0;Ce<Y.length;Ce++){Fe.numFeatures++,as(Fe,Y[Ce],pe,le);var me=Y[Ce].minX,Te=Y[Ce].minY,Re=Y[Ce].maxX,lt=Y[Ce].maxY;me<Fe.minX&&(Fe.minX=me),Te<Fe.minY&&(Fe.minY=Te),Re>Fe.maxX&&(Fe.maxX=Re),lt>Fe.maxY&&(Fe.maxY=lt)}return Fe}function as(Y,O,N,q){var le=O.geometry,pe=O.type,Fe=[];if(pe==="Point"||pe==="MultiPoint")for(var Ce=0;Ce<le.length;Ce+=3)Fe.push(le[Ce]),Fe.push(le[Ce+1]),Y.numPoints++,Y.numSimplified++;else if(pe==="LineString")Dn(Fe,le,Y,N,!1,!1);else if(pe==="MultiLineString"||pe==="Polygon")for(Ce=0;Ce<le.length;Ce++)Dn(Fe,le[Ce],Y,N,pe==="Polygon",Ce===0);else if(pe==="MultiPolygon")for(var me=0;me<le.length;me++){var Te=le[me];for(Ce=0;Ce<Te.length;Ce++)Dn(Fe,Te[Ce],Y,N,!0,Ce===0)}if(Fe.length){var Re=O.tags||null;if(pe==="LineString"&&q.lineMetrics){for(var lt in Re={},O.tags)Re[lt]=O.tags[lt];Re.mapbox_clip_start=le.start/le.size,Re.mapbox_clip_end=le.end/le.size}var $e={geometry:Fe,type:pe==="Polygon"||pe==="MultiPolygon"?3:pe==="LineString"||pe==="MultiLineString"?2:1,tags:Re};O.id!==null&&($e.id=O.id),Y.features.push($e)}}function Dn(Y,O,N,q,le,pe){var Fe=q*q;if(q>0&&O.size<(le?Fe:q))N.numPoints+=O.length/3;else{for(var Ce=[],me=0;me<O.length;me+=3)(q===0||O[me+2]>Fe)&&(N.numSimplified++,Ce.push(O[me]),Ce.push(O[me+1])),N.numPoints++;le&&function(Te,Re){for(var lt=0,$e=0,St=Te.length,ut=St-2;$e<St;ut=$e,$e+=2)lt+=(Te[$e]-Te[ut])*(Te[$e+1]+Te[ut+1]);if(lt>0===Re)for($e=0,St=Te.length;$e<St/2;$e+=2){var xe=Te[$e],Pe=Te[$e+1];Te[$e]=Te[St-2-$e],Te[$e+1]=Te[St-1-$e],Te[St-2-$e]=xe,Te[St-1-$e]=Pe}}(Ce,pe),Y.push(Ce)}}function oi(Y,O){var N=(O=this.options=function(le,pe){for(var Fe in pe)le[Fe]=pe[Fe];return le}(Object.create(this.options),O)).debug;if(N&&console.time("preprocess data"),O.maxZoom<0||O.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(O.promoteId&&O.generateId)throw new Error("promoteId and generateId cannot be used together.");var q=function(le,pe){var Fe=[];if(le.type==="FeatureCollection")for(var Ce=0;Ce<le.features.length;Ce++)ro(Fe,le.features[Ce],pe,Ce);else ro(Fe,le.type==="Feature"?le:{geometry:le},pe);return Fe}(Y,O);this.tiles={},this.tileCoords=[],N&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",O.indexMaxZoom,O.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(q=function(le,pe){var Fe=pe.buffer/pe.extent,Ce=le,me=wn(le,1,-1-Fe,Fe,0,-1,2,pe),Te=wn(le,1,1-Fe,2+Fe,0,-1,2,pe);return(me||Te)&&(Ce=wn(le,1,-Fe,1+Fe,0,-1,2,pe)||[],me&&(Ce=vo(me,1).concat(Ce)),Te&&(Ce=Ce.concat(vo(Te,-1)))),Ce}(q,O)).length&&this.splitTile(q,0,0,0),N&&(q.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Mi(Y,O,N){return 32*((1<<Y)*N+O)+Y}function Ko(Y,O){const N=Y.tileID.canonical;if(!this._geoJSONIndex)return O(null,null);const q=this._geoJSONIndex.getTile(N.z,N.x,N.y);if(!q)return O(null,null);const le=new G(q.features);let pe=Ue(le);pe.byteOffset===0&&pe.byteLength===pe.buffer.byteLength||(pe=new Uint8Array(pe)),O(null,{vectorTile:le,rawData:pe.buffer})}oi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},oi.prototype.splitTile=function(Y,O,N,q,le,pe,Fe){for(var Ce=[Y,O,N,q],me=this.options,Te=me.debug;Ce.length;){q=Ce.pop(),N=Ce.pop(),O=Ce.pop(),Y=Ce.pop();var Re=1<<O,lt=Mi(O,N,q),$e=this.tiles[lt];if(!$e&&(Te>1&&console.time("creation"),$e=this.tiles[lt]=Qi(Y,O,N,q,me),this.tileCoords.push({z:O,x:N,y:q}),Te)){Te>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",O,N,q,$e.numFeatures,$e.numPoints,$e.numSimplified),console.timeEnd("creation"));var St="z"+O;this.stats[St]=(this.stats[St]||0)+1,this.total++}if($e.source=Y,le){if(O===me.maxZoom||O===le)continue;var ut=1<<le-O;if(N!==Math.floor(pe/ut)||q!==Math.floor(Fe/ut))continue}else if(O===me.indexMaxZoom||$e.numPoints<=me.indexMaxPoints)continue;if($e.source=null,Y.length!==0){Te>1&&console.time("clipping");var xe,Pe,zt,ar,Rt,ir,or=.5*me.buffer/me.extent,io=.5-or,cn=.5+or,dt=1+or;xe=Pe=zt=ar=null,Rt=wn(Y,Re,N-or,N+cn,0,$e.minX,$e.maxX,me),ir=wn(Y,Re,N+io,N+dt,0,$e.minX,$e.maxX,me),Y=null,Rt&&(xe=wn(Rt,Re,q-or,q+cn,1,$e.minY,$e.maxY,me),Pe=wn(Rt,Re,q+io,q+dt,1,$e.minY,$e.maxY,me),Rt=null),ir&&(zt=wn(ir,Re,q-or,q+cn,1,$e.minY,$e.maxY,me),ar=wn(ir,Re,q+io,q+dt,1,$e.minY,$e.maxY,me),ir=null),Te>1&&console.timeEnd("clipping"),Ce.push(xe||[],O+1,2*N,2*q),Ce.push(Pe||[],O+1,2*N,2*q+1),Ce.push(zt||[],O+1,2*N+1,2*q),Ce.push(ar||[],O+1,2*N+1,2*q+1)}}},oi.prototype.getTile=function(Y,O,N){var q=this.options,le=q.extent,pe=q.debug;if(Y<0||Y>24)return null;var Fe=1<<Y,Ce=Mi(Y,O=(O%Fe+Fe)%Fe,N);if(this.tiles[Ce])return qr(this.tiles[Ce],le);pe>1&&console.log("drilling down to z%d-%d-%d",Y,O,N);for(var me,Te=Y,Re=O,lt=N;!me&&Te>0;)Te--,Re=Math.floor(Re/2),lt=Math.floor(lt/2),me=this.tiles[Mi(Te,Re,lt)];return me&&me.source?(pe>1&&console.log("found parent tile z%d-%d-%d",Te,Re,lt),pe>1&&console.time("drilling down"),this.splitTile(me.source,Te,Re,lt,Y,O,N),pe>1&&console.timeEnd("drilling down"),this.tiles[Ce]?qr(this.tiles[Ce],le):null):null};class Li extends s.VectorTileWorkerSource{constructor(O,N,q,le,pe){super(O,N,q,le,Ko),pe&&(this.loadGeoJSON=pe)}loadData(O,N){const q=O&&O.request,le=q&&q.collectResourceTiming;this.loadGeoJSON(O,(pe,Fe)=>{if(pe||!Fe)return N(pe);if(typeof Fe!="object")return N(new Error(`Input data given to '${O.source}' is not a valid GeoJSON object.`));{V(Fe,!0);try{if(O.filter){const me=s.createExpression(O.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(me.result==="error")throw new Error(me.value.map(Re=>`${Re.key}: ${Re.message}`).join(", "));Fe={type:"FeatureCollection",features:Fe.features.filter(Re=>me.value.evaluate({zoom:0},Re))}}this._geoJSONIndex=O.cluster?new Ot(function({superclusterOptions:me,clusterProperties:Te}){if(!Te||!me)return me;const Re={},lt={},$e={accumulated:null,zoom:0},St={properties:null},ut=Object.keys(Te);for(const xe of ut){const[Pe,zt]=Te[xe],ar=s.createExpression(zt),Rt=s.createExpression(typeof Pe=="string"?[Pe,["accumulated"],["get",xe]]:Pe);Re[xe]=ar.value,lt[xe]=Rt.value}return me.map=xe=>{St.properties=xe;const Pe={};for(const zt of ut)Pe[zt]=Re[zt].evaluate($e,St);return Pe},me.reduce=(xe,Pe)=>{St.properties=Pe;for(const zt of ut)$e.accumulated=xe[zt],xe[zt]=lt[zt].evaluate($e,St)},me}(O)).load(Fe.features):function(me,Te){return new oi(me,Te)}(Fe,O.geojsonVtOptions)}catch(me){return N(me)}this.loaded={};const Ce={};if(le){const me=s.getPerformanceMeasurement(q);me&&(Ce.resourceTiming={},Ce.resourceTiming[O.source]=JSON.parse(JSON.stringify(me)))}N(null,Ce)}})}reloadTile(O,N){const q=this.loaded;return q&&q[O.uid]?super.reloadTile(O,N):this.loadTile(O,N)}loadGeoJSON(O,N){if(O.request)s.getJSON(O.request,N);else{if(typeof O.data!="string")return N(new Error(`Input data given to '${O.source}' is not a valid GeoJSON object.`));try{return N(null,JSON.parse(O.data))}catch{return N(new Error(`Input data given to '${O.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(O,N){try{N(null,this._geoJSONIndex.getClusterExpansionZoom(O.clusterId))}catch(q){N(q)}}getClusterChildren(O,N){try{N(null,this._geoJSONIndex.getChildren(O.clusterId))}catch(q){N(q)}}getClusterLeaves(O,N){try{N(null,this._geoJSONIndex.getLeaves(O.clusterId,O.limit,O.offset))}catch(q){N(q)}}}class nn{constructor(O){this.self=O,this.actor=new s.Actor(O,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:Li},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(N,q)=>{if(this.workerSourceTypes[N])throw new Error(`Worker source with name "${N}" already registered.`);this.workerSourceTypes[N]=q},this.self.registerRTLTextPlugin=N=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=N.applyArabicShaping,s.plugin.processBidirectionalText=N.processBidirectionalText,s.plugin.processStyledBidirectionalText=N.processStyledBidirectionalText}}clearCaches(O,N,q){delete this.layerIndexes[O],delete this.availableImages[O],delete this.workerSources[O],delete this.demWorkerSources[O],q()}checkIfReady(O,N,q){q()}setReferrer(O,N){this.referrer=N}spriteLoaded(O,N){this.isSpriteLoaded[O]=N;for(const q in this.workerSources[O]){const le=this.workerSources[O][q];for(const pe in le)le[pe]instanceof s.VectorTileWorkerSource&&(le[pe].isSpriteLoaded=N,le[pe].fire(new s.Event("isSpriteLoaded")))}}setImages(O,N,q){this.availableImages[O]=N;for(const le in this.workerSources[O]){const pe=this.workerSources[O][le];for(const Fe in pe)pe[Fe].availableImages=N}q()}enableTerrain(O,N,q){this.terrain=N,q()}setProjection(O,N){this.projections[O]=s.getProjection(N)}setLayers(O,N,q){this.getLayerIndex(O).replace(N),q()}updateLayers(O,N,q){this.getLayerIndex(O).update(N.layers,N.removedIds),q()}loadTile(O,N,q){const le=this.enableTerrain?s.extend({enableTerrain:this.terrain},N):N;le.projection=this.projections[O]||this.defaultProjection,this.getWorkerSource(O,N.type,N.source).loadTile(le,q)}loadDEMTile(O,N,q){const le=this.enableTerrain?s.extend({buildQuadTree:this.terrain},N):N;this.getDEMWorkerSource(O,N.source).loadTile(le,q)}reloadTile(O,N,q){const le=this.enableTerrain?s.extend({enableTerrain:this.terrain},N):N;le.projection=this.projections[O]||this.defaultProjection,this.getWorkerSource(O,N.type,N.source).reloadTile(le,q)}abortTile(O,N,q){this.getWorkerSource(O,N.type,N.source).abortTile(N,q)}removeTile(O,N,q){this.getWorkerSource(O,N.type,N.source).removeTile(N,q)}removeSource(O,N,q){if(!this.workerSources[O]||!this.workerSources[O][N.type]||!this.workerSources[O][N.type][N.source])return;const le=this.workerSources[O][N.type][N.source];delete this.workerSources[O][N.type][N.source],le.removeSource!==void 0?le.removeSource(N,q):q()}loadWorkerSource(O,N,q){try{this.self.importScripts(N.url),q()}catch(le){q(le.toString())}}syncRTLPluginState(O,N,q){try{s.plugin.setState(N);const le=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&le!=null){this.self.importScripts(le);const pe=s.plugin.isParsed();q(pe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${le}`),pe)}}catch(le){q(le.toString())}}getAvailableImages(O){let N=this.availableImages[O];return N||(N=[]),N}getLayerIndex(O){let N=this.layerIndexes[O];return N||(N=this.layerIndexes[O]=new z),N}getWorkerSource(O,N,q){return this.workerSources[O]||(this.workerSources[O]={}),this.workerSources[O][N]||(this.workerSources[O][N]={}),this.workerSources[O][N][q]||(this.workerSources[O][N][q]=new this.workerSourceTypes[N]({send:(le,pe,Fe,Ce,me,Te)=>{this.actor.send(le,pe,Fe,O,me,Te)},scheduler:this.actor.scheduler},this.getLayerIndex(O),this.getAvailableImages(O),this.isSpriteLoaded[O])),this.workerSources[O][N][q]}getDEMWorkerSource(O,N){return this.demWorkerSources[O]||(this.demWorkerSources[O]={}),this.demWorkerSources[O][N]||(this.demWorkerSources[O][N]=new Q),this.demWorkerSources[O][N]}enforceCacheSizeLimit(O,N){s.enforceCacheSizeLimit(N)}getWorkerPerformanceMetrics(O,N,q){q(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new nn(self)),nn}),x(["./shared"],function(s){var F=M;function M(d){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,y,_=new Blob([""],{type:"text/javascript"}),b=URL.createObjectURL(_);try{y=new Worker(b),p=!0}catch{p=!1}return y&&y.terminate(),URL.revokeObjectURL(b),p}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var p=document.createElement("canvas");p.width=p.height=1;var y=p.getContext("2d");if(!y)return!1;var _=y.getImageData(0,0,1,1);return _&&_.width===p.width}()?(z[c=r&&r.failIfMajorPerformanceCaveat]===void 0&&(z[c]=function(p){var y,_=function(b){var E=document.createElement("canvas"),U=Object.create(M.webGLContextAttributes);return U.failIfMajorPerformanceCaveat=b,E.getContext("webgl",U)||E.getContext("experimental-webgl",U)}(p);if(!_)return!1;try{y=_.createShader(_.VERTEX_SHADER)}catch{return!1}return!(!y||_.isContextLost())&&(_.shaderSource(y,"void main() {}"),_.compileShader(y),_.getShaderParameter(y,_.COMPILE_STATUS)===!0)}(c)),z[c]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var c}(d)}var z={};function L(d,r){if(Array.isArray(d)){if(!Array.isArray(r)||d.length!==r.length)return!1;for(let c=0;c<d.length;c++)if(!L(d[c],r[c]))return!1;return!0}if(typeof d=="object"&&d!==null&&r!==null){if(typeof r!="object"||Object.keys(d).length!==Object.keys(r).length)return!1;for(const c in d)if(!L(d[c],r[c]))return!1;return!0}return d===r}M.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Q={create:function(d,r,c){const p=s.window.document.createElement(d);return r!==void 0&&(p.className=r),c&&c.appendChild(p),p},createNS:function(d,r){return s.window.document.createElementNS(d,r)}},V=s.window.document&&s.window.document.documentElement.style,ie=V&&V.userSelect!==void 0?"userSelect":"WebkitUserSelect";let de;Q.disableDrag=function(){V&&ie&&(de=V[ie],V[ie]="none")},Q.enableDrag=function(){V&&ie&&(V[ie]=de)},Q.setTransform=function(d,r){d.style.transform=r};let re=!1;try{const d=Object.defineProperty({},"passive",{get(){re=!0}});s.window.addEventListener("test",d,d),s.window.removeEventListener("test",d,d)}catch{re=!1}Q.addEventListener=function(d,r,c,p={}){d.addEventListener(r,c,"passive"in p&&re?p:p.capture)},Q.removeEventListener=function(d,r,c,p={}){d.removeEventListener(r,c,"passive"in p&&re?p:p.capture)};const K=function(d){d.preventDefault(),d.stopPropagation(),s.window.removeEventListener("click",K,!0)};function G(d,r,c){const p=d.offsetWidth===r.width?1:d.offsetWidth/r.width;return new s.pointGeometry((c.clientX-r.left)*p,(c.clientY-r.top)*p)}function ne(d,r){var c=r[0],p=r[1],y=r[2],_=r[3],b=c*_-y*p;return b?(d[0]=_*(b=1/b),d[1]=-p*b,d[2]=-y*b,d[3]=c*b,d):null}Q.suppressClick=function(){s.window.addEventListener("click",K,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",K,!0)},0)},Q.mousePos=function(d,r){const c=d.getBoundingClientRect();return G(d,c,r)},Q.touchPos=function(d,r){const c=d.getBoundingClientRect(),p=[];for(let y=0;y<r.length;y++)p.push(G(d,c,r[y]));return p},Q.mouseButton=function(d){return s.window.InstallTrigger!==void 0&&d.button===2&&d.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button},Q.remove=function(d){d.parentNode&&d.parentNode.removeChild(d)};class oe{constructor(r,c){this.pos=r,this.dir=c}intersectsPlane(r,c,p){const y=s.dot(c,this.dir);if(Math.abs(y)<1e-6)return!1;const _=s.dot(s.sub(s.create(),r,this.pos),c)/y,b=s.scaleAndAdd(s.create(),this.pos,this.dir,_);return s.copy(p,b),!0}}class we{constructor(r,c){this.points=r,this.planes=c}static fromInvProjectionMatrix(r,c,p){const y=Math.pow(2,p),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const U=s.transformMat4([],E,r),D=1/U[3]/c*y;return s.mul(U,U,[D,D,1/U[3],D])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const U=s.sub([],_[E[0]],_[E[1]]),D=s.sub([],_[E[2]],_[E[1]]),k=s.normalize([],s.cross([],U,D)),P=-s.dot(k,_[E[1]]);return k.concat(P)});return new we(_,b)}}class ge{constructor(r,c){this.min=r,this.max=c,this.center=s.scale([],s.add([],this.min,this.max),.5)}quadrant(r){const c=[r%2==0,r<2],p=s.clone(this.min),y=s.clone(this.max);for(let _=0;_<c.length;_++)p[_]=c[_]?this.min[_]:this.center[_],y[_]=c[_]?this.center[_]:this.max[_];return y[2]=this.max[2],new ge(p,y)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}intersects(r){const c=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let y=0;y<r.planes.length;y++){const _=r.planes[y];let b=0;for(let E=0;E<c.length;E++)b+=s.dot$1(_,c[E])>=0;if(b===0)return 0;b!==c.length&&(p=!1)}if(p)return 2;for(let y=0;y<3;y++){let _=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let E=0;E<r.points.length;E++){const U=r.points[E][y]-this.min[y];_=Math.min(_,U),b=Math.max(b,U)}if(b<0||_>this.max[y]-this.min[y])return 0}return 1}}function Ue(d){const{userImage:r}=d;return!!(r&&r.render&&r.render())&&(d.data.replace(new Uint8Array(r.data.buffer)),!0)}class Ke extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:c,callback:p}of this.requestors)this._notify(c,p);this.requestors=[]}}getImage(r){return this.images[r]}addImage(r,c){this._validate(r,c)&&(this.images[r]=c)}_validate(r,c){let p=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),p=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),p=!1),this._validateContent(c.content,c)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),p=!1),p}_validateStretch(r,c){if(!r)return!0;let p=0;for(const y of r){if(y[0]<p||y[1]<y[0]||c<y[1])return!1;p=y[1]}return!0}_validateContent(r,c){return!(r&&(r.length!==4||r[0]<0||c.data.width<r[0]||r[1]<0||c.data.height<r[1]||r[2]<0||c.data.width<r[2]||r[3]<0||c.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,c){c.version=this.images[r].version+1,this.images[r]=c,this.updatedImages[r]=!0}removeImage(r){const c=this.images[r];delete this.images[r],delete this.patterns[r],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,c){let p=!0;if(!this.isLoaded())for(const y of r)this.images[y]||(p=!1);this.isLoaded()||p?this._notify(r,c):this.requestors.push({ids:r,callback:c})}_notify(r,c){const p={};for(const y of r){this.images[y]||this.fire(new s.Event("styleimagemissing",{id:y}));const _=this.images[y];_?p[y]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:s.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,p)}getPixelSize(){const{width:r,height:c}=this.atlasImage;return{width:r,height:c}}getPattern(r){const c=this.patterns[r],p=this.getImage(r);if(!p)return null;if(c&&c.position.version===p.version)return c.position;if(c)c.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},_=new s.ImagePosition(y,p);this.patterns[r]={bin:y,position:_}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const c=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(r,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const _ in this.patterns)r.push(this.patterns[_].bin);const{w:c,h:p}=s.potpack(r),y=this.atlasImage;y.resize({width:c||1,height:p||1});for(const _ in this.patterns){const{bin:b}=this.patterns[_],E=b.x+1,U=b.y+1,D=this.images[_].data,k=D.width,P=D.height;s.RGBAImage.copy(D,y,{x:0,y:0},{x:E,y:U},{width:k,height:P}),s.RGBAImage.copy(D,y,{x:0,y:P-1},{x:E,y:U-1},{width:k,height:1}),s.RGBAImage.copy(D,y,{x:0,y:0},{x:E,y:U+P},{width:k,height:1}),s.RGBAImage.copy(D,y,{x:k-1,y:0},{x:E-1,y:U},{width:1,height:P}),s.RGBAImage.copy(D,y,{x:0,y:0},{x:E+k,y:U},{width:1,height:P})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const c of r){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const p=this.images[c];Ue(p)&&this.updateImage(c,p)}}}const Me=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(d,r){return function([c,p,y]){const _=s.degToRad(p+90),b=s.degToRad(y);return{x:c*Math.cos(_)*Math.sin(b),y:c*Math.sin(_)*Math.sin(b),z:c*Math.cos(b),azimuthal:p,polar:y}}(d.expression.evaluate(r))}interpolate(d,r,c){return{x:s.number(d.x,r.x,c),y:s.number(d.y,r.y,c),z:s.number(d.z,r.z,c),azimuthal:s.number(d.azimuthal,r.azimuthal,c),polar:s.number(d.polar,r.polar,c)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),et="-transition";class qe extends s.Evented{constructor(r){super(),this._transitionable=new s.Transitionable(Me),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,c={}){if(!this._validate(s.validateLight,r,c))for(const p in r){const y=r[p];s.endsWith(p,et)?this._transitionable.setTransition(p.slice(0,-et.length),y):this._transitionable.setValue(p,y)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,p){return(!p||p.validate!==!1)&&s.emitValidationErrors(this,r.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const it=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)}),Xe="-transition";class Ne extends s.Evented{constructor(r){super(),this._transitionable=new s.Transitionable(it),this.set(r),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(r){for(const c in r){const p=r[c];s.endsWith(c,Xe)?this._transitionable.setTransition(c.slice(0,-Xe.length),p):this._transitionable.setValue(c,p)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}}function At(d,r,c,p){const y=s.smoothstep(45,65,c),[_,b]=Et(d,p),E=s.length(r);let U=1-Math.min(1,Math.exp((E-_)/(b-_)*-6));return U*=U*U,U=Math.min(1,1.00747*U),U*y*d.alpha}function Et(d,r){const c=.5/Math.tan(.5*r);return[d.range[0]+c,d.range[1]+c]}const It=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"])}),Ut="-transition";class Dt extends s.Evented{constructor(r,c){super(),this._transitionable=new s.Transitionable(It),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=c}isSoftDisabled(){return this._transform.projection.name!=="mercator"}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,c={}){if(!this._validate(s.validateFog,r,c))for(const p in r){const y=r[p];s.endsWith(p,Ut)?this._transitionable.setTransition(p.slice(0,-Ut.length),y):this._transitionable.setValue(p,y)}}getOpacity(r){if(this.isSoftDisabled())return 0;const c=this.properties&&this.properties.get("color")||1;return s.smoothstep(45,65,r)*c.a}getOpacityAtLatLng(r,c){return this.isSoftDisabled()?0:function(p,y,_){const b=s.MercatorCoordinate.fromLngLat(y),E=_.elevation?_.elevation.getAtPointOrZero(b):0,U=[b.x,b.y,E];return s.transformMat4$1(U,U,_.mercatorFogMatrix),At(p,U,_.pitch,_._fov)}(this.state,r,c)}getFovAdjustedRange(r){return this.isSoftDisabled()?[0,1]:Et(this.state,r)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,p){return(!p||p.validate!==!1)&&s.emitValidationErrors(this,r.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class Vt{constructor(r,c){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const p=this.workerPool.acquire(this.id);for(let y=0;y<p.length;y++){const _=new Vt.Actor(p[y],c,this.id);_.name=`Worker ${y}`,this.actors.push(_)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,c,p){s.asyncAll(this.actors,(y,_)=>{y.send(r,c,_)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Je(d,r,c){return r*(s.EXTENT/(d.tileSize*Math.pow(2,c-d.tileID.overscaledZ)))}Vt.Actor=s.Actor;class yt{constructor(r,c,p,y){this.screenBounds=r,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(_=>y.pointCoordinate3D(_)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(r,c){let p,y;if(r instanceof s.pointGeometry||typeof r[0]=="number"){const _=s.pointGeometry.convert(r);p=[s.pointGeometry.convert(r)],y=c.isPointAboveHorizon(_)}else{const _=s.pointGeometry.convert(r[0]),b=s.pointGeometry.convert(r[1]);p=[_,b],y=s.polygonizeBounds(_,b).every(E=>c.isPointAboveHorizon(E))}return new yt(p,c.getCameraPoint(),y,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const c=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],y=s.polygonizeBounds(c,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<p.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?y[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(y[3]=this.cameraPoint)),s.bufferConvexPolygon(y,r)}containsTile(r,c,p){const y=r.queryPadding+1,_=r.tileID.wrap,b=p?this._bufferedCameraMercator(y,c).map(ee=>s.getTilePoint(r.tileTransform,ee,_)):this._bufferedScreenMercator(y,c).map(ee=>s.getTilePoint(r.tileTransform,ee,_)),E=this.screenGeometryMercator.map(ee=>s.getTileVec3(r.tileTransform,ee,_)),U=E.map(ee=>new s.pointGeometry(ee[0],ee[1])),D=c.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),k=s.getTileVec3(r.tileTransform,D,_),P=E.map(ee=>{const X=s.sub(ee,ee,k);return s.normalize(X,X),new oe(k,X)}),j=Je(r,1,c.zoom);if(s.polygonIntersectsBox(b,0,0,s.EXTENT,s.EXTENT))return{queryGeometry:this,tilespaceGeometry:U,tilespaceRays:P,bufferedTilespaceGeometry:b,bufferedTilespaceBounds:($=s.getBounds(b),$.min.x=s.clamp($.min.x,0,s.EXTENT),$.min.y=s.clamp($.min.y,0,s.EXTENT),$.max.x=s.clamp($.max.x,0,s.EXTENT),$.max.y=s.clamp($.max.y,0,s.EXTENT),$),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:j};var $}_bufferedScreenMercator(r,c){const p=ke(r);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{const y=this.bufferedScreenGeometry(r).map(_=>c.pointCoordinate3D(_));return this._screenRaycastCache[p]=y,y}}_bufferedCameraMercator(r,c){const p=ke(r);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{const y=this.bufferedCameraGeometry(r).map(_=>c.pointCoordinate3D(_));return this._cameraRaycastCache[p]=y,y}}}function ke(d){return 100*d|0}function xt(d,r,c){const p=function(y,_){if(y)return c(y);if(_){const b=s.pick(s.extend(_,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);_.vector_layers&&(b.vectorLayers=_.vector_layers,b.vectorLayerIds=b.vectorLayers.map(E=>E.id)),b.tiles=r.canonicalizeTileset(b,d.url),c(null,b)}};return d.url?s.getJSON(r.transformRequest(r.normalizeSourceURL(d.url),s.ResourceType.Source),p):s.exported.frame(()=>p(null,d))}class Se{constructor(r,c,p){this.bounds=s.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=c||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const c=Math.pow(2,r.z),p=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*c),y=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*c),_=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*c),b=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*c);return r.x>=p&&r.x<_&&r.y>=y&&r.y<b}}class ot{constructor(r,c,p){this.context=r;const y=r.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const vt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ot{constructor(r,c,p,y){this.length=c.length,this.attributes=p,this.itemSize=c.bytesPerElement,this.dynamicDraw=y,this.context=r;const _=r.gl;this.buffer=_.createBuffer(),r.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,c){for(let p=0;p<this.attributes.length;p++){const y=c.attributes[this.attributes[p].name];y!==void 0&&r.enableVertexAttribArray(y)}}setVertexAttribPointers(r,c,p){for(let y=0;y<this.attributes.length;y++){const _=this.attributes[y],b=c.attributes[_.name];b!==void 0&&r.vertexAttribPointer(b,_.components,r[vt[_.type]],!1,this.itemSize,_.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class nt{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class tr extends nt{getDefault(){return s.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class br extends nt{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Dr extends nt{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class sr extends nt{getDefault(){return[!0,!0,!0,!0]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class dr extends nt{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class An extends nt{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Ct extends nt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const c=this.current;(r.func!==c.func||r.ref!==c.ref||r.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class mi extends nt{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Nr extends nt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=r,this.dirty=!1}}class $r extends nt{getDefault(){return[0,1]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class to extends nt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=r,this.dirty=!1}}class Ii extends nt{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class gi extends nt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.BLEND):c.disable(c.BLEND),this.current=r,this.dirty=!1}}class ro extends nt{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Ki extends nt{getDefault(){return s.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Mn extends nt{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Ti extends nt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=r,this.dirty=!1}}class Vo extends nt{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Ln extends nt{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class wn extends nt{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class os extends nt{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Ui extends nt{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class no extends nt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class _o extends nt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ln extends nt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class ss extends nt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Si extends nt{getDefault(){return null}set(r){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class vo extends nt{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class Zn extends nt{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class qr extends nt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Tn extends nt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Qi extends nt{constructor(r,c){super(r),this.context=r,this.parent=c}getDefault(){return null}}class as extends Qi{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Dn extends Qi{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class oi extends Dn{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Mi{constructor(r,c,p,y){this.context=r,this.width=c,this.height=p;const _=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new as(r,_),y&&(this.depthAttachment=new Dn(r,_))}destroy(){const r=this.context.gl,c=this.colorAttachment.get();if(c&&r.deleteTexture(c),this.depthAttachment){const p=this.depthAttachment.get();p&&r.deleteRenderbuffer(p)}r.deleteFramebuffer(this.framebuffer)}}class Ko{constructor(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new tr(this),this.clearDepth=new br(this),this.clearStencil=new Dr(this),this.colorMask=new sr(this),this.depthMask=new dr(this),this.stencilMask=new An(this),this.stencilFunc=new Ct(this),this.stencilOp=new mi(this),this.stencilTest=new Nr(this),this.depthRange=new $r(this),this.depthTest=new to(this),this.depthFunc=new Ii(this),this.blend=new gi(this),this.blendFunc=new ro(this),this.blendColor=new Ki(this),this.blendEquation=new Mn(this),this.cullFace=new Ti(this),this.cullFaceSide=new Vo(this),this.frontFace=new Ln(this),this.program=new wn(this),this.activeTexture=new os(this),this.viewport=new Ui(this),this.bindFramebuffer=new no(this),this.bindRenderbuffer=new _o(this),this.bindTexture=new ln(this),this.bindVertexBuffer=new ss(this),this.bindElementBuffer=new Si(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new vo(this),this.pixelStoreUnpack=new Zn(this),this.pixelStoreUnpackPremultiplyAlpha=new qr(this),this.pixelStoreUnpackFlipY=new Tn(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(r.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,c){return new ot(this,r,c)}createVertexBuffer(r,c,p){return new Ot(this,r,c,p)}createRenderbuffer(r,c,p){const y=this.gl,_=y.createRenderbuffer();return this.bindRenderbuffer.set(_),y.renderbufferStorage(y.RENDERBUFFER,r,c,p),this.bindRenderbuffer.set(null),_}createFramebuffer(r,c,p){return new Mi(this,r,c,p)}clear({color:r,depth:c,stencil:p}){const y=this.gl;let _=0;r&&(_|=y.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(_|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),p!==void 0&&(_|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),y.clear(_)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){L(r.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Li extends s.Evented{constructor(r,c,p,y){super(),this.id=r,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},c),s.extend(this,s.pick(c,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=xt(this._options,this.map._requestManager,(r,c)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new s.ErrorEvent(r)):c&&(s.extend(this,c),c.bounds&&(this.tileBounds=new Se(c.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(c.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,c){const p=s.exported.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);r.request=s.getImage(this.map._requestManager.transformRequest(y,s.ResourceType.Tile),(_,b,E,U)=>{if(delete r.request,r.aborted)r.state="unloaded",c(null);else if(_)r.state="errored",c(_);else if(b){this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:E,expires:U});const D=this.map.painter.context,k=D.gl;r.texture=this.map.painter.getTileTexture(b.width),r.texture?r.texture.update(b,{useMipmap:!0}):(r.texture=new s.Texture(D,b,k.RGBA,{useMipmap:!0}),r.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE),D.extTextureFilterAnisotropic&&k.texParameterf(k.TEXTURE_2D,D.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,D.extTextureFilterAnisotropicMax)),r.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),c(null)}})}abortTile(r,c){r.request&&(r.request.cancel(),delete r.request),c()}unloadTile(r,c){r.texture&&this.map.painter.saveTileTexture(r.texture),c()}hasTransition(){return!1}}let nn;class Y extends s.Evented{constructor(r,c,p,y){super(),this.id=r,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=c}load(r,c){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(p,y)=>{this._loaded=!0,p?this.fire(new s.ErrorEvent(p)):y&&(this.image=s.exported.getImageData(y),r&&(this.coordinates=r),c&&c(),this._finishLoading())})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this.options.url=r.url,this.load(r.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}setCoordinates(r){this.coordinates=r,delete this._boundsArray;const c=r.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let y=1/0,_=1/0,b=-1/0,E=-1/0;for(const P of p)y=Math.min(y,P.x),_=Math.min(_,P.y),b=Math.max(b,P.x),E=Math.max(E,P.y);const U=Math.max(b-y,E-_),D=Math.max(0,Math.floor(-Math.log(U)/Math.LN2)),k=Math.pow(2,D);return new s.CanonicalTileID(D,Math.floor((y+b)/2*k),Math.floor((_+E)/2*k))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){delete this._boundsArray}_makeBoundsArray(){const r=s.tileTransform(this.tileID,this.map.transform.projection),c=this.coordinates.map(p=>{const y=r.projection.project(p[0],p[1]);return s.getTilePoint(r,y)._round()});return this._boundsArray=new s.StructArrayLayout4i8,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,s.EXTENT,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,s.EXTENT),this._boundsArray.emplaceBack(c[2].x,c[2].y,s.EXTENT,s.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,c=r.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,s.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new s.Texture(r,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture)}}loadTile(r,c){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},c(null)):(r.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const O={vector:class extends s.Evented{constructor(d,r,c,p){if(super(),this.id=d,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(r,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=xt(this._options,this.map._requestManager,(d,r)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new s.ErrorEvent(d)):r&&(s.extend(this,r),r.bounds&&(this.tileBounds=new Se(r.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(r.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}setSourceProperty(d){this._tileJSONRequest&&this._tileJSONRequest.cancel(),d();const r=this.map.style._getSourceCaches(this.id);for(const c of r)c.clearTiles();this.load()}setTiles(d){return this.setSourceProperty(()=>{this._options.tiles=d}),this}setUrl(d){return this.setSourceProperty(()=>{this.url=d,this._options.url=d}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}loadTile(d,r){const c=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(c,s.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(p.request.collectResourceTiming=this._collectResourceTiming,d.actor&&d.state!=="expired")d.state==="loading"?d.reloadCallback=r:d.request=d.actor.send("reloadTile",p,y.bind(this));else if(d.actor=this._tileWorkers[c]=this._tileWorkers[c]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",p,y.bind(this),void 0,!0);else{const _=s.loadVectorTile.call({deduped:this._deduped},p,(b,E)=>{b||!E?y.call(this,b):(p.data={cacheControl:E.cacheControl,expires:E.expires,rawData:E.rawData.slice(0)},d.actor&&d.actor.send("loadTile",p,y.bind(this),void 0,!0))},!0);d.request={cancel:_}}function y(_,b){return delete d.request,d.aborted?r(null):_&&_.status!==404?r(_):(b&&b.resourceTiming&&(d.resourceTiming=b.resourceTiming),this.map._refreshExpiredTiles&&b&&d.setExpiryData(b),d.loadVectorData(b,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:Li,"raster-dem":class extends Li{constructor(d,r,c,p){super(d,r,c,p),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(d,r){const c=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(y,_){y&&(d.state="errored",r(y)),_&&(d.dem=_,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",r(null))}d.request=s.getImage(this.map._requestManager.transformRequest(c,s.ResourceType.Tile),(function(y,_,b,E){if(delete d.request,d.aborted)d.state="unloaded",r(null);else if(y)d.state="errored",r(y);else if(_){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:b,expires:E});const U=s.window.ImageBitmap&&_ instanceof s.window.ImageBitmap&&(nn==null&&(nn=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),nn),D=1-(_.width-s.prevPowerOfTwo(_.width))/2;D<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const k=U?_:s.exported.getImageData(_,D),P={uid:d.uid,coord:d.tileID,source:this.id,rawImageData:k,encoding:this.encoding,padding:D};d.actor&&d.state!=="expired"||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",P,p.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(d){const r=d.canonical,c=Math.pow(2,r.z),p=(r.x-1+c)%c,y=r.x===0?d.wrap-1:d.wrap,_=(r.x+1+c)%c,b=r.x+1===c?d.wrap+1:d.wrap,E={};return E[new s.OverscaledTileID(d.overscaledZ,y,r.z,p,r.y).key]={backfilled:!1},E[new s.OverscaledTileID(d.overscaledZ,b,r.z,_,r.y).key]={backfilled:!1},r.y>0&&(E[new s.OverscaledTileID(d.overscaledZ,y,r.z,p,r.y-1).key]={backfilled:!1},E[new s.OverscaledTileID(d.overscaledZ,d.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},E[new s.OverscaledTileID(d.overscaledZ,b,r.z,_,r.y-1).key]={backfilled:!1}),r.y+1<c&&(E[new s.OverscaledTileID(d.overscaledZ,y,r.z,p,r.y+1).key]={backfilled:!1},E[new s.OverscaledTileID(d.overscaledZ,d.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},E[new s.OverscaledTileID(d.overscaledZ,b,r.z,_,r.y+1).key]={backfilled:!1}),E}unloadTile(d){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded"}},geojson:class extends s.Evented{constructor(d,r,c,p){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(p),this._data=r.data,this._options=s.extend({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const y=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*y,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*y,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:s.EXTENT,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*y,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}getClusterExpansionZoom(d,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id},r),this}getClusterChildren(d,r){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id},r),this}getClusterLeaves(d,r,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:d,limit:r,offset:c},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const d=s.extend({},this.workerOptions),r=this._data;typeof r=="string"?(d.request=this.map._requestManager.transformRequest(s.exported.resolveURL(r),s.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,d,(c,p)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new s.ErrorEvent(c));else{const y={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(y.resourceTiming=p.resourceTiming[this.id]),this.fire(new s.Event("data",y)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,r){const c=d.actor?"reloadTile":"loadTile";d.actor=this.actor,d.request=this.actor.send(c,{type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,y)=>(delete d.request,d.unloadVectorData(),d.aborted?r(null):p?r(p):(d.loadVectorData(y,this.map.painter,c==="reloadTile"),r(null))),void 0,c==="loadTile")}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d){d.unloadVectorData(),this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Y{constructor(d,r,c,p){super(d,r,c,p),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const r of d.urls)this.urls.push(this.map._requestManager.transformRequest(r,s.ResourceType.Source).url);s.getVideo(this.urls,(r,c)=>{this._loaded=!0,r?this.fire(new s.ErrorEvent(r)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const r=this.video.seekable;d<r.start(0)||d>r.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const d=this.map.painter.context,r=d.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,s.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(d,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Y,canvas:class extends Y{constructor(d,r,c,p){super(d,r,c,p),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(_=>typeof _!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${d}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${d}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,c=r.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,s.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(r,this.canvas,c.RGBA,{premultiply:!0});for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}}},N=function(d,r,c,p){const y=new O[r.type](d,r,c,p);if(y.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${y.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],y),y};function q(d,r){const c=s.identity([]);return s.scale$1(c,c,[.5*d.width,.5*-d.height,1]),s.translate(c,c,[1,-1,0]),s.multiply(c,c,d.calculateProjMatrix(r.toUnwrapped()))}function le(d,r,c,p,y,_,b,E=!1){const U=d.tilesIn(p,b,E);U.sort(Fe);const D=[];for(const P of U)D.push({wrappedTileID:P.tile.tileID.wrapped().key,queryResults:P.tile.queryRenderedFeatures(r,c,d._state,P,y,_,q(d.transform,P.tile.tileID),E)});const k=function(P){const j={},$={};for(const ee of P){const X=ee.queryResults,ae=ee.wrappedTileID,W=$[ae]=$[ae]||{};for(const Ae in X){const ue=X[Ae],J=W[Ae]=W[Ae]||{},he=j[Ae]=j[Ae]||[];for(const ye of ue)J[ye.featureIndex]||(J[ye.featureIndex]=!0,he.push(ye))}}return j}(D);for(const P in k)k[P].forEach(j=>{const $=j.feature,ee=d.getFeatureState($.layer["source-layer"],$.id);$.source=$.layer.source,$.layer["source-layer"]&&($.sourceLayer=$.layer["source-layer"]),$.state=ee});return k}function pe(d,r){const c=d.getRenderableIds().map(_=>d.getTileByID(_)),p=[],y={};for(let _=0;_<c.length;_++){const b=c[_],E=b.tileID.canonical.key;y[E]||(y[E]=!0,b.querySourceFeatures(p,r))}return p}function Fe(d,r){const c=d.tileID,p=r.tileID;return c.overscaledZ-p.overscaledZ||c.canonical.y-p.canonical.y||c.wrap-p.wrap||c.canonical.x-p.canonical.x}function Ce(){return wa.workerClass!=null?new wa.workerClass:new s.window.Worker(wa.workerUrl)}const me="mapboxgl_preloaded_worker_pool";class Te{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Te.workerCount;)this.workers.push(new Ce);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[me]}numActive(){return Object.keys(this.active).length}}let Re;function lt(){return Re||(Re=new Te),Re}function $e(d,r){const c={};for(const p in d)p!=="ref"&&(c[p]=d[p]);return s.refProperties.forEach(p=>{p in r&&(c[p]=r[p])}),c}function St(d){d=d.slice();const r=Object.create(null);for(let c=0;c<d.length;c++)r[d[c].id]=d[c];for(let c=0;c<d.length;c++)"ref"in d[c]&&(d[c]=$e(d[c],r[d[c].ref]));return d}Te.workerCount=2;const ut={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function xe(d,r,c){c.push({command:ut.addSource,args:[d,r[d]]})}function Pe(d,r,c){r.push({command:ut.removeSource,args:[d]}),c[d]=!0}function zt(d,r,c,p){Pe(d,c,p),xe(d,r,c)}function ar(d,r,c){let p;for(p in d[c])if(d[c].hasOwnProperty(p)&&p!=="data"&&!L(d[c][p],r[c][p]))return!1;for(p in r[c])if(r[c].hasOwnProperty(p)&&p!=="data"&&!L(d[c][p],r[c][p]))return!1;return!0}function Rt(d,r,c,p,y,_){let b;for(b in r=r||{},d=d||{})d.hasOwnProperty(b)&&(L(d[b],r[b])||c.push({command:_,args:[p,b,r[b],y]}));for(b in r)r.hasOwnProperty(b)&&!d.hasOwnProperty(b)&&(L(d[b],r[b])||c.push({command:_,args:[p,b,r[b],y]}))}function ir(d){return d.id}function or(d,r){return d[r.id]=r,d}class io{constructor(r,c){this.reset(r,c)}reset(r,c){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=s.clamp(r,0,1);let c=1,p=this._distances[c];const y=r*this.paddedLength+this.padding;for(;p<y&&c<this._distances.length;)p=this._distances[++c];const _=c-1,b=this._distances[_],E=p-b,U=E>0?(y-b)/E:0;return this.points[_].mult(1-U).add(this.points[c].mult(U))}}class cn{constructor(r,c,p){const y=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(c/p);for(let b=0;b<this.xCellCount*this.yCellCount;b++)y.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=c,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,c,p,y,_){this._forEachCell(c,p,y,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(_)}insertCircle(r,c,p,y){this._forEachCell(c-y,p-y,c+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(c),this.circles.push(p),this.circles.push(y)}_insertBoxCell(r,c,p,y,_,b){this.boxCells[_].push(b)}_insertCircleCell(r,c,p,y,_,b){this.circleCells[_].push(b)}_query(r,c,p,y,_,b){if(p<0||r>this.width||y<0||c>this.height)return!_&&[];const E=[];if(r<=0&&c<=0&&this.width<=p&&this.height<=y){if(_)return!0;for(let U=0;U<this.boxKeys.length;U++)E.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const D=this.circles[3*U],k=this.circles[3*U+1],P=this.circles[3*U+2];E.push({key:this.circleKeys[U],x1:D-P,y1:k-P,x2:D+P,y2:k+P})}return b?E.filter(b):E}return this._forEachCell(r,c,p,y,this._queryCell,E,{hitTest:_,seenUids:{box:{},circle:{}}},b),_?E.length>0:E}_queryCircle(r,c,p,y,_){const b=r-p,E=r+p,U=c-p,D=c+p;if(E<0||b>this.width||D<0||U>this.height)return!y&&[];const k=[];return this._forEachCell(b,U,E,D,this._queryCellCircle,k,{hitTest:y,circle:{x:r,y:c,radius:p},seenUids:{box:{},circle:{}}},_),y?k.length>0:k}query(r,c,p,y,_){return this._query(r,c,p,y,!1,_)}hitTest(r,c,p,y,_){return this._query(r,c,p,y,!0,_)}hitTestCircle(r,c,p,y){return this._queryCircle(r,c,p,!0,y)}_queryCell(r,c,p,y,_,b,E,U){const D=E.seenUids,k=this.boxCells[_];if(k!==null){const j=this.bboxes;for(const $ of k)if(!D.box[$]){D.box[$]=!0;const ee=4*$;if(r<=j[ee+2]&&c<=j[ee+3]&&p>=j[ee+0]&&y>=j[ee+1]&&(!U||U(this.boxKeys[$]))){if(E.hitTest)return b.push(!0),!0;b.push({key:this.boxKeys[$],x1:j[ee],y1:j[ee+1],x2:j[ee+2],y2:j[ee+3]})}}}const P=this.circleCells[_];if(P!==null){const j=this.circles;for(const $ of P)if(!D.circle[$]){D.circle[$]=!0;const ee=3*$;if(this._circleAndRectCollide(j[ee],j[ee+1],j[ee+2],r,c,p,y)&&(!U||U(this.circleKeys[$]))){if(E.hitTest)return b.push(!0),!0;{const X=j[ee],ae=j[ee+1],W=j[ee+2];b.push({key:this.circleKeys[$],x1:X-W,y1:ae-W,x2:X+W,y2:ae+W})}}}}}_queryCellCircle(r,c,p,y,_,b,E,U){const D=E.circle,k=E.seenUids,P=this.boxCells[_];if(P!==null){const $=this.bboxes;for(const ee of P)if(!k.box[ee]){k.box[ee]=!0;const X=4*ee;if(this._circleAndRectCollide(D.x,D.y,D.radius,$[X+0],$[X+1],$[X+2],$[X+3])&&(!U||U(this.boxKeys[ee])))return b.push(!0),!0}}const j=this.circleCells[_];if(j!==null){const $=this.circles;for(const ee of j)if(!k.circle[ee]){k.circle[ee]=!0;const X=3*ee;if(this._circlesCollide($[X],$[X+1],$[X+2],D.x,D.y,D.radius)&&(!U||U(this.circleKeys[ee])))return b.push(!0),!0}}}_forEachCell(r,c,p,y,_,b,E,U){const D=this._convertToXCellCoord(r),k=this._convertToYCellCoord(c),P=this._convertToXCellCoord(p),j=this._convertToYCellCoord(y);for(let $=D;$<=P;$++)for(let ee=k;ee<=j;ee++)if(_.call(this,r,c,p,y,this.xCellCount*ee+$,b,E,U))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,c,p,y,_,b){const E=y-r,U=_-c,D=p+b;return D*D>E*E+U*U}_circleAndRectCollide(r,c,p,y,_,b,E){const U=(b-y)/2,D=Math.abs(r-(y+U));if(D>U+p)return!1;const k=(E-_)/2,P=Math.abs(c-(_+k));if(P>k+p)return!1;if(D<=U||P<=k)return!0;const j=D-U,$=P-k;return j*j+$*$<=p*p}}const dt=Math.tan(85*Math.PI/180);function Yt(d,r,c,p,y){const _=s.create$1();if(r){const b=ne([],y);_[0]=b[0],_[1]=b[1],_[4]=b[2],_[5]=b[3],c||s.rotateZ(_,_,p.angle)}else s.multiply(_,p.labelPlaneMatrix,d);return _}function Wt(d,r,c,p,y){if(r){const _=s.clone$1(d),b=s.identity([]);return b[0]=y[0],b[1]=y[1],b[4]=y[2],b[5]=y[3],s.multiply(_,_,b),c||s.rotateZ(_,_,-p.angle),_}return p.glCoordMatrix}function kr(d,r,c=0){const p=[d.x,d.y,c,1];c?s.transformMat4(p,p,r):Gi(p,p,r);const y=p[3];return{point:new s.pointGeometry(p[0]/y,p[1]/y),signedDistanceFromCamera:y}}function oo(d,r){return Math.min(.5+d/r*.5,1.5)}function Zt(d,r){const c=d[0]/d[3],p=d[1]/d[3];return c>=-r[0]&&c<=r[0]&&p>=-r[1]&&p<=r[1]}function As(d,r,c,p,y,_,b,E,U){const D=p?d.textSizeData:d.iconSizeData,k=s.evaluateSizeForZoom(D,c.transform.zoom),P=[256/c.width*2+1,256/c.height*2+1],j=p?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;j.clear();const $=d.lineVertexArray,ee=p?d.text.placedSymbolArray:d.icon.placedSymbolArray,X=c.transform.width/c.transform.height;let ae=!1;for(let W=0;W<ee.length;W++){const Ae=ee.get(W);if(Ae.writingMode!==s.WritingMode.vertical||ae||W!==0&&ee.get(W-1).writingMode===s.WritingMode.horizontal||(ae=!0),Ae.hidden||Ae.writingMode===s.WritingMode.vertical&&!ae){si(Ae.numGlyphs,j);continue}ae=!1;const ue=new s.pointGeometry(Ae.tileAnchorX,Ae.tileAnchorY),J=U?U(ue):0,he=[ue.x,ue.y,J],ye=[...he,1];if(s.transformMat4(ye,ye,r),!Zt(ye,P)){si(Ae.numGlyphs,j);continue}const De=oo(c.transform.cameraToCenterDistance,ye[3]),Le=s.evaluateSizeForFeature(D,k,Ae),Ve=b?Le/De:Le*De,Ge=kr(new s.pointGeometry(he[0],he[1]),y,he[2]);if(Ge.signedDistanceFromCamera<=0){si(Ae.numGlyphs,j);continue}let at={};const He=b?null:U,ht=Pn(Ae,Ve,!1,E,r,y,_,d.glyphOffsetArray,$,j,Ge.point,ue,at,X,He);ae=ht.useVertical,He&&ht.needsFlipping&&(at={}),(ht.notEnoughRoom||ae||ht.needsFlipping&&Pn(Ae,Ve,!0,E,r,y,_,d.glyphOffsetArray,$,j,Ge.point,ue,at,X,He).notEnoughRoom)&&si(Ae.numGlyphs,j)}p?d.text.dynamicLayoutVertexBuffer.updateData(j):d.icon.dynamicLayoutVertexBuffer.updateData(j)}function xo(d,r,c,p,y,_,b,E,U,D,k,P,j){const $=E.glyphStartIndex+E.numGlyphs,ee=E.lineStartIndex,X=E.lineStartIndex+E.lineLength,ae=r.getoffsetX(E.glyphStartIndex),W=r.getoffsetX($-1),Ae=Di(d*ae,c,p,y,_,b,E.segment,ee,X,U,D,k,P,j,!0);if(!Ae)return null;const ue=Di(d*W,c,p,y,_,b,E.segment,ee,X,U,D,k,P,j,!0);return ue?{first:Ae,last:ue}:null}function kn(d,r,c,p){return d.writingMode===s.WritingMode.horizontal&&Math.abs(c.y-r.y)>Math.abs(c.x-r.x)*p?{useVertical:!0}:d.writingMode===s.WritingMode.vertical?r.y<c.y?{needsFlipping:!0}:null:d.flipState!==0&&function(y,_,b){const E=(_.x-y.x)*b;return E===0||Math.abs((_.y-y.y)/E)>dt}(r,c,p)?d.flipState===1?{needsFlipping:!0}:null:r.x>c.x?{needsFlipping:!0}:null}function Pn(d,r,c,p,y,_,b,E,U,D,k,P,j,$,ee){const X=r/24,ae=d.lineOffsetX*X,W=d.lineOffsetY*X;let Ae;if(d.numGlyphs>1){const ue=d.glyphStartIndex+d.numGlyphs,J=d.lineStartIndex,he=d.lineStartIndex+d.lineLength,ye=xo(X,E,ae,W,c,k,P,d,U,_,j,ee,!1);if(!ye)return{notEnoughRoom:!0};const De=kr(ye.first.point,b).point,Le=kr(ye.last.point,b).point;if(p&&!c){const Ve=kn(d,De,Le,$);if(d.flipState=Ve&&Ve.needsFlipping?1:2,Ve)return Ve}Ae=[ye.first];for(let Ve=d.glyphStartIndex+1;Ve<ue-1;Ve++)Ae.push(Di(X*E.getoffsetX(Ve),ae,W,c,k,P,d.segment,J,he,U,_,j,ee,!1,!1));Ae.push(ye.last)}else{if(p&&!c){const J=kr(P,y).point,he=d.lineStartIndex+d.segment+1,ye=new s.pointGeometry(U.getx(he),U.gety(he)),De=kr(ye,y),Le=kn(d,J,De.signedDistanceFromCamera>0?De.point:aa(P,ye,J,1,y,void 0),$);if(d.flipState=Le&&Le.needsFlipping?1:2,Le)return Le}const ue=Di(X*E.getoffsetX(d.glyphStartIndex),ae,W,c,k,P,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,U,_,j,ee,!1,!1);if(!ue)return{notEnoughRoom:!0};Ae=[ue]}for(const ue of Ae)s.addDynamicAttributes(D,ue.point,ue.angle);return{}}function gr(d,r,c){const p={x:d.x,y:d.y,z:0};if(!c)return kr(p,r,p.z);const y=c(d);return kr(new s.pointGeometry(p.x,p.y),r,p.z+y)}function aa(d,r,c,p,y,_){const b=gr(d.add(d.sub(r)._unit()),y,_).point,E=c.sub(b);return c.add(E._mult(p/E.mag()))}function Di(d,r,c,p,y,_,b,E,U,D,k,P,j,$,ee){const X=p?d-r:d+r;let ae=X>0?1:-1,W=0;p&&(ae*=-1,W=Math.PI),ae<0&&(W+=Math.PI);let Ae=ae>0?E+b:E+b+1,ue=y,J=y,he=0,ye=0;const De=Math.abs(X),Le=[],Ve=[];let Ge=_;const at=()=>{const Pt=Ae-ae;return he===0?_:new s.pointGeometry(D.getx(Pt),D.gety(Pt))},He=()=>aa(at(),Ge,J,De-he+1,k,j);for(;he+ye<=De;){if(Ae+=ae,Ae<E||Ae>=U)return null;if(J=ue,Le.push(ue),$&&Ve.push(Ge||at()),ue=P[Ae],ue===void 0){Ge=new s.pointGeometry(D.getx(Ae),D.gety(Ae));const Pt=gr(Ge,k,j);ue=Pt.signedDistanceFromCamera>0?P[Ae]=Pt.point:He()}else Ge=null;he+=ye,ye=J.dist(ue)}ee&&j&&(Ge=Ge||new s.pointGeometry(D.getx(Ae),D.gety(Ae)),P[Ae]=ue=P[Ae]===void 0?ue:He(),ye=J.dist(ue));const ht=(De-he)/ye,Qe=ue.sub(J),ft=Qe.mult(ht)._add(J);c&&ft._add(Qe._unit()._perp()._mult(c*ae));const bt=W+Math.atan2(ue.y-J.y,ue.x-J.x);return Le.push(ft),$&&(Ge=Ge||new s.pointGeometry(D.getx(Ae),D.gety(Ae)),Ve.push(function(Pt,Ht,Kt){const Gt=1-Kt;return new s.pointGeometry(Pt.x*Gt+Ht.x*Kt,Pt.y*Gt+Ht.y*Kt)}(Ve.length>0?Ve[Ve.length-1]:Ge,Ge,ht))),{point:ft,angle:bt,path:Le,tilePath:Ve}}const Go=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function si(d,r){for(let c=0;c<d;c++){const p=r.length;r.resize(p+4),r.float32.set(Go,3*p)}}function Gi(d,r,c){const p=r[0],y=r[1];return d[0]=c[0]*p+c[4]*y+c[12],d[1]=c[1]*p+c[5]*y+c[13],d[3]=c[3]*p+c[7]*y+c[15],d}const Xn=100;class rr{constructor(r,c,p=new cn(r.width+200,r.height+200,25),y=new cn(r.width+200,r.height+200,25)){this.transform=r,this.grid=p,this.ignoredGrid=y,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Xn,this.screenBottomBoundary=r.height+Xn,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=c}placeCollisionBox(r,c,p,y,_,b,E){let U=c.projectedAnchorZ;c.elevation&&(U+=c.elevation);const D=this.projectAndGetPerspectiveRatio(b,c.projectedAnchorX,c.projectedAnchorY,U,c.tileID),k=_*D.perspectiveRatio,P=(c.x1*r+p.x-c.padding)*k+D.point.x,j=(c.y1*r+p.y-c.padding)*k+D.point.y,$=(c.x2*r+p.x+c.padding)*k+D.point.x,ee=(c.y2*r+p.y+c.padding)*k+D.point.y,X=D.perspectiveRatio<=.55||D.aboveHorizon;return!this.isInsideGrid(P,j,$,ee)||!y&&this.grid.hitTest(P,j,$,ee,E)||X?{box:[],offscreen:!1}:{box:[P,j,$,ee],offscreen:this.isOffscreen(P,j,$,ee)}}placeCollisionCircles(r,c,p,y,_,b,E,U,D,k,P,j,$,ee){const X=[],ae=this.transform.elevation,W=ae?He=>ae.getAtTileOffset(ee,He.x,He.y):He=>0,Ae=new s.pointGeometry(c.tileAnchorX,c.tileAnchorY),ue=W(Ae),J=this.projectAndGetPerspectiveRatio(b,Ae.x,Ae.y,ue,ee),{perspectiveRatio:he}=J,ye=(k?_/he:_*he)/s.ONE_EM,De=kr(Ae,E,ue).point,Le=J.signedDistanceFromCamera>0?xo(ye,y,c.lineOffsetX*ye,c.lineOffsetY*ye,!1,De,Ae,c,p,E,{},ae&&!k?W:null,k&&!!ae):null;let Ve=!1,Ge=!1,at=!0;if(Le&&!J.aboveHorizon){const He=.5*j*he+$,ht=new s.pointGeometry(-100,-100),Qe=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ft=new io,bt=Le.first,Pt=Le.last;let Ht=[];for(let kt=bt.path.length-1;kt>=1;kt--)Ht.push(bt.path[kt]);for(let kt=1;kt<Pt.path.length;kt++)Ht.push(Pt.path[kt]);const Kt=2.5*He;if(U){const kt=Ht.map(ae?(qt,fr)=>{const dn=W(fr<bt.path.length-1?bt.tilePath[bt.path.length-1-fr]:Pt.tilePath[fr-bt.path.length+2]);return kr(qt,U,dn)}:qt=>kr(qt,U));Ht=kt.some(qt=>qt.signedDistanceFromCamera<=0)?[]:kt.map(qt=>qt.point)}let Gt=[];if(Ht.length>0){const kt=Ht[0].clone(),qt=Ht[0].clone();for(let fr=1;fr<Ht.length;fr++)kt.x=Math.min(kt.x,Ht[fr].x),kt.y=Math.min(kt.y,Ht[fr].y),qt.x=Math.max(qt.x,Ht[fr].x),qt.y=Math.max(qt.y,Ht[fr].y);Gt=kt.x>=ht.x&&qt.x<=Qe.x&&kt.y>=ht.y&&qt.y<=Qe.y?[Ht]:qt.x<ht.x||kt.x>Qe.x||qt.y<ht.y||kt.y>Qe.y?[]:s.clipLine([Ht],ht.x,ht.y,Qe.x,Qe.y)}for(const kt of Gt){ft.reset(kt,.25*He);let qt=0;qt=ft.length<=.5*He?1:Math.ceil(ft.paddedLength/Kt)+1;for(let fr=0;fr<qt;fr++){const dn=fr/Math.max(qt-1,1),Hn=ft.lerp(dn),Jn=Hn.x+Xn,Ai=Hn.y+Xn;X.push(Jn,Ai,He,0);const fn=Jn-He,Wo=Ai-He,To=Jn+He,Mr=Ai+He;if(at=at&&this.isOffscreen(fn,Wo,To,Mr),Ge=Ge||this.isInsideGrid(fn,Wo,To,Mr),!r&&this.grid.hitTestCircle(Jn,Ai,He,P)&&(Ve=!0,!D))return{circles:[],offscreen:!1,collisionDetected:Ve}}}}return{circles:!D&&Ve||!Ge?[]:X,offscreen:at,collisionDetected:Ve}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let p=1/0,y=1/0,_=-1/0,b=-1/0;for(const k of r){const P=new s.pointGeometry(k.x+Xn,k.y+Xn);p=Math.min(p,P.x),y=Math.min(y,P.y),_=Math.max(_,P.x),b=Math.max(b,P.y),c.push(P)}const E=this.grid.query(p,y,_,b).concat(this.ignoredGrid.query(p,y,_,b)),U={},D={};for(const k of E){const P=k.key;if(U[P.bucketInstanceId]===void 0&&(U[P.bucketInstanceId]={}),U[P.bucketInstanceId][P.featureIndex])continue;const j=[new s.pointGeometry(k.x1,k.y1),new s.pointGeometry(k.x2,k.y1),new s.pointGeometry(k.x2,k.y2),new s.pointGeometry(k.x1,k.y2)];s.polygonIntersectsPolygon(c,j)&&(U[P.bucketInstanceId][P.featureIndex]=!0,D[P.bucketInstanceId]===void 0&&(D[P.bucketInstanceId]=[]),D[P.bucketInstanceId].push(P.featureIndex))}return D}insertCollisionBox(r,c,p,y,_){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:y,collisionGroupID:_},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,c,p,y,_){const b=c?this.ignoredGrid:this.grid,E={bucketInstanceId:p,featureIndex:y,collisionGroupID:_};for(let U=0;U<r.length;U+=4)b.insertCircle(E,r[U],r[U+1],r[U+2])}projectAndGetPerspectiveRatio(r,c,p,y,_){const b=[c,p,y||0,1];let E=!1;if(y||this.transform.pitch>0){s.transformMat4(b,b,r);let U=!1;this.fogState&&_&&(U=function(D,k,P,j,$,ee){const X=ee.calculateFogTileMatrix($),ae=[k,P,j];return s.transformMat4$1(ae,ae,X),At(D,ae,ee.pitch,ee._fov)}(this.fogState,c,p,y||0,_.toUnwrapped(),this.transform)>.9),E=b[2]>b[3]||U}else Gi(b,b,r);return{point:new s.pointGeometry((b[0]/b[3]+1)/2*this.transform.width+Xn,(-b[1]/b[3]+1)/2*this.transform.height+Xn),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/b[3]*.5,1.5),signedDistanceFromCamera:b[3],aboveHorizon:E}}isOffscreen(r,c,p,y){return p<Xn||r>=this.screenRightBoundary||y<Xn||c>this.screenBottomBoundary}isInsideGrid(r,c,p,y){return p>=0&&r<this.gridRightBoundary&&y>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const r=s.identity([]);return s.translate(r,r,[-100,-100,0]),r}}class ji{constructor(r,c,p,y){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?c:-c))):y&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class On{constructor(r,c,p,y,_,b=!1){this.text=new ji(r?r.text:null,c,p,_),this.icon=new ji(r?r.icon:null,c,y,_),this.clipped=b}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class un{constructor(r,c,p,y=!1){this.text=r,this.icon=c,this.skipFade=p,this.clipped=y}}class Wn{constructor(){this.invProjMatrix=s.create$1(),this.viewportMatrix=s.create$1(),this.circles=[]}}class Aa{constructor(r,c,p,y,_){this.bucketInstanceId=r,this.featureIndex=c,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=_}}class ls{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const c=++this.maxGroupID;this.collisionGroups[r]={ID:c,predicate:p=>p.collisionGroupID===c}}return this.collisionGroups[r]}}function Ur(d,r,c,p,y){const{horizontalAlign:_,verticalAlign:b}=s.getAnchorAlignment(d),E=-(_-.5)*r,U=-(b-.5)*c,D=s.evaluateVariableOffset(d,p);return new s.pointGeometry(E+D[0]*y,U+D[1]*y)}function so(d,r,c,p,y){const _=new s.pointGeometry(d,r);return c&&_._rotate(p?y:-y),_}class ao{constructor(r,c,p,y,_){this.transform=r.clone(),this.collisionIndex=new rr(this.transform,_),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new ls(p),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,c,p,y){const _=p.getBucket(c),b=p.latestFeatureIndex;if(!_||!b||c.id!==_.layerIds[0])return;const E=_.layers[0].layout,U=p.collisionBoxArray,D=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),k=p.tileSize/s.EXTENT,P=p.tileID.toUnwrapped(),j=this.transform.calculateProjMatrix(P),$=E.get("text-pitch-alignment")==="map",ee=E.get("text-rotation-alignment")==="map";c.compileFilter();const X=c.dynamicFilter(),ae=c.dynamicFilterNeedsFeature(),W=this.transform.calculatePixelsToTileUnitsMatrix(p),Ae=Yt(j,$,ee,this.transform,W);let ue=null;if($){const ye=Wt(j,$,ee,this.transform,W);ue=s.multiply([],this.transform.labelPlaneMatrix,ye)}let J=null;X&&p.latestFeatureIndex&&(J={unwrappedTileID:P,dynamicFilter:X,dynamicFilterNeedsFeature:ae,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[_.bucketInstanceId]=new Aa(_.bucketInstanceId,b,_.sourceLayerIndex,_.index,p.tileID);const he={bucket:_,layout:E,posMatrix:j,textLabelPlaneMatrix:Ae,labelToScreenMatrix:ue,clippingData:J,scale:D,textPixelRatio:k,holdingForFade:p.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(_.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(_.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(y)for(const ye of _.sortKeyRanges){const{sortKey:De,symbolInstanceStart:Le,symbolInstanceEnd:Ve}=ye;r.push({sortKey:De,symbolInstanceStart:Le,symbolInstanceEnd:Ve,parameters:he})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:he})}attemptAnchorPlacement(r,c,p,y,_,b,E,U,D,k,P,j,$,ee,X,ae,W,Ae){const ue=[j.textOffset0,j.textOffset1],J=Ur(r,p,y,ue,_),he=this.collisionIndex.placeCollisionBox(_,c,so(J.x,J.y,b,E,this.transform.angle),P,U,D,k.predicate);if((!ae||this.collisionIndex.placeCollisionBox(ee.getSymbolInstanceIconSize(Ae,this.transform.zoom,$),ae,so(J.x,J.y,b,E,this.transform.angle),P,U,D,k.predicate).box.length!==0)&&he.box.length>0){let ye;return this.prevPlacement&&this.prevPlacement.variableOffsets[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID].text&&(ye=this.prevPlacement.variableOffsets[j.crossTileID].anchor),this.variableOffsets[j.crossTileID]={textOffset:ue,width:p,height:y,anchor:r,textScale:_,prevAnchor:ye},this.markUsedJustification(ee,r,j,X),ee.allowVerticalPlacement&&(this.markUsedOrientation(ee,X,j),this.placedOrientations[j.crossTileID]=X),{shift:J,placedGlyphBoxes:he}}}placeLayerBucketPart(r,c,p,y){const{bucket:_,layout:b,posMatrix:E,textLabelPlaneMatrix:U,labelToScreenMatrix:D,clippingData:k,textPixelRatio:P,holdingForFade:j,collisionBoxArray:$,partiallyEvaluatedTextSize:ee,partiallyEvaluatedIconSize:X,collisionGroup:ae}=r.parameters,W=b.get("text-optional"),Ae=b.get("icon-optional"),ue=b.get("text-allow-overlap"),J=b.get("icon-allow-overlap"),he=b.get("text-rotation-alignment")==="map",ye=b.get("text-pitch-alignment")==="map",De=b.get("icon-text-fit")!=="none",Le=b.get("symbol-z-order")==="viewport-y",Ve=ue&&(J||!_.hasIconData()||Ae),Ge=J&&(ue||!_.hasTextData()||W);!_.collisionArrays&&$&&_.deserializeCollisionBoxes($),p&&y&&_.updateCollisionDebugBuffers(this.transform.zoom,$);const at=(He,ht,Qe)=>{if(k){const Mr={zoom:this.transform.zoom,pitch:this.transform.pitch};let Yr=null;if(k.dynamicFilterNeedsFeature){const Ar=this.retainedQueryData[_.bucketInstanceId];Yr=k.featureIndex.loadFeature({featureIndex:He.featureIndex,bucketIndex:Ar.bucketIndex,sourceLayerIndex:Ar.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,k.dynamicFilter)(Mr,Yr,this.retainedQueryData[_.bucketInstanceId].tileID.canonical,new s.pointGeometry(He.tileAnchorX,He.tileAnchorY),this.transform.calculateDistanceTileData(k.unwrappedTileID)))return this.placements[He.crossTileID]=new un(!1,!1,!1,!0),void(c[He.crossTileID]=!0)}if(c[He.crossTileID])return;if(j)return void(this.placements[He.crossTileID]=new un(!1,!1,!1));let ft=!1,bt=!1,Pt=!0,Ht=null,Kt={box:null,offscreen:null},Gt={box:null,offscreen:null},kt=null,qt=null,fr=null,dn=0,Hn=0,Jn=0;Qe.textFeatureIndex?dn=Qe.textFeatureIndex:He.useRuntimeCollisionCircles&&(dn=He.featureIndex),Qe.verticalTextFeatureIndex&&(Hn=Qe.verticalTextFeatureIndex);const Ai=Mr=>{Mr.tileID=this.retainedQueryData[_.bucketInstanceId].tileID,(this.transform.elevation||Mr.elevation)&&(Mr.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[_.bucketInstanceId].tileID,Mr.tileAnchorX,Mr.tileAnchorY):0)},fn=Qe.textBox;if(fn){Ai(fn);const Mr=Ar=>{let Or=s.WritingMode.horizontal;if(_.allowVerticalPlacement&&!Ar&&this.prevPlacement){const Nn=this.prevPlacement.placedOrientations[He.crossTileID];Nn&&(this.placedOrientations[He.crossTileID]=Nn,Or=Nn,this.markUsedOrientation(_,Or,He))}return Or},Yr=(Ar,Or)=>{if(_.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&Qe.verticalTextBox){for(const Nn of _.writingModes)if(Nn===s.WritingMode.vertical?(Kt=Or(),Gt=Kt):Kt=Ar(),Kt&&Kt.box&&Kt.box.length)break}else Kt=Ar()};if(b.get("text-variable-anchor")){let Ar=b.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[He.crossTileID]){const Lr=this.prevPlacement.variableOffsets[He.crossTileID];Ar.indexOf(Lr.anchor)>0&&(Ar=Ar.filter(Oi=>Oi!==Lr.anchor),Ar.unshift(Lr.anchor))}const Or=(Lr,Oi,EA)=>{const vi=_.getSymbolInstanceTextSize(ee,He,this.transform.zoom,ht),xs=(Lr.x2-Lr.x1)*vi+2*Lr.padding,Bd=(Lr.y2-Lr.y1)*vi+2*Lr.padding,bl=De&&!J?Oi:null;bl&&Ai(bl);let Ba={box:[],offscreen:!1};const bd=ue?2*Ar.length:Ar.length;for(let FA=0;FA<bd;++FA){const Cl=this.attemptAnchorPlacement(Ar[FA%Ar.length],Lr,xs,Bd,vi,he,ye,P,E,ae,FA>=Ar.length,He,ht,_,EA,bl,ee,X);if(Cl&&(Ba=Cl.placedGlyphBoxes,Ba&&Ba.box&&Ba.box.length)){ft=!0,Ht=Cl.shift;break}}return Ba};Yr(()=>Or(fn,Qe.iconBox,s.WritingMode.horizontal),()=>{const Lr=Qe.verticalTextBox;return Lr&&Ai(Lr),_.allowVerticalPlacement&&!(Kt&&Kt.box&&Kt.box.length)&&He.numVerticalGlyphVertices>0&&Lr?Or(Lr,Qe.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null}}),Kt&&(ft=Kt.box,Pt=Kt.offscreen);const Nn=Mr(Kt&&Kt.box);if(!ft&&this.prevPlacement){const Lr=this.prevPlacement.variableOffsets[He.crossTileID];Lr&&(this.variableOffsets[He.crossTileID]=Lr,this.markUsedJustification(_,Lr.anchor,He,Nn))}}else{const Ar=(Or,Nn)=>{const Lr=_.getSymbolInstanceTextSize(ee,He,this.transform.zoom,ht),Oi=this.collisionIndex.placeCollisionBox(Lr,Or,new s.pointGeometry(0,0),ue,P,E,ae.predicate);return Oi&&Oi.box&&Oi.box.length&&(this.markUsedOrientation(_,Nn,He),this.placedOrientations[He.crossTileID]=Nn),Oi};Yr(()=>Ar(fn,s.WritingMode.horizontal),()=>{const Or=Qe.verticalTextBox;return _.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&Or?(Ai(Or),Ar(Or,s.WritingMode.vertical)):{box:null,offscreen:null}}),Mr(Kt&&Kt.box&&Kt.box.length)}}if(kt=Kt,ft=kt&&kt.box&&kt.box.length>0,Pt=kt&&kt.offscreen,He.useRuntimeCollisionCircles){const Mr=_.text.placedSymbolArray.get(He.centerJustifiedTextSymbolIndex>=0?He.centerJustifiedTextSymbolIndex:He.verticalPlacedTextSymbolIndex),Yr=s.evaluateSizeForFeature(_.textSizeData,ee,Mr),Ar=b.get("text-padding");qt=this.collisionIndex.placeCollisionCircles(ue,Mr,_.lineVertexArray,_.glyphOffsetArray,Yr,E,U,D,p,ye,ae.predicate,He.collisionCircleDiameter*Yr/s.ONE_EM,Ar,this.retainedQueryData[_.bucketInstanceId].tileID),ft=ue||qt.circles.length>0&&!qt.collisionDetected,Pt=Pt&&qt.offscreen}if(Qe.iconFeatureIndex&&(Jn=Qe.iconFeatureIndex),Qe.iconBox){const Mr=Yr=>{Ai(Yr);const Ar=De&&Ht?so(Ht.x,Ht.y,he,ye,this.transform.angle):new s.pointGeometry(0,0),Or=_.getSymbolInstanceIconSize(X,this.transform.zoom,ht);return this.collisionIndex.placeCollisionBox(Or,Yr,Ar,J,P,E,ae.predicate)};Gt&&Gt.box&&Gt.box.length&&Qe.verticalIconBox?(fr=Mr(Qe.verticalIconBox),bt=fr.box.length>0):(fr=Mr(Qe.iconBox),bt=fr.box.length>0),Pt=Pt&&fr.offscreen}const Wo=W||He.numHorizontalGlyphVertices===0&&He.numVerticalGlyphVertices===0,To=Ae||He.numIconVertices===0;if(Wo||To?To?Wo||(bt=bt&&ft):ft=bt&&ft:bt=ft=bt&&ft,ft&&kt&&kt.box&&this.collisionIndex.insertCollisionBox(kt.box,b.get("text-ignore-placement"),_.bucketInstanceId,Gt&&Gt.box&&Hn?Hn:dn,ae.ID),bt&&fr&&this.collisionIndex.insertCollisionBox(fr.box,b.get("icon-ignore-placement"),_.bucketInstanceId,Jn,ae.ID),qt&&(ft&&this.collisionIndex.insertCollisionCircles(qt.circles,b.get("text-ignore-placement"),_.bucketInstanceId,dn,ae.ID),p)){const Mr=_.bucketInstanceId;let Yr=this.collisionCircleArrays[Mr];Yr===void 0&&(Yr=this.collisionCircleArrays[Mr]=new Wn);for(let Ar=0;Ar<qt.circles.length;Ar+=4)Yr.circles.push(qt.circles[Ar+0]),Yr.circles.push(qt.circles[Ar+1]),Yr.circles.push(qt.circles[Ar+2]),Yr.circles.push(qt.collisionDetected?1:0)}this.placements[He.crossTileID]=new un(ft||Ve,bt||Ge,Pt||_.justReloaded),c[He.crossTileID]=!0};if(Le){const He=_.getSortedSymbolIndexes(this.transform.angle);for(let ht=He.length-1;ht>=0;--ht){const Qe=He[ht];at(_.symbolInstances.get(Qe),Qe,_.collisionArrays[Qe])}}else for(let He=r.symbolInstanceStart;He<r.symbolInstanceEnd;He++)at(_.symbolInstances.get(He),He,_.collisionArrays[He]);if(p&&_.bucketInstanceId in this.collisionCircleArrays){const He=this.collisionCircleArrays[_.bucketInstanceId];s.invert(He.invProjMatrix,E),He.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(r,c,p,y){let _;_=y===s.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(c)];const b=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const E of b)E>=0&&(r.text.placedSymbolArray.get(E).crossTileID=_>=0&&E!==_?0:p.crossTileID)}markUsedOrientation(r,c,p){const y=c===s.WritingMode.horizontal||c===s.WritingMode.horizontalOnly?c:0,_=c===s.WritingMode.vertical?c:0,b=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const E of b)r.text.placedSymbolArray.get(E).placedOrientation=y;p.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let p=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const y=c?c.symbolFadeChange(r):1,_=c?c.opacities:{},b=c?c.variableOffsets:{},E=c?c.placedOrientations:{};for(const U in this.placements){const D=this.placements[U],k=_[U];k?(this.opacities[U]=new On(k,y,D.text,D.icon,null,D.clipped),p=p||D.text!==k.text.placed||D.icon!==k.icon.placed):(this.opacities[U]=new On(null,y,D.text,D.icon,D.skipFade,D.clipped),p=p||D.text||D.icon)}for(const U in _){const D=_[U];if(!this.opacities[U]){const k=new On(D,y,!1,!1);k.isHidden()||(this.opacities[U]=k,p=p||D.text.placed||D.icon.placed)}}for(const U in b)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=b[U]);for(const U in E)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=E[U]);p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:r)}updateLayerOpacities(r,c){const p={};for(const y of c){const _=y.getBucket(r);_&&y.latestFeatureIndex&&r.id===_.layerIds[0]&&this.updateBucketOpacities(_,p,y.collisionBoxArray)}}updateBucketOpacities(r,c,p){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const y=r.layers[0].layout,_=!!r.layers[0].dynamicFilter(),b=new On(null,0,!1,!1,!0),E=y.get("text-allow-overlap"),U=y.get("icon-allow-overlap"),D=y.get("text-variable-anchor"),k=y.get("text-rotation-alignment")==="map",P=y.get("text-pitch-alignment")==="map",j=y.get("icon-text-fit")!=="none",$=new On(null,0,E&&(U||!r.hasIconData()||y.get("icon-optional")),U&&(E||!r.hasTextData()||y.get("text-optional")),!0);!r.collisionArrays&&p&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(p);const ee=(X,ae,W)=>{for(let Ae=0;Ae<ae/4;Ae++)X.opacityVertexArray.emplaceBack(W)};for(let X=0;X<r.symbolInstances.length;X++){const ae=r.symbolInstances.get(X),{numHorizontalGlyphVertices:W,numVerticalGlyphVertices:Ae,crossTileID:ue}=ae;let J=this.opacities[ue];c[ue]?J=b:J||(J=$,this.opacities[ue]=J),c[ue]=!0;const he=ae.numIconVertices>0,ye=this.placedOrientations[ae.crossTileID],De=ye===s.WritingMode.vertical,Le=ye===s.WritingMode.horizontal||ye===s.WritingMode.horizontalOnly;if(W>0||Ae>0){const Ve=$t(J.text);ee(r.text,W,De?jt:Ve),ee(r.text,Ae,Le?jt:Ve);const Ge=J.text.isHidden();[ae.rightJustifiedTextSymbolIndex,ae.centerJustifiedTextSymbolIndex,ae.leftJustifiedTextSymbolIndex].forEach(ht=>{ht>=0&&(r.text.placedSymbolArray.get(ht).hidden=Ge||De?1:0)}),ae.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(ae.verticalPlacedTextSymbolIndex).hidden=Ge||Le?1:0);const at=this.variableOffsets[ae.crossTileID];at&&this.markUsedJustification(r,at.anchor,ae,ye);const He=this.placedOrientations[ae.crossTileID];He&&(this.markUsedJustification(r,"left",ae,He),this.markUsedOrientation(r,He,ae))}if(he){const Ve=$t(J.icon);ae.placedIconSymbolIndex>=0&&(ee(r.icon,ae.numIconVertices,De?jt:Ve),r.icon.placedSymbolArray.get(ae.placedIconSymbolIndex).hidden=J.icon.isHidden()),ae.verticalPlacedIconSymbolIndex>=0&&(ee(r.icon,ae.numVerticalIconVertices,Le?jt:Ve),r.icon.placedSymbolArray.get(ae.verticalPlacedIconSymbolIndex).hidden=J.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Ve=r.collisionArrays[X];if(Ve){let Ge=new s.pointGeometry(0,0),at=!0;if(Ve.textBox||Ve.verticalTextBox){if(D){const ht=this.variableOffsets[ue];ht?(Ge=Ur(ht.anchor,ht.width,ht.height,ht.textOffset,ht.textScale),k&&Ge._rotate(P?this.transform.angle:-this.transform.angle)):at=!1}_&&(at=!J.clipped),Ve.textBox&&zr(r.textCollisionBox.collisionVertexArray,J.text.placed,!at||De,Ge.x,Ge.y),Ve.verticalTextBox&&zr(r.textCollisionBox.collisionVertexArray,J.text.placed,!at||Le,Ge.x,Ge.y)}const He=at&&!!(!Le&&Ve.verticalIconBox);Ve.iconBox&&zr(r.iconCollisionBox.collisionVertexArray,J.icon.placed,He,j?Ge.x:0,j?Ge.y:0),Ve.verticalIconBox&&zr(r.iconCollisionBox.collisionVertexArray,J.icon.placed,!He,j?Ge.x:0,j?Ge.y:0)}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const X=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=X.invProjMatrix,r.placementViewportMatrix=X.viewportMatrix,r.collisionCircleArray=X.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,c){const p=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function zr(d,r,c,p,y){d.emplaceBack(r?1:0,c?1:0,p||0,y||0),d.emplaceBack(r?1:0,c?1:0,p||0,y||0),d.emplaceBack(r?1:0,c?1:0,p||0,y||0),d.emplaceBack(r?1:0,c?1:0,p||0,y||0)}const wo=Math.pow(2,25),hn=Math.pow(2,24),Bo=Math.pow(2,17),cs=Math.pow(2,16),_e=Math.pow(2,9),ze=Math.pow(2,8),ct=Math.pow(2,1);function $t(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const r=d.placed?1:0,c=Math.floor(127*d.opacity);return c*wo+r*hn+c*Bo+r*cs+c*_e+r*ze+c*ct+r}const jt=0;class Pr{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,c,p,y,_){const b=this._bucketParts;for(;this._currentTileIndex<r.length;)if(c.getBucketParts(b,y,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort((E,U)=>E.sortKey-U.sortKey));this._currentPartIndex<b.length;){const E=b[this._currentPartIndex];if(c.placeLayerBucketPart(E,this._seenCrossTileIDs,p,E.symbolInstanceStart===0),this._currentPartIndex++,_())return!0}return!1}}class xr{constructor(r,c,p,y,_,b,E,U){this.placement=new ao(r,_,b,E,U),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(r,c,p){const y=s.exported.now(),_=()=>{const b=s.exported.now()-y;return!this._forceFullPlacement&&b>2};for(;this._currentPlacementIndex>=0;){const b=c[r[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=E)&&(!b.maxzoom||b.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new Pr(b)),this._inProgressLayer.continuePlacement(p[b.source],this.placement,this._showCollisionBoxes,b,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Sr=512/s.EXTENT/2;class Rn{constructor(r,c,p){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(let y=0;y<c.length;y++){const _=c.get(y),b=_.key;this.indexedSymbolInstances[b]||(this.indexedSymbolInstances[b]=[]),this.indexedSymbolInstances[b].push({crossTileID:_.crossTileID,coord:this.getScaledCoordinates(_,r)})}}getScaledCoordinates(r,c){const p=Sr/Math.pow(2,c.canonical.z-this.tileID.canonical.z);return{x:Math.floor((c.canonical.x*s.EXTENT+r.tileAnchorX)*p),y:Math.floor((c.canonical.y*s.EXTENT+r.tileAnchorY)*p)}}findMatches(r,c,p){const y=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let _=0;_<r.length;_++){const b=r.get(_);if(b.crossTileID)continue;const E=this.indexedSymbolInstances[b.key];if(!E)continue;const U=this.getScaledCoordinates(b,c);for(const D of E)if(Math.abs(D.coord.x-U.x)<=y&&Math.abs(D.coord.y-U.y)<=y&&!p[D.crossTileID]){p[D.crossTileID]=!0,b.crossTileID=D.crossTileID;break}}}}class Bn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class la{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const c=Math.round((r-this.lng)/360);if(c!==0)for(const p in this.indexes){const y=this.indexes[p],_={};for(const b in y){const E=y[b];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+c),_[E.tileID.key]=E}this.indexes[p]=_}this.lng=r}addBucket(r,c,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let _=0;_<c.symbolInstances.length;_++)c.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const y=this.usedCrossTileIDs[r.overscaledZ];for(const _ in this.indexes){const b=this.indexes[_];if(Number(_)>r.overscaledZ)for(const E in b){const U=b[E];U.tileID.isChildOf(r)&&U.findMatches(c.symbolInstances,r,y)}else{const E=b[r.scaledTo(Number(_)).key];E&&E.findMatches(c.symbolInstances,r,y)}}for(let _=0;_<c.symbolInstances.length;_++){const b=c.symbolInstances.get(_);b.crossTileID||(b.crossTileID=p.generate(),y[b.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Rn(r,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(r,c){for(const p in c.indexedSymbolInstances)for(const y of c.indexedSymbolInstances[p])delete this.usedCrossTileIDs[r][y.crossTileID]}removeStaleBuckets(r){let c=!1;for(const p in this.indexes){const y=this.indexes[p];for(const _ in y)r[y[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[_]),delete y[_],c=!0)}return c}}class Gr{constructor(){this.layerIndexes={},this.crossTileIDs=new Bn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,c,p){let y=this.layerIndexes[r.id];y===void 0&&(y=this.layerIndexes[r.id]=new la);let _=!1;const b={};y.handleWrapJump(p);for(const E of c){const U=E.getBucket(r);U&&r.id===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(E.tileID,U,this.crossTileIDs)&&(_=!0),b[U.bucketInstanceId]=!0)}return y.removeStaleBuckets(b)&&(_=!0),_}pruneUnusedLayers(r){const c={};r.forEach(p=>{c[p]=!0});for(const p in this.layerIndexes)c[p]||delete this.layerIndexes[p]}}const us=(d,r)=>s.emitValidationErrors(d,r&&r.filter(c=>c.identifier!=="source.canvas")),Ps=s.pick(ut,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),hs=s.pick(ut,["setCenter","setZoom","setBearing","setPitch"]),bo=function(){const d={},r=s.spec.$version;for(const c in s.spec.$root){const p=s.spec.$root[c];if(p.required){let y=null;y=c==="version"?r:p.type==="array"?[]:{},y!=null&&(d[c]=y)}}return d}(),Co={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Un extends s.Evented{constructor(r,c={}){super(),this.map=r,this.dispatcher=new Vt(lt(),this),this.imageManager=new Ke,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(r._requestManager,c.localFontFamily?s.LocalGlyphMode.all:c.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.lineAtlas=new s.LineAtlas(256,512),this.crossTileSymbolIndex=new Gr,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const p=this;this._rtlTextPluginCallback=Un.registerForPluginStateChange(y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(_,b)=>{if(s.triggerPluginCompletionEvent(_),b&&b.every(E=>E))for(const E in p._sourceCaches){const U=p._sourceCaches[E],D=U.getSource().type;D!=="vector"&&D!=="geojson"||U.reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const _=this.getSource(y.sourceId);if(_&&_.vectorLayerIds)for(const b in this._layers){const E=this._layers[b];E.source===_.id&&this._validateLayer(E)}})}loadURL(r,c={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const p=typeof c.validate=="boolean"?c.validate:!s.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,c.accessToken);const y=this.map._requestManager.transformRequest(r,s.ResourceType.Style);this._request=s.getJSON(y,(_,b)=>{this._request=null,_?this.fire(new s.ErrorEvent(_)):b&&this._load(b,p)})}loadJSON(r,c={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(r,c.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(bo,!1)}_updateLayerCount(r,c){const p=c?1:-1;r.is3D()&&(this._num3DLayers+=p),r.type==="circle"&&(this._numCircleLayers+=p),r.type==="symbol"&&(this._numSymbolLayers+=p)}_load(r,c){if(c&&us(this,s.validateStyle(r)))return;this._loaded=!0,this.stylesheet=r,this.updateProjection();for(const y in r.sources)this.addSource(y,r.sources[y],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const p=St(this.stylesheet.layers);this._order=p.map(y=>y.id),this._layers={},this._serializedLayers={};for(let y of p)y=s.createStyleLayer(y),y.setEventedParent(this,{layer:{id:y.id}}),this._layers[y.id]=y,this._serializedLayers[y.id]=y.serialize(),this._updateLayerCount(y,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new qe(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.updateProjection()}updateProjection(){const r=this.map.transform.setProjection(this.map._runtimeProjection||(this.stylesheet?this.stylesheet.projection:void 0));if(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),r){this.map.painter.clearBackgroundTiles();for(const c in this._sourceCaches)this._sourceCaches[c].clearTiles();this.map._update(!0)}}_loadSprite(r){this._spriteRequest=function(c,p,y){let _,b,E;const U=s.exported.devicePixelRatio>1?"@2x":"";let D=s.getJSON(p.transformRequest(p.normalizeSpriteURL(c,U,".json"),s.ResourceType.SpriteJSON),(j,$)=>{D=null,E||(E=j,_=$,P())}),k=s.getImage(p.transformRequest(p.normalizeSpriteURL(c,U,".png"),s.ResourceType.SpriteImage),(j,$)=>{k=null,E||(E=j,b=$,P())});function P(){if(E)y(E);else if(_&&b){const j=s.exported.getImageData(b),$={};for(const ee in _){const{width:X,height:ae,x:W,y:Ae,sdf:ue,pixelRatio:J,stretchX:he,stretchY:ye,content:De}=_[ee],Le=new s.RGBAImage({width:X,height:ae});s.RGBAImage.copy(j,Le,{x:W,y:Ae},{x:0,y:0},{width:X,height:ae}),$[ee]={data:Le,pixelRatio:J,sdf:ue,stretchX:he,stretchY:ye,content:De}}y(null,$)}}return{cancel(){D&&(D.cancel(),D=null),k&&(k.cancel(),k=null)}}}(r,this.map._requestManager,(c,p)=>{if(this._spriteRequest=null,c)this.fire(new s.ErrorEvent(c));else if(p)for(const y in p)this.imageManager.addImage(y,p[y]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(r){const c=this.getSource(r.source);if(!c)return;const p=r.sourceLayer;p&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(p)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${c.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const c=[];for(const p of r){const y=this._layers[p];y.type!=="custom"&&c.push(y.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&Co[r.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const c=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(y.length||_.length)&&this._updateWorkerLayers(y,_);for(const b in this._updatedSources){const E=this._updatedSources[b];E==="reload"?this._reloadSource(b):E==="clear"&&this._clearSource(b)}this._updateTilesForChangedImages();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const p={};for(const y in this._sourceCaches){const _=this._sourceCaches[y];p[y]=_.used,_.used=!1}for(const y of this._order){const _=this._layers[y];if(_.recalculate(r,this._availableImages),!_.isHidden(r.zoom)){const E=this._getLayerSourceCache(_);E&&(E.used=!0)}const b=this.map.painter;if(b){const E=_.getProgramIds();if(!E)continue;const U=_.getProgramConfiguration(r.zoom);for(const D of E)b.useProgram(D,U)}}for(const y in p){const _=this._sourceCaches[y];p[y]!==_.used&&_.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:_.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),us(this,s.validateStyle(r)))return!1;(r=s.clone$2(r)).layers=St(r.layers);const c=function(y,_){if(!y)return[{command:ut.setStyle,args:[_]}];let b=[];try{if(!L(y.version,_.version))return[{command:ut.setStyle,args:[_]}];L(y.center,_.center)||b.push({command:ut.setCenter,args:[_.center]}),L(y.zoom,_.zoom)||b.push({command:ut.setZoom,args:[_.zoom]}),L(y.bearing,_.bearing)||b.push({command:ut.setBearing,args:[_.bearing]}),L(y.pitch,_.pitch)||b.push({command:ut.setPitch,args:[_.pitch]}),L(y.sprite,_.sprite)||b.push({command:ut.setSprite,args:[_.sprite]}),L(y.glyphs,_.glyphs)||b.push({command:ut.setGlyphs,args:[_.glyphs]}),L(y.transition,_.transition)||b.push({command:ut.setTransition,args:[_.transition]}),L(y.light,_.light)||b.push({command:ut.setLight,args:[_.light]}),L(y.fog,_.fog)||b.push({command:ut.setFog,args:[_.fog]}),L(y.projection,_.projection)||b.push({command:ut.setProjection,args:[_.projection]});const E={},U=[];(function(P,j,$,ee){let X;for(X in j=j||{},P=P||{})P.hasOwnProperty(X)&&(j.hasOwnProperty(X)||Pe(X,$,ee));for(X in j)j.hasOwnProperty(X)&&(P.hasOwnProperty(X)?L(P[X],j[X])||(P[X].type==="geojson"&&j[X].type==="geojson"&&ar(P,j,X)?$.push({command:ut.setGeoJSONSourceData,args:[X,j[X].data]}):zt(X,j,$,ee)):xe(X,j,$))})(y.sources,_.sources,U,E);const D=[];y.layers&&y.layers.forEach(P=>{E[P.source]?b.push({command:ut.removeLayer,args:[P.id]}):D.push(P)});let k=y.terrain;k&&E[k.source]&&(b.push({command:ut.setTerrain,args:[void 0]}),k=void 0),b=b.concat(U),L(k,_.terrain)||b.push({command:ut.setTerrain,args:[_.terrain]}),function(P,j,$){j=j||[];const ee=(P=P||[]).map(ir),X=j.map(ir),ae=P.reduce(or,{}),W=j.reduce(or,{}),Ae=ee.slice(),ue=Object.create(null);let J,he,ye,De,Le,Ve,Ge;for(J=0,he=0;J<ee.length;J++)ye=ee[J],W.hasOwnProperty(ye)?he++:($.push({command:ut.removeLayer,args:[ye]}),Ae.splice(Ae.indexOf(ye,he),1));for(J=0,he=0;J<X.length;J++)ye=X[X.length-1-J],Ae[Ae.length-1-J]!==ye&&(ae.hasOwnProperty(ye)?($.push({command:ut.removeLayer,args:[ye]}),Ae.splice(Ae.lastIndexOf(ye,Ae.length-he),1)):he++,Ve=Ae[Ae.length-J],$.push({command:ut.addLayer,args:[W[ye],Ve]}),Ae.splice(Ae.length-J,0,ye),ue[ye]=!0);for(J=0;J<X.length;J++)if(ye=X[J],De=ae[ye],Le=W[ye],!ue[ye]&&!L(De,Le))if(L(De.source,Le.source)&&L(De["source-layer"],Le["source-layer"])&&L(De.type,Le.type)){for(Ge in Rt(De.layout,Le.layout,$,ye,null,ut.setLayoutProperty),Rt(De.paint,Le.paint,$,ye,null,ut.setPaintProperty),L(De.filter,Le.filter)||$.push({command:ut.setFilter,args:[ye,Le.filter]}),L(De.minzoom,Le.minzoom)&&L(De.maxzoom,Le.maxzoom)||$.push({command:ut.setLayerZoomRange,args:[ye,Le.minzoom,Le.maxzoom]}),De)De.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?Rt(De[Ge],Le[Ge],$,ye,Ge.slice(6),ut.setPaintProperty):L(De[Ge],Le[Ge])||$.push({command:ut.setLayerProperty,args:[ye,Ge,Le[Ge]]}));for(Ge in Le)Le.hasOwnProperty(Ge)&&!De.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?Rt(De[Ge],Le[Ge],$,ye,Ge.slice(6),ut.setPaintProperty):L(De[Ge],Le[Ge])||$.push({command:ut.setLayerProperty,args:[ye,Ge,Le[Ge]]}))}else $.push({command:ut.removeLayer,args:[ye]}),Ve=Ae[Ae.lastIndexOf(ye)+1],$.push({command:ut.addLayer,args:[Le,Ve]})}(D,_.layers,b)}catch(E){console.warn("Unable to compute style diff:",E),b=[{command:ut.setStyle,args:[_]}]}return b}(this.serialize(),r).filter(y=>!(y.command in hs));if(c.length===0)return!1;const p=c.filter(y=>!(y.command in Ps));if(p.length>0)throw new Error(`Unimplemented: ${p.map(y=>y.command).join(", ")}.`);return c.forEach(y=>{y.command!=="setTransition"&&this[y.command].apply(this,y.args)}),this.stylesheet=r,!0}addImage(r,c){if(this.getImage(r))return this.fire(new s.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(r,c),this._afterImageUpdated(r)}updateImage(r,c){this.imageManager.updateImage(r,c)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new s.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,c,p={}){if(this._checkLoaded(),this.getSource(r)!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(s.validateStyle.source,`sources.${r}`,c,null,p))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const y=N(r,c,this.dispatcher,this);y.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:y.serialize(),sourceId:r}));const _=b=>{const E=(b?"symbol:":"other:")+r,U=this._sourceCaches[E]=new s.SourceCache(E,y,b);(b?this._symbolSourceCaches:this._otherSourceCaches)[r]=U,U.style=this,U.onAdd(this.map)};_(!1),c.type!=="vector"&&c.type!=="geojson"||_(!0),y.onAdd&&y.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const c=this.getSource(r);if(c===void 0)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===r)return this.fire(new s.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new s.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(r);for(const y of p)delete this._sourceCaches[y.id],delete this._updatedSources[y.id],y.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles();delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,c){this._checkLoaded(),this.getSource(r).setData(c),this._changed=!0}getSource(r){const c=this._getSourceCache(r);return c&&c.getSource()}addLayer(r,c,p={}){this._checkLoaded();const y=r.id;if(this.getLayer(y))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${y}" already exists on this map`)));let _;if(r.type==="custom"){if(us(this,s.validateCustomStyleLayer(r)))return;_=s.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(y,r.source),r=s.clone$2(r),r=s.extend(r,{source:y})),this._validate(s.validateStyle.layer,`layers.${y}`,r,{arrayIndex:-1},p))return;_=s.createStyleLayer(r),this._validateLayer(_),_.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[_.id]=_.serialize(),this._updateLayerCount(_,!0)}const b=c?this._order.indexOf(c):this._order.length;if(c&&b===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(b,0,y),this._layerOrderChanged=!0,this._layers[y]=_;const E=this._getLayerSourceCache(_);if(this._removedLayers[y]&&_.source&&E&&_.type!=="custom"){const U=this._removedLayers[y];delete this._removedLayers[y],U.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",E.pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,c){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===c)return;const p=this._order.indexOf(r);this._order.splice(p,1);const y=c?this._order.indexOf(c):this._order.length;c&&y===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(y,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const c=this._layers[r];if(!c)return void this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const p=this._order.indexOf(r);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=c,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const c in this._layers)if(this._layers[c].type===r)return!0;return!1}setLayerZoomRange(r,c,p){this._checkLoaded();const y=this.getLayer(r);y?y.minzoom===c&&y.maxzoom===p||(c!=null&&(y.minzoom=c),p!=null&&(y.maxzoom=p),this._updateLayer(y)):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,c,p={}){this._checkLoaded();const y=this.getLayer(r);if(y){if(!L(y.filter,c))return c==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(s.validateStyle.filter,`layers.${y.id}.filter`,c,{layerType:y.type},p)||(y.filter=s.clone$2(c),this._updateLayer(y)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){return s.clone$2(this.getLayer(r).filter)}setLayoutProperty(r,c,p,y={}){this._checkLoaded();const _=this.getLayer(r);_?L(_.getLayoutProperty(c),p)||(_.setLayoutProperty(c,p,y),this._updateLayer(_)):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,c){const p=this.getLayer(r);if(p)return p.getLayoutProperty(c);this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,c,p,y={}){this._checkLoaded();const _=this.getLayer(r);_?L(_.getPaintProperty(c),p)||(_.setPaintProperty(c,p,y)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,c){return this.getLayer(r).getPaintProperty(c)}setFeatureState(r,c){this._checkLoaded();const p=r.source,y=r.sourceLayer,_=this.getSource(p);if(_===void 0)return void this.fire(new s.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const b=_.type;if(b==="geojson"&&y)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(b==="vector"&&!y)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const E=this._getSourceCaches(p);for(const U of E)U.setFeatureState(y,r.id,c)}removeFeatureState(r,c){this._checkLoaded();const p=r.source,y=this.getSource(p);if(y===void 0)return void this.fire(new s.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const _=y.type,b=_==="vector"?r.sourceLayer:void 0;if(_==="vector"&&!b)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const E=this._getSourceCaches(p);for(const U of E)U.removeFeatureState(b,r.id,c)}getFeatureState(r){this._checkLoaded();const c=r.source,p=r.sourceLayer,y=this.getSource(c);if(y!==void 0){if(y.type!=="vector"||p)return r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(p,r.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const c in this._sourceCaches){const p=this._sourceCaches[c].getSource();r[p.id]||(r[p.id]=p.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0;const c=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&c&&c.getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",c.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const c=b=>this._layers[b].type==="fill-extrusion",p={},y=[];for(let b=this._order.length-1;b>=0;b--){const E=this._order[b];if(c(E)){p[E]=b;for(const U of r){const D=U[E];if(D)for(const k of D)y.push(k)}}}y.sort((b,E)=>E.intersectionZ-b.intersectionZ);const _=[];for(let b=this._order.length-1;b>=0;b--){const E=this._order[b];if(c(E))for(let U=y.length-1;U>=0;U--){const D=y[U].feature;if(p[D.layer.id]<b)break;_.push(D),y.pop()}else for(const U of r){const D=U[E];if(D)for(const k of D)_.push(k.feature)}}return _}queryRenderedFeatures(r,c,p){c&&c.filter&&this._validate(s.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);const y={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const U of c.layers){const D=this._layers[U];if(!D)return this.fire(new s.ErrorEvent(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];y[D.source]=!0}}const _=[];c.availableImages=this._availableImages;const b=c&&c.layers?c.layers.some(U=>{const D=this.getLayer(U);return D&&D.is3D()}):this.has3DLayers(),E=yt.createFromScreenPoints(r,p);for(const U in this._sourceCaches){const D=this._sourceCaches[U].getSource().id;c.layers&&!y[D]||_.push(le(this._sourceCaches[U],this._layers,this._serializedLayers,E,c,p,b,!!this.map._showQueryGeometry))}return this.placement&&_.push(function(U,D,k,P,j,$,ee){const X={},ae=$.queryRenderedSymbols(P),W=[];for(const Ae of Object.keys(ae).map(Number))W.push(ee[Ae]);W.sort(Fe);for(const Ae of W){const ue=Ae.featureIndex.lookupSymbolFeatures(ae[Ae.bucketInstanceId],D,Ae.bucketIndex,Ae.sourceLayerIndex,j.filter,j.layers,j.availableImages,U);for(const J in ue){const he=X[J]=X[J]||[],ye=ue[J];ye.sort((De,Le)=>{const Ve=Ae.featureSortOrder;if(Ve){const Ge=Ve.indexOf(De.featureIndex);return Ve.indexOf(Le.featureIndex)-Ge}return Le.featureIndex-De.featureIndex});for(const De of ye)he.push(De)}}for(const Ae in X)X[Ae].forEach(ue=>{const J=ue.feature,he=k(U[Ae]).getFeatureState(J.layer["source-layer"],J.id);J.source=J.layer.source,J.layer["source-layer"]&&(J.sourceLayer=J.layer["source-layer"]),J.state=he});return X}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),E.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(r,c){c&&c.filter&&this._validate(s.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);const p=this._getSourceCaches(r);let y=[];for(const _ of p)y=y.concat(pe(_,c));return y}addSourceType(r,c,p){return Un.getSourceType(r)?p(new Error(`A source type called "${r}" already exists.`)):(Un.setSourceType(r,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:c.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(r,c={}){this._checkLoaded();const p=this.light.getLight();let y=!1;for(const b in r)if(!L(r[b],p[b])){y=!0;break}if(!y)return;const _={now:s.exported.now(),transition:s.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,c),this.light.updateTransitions(_)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(r){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(typeof r.source=="object"){const c="terrain-dem-src";this.addSource(c,r.source),r=s.clone$2(r),r=s.extend(r,{source:c})}if(!this._validate(s.validateStyle.terrain,"terrain",r)){if(this.terrain){const c=this.terrain,p=c.get();for(const y in r)if(!L(r[y],p[y])){c.set(r),this.stylesheet.terrain=r;const _={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};c.updateTransitions(_);break}}else this._createTerrain(r);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}_createFog(r){const c=this.fog=new Dt(r,this.map.transform);this.stylesheet.fog=r;const p={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};c.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,p=c.get();for(const y in r)if(!L(r[y],p[y])){c.set(r),this.stylesheet.fog=r;const _={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};c.updateTransitions(_);break}}else this._createFog(r);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(p=>this.isLayerDraped(this._layers[p])),c=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...c)}_createTerrain(r){const c=this.terrain=new Ne(r);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const p={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};c.updateTransitions(p)}_force3DLayerUpdate(){for(const r in this._layers){const c=this._layers[r];c.type==="fill-extrusion"&&this._updateLayer(c)}}_validate(r,c,p,y,_={}){return(!_||_.validate!==!1)&&us(this,r.call(s.validateStyle,s.extend({key:c,style:this.serialize(),value:p,styleSpec:s.spec},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const c=this._getSourceCaches(r);for(const p of c)p.clearTiles()}_reloadSource(r){const c=this._getSourceCaches(r);for(const p of c)p.resume(),p.reload()}_updateSources(r){for(const c in this._sourceCaches)this._sourceCaches[c].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const c=this._sourceCaches[r];c.resume(),c.reload()}}_updatePlacement(r,c,p,y,_=!1){let b=!1,E=!1;const U={};for(const D of this._order){const k=this._layers[D];if(k.type!=="symbol")continue;if(!U[k.source]){const j=this._getLayerSourceCache(k);if(!j)continue;U[k.source]=j.getRenderableIds(!0).map($=>j.getTileByID($)).sort(($,ee)=>ee.tileID.overscaledZ-$.tileID.overscaledZ||($.tileID.isLessThan(ee.tileID)?-1:1))}const P=this.crossTileSymbolIndex.addLayer(k,U[k.source],r.center.lng);b=b||P}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),_=_||this._layerOrderChanged||p===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(_||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),r.zoom))&&(this.pauseablePlacement=new xr(r,this._order,_,c,p,y,this.placement,this.fog&&!this.fog.isSoftDisabled()?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),E=!0),b&&this.pauseablePlacement.placement.setStale()),E||b)for(const D of this._order){const k=this._layers[D];k.type==="symbol"&&this.placement.updateLayerOpacities(k,U[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,c,p){this.imageManager.getImages(c.icons,p),this._updateTilesForChangedImages();const y=_=>{_&&_.setDependencies(c.tileID.key,c.type,c.icons)};y(this._otherSourceCaches[c.source]),y(this._symbolSourceCaches[c.source])}getGlyphs(r,c,p){this.glyphManager.getGlyphs(c.stacks,p)}getResource(r,c,p){return s.makeRequest(c,p)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const c=[];return this._otherSourceCaches[r]&&c.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&c.push(this._symbolSourceCaches[r]),c}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}}Un.getSourceType=function(d){return O[d]},Un.setSourceType=function(d,r){O[d]=r},Un.registerForPluginStateChange=s.registerForPluginStateChange;var Eo=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}
#endif`,Os="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Fo={},se={};Fo=Mt("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else 
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),se=Mt(`#ifdef FOG
uniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const Ee=Mt(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {
#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)
return mix(globe,mercator,t);
#else
return globe;
#endif
}vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Ye=Eo;var Ft={background:Mt(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Mt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Mt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Mt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Mt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
extrude*=a_scale;vec3 normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));vec3 globePos=a_pos_3+xAxis*extrude.x+yAxis*extrude.y+elevationVector(tilePos)*elevation(tilePos);vec3 mercPos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+xAxis*extrude.x+yAxis*extrude.y;vec3 pos=mix_globe_mercator(globePos,mercPos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Mt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Mt("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Mt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Mt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:Mt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Mt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Mt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Mt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Mt(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Mt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Mt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Mt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Mt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
vec4 out_color=texture2D(u_gradient_image,v_uv);
#else
vec4 out_color=color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#ifdef RENDER_LINE_GRADIENT
attribute vec3 a_packed;
#else
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_GRADIENT
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Mt(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Mt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Mt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Mt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Mt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Mt(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:Mt(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Mt(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Os),skyboxGradient:Mt(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Os),skyboxCapture:Mt(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Mt(`uniform sampler2D u_image0;varying vec2 v_pos0;void main() {vec4 color=texture2D(u_image0,v_pos0);gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat4 u_up_vector_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying vec2 v_pos0;void main() {v_pos0=a_uv;vec2 uv=a_uv*EXTENT;vec4 up_vector=u_up_vector_matrix*vec4(elevationVector(uv),1.0);float height=elevation(uv);vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}"),globeAtmosphere:Mt(`uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {highp vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)
discard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}`,"attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}"),globeDepth:Mt(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat4 u_up_vector_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying float v_depth;void main() {vec2 uv=a_uv*EXTENT;vec4 up_vector=u_up_vector_matrix*vec4(elevationVector(uv),1.0);float height=elevation(uv);vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);v_depth=gl_Position.z/gl_Position.w;}")};function Mt(d,r,c){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,_=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),b=d.match(y),E=r.match(y),U=Eo.match(y);let D=E?E.concat(b):b;c||(Fo.staticUniforms&&(D=Fo.staticUniforms.concat(D)),se.staticUniforms&&(D=se.staticUniforms.concat(D))),D&&(D=D.concat(U));const k={};return{fragmentSource:d=d.replace(p,(P,j,$,ee,X)=>(k[X]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_${X}
varying ${$} ${ee} ${X};
#else
uniform ${$} ${ee} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${$} ${ee} ${X} = u_${X};
#endif
`)),vertexSource:r=r.replace(p,(P,j,$,ee,X)=>{const ae=ee==="float"?"vec2":"vec4",W=X.match(/color/)?"color":ae;return k[X]?j==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${$} ${ae} a_${X};
varying ${$} ${ee} ${X};
#else
uniform ${$} ${ee} u_${X};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${$} ${ee} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${W}(a_${X}, u_${X}_t);
#else
    ${$} ${ee} ${X} = u_${X};
#endif
`:j==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${$} ${ae} a_${X};
#else
uniform ${$} ${ee} u_${X};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${$} ${ee} ${X} = a_${X};
#else
    ${$} ${ee} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${$} ${ee} ${X} = unpack_mix_${W}(a_${X}, u_${X}_t);
#else
    ${$} ${ee} ${X} = u_${X};
#endif
`}),staticAttributes:_,staticUniforms:D}}class er{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,c,p,y,_,b,E,U){this.context=r;let D=this.boundPaintVertexBuffers.length!==y.length;for(let k=0;!D&&k<y.length;k++)this.boundPaintVertexBuffers[k]!==y[k]&&(D=!0);r.extVertexArrayObject&&this.vao&&this.boundProgram===c&&this.boundLayoutVertexBuffer===p&&!D&&this.boundIndexBuffer===_&&this.boundVertexOffset===b&&this.boundDynamicVertexBuffer===E&&this.boundDynamicVertexBuffer2===U?(r.bindVertexArrayOES.set(this.vao),E&&E.bind(),_&&_.dynamicDraw&&_.bind(),U&&U.bind()):this.freshBind(c,p,y,_,b,E,U)}freshBind(r,c,p,y,_,b,E){let U;const D=r.numAttributes,k=this.context,P=k.gl;if(k.extVertexArrayObject)this.vao&&this.destroy(),this.vao=k.extVertexArrayObject.createVertexArrayOES(),k.bindVertexArrayOES.set(this.vao),U=0,this.boundProgram=r,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=E;else{U=k.currentNumAttributes||0;for(let j=D;j<U;j++)P.disableVertexAttribArray(j)}c.enableAttributes(P,r);for(const j of p)j.enableAttributes(P,r);b&&b.enableAttributes(P,r),E&&E.enableAttributes(P,r),c.bind(),c.setVertexAttribPointers(P,r,_);for(const j of p)j.bind(),j.setVertexAttribPointers(P,r,_);b&&(b.bind(),b.setVertexAttribPointers(P,r,_)),y&&y.bind(),E&&(E.bind(),E.setVertexAttribPointers(P,r,_)),k.currentNumAttributes=D}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Qr(d,r){const c=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new s.MercatorCoordinate(0,p/c).toLngLat().lat,new s.MercatorCoordinate(0,(p+1)/c).toLngLat().lat]}function Jr(d,r,c,p,y,_,b){const E=d.context,U=E.gl,D=c.fbo;if(!D)return;d.prepareDrawTile(r);const k=d.useProgram("hillshade");E.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,D.colorAttachment.get());const P=((X,ae,W,Ae)=>{const ue=W.paint.get("hillshade-shadow-color"),J=W.paint.get("hillshade-highlight-color"),he=W.paint.get("hillshade-accent-color");let ye=W.paint.get("hillshade-illumination-direction")*(Math.PI/180);W.paint.get("hillshade-illumination-anchor")==="viewport"&&(ye-=X.transform.angle);const De=!X.options.moving;return{u_matrix:Ae||X.transform.calculateProjMatrix(ae.tileID.toUnwrapped(),De),u_image:0,u_latrange:Qr(0,ae.tileID),u_light:[W.paint.get("hillshade-exaggeration"),ye],u_shadow:ue,u_highlight:J,u_accent:he}})(d,c,p,d.terrain?r.projMatrix:null);d.prepareDrawProgram(E,k,r.toUnwrapped());const{tileBoundsBuffer:j,tileBoundsIndexBuffer:$,tileBoundsSegments:ee}=d.getTileBoundsBuffers(c);k.draw(E,U.TRIANGLES,y,_,b,s.CullFaceMode.disabled,P,p.id,j,$,ee)}function jr(d,r,c){if(!r.needsDEMTextureUpload)return;const p=d.context,y=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||d.getTileTexture(c.stride);const _=c.getPixels();r.demTexture?r.demTexture.update(_,{premultiply:!1}):r.demTexture=new s.Texture(p,_,y.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function wr(d,r,c,p,y,_){const b=d.context,E=b.gl;if(!r.dem)return;const U=r.dem;if(b.activeTexture.set(E.TEXTURE1),jr(d,r,U),!r.demTexture)return;r.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);const D=U.dim;b.activeTexture.set(E.TEXTURE0);let k=r.fbo;if(!k){const ee=new s.Texture(b,{width:D,height:D,data:null},E.RGBA);ee.bind(E.LINEAR,E.CLAMP_TO_EDGE),k=r.fbo=b.createFramebuffer(D,D,!0),k.colorAttachment.set(ee.texture)}b.bindFramebuffer.set(k.framebuffer),b.viewport.set([0,0,D,D]);const{tileBoundsBuffer:P,tileBoundsIndexBuffer:j,tileBoundsSegments:$}=d.getMercatorTileBoundsBuffers();d.useProgram("hillshadePrepare").draw(b,E.TRIANGLES,p,y,_,s.CullFaceMode.disabled,((ee,X)=>{const ae=X.stride,W=s.create$1();return s.ortho(W,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(W,W,[0,-s.EXTENT,0]),{u_matrix:W,u_image:1,u_dimension:[ae,ae],u_zoom:ee.overscaledZ,u_unpack:X.unpackVector}})(r.tileID,U),c.id,P,j,$),r.needsHillshadePrepare=!1}const Xt=(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_image0:new s.Uniform1i(d,r.u_image0),u_skirt_height:new s.Uniform1f(d,r.u_skirt_height)}),zn=(d,r)=>({u_matrix:d,u_image0:0,u_skirt_height:r}),on=new class{constructor(){this.operations={}}newMorphing(d,r,c,p,y){if(d in this.operations){const _=this.operations[d];_.to.tileID.key!==c.tileID.key&&(_.queued=c)}else this.operations[d]={startTime:p,phase:0,duration:y,from:r,to:c,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const r=this.operations[d];return{from:r.from,to:r.to,phase:r.phase}}update(d){for(const r in this.operations){const c=this.operations[r];for(c.phase=(d-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,d)){delete this.operations[r];break}}}_nextOp(d,r){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=r,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},$n={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function ai(d,r){const c=1<<d.z;return!r&&(d.x===0||d.x===c-1)||d.y===0||d.y===c-1}const yi=d=>({u_matrix:d});function ki(d,r,c,p,y){if(y>0){const _=s.exported.now(),b=(_-d.timeAdded)/y,E=r?(_-r.timeAdded)/y:-1,U=c.getSource(),D=p.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),k=!r||Math.abs(r.tileID.overscaledZ-D)>Math.abs(d.tileID.overscaledZ-D),P=k&&d.refreshedUponExpiration?1:s.clamp(k?b:1-E,0,1);return d.refreshedUponExpiration&&b>=1&&(d.refreshedUponExpiration=!1),r?{opacity:1,mix:1-P}:{opacity:P,mix:0}}return{opacity:1,mix:0}}class jo extends s.SourceCache{constructor(r){const c=N("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new Vt(lt(),null),r.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,c,p){if(r.freezeTileCoverage)return;this.transform=r;const y=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((_,b)=>{if(_[b.key]="",!this._tiles[b.key]){const E=new s.Tile(b,this._source.tileSize*b.overscaleFactor(),r.tileZoom);E.state="loaded",this._tiles[b.key]=E}return _},{});for(const _ in this._tiles)_ in y||(this.freeFBO(_),this._tiles[_].unloadVectorData(),delete this._tiles[_])}freeFBO(r){const c=this.proxyCachedFBO[r];if(c!==void 0){const p=Object.values(c);this.renderCachePool.push(...p),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class uA extends s.OverscaledTileID{constructor(r,c,p){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=c,this.projMatrix=p}}class ds extends s.Elevation{constructor(r,c){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,y,_]=function(U){const D=new s.StructArrayLayout4i8,k=new s.StructArrayLayout3ui6,P=131;D.reserve(17161),k.reserve(33800);const j=s.EXTENT/128,$=s.EXTENT+j/2,ee=$+j;for(let ae=-j;ae<ee;ae+=j)for(let W=-j;W<ee;W+=j){const Ae=W<0||W>$||ae<0||ae>$?24575:0,ue=s.clamp(Math.round(W),0,s.EXTENT),J=s.clamp(Math.round(ae),0,s.EXTENT);D.emplaceBack(ue+Ae,J,ue,J)}const X=(ae,W)=>{const Ae=W*P+ae;k.emplaceBack(Ae+1,Ae,Ae+P),k.emplaceBack(Ae+P,Ae+P+1,Ae+1)};for(let ae=1;ae<129;ae++)for(let W=1;W<129;W++)X(W,ae);return[0,129].forEach(ae=>{for(let W=0;W<130;W++)X(W,ae),X(ae,W)}),[D,k,32768]}(),b=r.context;this.gridBuffer=b.createVertexBuffer(p,s.boundsAttributes.members),this.gridIndexBuffer=b.createIndexBuffer(y),this.gridSegments=s.SegmentVector.simpleSegment(0,0,p.length,y.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,p.length,_),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new jo(c.map),this.orthoMatrix=s.create$1(),s.ortho(this.orthoMatrix,0,s.EXTENT,0,s.EXTENT,0,1);const E=b.gl;this._overlapStencilMode=new s.StencilMode({func:E.GEQUAL,mask:255},0,255,E.KEEP,E.KEEP,E.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency()}update(r,c,p){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const y=r.terrain.properties;this.sourceCache=r._getSourceCache(y.get("source")),this._exaggeration=y.get("exaggeration");const _=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const b=this.sourceCache.getSource().tileSize/128,E=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(c,b*E,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,_(),this._initializing=!0),_(),c.updateElevation(!p),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||r.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=c.getIds().map(U=>{const D=c.getTileByID(U).tileID;return D.projMatrix=p.calculateProjMatrix(D.toUnwrapped()),D});(function(U,D){const k=D.transform.pointCoordinate(D.transform.getCameraPoint()),P=new s.pointGeometry(k.x,k.y);U.sort((j,$)=>{if($.overscaledZ-j.overscaledZ)return $.overscaledZ-j.overscaledZ;const ee=new s.pointGeometry(j.canonical.x+(1<<j.canonical.z)*j.wrap,j.canonical.y),X=new s.pointGeometry($.canonical.x+(1<<$.canonical.z)*$.wrap,$.canonical.y),ae=P.mult(1<<j.canonical.z);return ae.x-=.5,ae.y-=.5,ae.distSqr(ee)-ae.distSqr(X)})})(y,this.painter),this._previousZoom=p.zoom;const _=this.proxyToSource||{};this.proxyToSource={},y.forEach(U=>{this.proxyToSource[U.key]={}}),this.terrainTileForTile={};const b=this._style._sourceCaches;for(const U in b){const D=b[U];if(!D.used||(D!==this.sourceCache&&(this._findCoveringTileCache[D.id]={}),this._setupProxiedCoordsForOrtho(D,r[U],_),D.usedForTerrain))continue;const k=r[U];D.getSource().reparseOverscaled&&this._assignTerrainTiles(k)}this.proxiedCoords[c.id]=y.map(U=>new uA(U,U.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(_),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const E={};this._visibleDemTiles=[];for(const U of this.proxyCoords){const D=this.terrainTileForTile[U.key];if(!D)continue;const k=D.tileID.key;k in E||(this._visibleDemTiles.push(D),E[k]=k)}}_assignTerrainTiles(r){this._initializing||r.forEach(c=>{if(this.terrainTileForTile[c.key])return;const p=this._findTileCoveringTileID(c,this.sourceCache);p&&(this.terrainTileForTile[c.key]=p)})}_prepareDEMTextures(){const r=this.painter.context,c=r.gl;for(const p in this.terrainTileForTile){const y=this.terrainTileForTile[p],_=y.dem;!_||y.demTexture&&!y.needsDEMTextureUpload||(r.activeTexture.set(c.TEXTURE1),jr(this.painter,y,_))}}_prepareDemTileUniforms(r,c,p,y){if(!c||c.demTexture==null)return!1;const _=r.tileID.canonical,b=Math.pow(2,c.tileID.canonical.z-_.z),E=y||"";return p[`u_dem_tl${E}`]=[_.x*b%1,_.y*b%1],p[`u_dem_scale${E}`]=b,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let r=0;const c=this._visibleDemTiles.reduce((p,y)=>{if(!y.dem)return p;const _=y.dem.tree.minimums[0];return _>0&&r++,p+_},0);return r?c/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,c=r.gl;r.activeTexture.set(c.TEXTURE2);const p=this._getLoadedAreaMinimum(),y={width:1,height:1,data:new Uint8Array(s.DEMData.pack(p,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let _=this._emptyDEMTexture;return _?_.update(y,{premultiply:!1}):_=this._emptyDEMTexture=new s.Texture(r,y,c.RGBA,{premultiply:!1}),_}setupElevationDraw(r,c,p){const y=this.painter.context,_=y.gl,b=(E=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(E),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var E;b.u_dem_size=this.sourceCache.getSource().tileSize,b.u_exaggeration=this.exaggeration();let U=null,D=null,k=1;if(p&&p.morphing&&this._useVertexMorphing){const P=p.morphing.srcDemTile,j=p.morphing.dstDemTile;k=p.morphing.phase,P&&j&&(this._prepareDemTileUniforms(r,P,b,"_prev")&&(D=P),this._prepareDemTileUniforms(r,j,b)&&(U=j))}if(D&&U?(y.activeTexture.set(_.TEXTURE2),U.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE,_.NEAREST),y.activeTexture.set(_.TEXTURE4),D.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE,_.NEAREST),b.u_dem_lerp=k):(U=this.terrainTileForTile[r.tileID.key],y.activeTexture.set(_.TEXTURE2),(this._prepareDemTileUniforms(r,U,b)?U.demTexture:this.emptyDEMTexture).bind(_.NEAREST,_.CLAMP_TO_EDGE)),p&&p.useDepthForOcclusion&&(y.activeTexture.set(_.TEXTURE3),this._depthTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE),b.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),p&&p.useMeterToDem&&U){const P=(1<<U.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;b.u_meter_to_dem=P}p&&p.labelPlaneMatrixInv&&(b.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),c.setTerrainUniformValues(y,b)}renderToBackBuffer(r){const c=this.painter,p=this.painter.context;r.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),this.renderingToTexture=!1,function(y,_,b,E,U){const D=y.context,k=D.gl;let P,j;const $=y.options.showTerrainWireframe?2:0,ee=(ue,J)=>{if(j===ue)return;const he=[$n[ue]];J&&he.push($n[$]),P=y.useProgram("terrainRaster",null,he),j=ue},X=y.colorModeForRenderPass(),ae=new s.DepthMode(k.LEQUAL,s.DepthMode.ReadWrite,y.depthRangeFor3D);on.update(U);const W=y.transform,Ae=6*Math.pow(1.5,22-W.zoom)*_.exaggeration();($?[!1,!0]:[!1]).forEach(ue=>{j=-1;const J=ue?k.LINES:k.TRIANGLES,[he,ye]=ue?_.getWirefameBuffer():[_.gridIndexBuffer,_.gridSegments];for(const Ve of E){const Ge=b.getTile(Ve),at=s.StencilMode.disabled,He=_.prevTerrainTileForTile[Ve.key],ht=_.terrainTileForTile[Ve.key];Le=ht,(De=He)!=null&&Le!=null&&De.hasData()&&Le.hasData()&&De.demTexture!=null&&Le.demTexture!=null&&De.tileID.key!==Le.tileID.key&&on.newMorphing(Ve.key,He,ht,U,250),D.activeTexture.set(k.TEXTURE0),Ge.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE);const Qe=on.getMorphValuesForProxy(Ve.key),ft=Qe?1:0;let bt;Qe&&(bt={morphing:{srcDemTile:Qe.from,dstDemTile:Qe.to,phase:s.easeCubicInOut(Qe.phase)}});const Pt=zn(Ve.projMatrix,ai(Ve.canonical,W.renderWorldCopies)?Ae/10:Ae);ee(ft,ue),_.setupElevationDraw(Ge,P,bt),y.prepareDrawProgram(D,P,Ve.toUnwrapped()),P.draw(D,J,ae,at,X,s.CullFaceMode.backCCW,Pt,"terrain_raster",_.gridBuffer,he,ye)}var De,Le})}(c,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const c=this.painter,p=this.painter.context,y=this.proxySourceCache,_=this.proxiedCoords[y.id],b=this._drapedRenderBatches.shift(),E=[],U=c.style.order;let D=0;for(const k of _){const P=y.getTileByID(k.proxyTileKey),j=y.proxyCachedFBO[k.key]?y.proxyCachedFBO[k.key][r]:void 0,$=j!==void 0?y.renderCache[j]:this.pool[D++],ee=j!==void 0;if(P.texture=$.tex,ee&&!$.dirty){E.push(P.tileID);continue}let X;p.bindFramebuffer.set($.fb.framebuffer),this.renderedToTile=!1,$.dirty&&(p.clear({color:s.Color.transparent}),$.dirty=!1);for(let ae=b.start;ae<=b.end;++ae){const W=c.style._layers[U[ae]];if(W.isHidden(c.transform.zoom))continue;const Ae=c.style._getLayerSourceCache(W),ue=Ae?this.proxyToSource[k.key][Ae.id]:[k];if(!ue)continue;const J=ue;p.viewport.set([0,0,$.fb.width,$.fb.height]),X!==(Ae?Ae.id:null)&&(this._setupStencil($,ue,W,Ae),X=Ae?Ae.id:null),c.renderLayer(c,Ae,W,J)}this.renderedToTile?($.dirty=!0,E.push(P.tileID)):ee||--D,D===5&&(D=0,this.renderToBackBuffer(E))}return this.renderToBackBuffer(E),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),b.end+1}postRender(){}renderCacheEfficiency(r){const c=r.order.length;if(c===0)return{efficiency:100};let p,y=0,_=0,b=!1;for(let E=0;E<c;++E){const U=r._layers[r.order[E]];this._style.isLayerDraped(U)?(b&&++y,++_):b||(b=!0,p=U.id)}return _===0?{efficiency:100}:{efficiency:100*(1-y/_),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{r=Math.min(r,c.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,c,p){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter(_=>_.dem).map(_=>{const b=_.tileID,E=Math.pow(2,b.overscaledZ),{x:U,y:D}=b.canonical,k=U/E,P=(U+1)/E,j=D/E,$=(D+1)/E;return{minx:k,miny:j,maxx:P,maxy:$,t:_.dem.tree.raycastRoot(k,j,P,$,r,c,p),tile:_}});y.sort((_,b)=>(_.t!==null?_.t:Number.MAX_VALUE)-(b.t!==null?b.t:Number.MAX_VALUE));for(const _ of y){if(_.t==null)return null;const b=_.tile.dem.tree.raycast(_.minx,_.miny,_.maxx,_.maxy,r,c,p);if(b!=null)return b}return null}_createFBO(){const r=this.painter.context,c=r.gl,p=this.drapeBufferSize;r.activeTexture.set(c.TEXTURE0);const y=new s.Texture(r,{width:p[0],height:p[1],data:null},c.RGBA);y.bind(c.LINEAR,c.CLAMP_TO_EDGE);const _=r.createFramebuffer(p[0],p[1],!1);return _.colorAttachment.set(y.texture),_.depthAttachment=new oi(r,_.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,_.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):_.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:_,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const c=this._style._layers[r],p=c.isHidden(this.painter.transform.zoom),y=c.getCrossfadeParameters(),_=!!y&&y.t!==1,b=c.hasTransition();return c.type!=="custom"&&!p&&(_||b)})}_clearRasterFadeFromRenderCache(){let r=!1;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c]._source instanceof Li){r=!0;break}if(r)for(let c=0;c<this._style.order.length;++c){const p=this._style._layers[this._style.order[c]],y=p.isHidden(this.painter.transform.zoom),_=this._style._getLayerSourceCache(p);if(p.type!=="raster"||y||!_)continue;const b=p.paint.get("raster-fade-duration");for(const E of this.proxyCoords){const U=this.proxyToSource[E.key][_.id];if(U)for(const D of U){const k=ki(_.getTile(D),_.findLoadedParent(D,0),_,this.painter.transform,b);(k.opacity!==1||k.mix!==0)&&this._clearRenderCacheForTile(_.id,D)}}}}_setupDrapedRenderBatches(){const r=this._style.order,c=r.length;if(c===0)return;const p=[];let y,_=0,b=this._style._layers[r[_]];for(;!this._style.isLayerDraped(b)&&b.isHidden(this.painter.transform.zoom)&&++_<c;)b=this._style._layers[r[_]];for(;_<c;++_){const E=this._style._layers[r[_]];E.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(E)?y===void 0&&(y=_):y!==void 0&&(p.push({start:y,end:_-1}),y=void 0))}y!==void 0&&p.push({start:y,end:_-1}),this._drapedRenderBatches=p}_setupRenderCache(r){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const b=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let E=0;E<b.length;++E){const U=Object.values(b[E]);c.renderCachePool.push(...U)}}return}this._clearRasterFadeFromRenderCache();const p=this.proxyCoords,y=this._tilesDirty;for(let b=p.length-1;b>=0;b--){const E=p[b];if(c.getTileByID(E.key),c.proxyCachedFBO[E.key]!==void 0){const U=r[E.key],D=this.proxyToSource[E.key];let k=0;for(const P in D){const j=D[P],$=U[P];if(!$||$.length!==j.length||j.some((ee,X)=>ee!==$[X]||y[P]&&y[P].hasOwnProperty(ee.key))){k=-1;break}++k}for(const P in c.proxyCachedFBO[E.key])c.renderCache[c.proxyCachedFBO[E.key][P]].dirty=k<0||k!==Object.values(U).length}}const _=[...this._drapedRenderBatches];_.sort((b,E)=>E.end-E.start-(b.end-b.start));for(const b of _)for(const E of p){if(c.proxyCachedFBO[E.key])continue;let U=c.renderCachePool.pop();U===void 0&&c.renderCache.length<50&&(U=c.renderCache.length,c.renderCache.push(this._createFBO())),U!==void 0&&(c.proxyCachedFBO[E.key]={},c.proxyCachedFBO[E.key][b.start]=U,c.renderCache[U].dirty=!0)}this._tilesDirty={}}_setupStencil(r,c,p,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const _=this.painter.context,b=_.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let E;if(p.isTileClipped())E=c.length,this._overlapStencilMode.test={func:b.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);E=1,this._overlapStencilMode.test={func:b.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+E>255&&(_.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=E,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(r,c){const p=this.painter,y=this.painter.context,_=y.gl;p._tileClippingMaskIDs={},y.setColorMode(s.ColorMode.disabled),y.setDepthMode(s.DepthMode.disabled);const b=p.useProgram("clippingMask");for(const E of r){const U=p._tileClippingMaskIDs[E.key]=--c;b.draw(y,_.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:_.ALWAYS,mask:0},U,255,_.KEEP,_.KEEP,_.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,yi(E.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(r){const c=this.painter.transform;if(r.x<0||r.x>c.width||r.y<0||r.y>c.height)return null;const p=[r.x,r.y,1,1];s.transformMat4(p,p,c.pixelMatrixInverse),s.scale$2(p,p,1/p[3]),p[0]/=c.worldSize,p[1]/=c.worldSize;const y=c._camera.position,_=s.mercatorZfromAltitude(1,c.center.lat),b=[y[0],y[1],y[2]/_,0],E=s.subtract([],p.slice(0,3),b);s.normalize(E,E);const U=this.raycast(b,E,this._exaggeration);return U!==null&&U?(s.scaleAndAdd(b,b,E,U),b[3]=b[2],b[2]*=_,b):null}drawDepth(){const r=this.painter,c=r.context,p=this.proxySourceCache,y=Math.ceil(r.width),_=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===y&&this._depthFBO.height===_||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const b=c.gl,E=c.createFramebuffer(y,_,!0);c.activeTexture.set(b.TEXTURE0);const U=new s.Texture(c,{width:y,height:_,data:null},b.RGBA);U.bind(b.NEAREST,b.CLAMP_TO_EDGE),E.colorAttachment.set(U.texture);const D=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,y,_);E.depthAttachment.set(D),this._depthFBO=E,this._depthTexture=U}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,y,_]),function(b,E,U,D){const k=b.context,P=k.gl;k.clear({depth:1});const j=b.useProgram("terrainDepth"),$=new s.DepthMode(P.LESS,s.DepthMode.ReadWrite,b.depthRangeFor3D);for(const ee of D){const X=U.getTile(ee),ae=zn(ee.projMatrix,0);E.setupElevationDraw(X,j),j.draw(k,P.TRIANGLES,$,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,ae,"terrain_depth",E.gridBuffer,E.gridIndexBuffer,E.gridNoSkirtSegments)}}(r,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,c,p){if(r.getSource()instanceof Y)return this._setupProxiedCoordsForImageSource(r,c,p);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const y=this.proxiedCoords[r.id]=[],_=this.proxyCoords;for(let E=0;E<_.length;E++){const U=_[E],D=this._findTileCoveringTileID(U,r);if(D){const k=this._createProxiedId(U,D,p[U.key]&&p[U.key][r.id]);y.push(k),this.proxyToSource[U.key][r.id]=[k]}}let b=!1;for(let E=0;E<c.length;E++){const U=r.getTile(c[E]);if(!U||!U.hasData())continue;const D=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if(D&&D.tileID.canonical.z!==U.tileID.canonical.z){const k=this.proxyToSource[D.tileID.key][r.id],P=this._createProxiedId(D.tileID,U,p[D.tileID.key]&&p[D.tileID.key][r.id]);k?k.splice(k.length-1,0,P):this.proxyToSource[D.tileID.key][r.id]=[P],y.push(P),b=!0}}this._sourceTilesOverlap[r.id]=b}_setupProxiedCoordsForImageSource(r,c,p){if(!r.getSource().loaded())return;const y=this.proxiedCoords[r.id]=[],_=this.proxyCoords,b=r.getSource(),E=new s.pointGeometry(b.tileID.x,b.tileID.y)._div(1<<b.tileID.z),U=b.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((k,P)=>(k.min.x=Math.min(k.min.x,P.x-E.x),k.min.y=Math.min(k.min.y,P.y-E.y),k.max.x=Math.max(k.max.x,P.x-E.x),k.max.y=Math.max(k.max.y,P.y-E.y),k),{min:new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),D=(k,P)=>{const j=k.wrap+k.canonical.x/(1<<k.canonical.z),$=k.canonical.y/(1<<k.canonical.z),ee=s.EXTENT/(1<<k.canonical.z),X=P.wrap+P.canonical.x/(1<<P.canonical.z),ae=P.canonical.y/(1<<P.canonical.z);return j+ee<X+U.min.x||j>X+U.max.x||$+ee<ae+U.min.y||$>ae+U.max.y};for(let k=0;k<_.length;k++){const P=_[k];for(let j=0;j<c.length;j++){const $=r.getTile(c[j]);if(!$||!$.hasData()||D(P,$.tileID))continue;const ee=this._createProxiedId(P,$,p[P.key]&&p[P.key][r.id]),X=this.proxyToSource[P.key][r.id];X?X.push(ee):this.proxyToSource[P.key][r.id]=[ee],y.push(ee)}}}_createProxiedId(r,c,p){let y=this.orthoMatrix;if(p){const _=p.find(b=>b.key===c.tileID.key);if(_)return _}if(c.tileID.key!==r.key){const _=r.canonical.z-c.tileID.canonical.z;let b,E,U;y=s.create$1();const D=c.tileID.wrap-r.wrap<<r.overscaledZ;_>0?(b=s.EXTENT>>_,E=b*((c.tileID.canonical.x<<_)-r.canonical.x+D),U=b*((c.tileID.canonical.y<<_)-r.canonical.y)):(b=s.EXTENT<<-_,E=s.EXTENT*(c.tileID.canonical.x-(r.canonical.x+D<<-_)),U=s.EXTENT*(c.tileID.canonical.y-(r.canonical.y<<-_))),s.ortho(y,0,b,0,b,0,1),s.translate(y,y,[E,U,0])}return new uA(c.tileID,r.key,y)}_findTileCoveringTileID(r,c){let p=c.getTile(r);if(p&&p.hasData())return p;const y=this._findCoveringTileCache[c.id],_=y[r.key];if(p=_?c.getTileByID(_):null,p&&p.hasData()||_===null)return p;let b=p?p.tileID:r,E=b.overscaledZ;const U=c.getSource().minzoom,D=[];if(!_){const P=c.getSource().maxzoom;if(r.canonical.z>=P){const j=r.canonical.z-P;c.getSource().reparseOverscaled?(E=Math.max(r.canonical.z+2,c.transform.tileZoom),b=new s.OverscaledTileID(E,r.wrap,P,r.canonical.x>>j,r.canonical.y>>j)):j!==0&&(E=P,b=new s.OverscaledTileID(E,r.wrap,P,r.canonical.x>>j,r.canonical.y>>j))}b.key!==r.key&&(D.push(b.key),p=c.getTile(b))}const k=P=>{D.forEach(j=>{y[j]=P}),D.length=0};for(E-=1;E>=U&&(!p||!p.hasData());E--){p&&k(p.tileID.key);const P=b.calculateScaledKey(E);if(p=c.getTileByID(P),p&&p.hasData())break;const j=y[P];if(j===null)break;j===void 0?D.push(P):p=c.getTileByID(j)}return k(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(r){this.renderedToTile=!0}_clearRenderCacheForTile(r,c){let p=this._tilesDirty[r];p||(p=this._tilesDirty[r]={}),p[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(c){let p,y,_;const b=new s.StructArrayLayout2ui4,E=131;for(y=1;y<129;y++){for(p=1;p<129;p++)_=y*E+p,b.emplaceBack(_,_+1),b.emplaceBack(_,_+E),b.emplaceBack(_+1,_+E),y===128&&b.emplaceBack(_+E,_+E+1);b.emplaceBack(_+1,_+1+E)}return b}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function Zo(d){const r=[];for(let c=0;c<d.length;c++){if(d[c]===null)continue;const p=d[c].split(" ");r.push(p.pop())}return r}class el{static cacheKey(r,c,p){let y=`${r}${p?p.cacheKey:""}`;for(const _ of c)y+=`/${_}`;return y}constructor(r,c,p,y,_,b){const E=r.gl;this.program=E.createProgram();const U=Zo(p.staticAttributes),D=y?y.getBinderAttributes():[],k=U.concat(D),P=p.staticUniforms?Zo(p.staticUniforms):[],j=y?y.getBinderUniforms():[],$=P.concat(j),ee=[];for(const he of $)ee.indexOf(he)<0&&ee.push(he);let X=y?y.defines():[];X=X.concat(b.map(he=>`#define ${he}`));const ae=X.concat(`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Ye,Ee.fragmentSource,se.fragmentSource,p.fragmentSource).join(`
`),W=X.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Ye,Ee.vertexSource,se.vertexSource,Fo.vertexSource,p.vertexSource).join(`
`),Ae=E.createShader(E.FRAGMENT_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);E.shaderSource(Ae,ae),E.compileShader(Ae),E.attachShader(this.program,Ae);const ue=E.createShader(E.VERTEX_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);E.shaderSource(ue,W),E.compileShader(ue),E.attachShader(this.program,ue),this.attributes={};const J={};this.numAttributes=k.length;for(let he=0;he<this.numAttributes;he++)k[he]&&(E.bindAttribLocation(this.program,he,k[he]),this.attributes[k[he]]=he);E.linkProgram(this.program),E.deleteShader(ue),E.deleteShader(Ae);for(let he=0;he<ee.length;he++){const ye=ee[he];if(ye&&!J[ye]){const De=E.getUniformLocation(this.program,ye);De&&(J[ye]=De)}}this.fixedUniforms=_(r,J),this.binderUniforms=y?y.getUniforms(r,J):[],b.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((he,ye)=>({u_dem:new s.Uniform1i(he,ye.u_dem),u_dem_prev:new s.Uniform1i(he,ye.u_dem_prev),u_dem_unpack:new s.Uniform4f(he,ye.u_dem_unpack),u_dem_tl:new s.Uniform2f(he,ye.u_dem_tl),u_dem_scale:new s.Uniform1f(he,ye.u_dem_scale),u_dem_tl_prev:new s.Uniform2f(he,ye.u_dem_tl_prev),u_dem_scale_prev:new s.Uniform1f(he,ye.u_dem_scale_prev),u_dem_size:new s.Uniform1f(he,ye.u_dem_size),u_dem_lerp:new s.Uniform1f(he,ye.u_dem_lerp),u_exaggeration:new s.Uniform1f(he,ye.u_exaggeration),u_depth:new s.Uniform1i(he,ye.u_depth),u_depth_size_inv:new s.Uniform2f(he,ye.u_depth_size_inv),u_meter_to_dem:new s.Uniform1f(he,ye.u_meter_to_dem),u_label_plane_matrix_inv:new s.UniformMatrix4f(he,ye.u_label_plane_matrix_inv),u_tile_tl_up:new s.Uniform3f(he,ye.u_tile_tl_up),u_tile_tr_up:new s.Uniform3f(he,ye.u_tile_tr_up),u_tile_br_up:new s.Uniform3f(he,ye.u_tile_br_up),u_tile_bl_up:new s.Uniform3f(he,ye.u_tile_bl_up),u_tile_up_scale:new s.Uniform1f(he,ye.u_tile_up_scale)}))(r,J)),b.indexOf("FOG")!==-1&&(this.fogUniforms=((he,ye)=>({u_fog_matrix:new s.UniformMatrix4f(he,ye.u_fog_matrix),u_fog_range:new s.Uniform2f(he,ye.u_fog_range),u_fog_color:new s.Uniform4f(he,ye.u_fog_color),u_fog_horizon_blend:new s.Uniform1f(he,ye.u_fog_horizon_blend),u_fog_temporal_offset:new s.Uniform1f(he,ye.u_fog_temporal_offset)}))(r,J))}setTerrainUniformValues(r,c){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in c)p[y].set(c[y])}}setFogUniformValues(r,c){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in c)p[y].location&&p[y].set(c[y])}}draw(r,c,p,y,_,b,E,U,D,k,P,j,$,ee,X,ae){const W=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(p),r.setStencilMode(y),r.setColorMode(_),r.setCullFace(b);for(const ue in this.fixedUniforms)this.fixedUniforms[ue].set(E[ue]);ee&&ee.setUniforms(r,this.binderUniforms,j,{zoom:$});const Ae={[W.LINES]:2,[W.TRIANGLES]:3,[W.LINE_STRIP]:1}[c];for(const ue of P.get()){const J=ue.vaos||(ue.vaos={});(J[U]||(J[U]=new er)).bind(r,this,D,ee?ee.getPaintVertexBuffers():[],k,ue.vertexOffset,X,ae),W.drawElements(c,ue.primitiveLength*Ae,W.UNSIGNED_SHORT,ue.primitiveOffset*Ae*2)}}}function tl(d,r,c){const p=1/Je(c,1,r.transform.tileZoom),y=Math.pow(2,c.tileID.overscaledZ),_=c.tileSize*Math.pow(2,r.transform.tileZoom)/y,b=_*(c.tileID.canonical.x+c.tileID.wrap*y),E=_*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[p,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[b>>16,E>>16],u_pixel_coord_lower:[65535&b,65535&E]}}const Sc=(d,r,c,p)=>{const y=r.style.light,_=y.properties.get("position"),b=[_.x,_.y,_.z],E=s.create$2();y.properties.get("anchor")==="viewport"&&(s.fromRotation(E,-r.transform.angle),s.transformMat3(b,b,E));const U=y.properties.get("color");return{u_matrix:d,u_lightpos:b,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[U.r,U.g,U.b],u_vertical_gradient:+c,u_opacity:p}},Rh=(d,r,c,p,y,_,b)=>s.extend(Sc(d,r,c,p),tl(_,r,b),{u_height_factor:-Math.pow(2,y.overscaledZ)/b.tileSize/8}),zh=d=>({u_matrix:d}),ca=(d,r,c,p)=>s.extend(zh(d),tl(c,r,p)),hA=(d,r)=>({u_matrix:d,u_world:r}),Hh=(d,r,c,p,y)=>s.extend(ca(d,r,c,p),{u_world:y}),Pi=(d,r,c,p)=>{const y=d.transform;let _;return _=p.paint.get("circle-pitch-alignment")==="map"?y.calculatePixelsToTileUnitsMatrix(c):new Float32Array([y.pixelsToGLUnits[0],0,0,y.pixelsToGLUnits[1]]),{u_camera_to_center_distance:y.cameraToCenterDistance,u_matrix:d.translatePosMatrix(r.projMatrix,c,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:_}},Qc=d=>{const r=[];return d.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),d.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r},rl=(d,r,c)=>{const p=s.EXTENT/c.tileSize;return{u_matrix:d,u_camera_to_center_distance:r.cameraToCenterDistance,u_extrude_scale:[r.pixelsToGLUnits[0]/p,r.pixelsToGLUnits[1]/p]}},dA=(d,r,c=1)=>({u_matrix:d,u_color:r,u_overlay:0,u_overlay_scale:c}),Mc=(d,r,c,p)=>({u_matrix:d,u_extrude_scale:Je(r,1,c),u_intensity:p}),Lc=(d,r,c,p,y,_)=>{const b=d.transform,E=b.calculatePixelsToTileUnitsMatrix(r),U={u_matrix:ol(d,r,c,y),u_pixels_to_tile_units:E,u_device_pixel_ratio:s.exported.devicePixelRatio,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0};if(Dc(c)){const D=il(r,d.transform);U.u_texsize=r.lineAtlasTexture.size,U.u_scale=[D,p.fromScale,p.toScale],U.u_mix=p.t}return U},nl=(d,r,c,p,y)=>{const _=d.transform,b=il(r,_);return{u_matrix:ol(d,r,c,y),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:_.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:s.exported.devicePixelRatio,u_image:0,u_scale:[b,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}};function il(d,r){return 1/Je(d,1,r.tileZoom)}function ol(d,r,c,p){return d.translatePosMatrix(p||r.tileID.projMatrix,r,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const sl=d=>{const r=[];return Dc(d)&&r.push("RENDER_LINE_DASH"),d.paint.get("line-gradient")&&r.push("RENDER_LINE_GRADIENT"),r};function Dc(d){const r=d.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}const Nh=(d,r,c,p,y)=>{return{u_matrix:d,u_tl_parent:r,u_scale_parent:c,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(b=y.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(_=y.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:ua(y.paint.get("raster-hue-rotate"))};var _,b};function ua(d){d*=Math.PI/180;const r=Math.sin(d),c=Math.cos(d);return[(2*c+1)/3,(-Math.sqrt(3)*r-c+1)/3,(Math.sqrt(3)*r-c+1)/3]}const Vh=(d,r,c,p,y,_,b,E,U,D,k,P,j,$)=>{const ee=y.transform;return{u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:ee.cameraToCenterDistance,u_pitch:ee.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:ee.width/ee.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:_,u_label_plane_matrix:b,u_coord_matrix:E,u_is_text:+U,u_pitch_with_map:+p,u_texsize:D,u_tile_id:k,u_zoom_transition:P,u_inv_rot_matrix:j,u_merc_center:$,u_texture:0}},Kh=(d,r,c,p,y,_,b,E,U,D,k,P,j,$,ee)=>{const{cameraToCenterDistance:X,_pitch:ae}=y.transform;return s.extend(Vh(d,r,c,p,y,_,b,E,U,D,P,j,$,ee),{u_gamma_scale:p?X*Math.cos(y.terrain?0:ae):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+k})},sm=(d,r,c,p,y,_,b,E,U,D,k,P,j,$)=>s.extend(Kh(d,r,c,p,y,_,b,E,!0,U,!0,k,P,j,$),{u_texsize_icon:D,u_texture_icon:1}),am=(d,r,c)=>({u_matrix:d,u_opacity:r,u_color:c}),Am=(d,r,c,p,y,_)=>s.extend(function(b,E,U,D){const k=U.imageManager.getPattern(b.from.toString()),P=U.imageManager.getPattern(b.to.toString()),{width:j,height:$}=U.imageManager.getPixelSize(),ee=Math.pow(2,D.tileID.overscaledZ),X=D.tileSize*Math.pow(2,U.transform.tileZoom)/ee,ae=X*(D.tileID.canonical.x+D.tileID.wrap*ee),W=X*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:P.tl,u_pattern_br_b:P.br,u_texsize:[j,$],u_mix:E.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:P.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/Je(D,1,U.transform.tileZoom),u_pixel_coord_upper:[ae>>16,W>>16],u_pixel_coord_lower:[65535&ae,65535&W]}}(p,_,c,y),{u_matrix:d,u_opacity:r}),lm={fillExtrusion:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_lightpos:new s.Uniform3f(d,r.u_lightpos),u_lightintensity:new s.Uniform1f(d,r.u_lightintensity),u_lightcolor:new s.Uniform3f(d,r.u_lightcolor),u_vertical_gradient:new s.Uniform1f(d,r.u_vertical_gradient),u_opacity:new s.Uniform1f(d,r.u_opacity)}),fillExtrusionPattern:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_lightpos:new s.Uniform3f(d,r.u_lightpos),u_lightintensity:new s.Uniform1f(d,r.u_lightintensity),u_lightcolor:new s.Uniform3f(d,r.u_lightcolor),u_vertical_gradient:new s.Uniform1f(d,r.u_vertical_gradient),u_height_factor:new s.Uniform1f(d,r.u_height_factor),u_image:new s.Uniform1i(d,r.u_image),u_texsize:new s.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new s.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new s.Uniform3f(d,r.u_scale),u_fade:new s.Uniform1f(d,r.u_fade),u_opacity:new s.Uniform1f(d,r.u_opacity)}),fill:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix)}),fillPattern:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_image:new s.Uniform1i(d,r.u_image),u_texsize:new s.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new s.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new s.Uniform3f(d,r.u_scale),u_fade:new s.Uniform1f(d,r.u_fade)}),fillOutline:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_world:new s.Uniform2f(d,r.u_world)}),fillOutlinePattern:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_world:new s.Uniform2f(d,r.u_world),u_image:new s.Uniform1i(d,r.u_image),u_texsize:new s.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new s.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new s.Uniform3f(d,r.u_scale),u_fade:new s.Uniform1f(d,r.u_fade)}),circle:(d,r)=>({u_camera_to_center_distance:new s.Uniform1f(d,r.u_camera_to_center_distance),u_extrude_scale:new s.UniformMatrix2f(d,r.u_extrude_scale),u_device_pixel_ratio:new s.Uniform1f(d,r.u_device_pixel_ratio),u_matrix:new s.UniformMatrix4f(d,r.u_matrix)}),collisionBox:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_camera_to_center_distance:new s.Uniform1f(d,r.u_camera_to_center_distance),u_extrude_scale:new s.Uniform2f(d,r.u_extrude_scale)}),collisionCircle:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_inv_matrix:new s.UniformMatrix4f(d,r.u_inv_matrix),u_camera_to_center_distance:new s.Uniform1f(d,r.u_camera_to_center_distance),u_viewport_size:new s.Uniform2f(d,r.u_viewport_size)}),debug:(d,r)=>({u_color:new s.UniformColor(d,r.u_color),u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_overlay:new s.Uniform1i(d,r.u_overlay),u_overlay_scale:new s.Uniform1f(d,r.u_overlay_scale)}),clippingMask:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix)}),heatmap:(d,r)=>({u_extrude_scale:new s.Uniform1f(d,r.u_extrude_scale),u_intensity:new s.Uniform1f(d,r.u_intensity),u_matrix:new s.UniformMatrix4f(d,r.u_matrix)}),heatmapTexture:(d,r)=>({u_image:new s.Uniform1i(d,r.u_image),u_color_ramp:new s.Uniform1i(d,r.u_color_ramp),u_opacity:new s.Uniform1f(d,r.u_opacity)}),hillshade:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_image:new s.Uniform1i(d,r.u_image),u_latrange:new s.Uniform2f(d,r.u_latrange),u_light:new s.Uniform2f(d,r.u_light),u_shadow:new s.UniformColor(d,r.u_shadow),u_highlight:new s.UniformColor(d,r.u_highlight),u_accent:new s.UniformColor(d,r.u_accent)}),hillshadePrepare:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_image:new s.Uniform1i(d,r.u_image),u_dimension:new s.Uniform2f(d,r.u_dimension),u_zoom:new s.Uniform1f(d,r.u_zoom),u_unpack:new s.Uniform4f(d,r.u_unpack)}),line:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_pixels_to_tile_units:new s.UniformMatrix2f(d,r.u_pixels_to_tile_units),u_device_pixel_ratio:new s.Uniform1f(d,r.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(d,r.u_units_to_pixels),u_dash_image:new s.Uniform1i(d,r.u_dash_image),u_gradient_image:new s.Uniform1i(d,r.u_gradient_image),u_image_height:new s.Uniform1f(d,r.u_image_height),u_texsize:new s.Uniform2f(d,r.u_texsize),u_scale:new s.Uniform3f(d,r.u_scale),u_mix:new s.Uniform1f(d,r.u_mix)}),linePattern:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_texsize:new s.Uniform2f(d,r.u_texsize),u_pixels_to_tile_units:new s.UniformMatrix2f(d,r.u_pixels_to_tile_units),u_device_pixel_ratio:new s.Uniform1f(d,r.u_device_pixel_ratio),u_image:new s.Uniform1i(d,r.u_image),u_units_to_pixels:new s.Uniform2f(d,r.u_units_to_pixels),u_scale:new s.Uniform3f(d,r.u_scale),u_fade:new s.Uniform1f(d,r.u_fade)}),raster:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_tl_parent:new s.Uniform2f(d,r.u_tl_parent),u_scale_parent:new s.Uniform1f(d,r.u_scale_parent),u_buffer_scale:new s.Uniform1f(d,r.u_buffer_scale),u_fade_t:new s.Uniform1f(d,r.u_fade_t),u_opacity:new s.Uniform1f(d,r.u_opacity),u_image0:new s.Uniform1i(d,r.u_image0),u_image1:new s.Uniform1i(d,r.u_image1),u_brightness_low:new s.Uniform1f(d,r.u_brightness_low),u_brightness_high:new s.Uniform1f(d,r.u_brightness_high),u_saturation_factor:new s.Uniform1f(d,r.u_saturation_factor),u_contrast_factor:new s.Uniform1f(d,r.u_contrast_factor),u_spin_weights:new s.Uniform3f(d,r.u_spin_weights)}),symbolIcon:(d,r)=>({u_is_size_zoom_constant:new s.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new s.Uniform1f(d,r.u_size_t),u_size:new s.Uniform1f(d,r.u_size),u_camera_to_center_distance:new s.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new s.Uniform1f(d,r.u_pitch),u_rotate_symbol:new s.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new s.Uniform1f(d,r.u_fade_change),u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new s.Uniform1i(d,r.u_is_text),u_pitch_with_map:new s.Uniform1i(d,r.u_pitch_with_map),u_texsize:new s.Uniform2f(d,r.u_texsize),u_tile_id:new s.Uniform3f(d,r.u_tile_id),u_zoom_transition:new s.Uniform1f(d,r.u_zoom_transition),u_inv_rot_matrix:new s.UniformMatrix4f(d,r.u_inv_rot_matrix),u_merc_center:new s.Uniform2f(d,r.u_merc_center),u_texture:new s.Uniform1i(d,r.u_texture)}),symbolSDF:(d,r)=>({u_is_size_zoom_constant:new s.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new s.Uniform1f(d,r.u_size_t),u_size:new s.Uniform1f(d,r.u_size),u_camera_to_center_distance:new s.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new s.Uniform1f(d,r.u_pitch),u_rotate_symbol:new s.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new s.Uniform1f(d,r.u_fade_change),u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new s.Uniform1i(d,r.u_is_text),u_pitch_with_map:new s.Uniform1i(d,r.u_pitch_with_map),u_texsize:new s.Uniform2f(d,r.u_texsize),u_texture:new s.Uniform1i(d,r.u_texture),u_gamma_scale:new s.Uniform1f(d,r.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(d,r.u_device_pixel_ratio),u_tile_id:new s.Uniform3f(d,r.u_tile_id),u_zoom_transition:new s.Uniform1f(d,r.u_zoom_transition),u_inv_rot_matrix:new s.UniformMatrix4f(d,r.u_inv_rot_matrix),u_merc_center:new s.Uniform2f(d,r.u_merc_center),u_is_halo:new s.Uniform1i(d,r.u_is_halo)}),symbolTextAndIcon:(d,r)=>({u_is_size_zoom_constant:new s.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new s.Uniform1f(d,r.u_size_t),u_size:new s.Uniform1f(d,r.u_size),u_camera_to_center_distance:new s.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new s.Uniform1f(d,r.u_pitch),u_rotate_symbol:new s.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new s.Uniform1f(d,r.u_fade_change),u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new s.Uniform1i(d,r.u_is_text),u_pitch_with_map:new s.Uniform1i(d,r.u_pitch_with_map),u_texsize:new s.Uniform2f(d,r.u_texsize),u_texsize_icon:new s.Uniform2f(d,r.u_texsize_icon),u_texture:new s.Uniform1i(d,r.u_texture),u_texture_icon:new s.Uniform1i(d,r.u_texture_icon),u_gamma_scale:new s.Uniform1f(d,r.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(d,r.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(d,r.u_is_halo)}),background:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_opacity:new s.Uniform1f(d,r.u_opacity),u_color:new s.UniformColor(d,r.u_color)}),backgroundPattern:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_opacity:new s.Uniform1f(d,r.u_opacity),u_image:new s.Uniform1i(d,r.u_image),u_pattern_tl_a:new s.Uniform2f(d,r.u_pattern_tl_a),u_pattern_br_a:new s.Uniform2f(d,r.u_pattern_br_a),u_pattern_tl_b:new s.Uniform2f(d,r.u_pattern_tl_b),u_pattern_br_b:new s.Uniform2f(d,r.u_pattern_br_b),u_texsize:new s.Uniform2f(d,r.u_texsize),u_mix:new s.Uniform1f(d,r.u_mix),u_pattern_size_a:new s.Uniform2f(d,r.u_pattern_size_a),u_pattern_size_b:new s.Uniform2f(d,r.u_pattern_size_b),u_scale_a:new s.Uniform1f(d,r.u_scale_a),u_scale_b:new s.Uniform1f(d,r.u_scale_b),u_pixel_coord_upper:new s.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(d,r.u_pixel_coord_lower),u_tile_units_to_pixels:new s.Uniform1f(d,r.u_tile_units_to_pixels)}),terrainRaster:Xt,terrainDepth:Xt,skybox:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_sun_direction:new s.Uniform3f(d,r.u_sun_direction),u_cubemap:new s.Uniform1i(d,r.u_cubemap),u_opacity:new s.Uniform1f(d,r.u_opacity),u_temporal_offset:new s.Uniform1f(d,r.u_temporal_offset)}),skyboxGradient:(d,r)=>({u_matrix:new s.UniformMatrix4f(d,r.u_matrix),u_color_ramp:new s.Uniform1i(d,r.u_color_ramp),u_center_direction:new s.Uniform3f(d,r.u_center_direction),u_radius:new s.Uniform1f(d,r.u_radius),u_opacity:new s.Uniform1f(d,r.u_opacity),u_temporal_offset:new s.Uniform1f(d,r.u_temporal_offset)}),skyboxCapture:(d,r)=>({u_matrix_3f:new s.UniformMatrix3f(d,r.u_matrix_3f),u_sun_direction:new s.Uniform3f(d,r.u_sun_direction),u_sun_intensity:new s.Uniform1f(d,r.u_sun_intensity),u_color_tint_r:new s.Uniform4f(d,r.u_color_tint_r),u_color_tint_m:new s.Uniform4f(d,r.u_color_tint_m),u_luminance:new s.Uniform1f(d,r.u_luminance)})};let ha;function al(d,r,c,p,y,_,b){const E=d.context,U=E.gl,D=d.useProgram("collisionBox"),k=[];let P=0,j=0;for(let ue=0;ue<p.length;ue++){const J=p[ue],he=r.getTile(J),ye=he.getBucket(c);if(!ye)continue;let De=J.projMatrix;y[0]===0&&y[1]===0||(De=d.translatePosMatrix(J.projMatrix,he,y,_));const Le=b?ye.textCollisionBox:ye.iconCollisionBox,Ve=ye.collisionCircleArray;if(Ve.length>0){const Ge=s.create$1(),at=De;s.mul$1(Ge,ye.placementInvProjMatrix,d.transform.glCoordMatrix),s.mul$1(Ge,Ge,ye.placementViewportMatrix),k.push({circleArray:Ve,circleOffset:j,transform:at,invTransform:Ge}),P+=Ve.length/4,j=P}Le&&(d.terrain&&d.terrain.setupElevationDraw(he,D),D.draw(E,U.LINES,s.DepthMode.disabled,s.StencilMode.disabled,d.colorModeForRenderPass(),s.CullFaceMode.disabled,rl(De,d.transform,he),c.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,null,d.transform.zoom,null,Le.collisionVertexBuffer,Le.collisionVertexBufferExt))}if(!b||!k.length)return;const $=d.useProgram("collisionCircle"),ee=new s.StructArrayLayout2f1f2i16;ee.resize(4*P),ee._trim();let X=0;for(const ue of k)for(let J=0;J<ue.circleArray.length/4;J++){const he=4*J,ye=ue.circleArray[he+0],De=ue.circleArray[he+1],Le=ue.circleArray[he+2],Ve=ue.circleArray[he+3];ee.emplace(X++,ye,De,Le,Ve,0),ee.emplace(X++,ye,De,Le,Ve,1),ee.emplace(X++,ye,De,Le,Ve,2),ee.emplace(X++,ye,De,Le,Ve,3)}(!ha||ha.length<2*P)&&(ha=function(ue){const J=2*ue,he=new s.StructArrayLayout3ui6;he.resize(J),he._trim();for(let ye=0;ye<J;ye++){const De=6*ye;he.uint16[De+0]=4*ye+0,he.uint16[De+1]=4*ye+1,he.uint16[De+2]=4*ye+2,he.uint16[De+3]=4*ye+2,he.uint16[De+4]=4*ye+3,he.uint16[De+5]=4*ye+0}return he}(P));const ae=E.createIndexBuffer(ha,!0),W=E.createVertexBuffer(ee,s.collisionCircleLayout.members,!0);for(const ue of k){const J={u_matrix:ue.transform,u_inv_matrix:ue.invTransform,u_camera_to_center_distance:(Ae=d.transform).cameraToCenterDistance,u_viewport_size:[Ae.width,Ae.height]};$.draw(E,U.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,d.colorModeForRenderPass(),s.CullFaceMode.disabled,J,c.id,W,ae,s.SegmentVector.simpleSegment(0,2*ue.circleOffset,ue.circleArray.length,ue.circleArray.length/2),null,d.transform.zoom,null,null,null)}var Ae;W.destroy(),ae.destroy()}const Rs=s.identity(new Float32Array(16));function Gh(d,r,c,p,y,_){const{horizontalAlign:b,verticalAlign:E}=s.getAnchorAlignment(d),U=-(b-.5)*r,D=-(E-.5)*c,k=s.evaluateVariableOffset(d,p);return new s.pointGeometry((U/y+k[0])*_,(D/y+k[1])*_)}function jh(d,r,c,p,y,_,b,E,U,D,k,P){const j=d.text.placedSymbolArray,$=d.text.dynamicLayoutVertexArray,ee=d.icon.dynamicLayoutVertexArray,X={};$.clear();for(let ae=0;ae<j.length;ae++){const W=j.get(ae),Ae=d.allowVerticalPlacement&&!W.placedOrientation,ue=W.hidden||!W.crossTileID||Ae?null:p[W.crossTileID];if(ue){const J=new s.pointGeometry(W.tileAnchorX,W.tileAnchorY),he=P(J),ye=kr(J,c?E:b,he),De=oo(_.cameraToCenterDistance,ye.signedDistanceFromCamera);let Le=y.evaluateSizeForFeature(d.textSizeData,D,W)*De/s.ONE_EM;c&&(Le*=d.tilePixelRatio/U);const{width:Ve,height:Ge,anchor:at,textOffset:He,textScale:ht}=ue,Qe=Gh(at,Ve,Ge,He,ht,Le),ft=c?kr(J.add(Qe),b,he).point:ye.point.add(r?Qe.rotate(-_.angle):Qe),bt=d.allowVerticalPlacement&&W.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let Pt=0;Pt<W.numGlyphs;Pt++)s.addDynamicAttributes($,ft,bt);k&&W.associatedIconIndex>=0&&(X[W.associatedIconIndex]={shiftedAnchor:ft,angle:bt})}else si(W.numGlyphs,$)}if(k){ee.clear();const ae=d.icon.placedSymbolArray;for(let W=0;W<ae.length;W++){const Ae=ae.get(W);if(Ae.hidden)si(Ae.numGlyphs,ee);else{const ue=X[W];if(ue)for(let J=0;J<Ae.numGlyphs;J++)s.addDynamicAttributes(ee,ue.shiftedAnchor,ue.angle);else si(Ae.numGlyphs,ee)}}d.icon.dynamicLayoutVertexBuffer.updateData(ee)}d.text.dynamicLayoutVertexBuffer.updateData($)}function kc(d,r,c){return c.iconsInText&&r?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function fs(d,r,c,p,y,_,b,E,U,D,k,P){const j=d.context,$=j.gl,ee=d.transform,X=E==="map",ae=U==="map",W=X&&c.layout.get("symbol-placement")!=="point",Ae=X&&!ae&&!W,ue=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let J=!1;const he=d.depthModeForSublayer(0,s.DepthMode.ReadOnly),ye=[0,0],De=c.layout.get("text-variable-anchor"),Le=[],Ve=[];d.terrain&&ae&&Ve.push("PITCH_WITH_MAP_TERRAIN"),W&&Ve.push("PROJECTED_POS_ON_VIEWPORT");for(const Ge of p){const at=r.getTile(Ge),He=at.getBucket(c);if(!He)continue;const ht=y?He.text:He.icon;if(!ht||!ht.segments.get().length)continue;const Qe=ht.programConfigurations.get(c.id),ft=y||He.sdfIcons,bt=y?He.textSizeData:He.iconSizeData,Pt=ae||ee.pitch!==0,Ht=d.useProgram(kc(ft,y,He),Qe,Ve),Kt=s.evaluateSizeForZoom(bt,ee.zoom),Gt=[Ge.canonical.x,Ge.canonical.y,1<<Ge.canonical.z];let kt,qt,fr,dn,Hn=[0,0],Jn=null;if(y){if(qt=at.glyphAtlasTexture,fr=$.LINEAR,kt=at.glyphAtlasTexture.size,He.iconsInText){Hn=at.imageAtlasTexture.size,Jn=at.imageAtlasTexture;const vi=bt.kind==="composite"||bt.kind==="camera";dn=Pt||d.options.rotating||d.options.zooming||vi?$.LINEAR:$.NEAREST}}else{const vi=c.layout.get("icon-size").constantOr(0)!==1||He.iconsNeedLinear;qt=at.imageAtlasTexture,fr=ft||d.options.rotating||d.options.zooming||vi||Pt?$.LINEAR:$.NEAREST,kt=at.imageAtlasTexture.size}const Ai=d.transform.calculatePixelsToTileUnitsMatrix(at),fn=Yt(Ge.projMatrix,ae,X,d.transform,Ai),Wo=d.terrain&&ae&&W?s.invert(new Float32Array(16),fn):Rs,To=Wt(Ge.projMatrix,ae,X,d.transform,Ai),Mr=De&&He.hasTextData(),Yr=c.layout.get("icon-text-fit")!=="none"&&Mr&&He.hasIconData();if(W){const vi=ee.elevation;As(He,Ge.projMatrix,d,y,fn,To,ae,D,vi?xs=>vi.getAtTileOffset(Ge,xs.x,xs.y):null)}const Ar=d.translatePosMatrix(Ge.projMatrix,at,_,b),Or=W||y&&De||Yr?Rs:fn,Nn=d.translatePosMatrix(To,at,_,b,!0),Lr=ft&&c.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Oi;Oi=ft?He.iconsInText?sm(bt.kind,Kt,Ae,ae,d,Ar,Or,Nn,kt,Hn,Gt,0,d.identityMat,ye):Kh(bt.kind,Kt,Ae,ae,d,Ar,Or,Nn,y,kt,!0,Gt,0,d.identityMat,ye):Vh(bt.kind,Kt,Ae,ae,d,Ar,Or,Nn,y,kt,Gt,0,d.identityMat,ye);const EA={program:Ht,buffers:ht,uniformValues:Oi,atlasTexture:qt,atlasTextureIcon:Jn,atlasInterpolation:fr,atlasInterpolationIcon:dn,isSDF:ft,hasHalo:Lr,tile:at,labelPlaneMatrixInv:Wo};if(ue&&He.canOverlap){J=!0;const vi=ht.segments.get();for(const xs of vi)Le.push({segments:new s.SegmentVector([xs]),sortKey:xs.sortKey,state:EA})}else Le.push({segments:ht.segments,sortKey:0,state:EA})}J&&Le.sort((Ge,at)=>Ge.sortKey-at.sortKey);for(const Ge of Le){const at=Ge.state;if(d.terrain&&d.terrain.setupElevationDraw(at.tile,at.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:at.labelPlaneMatrixInv}),j.activeTexture.set($.TEXTURE0),at.atlasTexture.bind(at.atlasInterpolation,$.CLAMP_TO_EDGE),at.atlasTextureIcon&&(j.activeTexture.set($.TEXTURE1),at.atlasTextureIcon&&at.atlasTextureIcon.bind(at.atlasInterpolationIcon,$.CLAMP_TO_EDGE)),at.isSDF){const He=at.uniformValues;at.hasHalo&&(He.u_is_halo=1,Pc(at.buffers,Ge.segments,c,d,at.program,he,k,P,He)),He.u_is_halo=0}Pc(at.buffers,Ge.segments,c,d,at.program,he,k,P,at.uniformValues)}}function Pc(d,r,c,p,y,_,b,E,U){const D=p.context;y.draw(D,D.gl.TRIANGLES,_,b,E,s.CullFaceMode.disabled,U,c.id,d.layoutVertexBuffer,d.indexBuffer,r,c.paint,p.transform.zoom,d.programConfigurations.get(c.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function zs(d,r,c,p,y,_,b){const E=d.context.gl,U=c.paint.get("fill-pattern"),D=U&&U.constantOr(1),k=c.getCrossfadeParameters();let P,j,$,ee,X;b?(j=D&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",P=E.LINES):(j=D?"fillPattern":"fill",P=E.TRIANGLES);for(const ae of p){const W=r.getTile(ae);if(D&&!W.patternsLoaded())continue;const Ae=W.getBucket(c);if(!Ae)continue;d.prepareDrawTile(ae);const ue=Ae.programConfigurations.get(c.id),J=d.useProgram(j,ue);D&&(d.context.activeTexture.set(E.TEXTURE0),W.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),ue.updatePaintBuffers(k));const he=U.constantOr(null);if(he&&W.imageAtlas){const De=W.imageAtlas,Le=De.patternPositions[he.to.toString()],Ve=De.patternPositions[he.from.toString()];Le&&Ve&&ue.setConstantPatternPositions(Le,Ve)}const ye=d.translatePosMatrix(ae.projMatrix,W,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(b){ee=Ae.indexBuffer2,X=Ae.segments2;const De=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[E.drawingBufferWidth,E.drawingBufferHeight];$=j==="fillOutlinePattern"&&D?Hh(ye,d,k,W,De):hA(ye,De)}else ee=Ae.indexBuffer,X=Ae.segments,$=D?ca(ye,d,k,W):zh(ye);d.prepareDrawProgram(d.context,J,ae.toUnwrapped()),J.draw(d.context,P,y,d.stencilModeForClipping(ae),_,s.CullFaceMode.disabled,$,c.id,Ae.layoutVertexBuffer,ee,X,c.paint,d.transform.zoom,ue)}}function ps(d,r,c,p,y,_,b){const E=d.context,U=E.gl,D=c.paint.get("fill-extrusion-pattern"),k=D.constantOr(1),P=c.getCrossfadeParameters(),j=c.paint.get("fill-extrusion-opacity");for(const $ of p){const ee=r.getTile($),X=ee.getBucket(c);if(!X)continue;const ae=X.programConfigurations.get(c.id),W=d.useProgram(k?"fillExtrusionPattern":"fillExtrusion",ae);if(d.terrain){const ye=d.terrain;if(!X.enableTerrain)continue;if(ye.setupElevationDraw(ee,W,{useMeterToDem:!0}),Zh(E,r,$,X,c,ye),!X.centroidVertexBuffer){const De=W.attributes.a_centroid_pos;De!==void 0&&U.vertexAttrib2f(De,0,0)}}k&&(d.context.activeTexture.set(U.TEXTURE0),ee.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),ae.updatePaintBuffers(P));const Ae=D.constantOr(null);if(Ae&&ee.imageAtlas){const ye=ee.imageAtlas,De=ye.patternPositions[Ae.to.toString()],Le=ye.patternPositions[Ae.from.toString()];De&&Le&&ae.setConstantPatternPositions(De,Le)}const ue=d.translatePosMatrix($.projMatrix,ee,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),J=c.paint.get("fill-extrusion-vertical-gradient"),he=k?Rh(ue,d,J,j,$,P,ee):Sc(ue,d,J,j);d.prepareDrawProgram(E,W,$.toUnwrapped()),W.draw(E,E.gl.TRIANGLES,y,_,b,s.CullFaceMode.backCCW,he,c.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,c.paint,d.transform.zoom,ae,d.terrain?X.centroidVertexBuffer:null)}}function Zh(d,r,c,p,y,_){const b=[W=>{let Ae=W.canonical.x-1,ue=W.wrap;return Ae<0&&(Ae=(1<<W.canonical.z)-1,ue--),new s.OverscaledTileID(W.overscaledZ,ue,W.canonical.z,Ae,W.canonical.y)},W=>{let Ae=W.canonical.x+1,ue=W.wrap;return Ae===1<<W.canonical.z&&(Ae=0,ue++),new s.OverscaledTileID(W.overscaledZ,ue,W.canonical.z,Ae,W.canonical.y)},W=>new s.OverscaledTileID(W.overscaledZ,W.wrap,W.canonical.z,W.canonical.x,(W.canonical.y===0?1<<W.canonical.z:W.canonical.y)-1),W=>new s.OverscaledTileID(W.overscaledZ,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y===(1<<W.canonical.z)-1?0:W.canonical.y+1)],E=W=>{const Ae=r.getSource().maxzoom,ue=De=>{const Le=r.getTileByID(De);if(Le&&Le.hasData())return Le.getBucket(y)};let J,he,ye;return(W.overscaledZ===W.canonical.z||W.overscaledZ>=Ae)&&(J=ue(W.key)),W.overscaledZ>=Ae&&(he=ue(W.calculateScaledKey(W.overscaledZ+1))),W.overscaledZ>Ae&&(ye=ue(W.calculateScaledKey(W.overscaledZ-1))),J||he||ye},U=[0,0,0],D=(W,Ae)=>(U[0]=Math.min(W.min.y,Ae.min.y),U[1]=Math.max(W.max.y,Ae.max.y),U[2]=s.EXTENT-Ae.min.x>W.max.x?Ae.min.x-s.EXTENT:W.max.x,U),k=(W,Ae)=>(U[0]=Math.min(W.min.x,Ae.min.x),U[1]=Math.max(W.max.x,Ae.max.x),U[2]=s.EXTENT-Ae.min.y>W.max.y?Ae.min.y-s.EXTENT:W.max.y,U),P=[(W,Ae)=>D(W,Ae),(W,Ae)=>D(Ae,W),(W,Ae)=>k(W,Ae),(W,Ae)=>k(Ae,W)],j=new s.pointGeometry(0,0);let $,ee,X;const ae=(W,Ae,ue,J,he)=>{const ye=[[J?ue:W,J?W:ue,0],[J?ue:Ae,J?Ae:ue,0]],De=he<0?s.EXTENT+he:he,Le=[J?De:(W+Ae)/2,J?(W+Ae)/2:De,0];return ue===0&&he<0||ue!==0&&he>0?_.getForTilePoints(X,[Le],!0,ee):ye.push(Le),_.getForTilePoints(c,ye,!0,$),Math.max(ye[0][2],ye[1][2],Le[2])/_.exaggeration()};for(let W=0;W<4;W++){const Ae=p.borders[W];if(Ae.length===0&&(p.borderDone[W]=!0),p.borderDone[W])continue;const ue=X=b[W](c),J=E(ue);if(!J||!J.enableTerrain||(ee=_.findDEMTileFor(ue),!ee||!ee.dem))continue;if(!$){const Le=_.findDEMTileFor(c);if(!Le||!Le.dem)return;$=Le}const he=(W<2?1:5)-W,ye=J.borders[he];let De=0;for(let Le=0;Le<Ae.length;Le++){const Ve=p.featuresOnBorder[Ae[Le]],Ge=Ve.borders[W];let at;for(;De<ye.length&&(at=J.featuresOnBorder[ye[De]],!(at.borders[he][1]>Ge[0]+3));)J.borderDone[he]||J.encodeCentroid(void 0,at,!1),De++;if(at&&De<ye.length){const He=De;let ht=0;for(;!(at.borders[he][0]>Ge[1]-3)&&(ht++,++De!==ye.length);)at=J.featuresOnBorder[ye[De]];if(at=J.featuresOnBorder[ye[He]],Ve.intersectsCount()>1||at.intersectsCount()>1||ht!==1){ht!==1&&(De=He),p.encodeCentroid(void 0,Ve,!1),J.borderDone[he]||J.encodeCentroid(void 0,at,!1);continue}const Qe=P[W](Ve,at),ft=W%2?s.EXTENT-1:0;j.x=ae(Qe[0],Math.min(s.EXTENT-1,Qe[1]),ft,W<2,Qe[2]),j.y=0,p.encodeCentroid(j,Ve,!1),J.borderDone[he]||J.encodeCentroid(j,at,!1)}else p.encodeCentroid(void 0,Ve,!1)}p.borderDone[W]=p.needsCentroidUpdate=!0,J.borderDone[he]||(J.borderDone[he]=J.needsCentroidUpdate=!0)}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(d)}const Oc=new s.Color(1,0,0,1),cr=new s.Color(0,1,0,1),Al=new s.Color(0,0,1,1),cm=new s.Color(1,0,1,1),Xh=new s.Color(0,1,1,1);function da(d,r,c,p){ll(d,0,r+c/2,d.transform.width,c,p)}function Wh(d,r,c,p){ll(d,r-c/2,0,c,d.transform.height,p)}function ll(d,r,c,p,y,_){const b=d.context,E=b.gl;E.enable(E.SCISSOR_TEST),E.scissor(r*s.exported.devicePixelRatio,c*s.exported.devicePixelRatio,p*s.exported.devicePixelRatio,y*s.exported.devicePixelRatio),b.clear({color:_}),E.disable(E.SCISSOR_TEST)}function $h(d,r,c){const p=d.context,y=p.gl,_=c.projMatrix,b=d.useProgram("debug"),E=r.getTileByID(c.key);d.terrain&&d.terrain.setupElevationDraw(E,b);const U=s.DepthMode.disabled,D=s.StencilMode.disabled,k=d.colorModeForRenderPass(),P="$debug";p.activeTexture.set(y.TEXTURE0),d.emptyTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),E._makeDebugTileBoundsBuffers(d.context,d.transform.projection);const j=E._tileDebugBuffer||d.debugBuffer,$=E._tileDebugIndexBuffer||d.debugIndexBuffer,ee=E._tileDebugSegments||d.debugSegments;b.draw(p,y.LINE_STRIP,U,D,k,s.CullFaceMode.disabled,dA(_,s.Color.red),P,j,$,ee);const X=E.latestRawTileData,ae=Math.floor((X&&X.byteLength||0)/1024),W=r.getTile(c).tileSize,Ae=512/Math.min(W,512)*(c.overscaledZ/d.transform.zoom)*.5;let ue=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(ue+=` => ${c.overscaledZ}`),function(J,he){J.initDebugOverlayCanvas();const ye=J.debugOverlayCanvas,De=J.context.gl,Le=J.debugOverlayCanvas.getContext("2d");Le.clearRect(0,0,ye.width,ye.height),Le.shadowColor="white",Le.shadowBlur=2,Le.lineWidth=1.5,Le.strokeStyle="white",Le.textBaseline="top",Le.font="bold 36px Open Sans, sans-serif",Le.fillText(he,5,5),Le.strokeText(he,5,5),J.debugOverlayTexture.update(ye),J.debugOverlayTexture.bind(De.LINEAR,De.CLAMP_TO_EDGE)}(d,`${ue} ${ae}kb`),b.draw(p,y.TRIANGLES,U,D,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,dA(_,s.Color.transparent,Ae),P,d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments)}const um=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Rc}=um;function Ao(d,r,c,p){d.emplaceBack(r,c,p)}class fa{constructor(r){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,Ao(this.vertexArray,-1,-1,1),Ao(this.vertexArray,1,-1,1),Ao(this.vertexArray,-1,1,1),Ao(this.vertexArray,1,1,1),Ao(this.vertexArray,-1,-1,-1),Ao(this.vertexArray,1,-1,-1),Ao(this.vertexArray,-1,1,-1),Ao(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,Rc),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function ms(d,r,c,p,y,_){const b=d.gl,E=r.paint.get("sky-atmosphere-color"),U=r.paint.get("sky-atmosphere-halo-color"),D=r.paint.get("sky-atmosphere-sun-intensity"),k=((P,j,$,ee,X)=>({u_matrix_3f:P,u_sun_direction:j,u_sun_intensity:$,u_color_tint_r:[ee.r,ee.g,ee.b,ee.a],u_color_tint_m:[X.r,X.g,X.b,X.a],u_luminance:5e-5}))(s.fromMat4([],p),y,D,E,U);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_CUBE_MAP_POSITIVE_X+_,r.skyboxTexture,0),c.draw(d,b.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,k,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const cl={symbol:function(d,r,c,p,y){if(d.renderPass!=="translucent")return;const _=s.StencilMode.disabled,b=d.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(E,U,D,k,P,j,$){const ee=U.transform,X=P==="map",ae=j==="map";for(const W of E){const Ae=k.getTile(W),ue=Ae.getBucket(D);if(!ue||!ue.text||!ue.text.segments.get().length)continue;const J=s.evaluateSizeForZoom(ue.textSizeData,ee.zoom),he=U.transform.calculatePixelsToTileUnitsMatrix(Ae),ye=Yt(W.projMatrix,ae,X,U.transform,he),De=D.layout.get("icon-text-fit")!=="none"&&ue.hasIconData();if(J){const Le=Math.pow(2,ee.zoom-Ae.tileID.overscaledZ),Ve=ee.elevation;jh(ue,X,ae,$,s.symbolSize,ee,ye,W.projMatrix,Le,J,De,Ve?Ge=>Ve.getAtTileOffset(W,Ge.x,Ge.y):Ge=>0)}}}(p,d,c,r,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),y),c.paint.get("icon-opacity").constantOr(1)!==0&&fs(d,r,c,p,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),_,b),c.paint.get("text-opacity").constantOr(1)!==0&&fs(d,r,c,p,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),_,b),r.map.showCollisionBoxes&&(al(d,r,c,p,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),al(d,r,c,p,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(d,r,c,p){if(d.renderPass!=="translucent")return;const y=c.paint.get("circle-opacity"),_=c.paint.get("circle-stroke-width"),b=c.paint.get("circle-stroke-opacity"),E=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(y.constantOr(1)===0&&(_.constantOr(1)===0||b.constantOr(1)===0))return;const U=d.context,D=U.gl,k=d.depthModeForSublayer(0,s.DepthMode.ReadOnly),P=s.StencilMode.disabled,j=d.colorModeForRenderPass(),$=[];for(let ee=0;ee<p.length;ee++){const X=p[ee],ae=r.getTile(X),W=ae.getBucket(c);if(!W)continue;const Ae=W.programConfigurations.get(c.id),ue=Qc(c),J={programConfiguration:Ae,program:d.useProgram("circle",Ae,ue),layoutVertexBuffer:W.layoutVertexBuffer,indexBuffer:W.indexBuffer,uniformValues:Pi(d,X,ae,c),tile:ae};if(E){const he=W.segments.get();for(const ye of he)$.push({segments:new s.SegmentVector([ye]),sortKey:ye.sortKey,state:J})}else $.push({segments:W.segments,sortKey:0,state:J})}E&&$.sort((ee,X)=>ee.sortKey-X.sortKey);for(const ee of $){const{programConfiguration:X,program:ae,layoutVertexBuffer:W,indexBuffer:Ae,uniformValues:ue,tile:J}=ee.state,he=ee.segments;d.terrain&&d.terrain.setupElevationDraw(J,ae,{useDepthForOcclusion:!0}),d.prepareDrawProgram(U,ae,J.tileID.toUnwrapped()),ae.draw(U,D.TRIANGLES,k,P,j,s.CullFaceMode.disabled,ue,c.id,W,Ae,he,c.paint,d.transform.zoom,X)}},heatmap:function(d,r,c,p){if(c.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const y=d.context,_=y.gl,b=s.StencilMode.disabled,E=new s.ColorMode([_.ONE,_.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(U,D,k){const P=U.gl;U.activeTexture.set(P.TEXTURE1),U.viewport.set([0,0,D.width/4,D.height/4]);let j=k.heatmapFbo;if(j)P.bindTexture(P.TEXTURE_2D,j.colorAttachment.get()),U.bindFramebuffer.set(j.framebuffer);else{const $=P.createTexture();P.bindTexture(P.TEXTURE_2D,$),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,P.LINEAR),j=k.heatmapFbo=U.createFramebuffer(D.width/4,D.height/4,!1),function(ee,X,ae,W){const Ae=ee.gl;Ae.texImage2D(Ae.TEXTURE_2D,0,Ae.RGBA,X.width/4,X.height/4,0,Ae.RGBA,ee.extRenderToTextureHalfFloat?ee.extTextureHalfFloat.HALF_FLOAT_OES:Ae.UNSIGNED_BYTE,null),W.colorAttachment.set(ae)}(U,D,$,j)}})(y,d,c),y.clear({color:s.Color.transparent});for(let U=0;U<p.length;U++){const D=p[U];if(r.hasRenderableParent(D))continue;const k=r.getTile(D),P=k.getBucket(c);if(!P)continue;const j=P.programConfigurations.get(c.id),$=d.useProgram("heatmap",j),{zoom:ee}=d.transform;d.terrain&&d.terrain.setupElevationDraw(k,$),d.prepareDrawProgram(y,$,D.toUnwrapped()),$.draw(y,_.TRIANGLES,s.DepthMode.disabled,b,E,s.CullFaceMode.disabled,Mc(D.projMatrix,k,ee,c.paint.get("heatmap-intensity")),c.id,P.layoutVertexBuffer,P.indexBuffer,P.segments,c.paint,d.transform.zoom,j)}y.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(y,_){const b=y.context,E=b.gl,U=_.heatmapFbo;if(!U)return;b.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,U.colorAttachment.get()),b.activeTexture.set(E.TEXTURE1);let D=_.colorRampTexture;D||(D=_.colorRampTexture=new s.Texture(b,_.colorRamp,E.RGBA)),D.bind(E.LINEAR,E.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(b,E.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,y.colorModeForRenderPass(),s.CullFaceMode.disabled,((k,P,j,$)=>({u_image:0,u_color_ramp:1,u_opacity:P.paint.get("heatmap-opacity")}))(0,_),_.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,_.paint,y.transform.zoom)}(d,c))},line:function(d,r,c,p){if(d.renderPass!=="translucent")return;const y=c.paint.get("line-opacity"),_=c.paint.get("line-width");if(y.constantOr(1)===0||_.constantOr(1)===0)return;const b=d.depthModeForSublayer(0,s.DepthMode.ReadOnly),E=d.colorModeForRenderPass(),U=c.paint.get("line-dasharray"),D=U.constantOr(1),k=c.layout.get("line-cap"),P=c.paint.get("line-pattern"),j=P.constantOr(1),$=c.paint.get("line-gradient"),ee=c.getCrossfadeParameters(),X=j?"linePattern":"line",ae=d.context,W=ae.gl;for(const Ae of p){const ue=r.getTile(Ae);if(j&&!ue.patternsLoaded())continue;const J=ue.getBucket(c);if(!J)continue;d.prepareDrawTile(Ae);const he=J.programConfigurations.get(c.id),ye=sl(c),De=d.useProgram(X,he,ye),Le=P.constantOr(null);if(Le&&ue.imageAtlas){const ht=ue.imageAtlas,Qe=ht.patternPositions[Le.to.toString()],ft=ht.patternPositions[Le.from.toString()];Qe&&ft&&he.setConstantPatternPositions(Qe,ft)}const Ve=U.constantOr(null),Ge=k.constantOr(null);if(!j&&Ve&&Ge&&ue.lineAtlas){const ht=ue.lineAtlas,Qe=ht.getDash(Ve.to,Ge),ft=ht.getDash(Ve.from,Ge);Qe&&ft&&he.setConstantPatternPositions(Qe,ft)}const at=d.terrain?Ae.projMatrix:null,He=j?nl(d,ue,c,ee,at):Lc(d,ue,c,ee,at,J.lineClipsArray.length);if($){const ht=J.gradients[c.id];let Qe=ht.texture;if(c.gradientVersion!==ht.version){let ft=256;if(c.stepInterpolant){const bt=r.getSource().maxzoom,Pt=Ae.canonical.z===bt?Math.ceil(1<<d.transform.maxZoom-Ae.canonical.z):1;ft=s.clamp(s.nextPowerOfTwo(J.maxLineLength/s.EXTENT*1024*Pt),256,ae.maxTextureSize)}ht.gradient=s.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:ft,image:ht.gradient||void 0,clips:J.lineClipsArray}),ht.texture?ht.texture.update(ht.gradient):ht.texture=new s.Texture(ae,ht.gradient,W.RGBA),ht.version=c.gradientVersion,Qe=ht.texture}ae.activeTexture.set(W.TEXTURE1),Qe.bind(c.stepInterpolant?W.NEAREST:W.LINEAR,W.CLAMP_TO_EDGE)}D&&(ae.activeTexture.set(W.TEXTURE0),ue.lineAtlasTexture.bind(W.LINEAR,W.REPEAT),he.updatePaintBuffers(ee)),j&&(ae.activeTexture.set(W.TEXTURE0),ue.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),he.updatePaintBuffers(ee)),d.prepareDrawProgram(ae,De,Ae.toUnwrapped()),De.draw(ae,W.TRIANGLES,b,d.stencilModeForClipping(Ae),E,s.CullFaceMode.disabled,He,c.id,J.layoutVertexBuffer,J.indexBuffer,J.segments,c.paint,d.transform.zoom,he,J.layoutVertexBuffer2)}},fill:function(d,r,c,p){const y=c.paint.get("fill-color"),_=c.paint.get("fill-opacity");if(_.constantOr(1)===0)return;const b=d.colorModeForRenderPass(),E=c.paint.get("fill-pattern"),U=d.opaquePassEnabledForLayer()&&!E.constantOr(1)&&y.constantOr(s.Color.transparent).a===1&&_.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===U){const D=d.depthModeForSublayer(1,d.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);zs(d,r,c,p,D,b,!1)}if(d.renderPass==="translucent"&&c.paint.get("fill-antialias")){const D=d.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);zs(d,r,c,p,D,b,!0)}},"fill-extrusion":function(d,r,c,p){const y=c.paint.get("fill-extrusion-opacity");if(y!==0&&d.renderPass==="translucent"){const _=new s.DepthMode(d.context.gl.LEQUAL,s.DepthMode.ReadWrite,d.depthRangeFor3D);if(y!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))ps(d,r,c,p,_,s.StencilMode.disabled,s.ColorMode.disabled),ps(d,r,c,p,_,d.stencilModeFor3D(),d.colorModeForRenderPass());else{const b=d.colorModeForRenderPass();ps(d,r,c,p,_,s.StencilMode.disabled,b)}}},hillshade:function(d,r,c,p){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const y=d.context,_=d.depthModeForSublayer(0,s.DepthMode.ReadOnly),b=d.colorModeForRenderPass(),E=d.terrain&&d.terrain.renderingToTexture,[U,D]=d.renderPass!=="translucent"||E?[{},p]:d.stencilConfigForOverlap(p);for(const k of D){const P=r.getTile(k);if(P.needsHillshadePrepare&&d.renderPass==="offscreen")wr(d,P,c,_,s.StencilMode.disabled,b);else if(d.renderPass==="translucent"){const j=E&&d.terrain?d.terrain.stencilModeForRTTOverlap(k):U[k.overscaledZ];Jr(d,k,P,c,_,j,b)}}y.viewport.set([0,0,d.width,d.height])},raster:function(d,r,c,p,y,_){if(d.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!p.length)return;const b=d.context,E=b.gl,U=r.getSource(),D=d.useProgram("raster"),k=d.colorModeForRenderPass(),P=d.terrain&&d.terrain.renderingToTexture,[j,$]=U instanceof Y||P?[{},p]:d.stencilConfigForOverlap(p),ee=$[$.length-1].overscaledZ,X=!d.options.moving;for(const ae of $){const W=P?s.DepthMode.disabled:d.depthModeForSublayer(ae.overscaledZ-ee,c.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,E.LESS),Ae=ae.toUnwrapped(),ue=r.getTile(ae);if(P&&(!ue||!ue.hasData()))continue;const J=P?ae.projMatrix:d.transform.calculateProjMatrix(Ae,X),he=d.terrain&&P?d.terrain.stencilModeForRTTOverlap(ae):j[ae.overscaledZ],ye=_?0:c.paint.get("raster-fade-duration");ue.registerFadeDuration(ye);const De=r.findLoadedParent(ae,0),Le=ki(ue,De,r,d.transform,ye);let Ve,Ge;d.terrain&&d.terrain.prepareDrawTile(ae);const at=c.paint.get("raster-resampling")==="nearest"?E.NEAREST:E.LINEAR;b.activeTexture.set(E.TEXTURE0),ue.texture.bind(at,E.CLAMP_TO_EDGE),b.activeTexture.set(E.TEXTURE1),De?(De.texture.bind(at,E.CLAMP_TO_EDGE),Ve=Math.pow(2,De.tileID.overscaledZ-ue.tileID.overscaledZ),Ge=[ue.tileID.canonical.x*Ve%1,ue.tileID.canonical.y*Ve%1]):ue.texture.bind(at,E.CLAMP_TO_EDGE);const He=Nh(J,Ge||[0,0],Ve||1,Le,c);if(d.prepareDrawProgram(b,D,Ae),U instanceof Y)D.draw(b,E.TRIANGLES,W,s.StencilMode.disabled,k,s.CullFaceMode.disabled,He,c.id,U.boundsBuffer,d.quadTriangleIndexBuffer,U.boundsSegments);else{const{tileBoundsBuffer:ht,tileBoundsIndexBuffer:Qe,tileBoundsSegments:ft}=d.getTileBoundsBuffers(ue);D.draw(b,E.TRIANGLES,W,he,k,s.CullFaceMode.disabled,He,c.id,ht,Qe,ft)}}},background:function(d,r,c,p){const y=c.paint.get("background-color"),_=c.paint.get("background-opacity");if(_===0)return;const b=d.context,E=b.gl,U=d.transform,D=U.tileSize,k=c.paint.get("background-pattern");if(d.isPatternMissing(k))return;const P=!k&&y.a===1&&_===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==P)return;const j=s.StencilMode.disabled,$=d.depthModeForSublayer(0,P==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),ee=d.colorModeForRenderPass(),X=d.useProgram(k?"backgroundPattern":"background");let ae,W=p;W||(ae=d.getBackgroundTiles(),W=Object.values(ae).map(ue=>ue.tileID)),k&&(b.activeTexture.set(E.TEXTURE0),d.imageManager.bind(d.context));const Ae=c.getCrossfadeParameters();for(const ue of W){const J=ue.toUnwrapped(),he=p?ue.projMatrix:d.transform.calculateProjMatrix(J);d.prepareDrawTile(ue);const ye=r?r.getTile(ue):ae?ae[ue.key]:new s.Tile(ue,D,U.zoom,d),De=k?Am(he,_,d,k,{tileID:ue,tileSize:D},Ae):am(he,_,y);d.prepareDrawProgram(b,X,J);const{tileBoundsBuffer:Le,tileBoundsIndexBuffer:Ve,tileBoundsSegments:Ge}=d.getTileBoundsBuffers(ye);X.draw(b,E.TRIANGLES,$,j,ee,s.CullFaceMode.disabled,De,c.id,Le,Ve,Ge)}},sky:function(d,r,c){const p=d.transform,y=p.projection.name==="mercator"?1:s.smoothstep(7,8,p.zoom),_=c.paint.get("sky-opacity")*y;if(_===0)return;const b=d.context,E=c.paint.get("sky-type"),U=new s.DepthMode(b.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),D=d.frameCounter/1e3%1;E==="atmosphere"?d.renderPass==="offscreen"?c.needsSkyboxCapture(d)&&(function(k,P,j,$){const ee=k.context,X=ee.gl;let ae=P.skyboxFbo;if(!ae){ae=P.skyboxFbo=ee.createFramebuffer(32,32,!1),P.skyboxGeometry=new fa(ee),P.skyboxTexture=ee.gl.createTexture(),X.bindTexture(X.TEXTURE_CUBE_MAP,P.skyboxTexture),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MAG_FILTER,X.LINEAR);for(let J=0;J<6;++J)X.texImage2D(X.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,X.RGBA,32,32,0,X.RGBA,X.UNSIGNED_BYTE,null)}ee.bindFramebuffer.set(ae.framebuffer),ee.viewport.set([0,0,32,32]);const W=P.getCenter(k,!0),Ae=k.useProgram("skyboxCapture"),ue=new Float64Array(16);s.identity(ue),s.rotateY(ue,ue,.5*-Math.PI),ms(ee,P,Ae,ue,W,0),s.identity(ue),s.rotateY(ue,ue,.5*Math.PI),ms(ee,P,Ae,ue,W,1),s.identity(ue),s.rotateX(ue,ue,.5*-Math.PI),ms(ee,P,Ae,ue,W,2),s.identity(ue),s.rotateX(ue,ue,.5*Math.PI),ms(ee,P,Ae,ue,W,3),s.identity(ue),ms(ee,P,Ae,ue,W,4),s.identity(ue),s.rotateY(ue,ue,Math.PI),ms(ee,P,Ae,ue,W,5),ee.viewport.set([0,0,k.width,k.height])}(d,c),c.markSkyboxValid(d)):d.renderPass==="sky"&&function(k,P,j,$,ee){const X=k.context,ae=X.gl,W=k.transform,Ae=k.useProgram("skybox");X.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_CUBE_MAP,P.skyboxTexture);const ue=((J,he,ye,De,Le)=>({u_matrix:J,u_sun_direction:he,u_cubemap:0,u_opacity:De,u_temporal_offset:Le}))(W.skyboxMatrix,P.getCenter(k,!1),0,$,ee);k.prepareDrawProgram(X,Ae),Ae.draw(X,ae.TRIANGLES,j,s.StencilMode.disabled,k.colorModeForRenderPass(),s.CullFaceMode.backCW,ue,"skybox",P.skyboxGeometry.vertexBuffer,P.skyboxGeometry.indexBuffer,P.skyboxGeometry.segment)}(d,c,U,_,D):E==="gradient"&&d.renderPass==="sky"&&function(k,P,j,$,ee){const X=k.context,ae=X.gl,W=k.transform,Ae=k.useProgram("skyboxGradient");P.skyboxGeometry||(P.skyboxGeometry=new fa(X)),X.activeTexture.set(ae.TEXTURE0);let ue=P.colorRampTexture;ue||(ue=P.colorRampTexture=new s.Texture(X,P.colorRamp,ae.RGBA)),ue.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);const J=((he,ye,De,Le,Ve)=>({u_matrix:he,u_color_ramp:0,u_center_direction:ye,u_radius:s.degToRad(De),u_opacity:Le,u_temporal_offset:Ve}))(W.skyboxMatrix,P.getCenter(k,!1),P.paint.get("sky-gradient-radius"),$,ee);k.prepareDrawProgram(X,Ae),Ae.draw(X,ae.TRIANGLES,j,s.StencilMode.disabled,k.colorModeForRenderPass(),s.CullFaceMode.backCW,J,"skyboxGradient",P.skyboxGeometry.vertexBuffer,P.skyboxGeometry.indexBuffer,P.skyboxGeometry.segment)}(d,c,U,_,D)},debug:function(d,r,c){for(let p=0;p<c.length;p++)$h(d,r,c[p])},custom:function(d,r,c){const p=d.context,y=c.implementation;if(d.transform.projection.name==="mercator"){if(d.renderPass==="offscreen"){const _=y.prerender;_&&(d.setCustomLayerDefaults(),p.setColorMode(d.colorModeForRenderPass()),_.call(y,p.gl,d.transform.customLayerMatrix()),p.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),p.setColorMode(d.colorModeForRenderPass()),p.setStencilMode(s.StencilMode.disabled);const _=y.renderingMode==="3d"?new s.DepthMode(d.context.gl.LEQUAL,s.DepthMode.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,s.DepthMode.ReadOnly);p.setDepthMode(_),y.render(p.gl,d.transform.customLayerMatrix()),p.setDirty(),d.setBaseState(),p.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.")}};class qh{constructor(r,c){this.context=new Ko(r),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Gr,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,c){const p=!!r&&!!r.terrain&&this.transform.projection.name==="mercator";if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ds(this,r));const y=this._terrain;this.transform.elevation=p?y:null,y.update(r,this.transform,c)}_updateFog(r){const c=r.fog;if(!c||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,y]=c.getFovAdjustedRange(this.transform._fov);if(p>y)return void(this.transform.fogCullDistSq=null);const _=p+.78*(y-p);this.transform.fogCullDistSq=_*_}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,c){if(this.width=r*s.exported.devicePixelRatio,this.height=c*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const r=this.context,c=new s.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(s.EXTENT,0),c.emplaceBack(0,s.EXTENT),c.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(c,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const p=new s.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(s.EXTENT,0),p.emplaceBack(0,s.EXTENT),p.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=r.createVertexBuffer(p,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const y=new s.StructArrayLayout2i4;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(y,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const _=new s.StructArrayLayout4i8;_.emplaceBack(0,0,0,0),_.emplaceBack(s.EXTENT,0,s.EXTENT,0),_.emplaceBack(0,s.EXTENT,0,s.EXTENT),_.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(_,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const b=new s.StructArrayLayout3ui6;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(b);const E=new s.StructArrayLayout1ui2;for(const D of[0,1,3,2,0])E.emplaceBack(D);this.debugIndexBuffer=r.createIndexBuffer(E),this.emptyTexture=new s.Texture(r,{width:1,height:1,data:new Uint8Array([0,0,0,0])},r.gl.RGBA),this.identityMat=s.create$1();const U=this.context.gl;this.stencilClearMode=new s.StencilMode({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.loadTimeStamps.push(s.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,c=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this.useProgram("clippingMask").draw(r,c.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,yi(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,c,p){if(!(c&&this.currentStencilSource!==c.id&&r.isTileClipped()&&p&&p.length))return;this.currentStencilSource=c.id;const y=this.context,_=y.gl;this.nextStencilID+p.length>256&&this.clearStencil(),y.setColorMode(s.ColorMode.disabled),y.setDepthMode(s.DepthMode.disabled);const b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of p){const U=c.getTile(E),D=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,{tileBoundsBuffer:k,tileBoundsIndexBuffer:P,tileBoundsSegments:j}=this.getTileBoundsBuffers(U);b.draw(y,_.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:_.ALWAYS,mask:0},D,255,_.KEEP,_.KEEP,_.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,yi(E.projMatrix),"$clipping",k,P,j)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,c=this.context.gl;return new s.StencilMode({func:c.NOTEQUAL,mask:255},r,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const c=this.context.gl;return new s.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(r){const c=this.context.gl,p=r.sort((b,E)=>E.overscaledZ-b.overscaledZ),y=p[p.length-1].overscaledZ,_=p[0].overscaledZ-y+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const b={};for(let E=0;E<_;E++)b[E+y]=new s.StencilMode({func:c.GEQUAL,mask:255},E+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=_,[b,p]}return[{[y]:s.StencilMode.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([r.CONSTANT_COLOR,r.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(r,c,p){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new s.DepthMode(p||this.context.gl.LEQUAL,c,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,c){this.style=r,this.options=c,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const p=this.style.order,y=this.style._sourceCaches;for(const D in y){const k=y[D];k.used&&k.prepare(this.context)}const _={},b={},E={};for(const D in y){const k=y[D];_[D]=k.getVisibleCoordinates(),b[D]=_[D].slice().reverse(),E[D]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let D=0;D<p.length;D++)if(this.style._layers[p[D]].is3D()){this.opaquePassCutoff=D;break}if(this.terrain&&(this.terrain.updateTileBinding(E),this.opaquePassCutoff=0),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const D of p){const k=this.style._layers[D],P=r._getLayerSourceCache(k);if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;const j=P?b[P.id]:void 0;(k.type==="custom"||k.isSky()||j&&j.length)&&this.renderLayer(this,P,k,j)}this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let U=s.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(U=this.style.fog.properties.get("color")),this.context.clear({color:c.showOverdrawInspector?s.Color.black:U,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const D=this.style._layers[p[this.currentLayer]],k=r._getLayerSourceCache(D);if(D.isSky())continue;const P=k?b[k.id]:void 0;this._renderTileClippingMasks(D,k,P),this.renderLayer(this,k,D,P)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const D=this.style._layers[p[this.currentLayer]],k=r._getLayerSourceCache(D);D.isSky()&&this.renderLayer(this,k,D,k?b[k.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const D=this.style._layers[p[this.currentLayer]],k=r._getLayerSourceCache(D);if(D.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(D)){if(D.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const P=k?(D.type==="symbol"?E:b)[k.id]:void 0;this._renderTileClippingMasks(D,k,k?_[k.id]:void 0),this.renderLayer(this,k,D,P),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let D=null;s.values(this.style._layers).forEach(k=>{const P=r._getLayerSourceCache(k);P&&!k.isHidden(this.transform.zoom)&&(!D||D.getSource().maxzoom<P.getSource().maxzoom)&&(D=P)}),D&&this.options.showTileBoundaries&&cl.debug(this,D,D.getVisibleCoordinates())}this.options.showPadding&&function(D){const k=D.transform.padding;da(D,D.transform.height-(k.top||0),3,Oc),da(D,k.bottom||0,3,cr),Wh(D,k.left||0,3,Al),Wh(D,D.transform.width-(k.right||0),3,cm);const P=D.transform.centerPoint;(function(j,$,ee,X){ll(j,$-1,ee-10,2,20,X),ll(j,$-10,ee-1,20,2,X)})(D,P.x,D.transform.height-P.y,Xh)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%s.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(r,c,p,y){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||y&&y.length)&&(this.id=p.id,this.gpuTimingStart(p),cl[p.type](r,c,p,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let p=this.gpuTimers[r.id];p||(p=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),p.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,p.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}queryGpuTimers(r){const c={};for(const p in r){const y=r[p],_=this.context.extTimerQuery,b=_.getQueryObjectEXT(y.query,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(y.query),c[p]=b}return c}translatePosMatrix(r,c,p,y,_){if(!p[0]&&!p[1])return r;const b=_?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(b){const D=Math.sin(b),k=Math.cos(b);p=[p[0]*k-p[1]*D,p[0]*D+p[1]*k]}const E=[_?p[0]:Je(c,p[0],this.transform.zoom),_?p[1]:Je(c,p[1],this.transform.zoom),0],U=new Float32Array(16);return s.translate(U,r,E),U}saveTileTexture(r){const c=this._tileTextures[r.size[0]];c?c.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const c=this._tileTextures[r];return c&&c.length>0?c.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const c=this.imageManager.getPattern(r.from.toString()),p=this.imageManager.getPattern(r.to.toString());return!c||!p}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,c=this.style&&this.style.fog,p=[];return this.terrain&&!this.terrain.renderingToTexture&&p.push("TERRAIN"),c&&!r&&c.getOpacity(this.transform.pitch)!==0&&p.push("FOG"),r&&p.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&p.push("OVERDRAW_INSPECTOR"),p}useProgram(r,c,p){this.cache=this.cache||{};const y=p||[],_=this.currentGlobalDefines().concat(y),b=el.cacheKey(r,_,c);return this.cache[b]||(this.cache[b]=new el(this.context,r,Ft[r],c,lm[r],_)),this.cache[b]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(r){this.terrain&&this.terrain.prepareDrawTile(r)}prepareDrawProgram(r,c,p){if(this.terrain&&this.terrain.renderingToTexture)return;const y=this.style.fog;if(y){const _=y.getOpacity(this.transform.pitch);_!==0&&c.setFogUniformValues(r,((b,E,U,D)=>{const k=E.properties.get("color"),P=b.frameCounter/1e3%1,j=[k.r/k.a,k.g/k.a,k.b/k.a,D];return{u_fog_matrix:U?b.transform.calculateFogTileMatrix(U):b.identityMat,u_fog_range:E.getFovAdjustedRange(b.transform._fov),u_fog_color:j,u_fog_horizon_blend:E.properties.get("horizon-blend"),u_fog_temporal_offset:P}})(this,y,p,_))}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const r=this.context.gl,c=r.createTexture();return r.bindTexture(r.TEXTURE_2D,c),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,c=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const y of p)c[y.key]=r[y.key]||new s.Tile(y,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class pa{constructor(r=0,c=0,p=0,y=0){if(isNaN(r)||r<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=c,this.left=p,this.right=y}interpolate(r,c,p){return c.top!=null&&r.top!=null&&(this.top=s.number(r.top,c.top,p)),c.bottom!=null&&r.bottom!=null&&(this.bottom=s.number(r.bottom,c.bottom,p)),c.left!=null&&r.left!=null&&(this.left=s.number(r.left,c.left,p)),c.right!=null&&r.right!=null&&(this.right=s.number(r.right,c.right,p)),this}getCenter(r,c){const p=s.clamp((this.left+r-this.right)/2,0,r),y=s.clamp((this.top+c-this.bottom)/2,0,c);return new s.pointGeometry(p,y)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new pa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function gs(d,r){return[d[4*r],d[4*r+1],d[4*r+2],d[4*r+3]]}function Zi(d,r,c){d[4*r+0]=c[0],d[4*r+1]=c[1],d[4*r+2]=c[2],d[4*r+3]=c[3]}function ul(d,r){const c=gs(d,3);s.fromQuat(d,r),Zi(d,3,c)}function zc(d,r){Zi(d,3,[r[0],r[1],r[2],1])}function hl(d,r){const c=s.identity$1([]);return s.rotateZ$1(c,c,-r),s.rotateX$1(c,c,-d),c}function ys(d,r){const c=[d[0],d[1],0],p=[r[0],r[1],0];if(s.length(c)>=1e-15){const b=s.normalize([],c);s.scale(p,b,s.dot(p,b)),r[0]=p[0],r[1]=p[1]}const y=s.cross([],r,d);if(s.len(y)<1e-15)return null;const _=Math.atan2(-y[1],y[0]);return hl(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),_)}class Hc{constructor(r,c){this.position=r,this.orientation=c}get position(){return this._position}set position(r){this._position=this._renderWorldCopies?function(c){if(!c)return;const p=Array.isArray(c)?new s.MercatorCoordinate(c[0],c[1],c[2]):c;return p.x=s.wrap(p.x,0,1),p}(r):r}lookAtPoint(r,c){if(this.orientation=null,!this.position)return;const p=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(r)):0,y=this.position,_=s.MercatorCoordinate.fromLngLat(r,p),b=[_.x-y.x,_.y-y.y,_.z-y.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=ys(b,c)}setPitchBearing(r,c){this.orientation=hl(s.degToRad(r),s.degToRad(-c))}}class ma{constructor(r,c){this._transform=s.identity([]),this._orientation=s.identity$1([]),c&&(this._orientation=c,ul(this._transform,this._orientation)),r&&zc(this._transform,r)}get mercatorPosition(){const r=this.position;return new s.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=gs(this._transform,3);return[r[0],r[1],r[2]]}set position(r){zc(this._transform,r)}get orientation(){return this._orientation}set orientation(r){this._orientation=r,ul(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,c){this._orientation=hl(r,c),ul(this._transform,this._orientation)}forward(){const r=gs(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=gs(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=gs(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,c){const p=new Float64Array(16);return s.invert(p,this.getWorldToCamera(r,c)),p}getWorldToCameraPosition(r,c,p){const y=this.position;s.scale(y,y,-r);const _=new Float64Array(16);return s.fromScaling(_,[p,p,p]),s.translate(_,_,y),_[10]*=c,_}getWorldToCamera(r,c){const p=new Float64Array(16),y=new Float64Array(4),_=this.position;return s.conjugate(y,this._orientation),s.scale(_,_,-r),s.fromQuat(p,y),s.translate(p,p,_),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=c,p[9]*=c,p[10]*=c,p[11]*=c,p}getCameraToClipPerspective(r,c,p,y){const _=new Float64Array(16);return s.perspective(_,r,c,p,y),_}getDistanceToElevation(r){const c=r===0?0:s.mercatorZfromAltitude(r,this.position[1]),p=this.forward();return(c-this.position[2])/p[2]}clone(){return new ma([...this.position],[...this.orientation])}}function dl(d,r){const c=Nc(d),p=function(_,b,E,U,D){const k=new s.LngLat(E.lng-180*Hs,E.lat),P=new s.LngLat(E.lng+180*Hs,E.lat),j=_.project(k.lng,k.lat),$=_.project(P.lng,P.lat),ee=-Math.atan2($.y-j.y,$.x-j.x),X=s.MercatorCoordinate.fromLngLat(E);X.y=s.clamp(X.y,-.999975,.999975);const ae=X.toLngLat(),W=_.project(ae.lng,ae.lat),Ae=s.MercatorCoordinate.fromLngLat(ae);Ae.x+=Hs;const ue=Ae.toLngLat(),J=_.project(ue.lng,ue.lat),he=Jh(J.x-W.x,J.y-W.y,ee),ye=s.MercatorCoordinate.fromLngLat(ae);ye.y+=Hs;const De=ye.toLngLat(),Le=_.project(De.lng,De.lat),Ve=Jh(Le.x-W.x,Le.y-W.y,ee),Ge=Math.abs(he.x)/Math.abs(Ve.y),at=s.identity([]);s.rotateZ(at,at,-ee*(1-(D?0:U)));const He=s.identity([]);return s.scale$1(He,He,[1,1-(1-Ge)*U,1]),He[4]=-Ve.x/Ve.y*U,s.rotateZ(He,He,ee),s.multiply(He,at,He),He}(d.projection,0,d.center,c,r),y=fA(d);return s.scale$1(p,p,[y,y,1]),p}function fA(d){const r=d.projection,c=Nc(d),p=Ns(r,d.center),y=Ns(r,s.LngLat.convert(r.center));return Math.pow(2,p*c+(1-c)*y)}function Nc(d){const r=d.projection.range;if(!r)return 0;const c=Math.max(d.width,d.height),p=Math.log(c/1024)/Math.LN2;return s.smoothstep(r[0]+p,r[1]+p,d.zoom)}const Hs=1/4e4;function Ns(d,r){const c=s.clamp(r.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),p=new s.LngLat(r.lng-180*Hs,c),y=new s.LngLat(r.lng+180*Hs,c),_=d.project(p.lng,c),b=d.project(y.lng,c),E=s.MercatorCoordinate.fromLngLat(p),U=s.MercatorCoordinate.fromLngLat(y),D=b.x-_.x,k=b.y-_.y,P=U.x-E.x,j=U.y-E.y,$=Math.sqrt((P*P+j*j)/(D*D+k*k));return Math.log($)/Math.LN2}function Jh(d,r,c){const p=Math.cos(c),y=Math.sin(c);return{x:d*p-r*y,y:d*y+r*p}}class Vc{constructor(r,c,p,y,_){this.tileSize=512,this._renderWorldCopies=_===void 0||_,this._minZoom=r||0,this._maxZoom=c||22,this._minPitch=p??0,this._maxPitch=y??60,this.setProjection(),this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new pa,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new ma,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const r=new Vc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r.tileSize=this.tileSize,r.setMaxBounds(this.getMaxBounds()),r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._cameraZoom=this._cameraZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.setProjection(this.getProjection()),r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,r?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(r){this._terrainEnabled()&&this._cameraZoom==null&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),r&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(r){r==null&&(r={name:"mercator"}),this.projectionOptions=r;const c=this.projection?this.getProjection():void 0;return this.projection=s.getProjection(r),!L(c,this.getProjection())&&(this._calcMatrices(),!0)}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.wrap===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return s.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const c=-r*Math.PI/180;var p;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(p=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),function(y,_,b){var E=_[0],U=_[1],D=_[2],k=_[3],P=Math.sin(b),j=Math.cos(b);y[0]=E*j+D*P,y[1]=U*j+k*P,y[2]=E*-P+D*j,y[3]=U*-P+k*j}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const c=s.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(r){const c=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const r=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center),-1);return r===-1?(this._cameraZoom=null,!1):(this._centerAltitude=r,!0)}_updateCameraOnTerrain(){const r=this.cameraToCenterDistance/this.worldSize,c=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(c+r)}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let y=0,_=0;for(let b=0;b<c.length;b++){const E=new s.pointGeometry(c[b][0]*this.width,p+c[b][1]*(this.height-p)),U=r.pointCoordinate(E);if(!U)continue;const D=1/Math.hypot(U[0]-this._camera.position[0],U[1]-this._camera.position[1]);y+=U[3]*D,_+=D}return _===0?NaN:y/_}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._cameraZoom==null||!this._elevation)return;const r=this._cameraZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=s.mercatorZfromAltitude(c,this.center.lat),y=this._mercatorZfromZoom(r),_=this._mercatorZfromZoom(this._maxZoom),b=Math.max(y-p,_);this._setZoom(this._zoomFromMercatorZ(b))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let p;p=r.z<this._camera.position[2]?[c.x,c.y,c.z]:[r.x,r.y,r.z];const y=s.length(s.sub([],this._camera.position,p));return s.clamp(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let c=!1;if(r.orientation&&!s.exactEquals(r.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(r.orientation)),r.position){const p=[r.position.x,r.position.y,r.position.z];s.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,c=new Hc;return c.position=new s.MercatorCoordinate(r[0],r[1],r[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(r){if(!s.length$1(r))return!1;s.normalize$1(r,r);const c=s.transformQuat([],[0,0,-1],r),p=s.transformQuat([],[0,-1,0],r);if(p[2]<0)return!1;const y=ys(c,p);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(r){const c=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;r[2]=s.clamp(r[2],y/p,y/c),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,c,p){this._unmodified=!1,this._edgeInsets.interpolate(r,c,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const c=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(r){const c=[new s.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const p=this.pointCoordinate(new s.pointGeometry(0,0)),y=this.pointCoordinate(new s.pointGeometry(this.width,0)),_=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),b=this.pointCoordinate(new s.pointGeometry(0,this.height)),E=Math.floor(Math.min(p.x,y.x,_.x,b.x)),U=Math.floor(Math.max(p.x,y.x,_.x,b.x)),D=1;for(let k=E-D;k<=U+D;k++)k!==0&&c.push(new s.UnwrappedTileID(k,r))}return c}coveringTiles(r){let c=this.coveringZoomLevel(r);const p=c,y=this.elevation&&!r.isTerrainDEM,_=this.projection.name==="mercator";if(r.minzoom!==void 0&&c<r.minzoom)return[];r.maxzoom!==void 0&&c>r.maxzoom&&(c=r.maxzoom);const b=this.locationCoordinate(this.center),E=1<<c,U=[E*b.x,E*b.y,0],D=we.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c),k=this.pointCoordinate(this.getCameraPoint()),P=E*s.mercatorZfromAltitude(1,this.center.lat),j=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),$=[E*k.x,E*k.y,j],ee=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),X=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&_?c:0,ae=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,W=r.isTerrainDEM?-ae:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ae=fA(this),ue=Qe=>{const bt=new s.MercatorCoordinate(Qe.x+25e-6,Qe.y,Qe.z),Pt=new s.MercatorCoordinate(Qe.x,Qe.y+25e-6,Qe.z),Ht=Qe.toLngLat(),Kt=bt.toLngLat(),Gt=Pt.toLngLat(),kt=this.locationCoordinate(Ht),qt=this.locationCoordinate(Kt),fr=this.locationCoordinate(Gt),dn=Math.hypot(qt.x-kt.x,qt.y-kt.y),Hn=Math.hypot(fr.x-kt.x,fr.y-kt.y);return Math.sqrt(dn*Hn)*Ae/25e-6},J=(Qe,ft,bt,Pt,Ht,Kt)=>{const Gt=s.tileTransform({z:Qe,x:ft,y:bt},this.projection);return new ge([(Pt+Gt.x/Gt.scale)*E,E*(Gt.y/Gt.scale),Ht],[(Pt+Gt.x2/Gt.scale)*E,E*(Gt.y2/Gt.scale),Kt])},he=Qe=>({aabb:J(0,0,0,Qe,W,ae),zoom:0,x:0,y:0,wrap:Qe,fullyVisible:!1}),ye=[];let De=[];const Le=c,Ve=r.reparseOverscaled?p:c,Ge=Qe=>{if(!this._elevation||!Qe.tileID)return;const ft=this._elevation.getMinMaxForTile(Qe.tileID),bt=Qe.aabb;ft?(bt.min[2]=ft.min,bt.max[2]=ft.max,bt.center[2]=(bt.min[2]+bt.max[2])/2):(Qe.shouldSplit=ht(Qe),Qe.shouldSplit||(bt.min[2]=bt.max[2]=bt.center[2]=this._centerAltitude))},at=Qe=>Qe*Qe,He=at((j-this._centerAltitude)*P),ht=Qe=>{if(Qe.zoom<X)return!0;if(Qe.zoom===Le)return!1;if(Qe.shouldSplit!=null)return Qe.shouldSplit;const ft=Qe.aabb.distanceX($),bt=Qe.aabb.distanceY($);let Pt=He;y&&(Pt=at(Qe.aabb.distanceZ($)*P));let Ht=1;if(!_&&p<=5){const Gt=Math.pow(2,Qe.zoom),kt=ue(new s.MercatorCoordinate((Qe.x+.5)/Gt,(Qe.y+.5)/Gt));Ht=kt>.85?1:kt}const Kt=ft*ft+bt*bt+Pt;return Kt<at((1<<Le-Qe.zoom)*ee*Ht*((Gt,kt)=>{if(kt*at(.707)<Gt)return 1;const qt=Math.sqrt(kt/Gt);return qt/(1.4144271570014144+(Math.pow(1.1,qt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Pt,He),Kt))};if(this.renderWorldCopies)for(let Qe=1;Qe<=3;Qe++)ye.push(he(-Qe)),ye.push(he(Qe));for(ye.push(he(0));ye.length>0;){const Qe=ye.pop(),ft=Qe.x,bt=Qe.y;let Pt=Qe.fullyVisible;if(!Pt){const Ht=Qe.aabb.intersects(D);if(Ht===0)continue;Pt=Ht===2}if(Qe.zoom!==Le&&ht(Qe))for(let Ht=0;Ht<4;Ht++){const Kt=(ft<<1)+Ht%2,Gt=(bt<<1)+(Ht>>1),kt={aabb:this.projection.name==="mercator"?Qe.aabb.quadrant(Ht):J(Qe.zoom+1,Kt,Gt,Qe.wrap,0,0),zoom:Qe.zoom+1,x:Kt,y:Gt,wrap:Qe.wrap,fullyVisible:Pt,tileID:void 0,shouldSplit:void 0};y&&(kt.tileID=new s.OverscaledTileID(Qe.zoom+1===Le?Ve:Qe.zoom+1,Qe.wrap,Qe.zoom+1,Kt,Gt),Ge(kt)),ye.push(kt)}else{const Ht=Qe.zoom===Le?Ve:Qe.zoom;if(r.minzoom&&r.minzoom>Ht)continue;const Kt=U[0]-(.5+ft+(Qe.wrap<<Qe.zoom))*(1<<c-Qe.zoom),Gt=U[1]-.5-bt,kt=Qe.tileID?Qe.tileID:new s.OverscaledTileID(Ht,Qe.wrap,Qe.zoom,ft,bt);De.push({tileID:kt,distanceSq:Kt*Kt+Gt*Gt})}}if(this.fogCullDistSq){const Qe=this.fogCullDistSq,ft=this.horizonLineFromTop();De=De.filter(bt=>{const Pt=[0,0,0,1],Ht=[s.EXTENT,s.EXTENT,0,1],Kt=this.calculateFogTileMatrix(bt.tileID.toUnwrapped());s.transformMat4(Pt,Pt,Kt),s.transformMat4(Ht,Ht,Kt);const Gt=s.getAABBPointSquareDist(Pt,Ht);if(Gt===0)return!0;let kt=!1;const qt=this._elevation;if(qt&&Gt>Qe&&ft!==0){const fr=this.calculateProjMatrix(bt.tileID.toUnwrapped());let dn;r.isTerrainDEM||(dn=qt.getMinMaxForTile(bt.tileID)),dn||(dn={min:W,max:ae});const Hn=s.furthestTileCorner(this.rotation),Jn=[Hn[0]*s.EXTENT,Hn[1]*s.EXTENT,dn.max];s.transformMat4$1(Jn,Jn,fr),kt=(1-Jn[1])*this.height*.5<ft}return Gt<Qe||kt})}return De.sort((Qe,ft)=>Qe.distanceSq-ft.distanceSq).map(Qe=>Qe.tileID)}resize(r,c){this.width=r,this.height=c,this.pixelsToGLUnits=[2/r,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const c=s.clamp(r.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),p=this.projection.project(r.lng,c);return new s.pointGeometry(p.x*this.worldSize,p.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(r,c){const p=this.pointCoordinate(c),y=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(r);this.setLocation(new s.MercatorCoordinate(_.x-(p.x-y.x),_.y-(p.y-y.y)))}setLocation(r){this.center=this.coordinateLocation(r),this.renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r){return this._coordinatePoint(this.locationCoordinate(r),!1)}locationPoint3D(r){return this._coordinatePoint(this.locationCoordinate(r),!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,c){const p=c?s.mercatorZfromAltitude(c,r.lat):void 0,y=this.projection.project(r.lng,r.lat);return new s.MercatorCoordinate(y.x,y.y,p)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,c){const p=c??this._centerAltitude,y=[r.x,r.y,0,1],_=[r.x,r.y,1,1];s.transformMat4(y,y,this.pixelMatrixInverse),s.transformMat4(_,_,this.pixelMatrixInverse);const b=_[3];s.scale$2(y,y,1/y[3]),s.scale$2(_,_,1/b);const E=y[2],U=_[2];return{p0:y,p1:_,t:E===U?0:(p-E)/(U-E)}}screenPointToMercatorRay(r){const c=[r.x,r.y,0,1],p=[r.x,r.y,1,1];return s.transformMat4(c,c,this.pixelMatrixInverse),s.transformMat4(p,p,this.pixelMatrixInverse),s.scale$2(c,c,1/c[3]),s.scale$2(p,p,1/p[3]),c[2]=s.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,p[2]=s.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,s.scale$2(c,c,1/this.worldSize),s.scale$2(p,p,1/this.worldSize),new oe([c[0],c[1],c[2]],s.normalize([],s.sub([],p,c)))}rayIntersectionCoordinate(r){const{p0:c,p1:p,t:y}=r,_=s.mercatorZfromAltitude(c[2],this._center.lat),b=s.mercatorZfromAltitude(p[2],this._center.lat);return new s.MercatorCoordinate(s.number(c[0],p[0],y)/this.worldSize,s.number(c[1],p[1],y)/this.worldSize,s.number(_,b,y))}pointCoordinate(r,c=this._centerAltitude){const p=this.horizonLineFromTop(!1),y=new s.pointGeometry(r.x,Math.max(p,r.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(y,c))}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);const c=this.elevation;let p=this.elevation.pointCoordinate(r);if(p)return new s.MercatorCoordinate(p[0],p[1],p[2]);let y=0,_=this.horizonLineFromTop();if(r.y>_)return this.pointCoordinate(r);const b=.02*_,E=r.clone();for(let U=0;U<10&&_-y>b;U++){E.y=s.number(y,_,.66);const D=c.pointCoordinate(E);D?(_=E.y,p=D):y=E.y}return p?new s.MercatorCoordinate(p[0],p[1],p[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){if(this.elevation)return!this.elevation.pointCoordinate(r);{const c=this.horizonLineFromTop();return r.y<c}}_coordinatePoint(r,c){const p=c&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,y=[r.x*this.worldSize,r.y*this.worldSize,p+r.toAltitude(),1];return s.transformMat4(y,y,this.pixelMatrix),y[3]>0?new s.pointGeometry(y[0]/y[3],y[1]/y[3]):new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(r,c){const p=new s.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),y=new s.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),_=new s.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),b=new s.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let E=this.pointCoordinate(p,r),U=this.pointCoordinate(y,r);const D=this.pointCoordinate(_,c),k=this.pointCoordinate(b,c),P=(j,$)=>($.y-j.y)/($.x-j.x);return E.y>1&&U.y>=0?E=new s.MercatorCoordinate((1-k.y)/P(k,E)+k.x,1):E.y<0&&U.y<=1&&(E=new s.MercatorCoordinate(-k.y/P(k,E)+k.x,0)),U.y>1&&E.y>=0?U=new s.MercatorCoordinate((1-D.y)/P(D,U)+D.x,1):U.y<0&&E.y<=1&&(U=new s.MercatorCoordinate(-D.y/P(D,U)+D.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(E)).extend(this.coordinateLocation(U)).extend(this.coordinateLocation(k)).extend(this.coordinateLocation(D))}_getBounds3D(){const r=this.elevation,c=r.visibleDemTiles.reduce((p,y)=>{if(y.dem){const _=y.dem.tree;p.min=Math.min(p.min,_.minimums[0]),p.max=Math.max(p.max,_.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBounds(c.min*r.exaggeration(),c.max*r.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(r=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-c*(1-this._horizonShift);return r?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,c){let p,y,_;const b=r.canonical,E=s.identity(new Float64Array(16));if(this.projection.name==="mercator")p=c/this.zoomScale(b.z),y=(b.x+Math.pow(2,b.z)*r.wrap)*p,_=b.y*p;else{const U=s.tileTransform(b,this.projection);p=1,y=U.x+r.wrap*U.scale,_=U.y,s.scale$1(E,E,[p/U.scale,p/U.scale,this.pixelsPerMeter/this.worldSize])}return s.translate(E,E,[y,_,0]),s.scale$1(E,E,[p/s.EXTENT,p/s.EXTENT,1]),E}calculateDistanceTileData(r){const c=r.key,p=this._distanceTileDataCache;if(p[c])return p[c];const y=r.canonical,_=1/this.height,b=this.cameraWorldSize/this.zoomScale(y.z),E=(y.x+Math.pow(2,y.z)*r.wrap)*b,U=y.y*b,D=this.point,k=this.angle,P=Math.sin(-k),j=-Math.cos(-k);return p[c]={bearing:[P,j],center:[(D.x-E)*_,(D.y-U)*_],scale:b/s.EXTENT*_},p[c]}calculateFogTileMatrix(r){const c=r.key,p=this._fogTileMatrixCache;if(p[c])return p[c];const y=this.calculatePosMatrix(r,this.cameraWorldSize);return s.multiply(y,this.worldToFogMatrix,y),p[c]=new Float32Array(y),p[c]}calculateProjMatrix(r,c=!1){const p=r.key,y=c?this._alignedProjMatrixCache:this._projMatrixCache;if(y[p])return y[p];const _=this.calculatePosMatrix(r,this.worldSize);return s.multiply(_,this.projection.name==="mercator"?c?this.alignedProjMatrix:this.projMatrix:this.mercatorMatrix,_),y[p]=new Float32Array(_),y[p]}calculatePixelsToTileUnitsMatrix(r){const c=r.tileID.key,p=this._pixelsToTileUnitsCache;if(p[c])return p[c];const y=function(_,b){const{scale:E}=_.tileTransform,U=E*s.EXTENT/(_.tileSize*Math.pow(2,b.zoom-_.tileID.overscaledZ+_.tileID.canonical.z));return D=new Float32Array(4),j=(k=b.inverseAdjustmentMatrix)[1],$=k[2],ee=k[3],ae=(P=[U,U])[1],D[0]=k[0]*(X=P[0]),D[1]=j*X,D[2]=$*ae,D[3]=ee*ae,D;var D,k,P,j,$,ee,X,ae}(r,this);return p[c]=y,p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const r=this._elevation;this._updateCameraState();const c=this._camera.position,p=this._camera.forward();if(c[2]<=0||p[2]>=0)return;const y=s.mercatorZfromAltitude(1,this._center.lat);c[2]/=y,p[2]/=y,s.normalize(p,p);const _=r.raycast(c,p,r.exaggeration());if(_){const b=s.scaleAndAdd([],c,p,_),E=new s.MercatorCoordinate(b[0],b[1],s.mercatorZfromAltitude(b[2],s.latFromMercatorY(b[1]))),U=this._camera.position,D=E.z+s.length([E.x-U[0],E.y-U[1],E.z-U[2]]);this._cameraZoom=this._zoomFromMercatorZ(D),this._centerAltitude=E.toAltitude(),this._center=this.coordinateLocation(E),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const r=this._elevation;this._updateCameraState();const c=r.getAtPointOrZero(this._camera.mercatorPosition),p=this._minimumHeightOverTerrain()*Math.cos(s.degToRad(this._maxPitch)),y=s.mercatorZfromAltitude(c,this._center.lat),_=this._camera.position[2]-y;if(_<p){const b=this.locationCoordinate(this._center,this._centerAltitude),E=this._camera.mercatorPosition,U=[b.x-E.x,b.y-E.y,b.z-E.z],D=s.length(U);U[2]-=p-_;const k=s.length(U);if(k===0)return;s.scale(U,U,D/k),this._camera.position=[b.x-U[0],b.y-U[1],b.z-U[2]],this._camera.orientation=ys(U,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.name!=="mercator"){const P=this.center;return P.lat=s.clamp(P.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(P.lng=s.clamp(P.lng,this.minLng,this.maxLng)),this.center=P,void(this._constraining=!1)}const r=this._unmodified,{x:c,y:p}=this.point;let y=0,_=c,b=p;const E=this.width/2,U=this.height/2,D=this.worldMinY*this.scale,k=this.worldMaxY*this.scale;if(p-U<D&&(b=D+U),p+U>k&&(b=k-U),k-D<this.height&&(y=Math.max(y,this.height/(k-D)),b=(k+D)/2),this.maxBounds||!this.renderWorldCopies){const P=this.worldMinX*this.scale,j=this.worldMaxX*this.scale,$=this.worldSize/2-(P+j)/2;_=(c+$+this.worldSize)%this.worldSize-$,_-E<P&&(_=P+E),_+E>j&&(_=j-E),j-P<this.width&&(y=Math.max(y,this.width/(j-P)),_=(j+P)/2)}_===c&&b===p||(this.center=this.unproject(new s.pointGeometry(_,b))),y&&(this.zoom+=this.scaleZoom(y)),this._constrainCameraAltitude(),this._unmodified=r,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const c=this.pixelsPerMeter;this._updateCameraState();const p=Math.PI/2+this._pitch,y=this.fovAboveCenter,_=this.elevation?this.elevation.getMinElevationBelowMSL()*c:0,b=(this._camera.position[2]*this.worldSize-_)/Math.cos(this._pitch),E=Math.sin(y)*b/Math.sin(s.clamp(Math.PI-p-y,.01,Math.PI-.01)),U=this.point,D=U.x,k=U.y,P=Math.cos(Math.PI/2-this._pitch)*E+b,j=Math.min(1.01*P,b*(1/this._horizonShift)),$=this.height/50,ee=this._camera.getWorldToCamera(this.worldSize,c),X=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,$,j);X[8]=2*-r.x/this.width,X[9]=2*r.y/this.height;let ae=s.mul$1([],X,ee);if(this.projection.name!=="mercator"){const at=this.locationCoordinate(this.center),He=s.identity([]);s.translate(He,He,[at.x*this.worldSize,at.y*this.worldSize,0]),s.multiply(He,He,dl(this)),s.translate(He,He,[-at.x*this.worldSize,-at.y*this.worldSize,0]),s.multiply(ae,ae,He),this.inverseAdjustmentMatrix=function(ht){const Qe=dl(ht,!0);return ne([],[Qe[0],Qe[1],Qe[4],Qe[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale$1([],ae,[this.worldSize,this.worldSize,this.worldSize/c]),this.projMatrix=ae,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const W=new Float32Array(16);s.identity(W),s.scale$1(W,W,[1,-1,1]),s.rotateX(W,W,this._pitch),s.rotateZ(W,W,this.angle);const Ae=s.perspective(new Float32Array(16),this._fov,this.width/this.height,$,j),ue=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Ae[8]=2*-r.x/this.width,Ae[9]=2*(r.y+ue)/this.height,this.skyboxMatrix=s.multiply(W,Ae,W);const J=this.width%2/2,he=this.height%2/2,ye=Math.cos(this.angle),De=Math.sin(this.angle),Le=D-Math.round(D)+ye*J+De*he,Ve=k-Math.round(k)+ye*he+De*J,Ge=new Float64Array(ae);if(s.translate(Ge,Ge,[Le>.5?Le-1:Le,Ve>.5?Ve-1:Ve,0]),this.alignedProjMatrix=Ge,ae=s.create$1(),s.scale$1(ae,ae,[this.width/2,-this.height/2,1]),s.translate(ae,ae,[1,-1,0]),this.labelPlaneMatrix=ae,ae=s.create$1(),s.scale$1(ae,ae,[1,-1,1]),s.translate(ae,ae,[-1,-1,0]),s.scale$1(ae,ae,[2/this.width,2/this.height,1]),this.glCoordMatrix=ae,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},ae=s.invert(new Float64Array(16),this.pixelMatrix),!ae)throw new Error("failed to invert matrix");this.pixelMatrixInverse=ae,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSize,c=this.cameraPixelsPerMeter,p=this._camera.position,y=1/this.height,_=[r,r,c];s.scale(_,_,y),s.scale(p,p,-1),s.multiply$1(p,p,_);const b=s.create$1();s.translate(b,b,p),s.scale$1(b,b,_),this.mercatorFogMatrix=b,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,c,y)}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const r=this._camera.forward(),c=this.cameraToCenterDistance,p=this.point,y=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-s.mercatorZfromAltitude(this._centerAltitude,this.center.lat),_=this.cameraToCenterDistance/y;this._camera.position=[p.x/this.worldSize-r[0]*c/_,p.y/this.worldSize-r[1]*c/_,s.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-r[2]*c/_]}_translateCameraConstrained(r){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=r[2];let y=1;p>0&&(y=Math.min((c-this._camera.position[2])/p,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,r,y),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,c=this._camera.forward(),{pitch:p,bearing:y}=this._camera.getPitchBearing(),_=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat),b=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),E=Math.max((r[2]-_)/Math.cos(p),b),U=this._zoomFromMercatorZ(E);s.scaleAndAdd(r,r,c,E),this._pitch=s.clamp(p,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(y,-Math.PI,Math.PI),this._setZoom(s.clamp(U,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=this.coordinateLocation(new s.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((this._cameraZoom!=null?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}_terrainEnabled(){return!(!this._elevation||this.projection.name!=="mercator"&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(r,c){const p=Math.min(r.x,c.x),y=Math.max(r.x,c.x),_=Math.min(r.y,c.y),b=Math.max(r.y,c.y);if(_<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const E=[new s.pointGeometry(p,_),new s.pointGeometry(y,b),new s.pointGeometry(p,b),new s.pointGeometry(y,_)],U=this.renderWorldCopies?-3:0,D=this.renderWorldCopies?4:1;for(const k of E){const P=this.pointRayIntersection(k);if(P.t<0)return!0;const j=this.rayIntersectionCoordinate(P);if(j.x<U||j.y<0||j.x>D||j.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.pointGeometry(0,0),new s.pointGeometry(this.width,this.height))}zoomDeltaToMovement(r,c){const p=s.length(s.sub([],this._camera.position,r)),y=this._zoomFromMercatorZ(p)+c;return p-this._mercatorZfromZoom(y)}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,r))}}function Kc(d,r){let c=!1,p=null;const y=()=>{p=null,c&&(d(),p=setTimeout(y,r),c=!1)};return()=>(c=!0,p||y(),p)}class fl{constructor(r){this._hashName=r&&encodeURIComponent(r),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Kc(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,s.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return s.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const c=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,y),b=Math.round(c.lng*_)/_,E=Math.round(c.lat*_)/_,U=this._map.getBearing(),D=this._map.getPitch();let k="";if(k+=r?`/${b}/${E}/${p}`:`${p}/${E}/${b}`,(U||D)&&(k+="/"+Math.round(10*U)/10),D&&(k+=`/${Math.round(D)}`),this._hashName){const P=this._hashName;let j=!1;const $=s.window.location.hash.slice(1).split("&").map(ee=>{const X=ee.split("=")[0];return X===P?(j=!0,`${X}=${k}`):ee}).filter(ee=>ee);return j||$.push(`${P}=${k}`),`#${$.join("&")}`}return`#${k}`}_getCurrentHash(){const r=s.window.location.hash.replace("#","");if(this._hashName){let c;return r.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(c=p)}),(c&&c[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._getCurrentHash();if(r.length>=3&&!r.some(c=>isNaN(c))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:c,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,r)}}const ga={linearity:.3,easing:s.bezier(0,0,.3,1)},Yh=s.extend({deceleration:2500,maxSpeed:1400},ga),ed=s.extend({deceleration:20,maxSpeed:1400},ga),pl=s.extend({deceleration:1e3,maxSpeed:360},ga),Gc=s.extend({deceleration:1e3,maxSpeed:90},ga);class td{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,c=s.exported.now();for(;r.length>0&&c-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)c.zoom+=_.zoomDelta||0,c.bearing+=_.bearingDelta||0,c.pitch+=_.pitchDelta||0,_.panDelta&&c.pan._add(_.panDelta),_.around&&(c.around=_.around),_.pinchAround&&(c.pinchAround=_.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(c.pan.mag()){const _=mA(c.pan.mag(),p,s.extend({},Yh,r||{}));y.offset=c.pan.mult(_.amount/c.pan.mag()),y.center=this._map.transform.center,pA(y,_)}if(c.zoom){const _=mA(c.zoom,p,ed);y.zoom=this._map.transform.zoom+_.amount,pA(y,_)}if(c.bearing){const _=mA(c.bearing,p,pl);y.bearing=this._map.transform.bearing+s.clamp(_.amount,-179,179),pA(y,_)}if(c.pitch){const _=mA(c.pitch,p,Gc);y.pitch=this._map.transform.pitch+_.amount,pA(y,_)}if(y.zoom||y.bearing){const _=c.pinchAround===void 0?c.around:c.pinchAround;y.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),s.extend(y,{noMoveStart:!0})}}function pA(d,r){(!d.duration||d.duration<r.duration)&&(d.duration=r.duration,d.easing=r.easing)}function mA(d,r,c){const{maxSpeed:p,linearity:y,deceleration:_}=c,b=s.clamp(d*y/(r/1e3),-p,p),E=Math.abs(b)/(_*y);return{easing:c.easing,duration:1e3*E,amount:b*(E/2)}}class _i extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,p,y={}){const _=Q.mousePos(c.getCanvasContainer(),p),b=c.unproject(_);super(r,s.extend({point:_,lngLat:b,originalEvent:p},y)),this._defaultPrevented=!1,this.target=c}}class gA extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,p){const y=r==="touchend"?p.changedTouches:p.touches,_=Q.touchPos(c.getCanvasContainer(),y),b=_.map(U=>c.unproject(U)),E=_.reduce((U,D,k,P)=>U.add(D.div(P.length)),new s.pointGeometry(0,0));super(r,{points:_,point:E,lngLats:b,lngLat:c.unproject(E),originalEvent:p}),this._defaultPrevented=!1}}class ya extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,p){super(r,{originalEvent:p}),this._defaultPrevented=!1}}class rd{constructor(r,c){this._map=r,this._clickTolerance=c.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new ya(r.type,this._map,r))}mousedown(r,c){return this._mousedownPos=c,this._firePreventable(new _i(r.type,this._map,r))}mouseup(r){this._map.fire(new _i(r.type,this._map,r))}preclick(r){const c=s.extend({},r);c.type="preclick",this._map.fire(new _i(c.type,this._map,c))}click(r,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(r),this._map.fire(new _i(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new _i(r.type,this._map,r))}mouseover(r){this._map.fire(new _i(r.type,this._map,r))}mouseout(r){this._map.fire(new _i(r.type,this._map,r))}touchstart(r){return this._firePreventable(new gA(r.type,this._map,r))}touchmove(r){this._map.fire(new gA(r.type,this._map,r))}touchend(r){this._map.fire(new gA(r.type,this._map,r))}touchcancel(r){this._map.fire(new gA(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class nd{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(r){this._map.fire(new _i(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _i("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new _i(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class id{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,c){this.isEnabled()&&r.shiftKey&&r.button===0&&(Q.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(r,c){if(!this._active)return;const p=c;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=p,this._box||(this._box=Q.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const _=Math.min(y.x,p.x),b=Math.max(y.x,p.x),E=Math.min(y.y,p.y),U=Math.max(y.y,p.y);this._map._requestDomTask(()=>{this._box&&(Q.setTransform(this._box,`translate(${_}px,${E}px)`),this._box.style.width=b-_+"px",this._box.style.height=U-E+"px")})}mouseupWindow(r,c){if(!this._active||r.button!==0)return;const p=this._startPos,y=c;if(this.reset(),Q.suppressClick(),p.x!==y.x||p.y!==y.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:_=>_.fitScreenCoordinates(p,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(Q.remove(this._box),this._box=null),Q.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,c){return this._map.fire(new s.Event(r,{originalEvent:c}))}}function ml(d,r){const c={};for(let p=0;p<d.length;p++)c[d[p].identifier]=r[p];return c}class od{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,c,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const _=new s.pointGeometry(0,0);for(const b of y)_._add(b);return _.div(y.length)}(c),this.touches=ml(p,c)))}touchmove(r,c,p){if(this.aborted||!this.centroid)return;const y=ml(p,c);for(const _ in this.touches){const b=this.touches[_],E=y[_];(!E||E.dist(b)>30)&&(this.aborted=!0)}}touchend(r,c,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class gl{constructor(r){this.singleTap=new od(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,c,p){this.singleTap.touchstart(r,c,p)}touchmove(r,c,p){this.singleTap.touchmove(r,c,p)}touchend(r,c,p){const y=this.singleTap.touchend(r,c,p);if(y){const _=r.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(y)<30;if(_&&b||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class qn{constructor(){this._zoomIn=new gl({numTouches:1,numTaps:2}),this._zoomOut=new gl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,c,p){this._zoomIn.touchstart(r,c,p),this._zoomOut.touchstart(r,c,p)}touchmove(r,c,p){this._zoomIn.touchmove(r,c,p),this._zoomOut.touchmove(r,c,p)}touchend(r,c,p){const y=this._zoomIn.touchend(r,c,p),_=this._zoomOut.touchend(r,c,p);return y?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:b.getZoom()+1,around:b.unproject(y)},{originalEvent:r})}):_?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:b.getZoom()-1,around:b.unproject(_)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const hm={0:1,2:2};class lo{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(r,c){return!1}_move(r,c){return{}}mousedown(r,c){if(this._lastPoint)return;const p=Q.mouseButton(r);this._correctButton(r,p)&&(this._lastPoint=c,this._eventButton=p)}mousemoveWindow(r,c){const p=this._lastPoint;if(p){if(r.preventDefault(),function(y,_){const b=hm[_];return y.buttons===void 0||(y.buttons&b)!==b}(r,this._eventButton))this.reset();else if(this._moved||!(c.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(p,c)}}mouseupWindow(r){this._lastPoint&&Q.mouseButton(r)===this._eventButton&&(this._moved&&Q.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sd extends lo{mousedown(r,c){super.mousedown(r,c),this._lastPoint&&(this._active=!0)}_correctButton(r,c){return c===0&&!r.ctrlKey}_move(r,c){return{around:c,panDelta:c.sub(r)}}}class Xo extends lo{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const p=.8*(c.x-r.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(r){r.preventDefault()}}class Vs extends lo{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const p=-.5*(c.y-r.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(r){r.preventDefault()}}class dm{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0)}touchstart(r,c,p){return this._calculateTransform(r,c,p)}touchmove(r,c,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.preventDefault(),this._calculateTransform(r,c,p)}}touchend(r,c,p){this._calculateTransform(r,c,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,c,p){p.length>0&&(this._active=!0);const y=ml(p,c),_=new s.pointGeometry(0,0),b=new s.pointGeometry(0,0);let E=0;for(const D in y){const k=y[D],P=this._touches[D];P&&(_._add(k),b._add(k.sub(P)),E++,y[D]=k)}if(this._touches=y,E<this._minTouches||!b.mag())return;const U=b.div(E);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(E),panDelta:U}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Q.create("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class jc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(r){}_move(r,c,p){return{}}touchstart(r,c,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([c[0],c[1]]))}touchmove(r,c,p){if(!this._firstTwoTouches)return;r.preventDefault();const[y,_]=this._firstTwoTouches,b=yl(p,c,y),E=yl(p,c,_);if(!b||!E)return;const U=this._aroundCenter?null:b.add(E).div(2);return this._move([b,E],U,r)}touchend(r,c,p){if(!this._firstTwoTouches)return;const[y,_]=this._firstTwoTouches,b=yl(p,c,y),E=yl(p,c,_);b&&E||(this._active&&Q.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function yl(d,r,c){for(let p=0;p<d.length;p++)if(d[p].identifier===c)return r[p]}function ad(d,r){return Math.log(d/r)/Math.LN2}class Ad extends jc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,c){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(ad(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ad(this._distance,p),pinchAround:c}}}function _a(d,r){return 180*d.angleWith(r)/Math.PI}class Io extends jc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,c){const p=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:_a(this._vector,p),pinchAround:c}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const c=25/(Math.PI*this._minDiameter)*360,p=_a(r,this._startVector);return Math.abs(p)<c}}function _l(d){return Math.abs(d.y)>Math.abs(d.x)}class ld extends jc{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(r){this._lastPoints=r,_l(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,c,p){const y=r[0].sub(this._lastPoints[0]),_=r[1].sub(this._lastPoints[1]);if(!(this._map._cooperativeGestures&&p.touches.length<3)&&(this._valid=this.gestureBeginsVertically(y,_,p.timeStamp),this._valid))return this._lastPoints=r,this._active=!0,{pitchDelta:(y.y+_.y)/2*-.5}}gestureBeginsVertically(r,c,p){if(this._valid!==void 0)return this._valid;const y=r.mag()>=2,_=c.mag()>=2;if(!y&&!_)return;if(!y||!_)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const b=r.y>0==c.y>0;return _l(r)&&_l(c)&&b}}const yA={panStep:100,bearingStep:15,pitchStep:10};class Bt{constructor(){const r=yA;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let c=0,p=0,y=0,_=0,b=0;switch(r.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),_=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),_=1);break;case 38:r.shiftKey?y=1:(r.preventDefault(),b=-1);break;case 40:r.shiftKey?y=-1:(r.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:E=>{const U=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:cd,zoom:c?Math.round(U)+c*(r.shiftKey?2:1):U,bearing:E.getBearing()+p*this._bearingStep,pitch:E.getPitch()+y*this._pitchStep,offset:[-_*this._panStep,-b*this._panStep],center:E.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function cd(d){return d*(2-d)}const Zc=4.000244140625;class _A{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=r.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=s.exported.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,c!==0&&c%Zc==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(y*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),r.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=r,this._delta-=c,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=Q.mousePos(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform,c=()=>r._terrainEnabled()?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>Zc?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&D!==0&&(D=1/D);const k=c(),P=Math.pow(2,k),j=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):P;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(j*D))),this._type==="wheel"&&(this._startZoom=c(),this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:c(),y=this._startZoom,_=this._easing;let b,E=!1;if(this._type==="wheel"&&y&&_){const U=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),D=_(U);b=s.number(y,p,D),U<1?this._frameId||(this._frameId=!0):E=!0}else b=p,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!E,zoomDelta:b-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let c=s.ease;if(this._prevEase){const p=this._prevEase,y=(s.exported.now()-p.start)/p.duration,_=p.easing(y+.01)-p.easing(y),b=.27/Math.sqrt(_*_+1e-4)*.01,E=Math.sqrt(.0729-b*b);c=s.bezier(b,E,.25,1)}return this._prevEase={start:s.exported.now(),duration:r,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Q.create("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!s.window.document.fullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class vA{constructor(r,c){this._clickZoom=r,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ud{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,c){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(r.shiftKey?-1:1),around:p.unproject(c)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hd{constructor(){this._tap=new gl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(r,c,p){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=c[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(r,c,p))}touchmove(r,c,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=c[0],_=y.y-this._swipePoint.y;return this._swipePoint=y,r.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(r,c,p)}touchend(r,c,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(r,c,p)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dd{constructor(r,c,p){this._el=r,this._mousePan=c,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class fd{constructor(r,c,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=c,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class pd{constructor(r,c,p,y){this._el=r,this._touchZoom=c,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const xA=d=>d.zoom||d.drag||d.pitch||d.rotate;class md extends s.Event{}class vl{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,c){const p=s.sub([],c,r);this.radius=s.length(p[2]<0?s.div([],p,this.constants):[p[0],p[1],0])}projectRay(r){s.div(r,r,this.constants),s.normalize(r,r),s.mul$2(r,r,this.constants);const c=s.scale([],r,this.radius);if(c[2]>0){const p=s.scale([],[0,0,1],s.dot(c,[0,0,1])),y=s.scale([],s.normalize([],[c[0],c[1],0]),this.radius),_=s.add([],c,s.scale([],s.sub([],s.add([],y,p),c),2));c[0]=_[0],c[1]=_[1]}return c}}function va(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class xl{constructor(r,c){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new td(r),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new vl,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),s.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[y,_,b]of this._listeners)Q.addEventListener(y,_,y===s.window.document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[r,c,p]of this._listeners)Q.removeEventListener(r,c,r===s.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(r){const c=this._map,p=c.getCanvasContainer();this._add("mapEvent",new rd(c,r));const y=c.boxZoom=new id(c,r);this._add("boxZoom",y);const _=new qn,b=new ud;c.doubleClickZoom=new vA(b,_),this._add("tapZoom",_),this._add("clickZoom",b);const E=new hd;this._add("tapDragZoom",E);const U=c.touchPitch=new ld(c);this._add("touchPitch",U);const D=new Xo(r),k=new Vs(r);c.dragRotate=new fd(r,D,k),this._add("mouseRotate",D,["mousePitch"]),this._add("mousePitch",k,["mouseRotate"]);const P=new sd(r),j=new dm(c,r);c.dragPan=new dd(p,P,j),this._add("mousePan",P),this._add("touchPan",j,["touchZoom","touchRotate"]);const $=new Io,ee=new Ad;c.touchZoomRotate=new pd(p,ee,$,E),this._add("touchRotate",$,["touchPan","touchZoom"]),this._add("touchZoom",ee,["touchPan","touchRotate"]),this._add("blockableMapEvent",new nd(c));const X=c.scrollZoom=new _A(c,this);this._add("scrollZoom",X,["mousePan"]);const ae=c.keyboard=new Bt;this._add("keyboard",ae);for(const W of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[W]&&c[W].enable(r[W])}_add(r,c,p){this._handlers.push({handlerName:r,handler:c,allowed:p}),this._handlersById[r]=c}stop(r){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!xA(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,c,p){for(const y in r)if(y!==p&&(!c||c.indexOf(y)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const c=[];for(const p of r)this._el.contains(p.target)&&c.push(p);return c}handleEvent(r,c){this._updatingCamera=!0;const p=r.type==="renderFrame",y=p?void 0:r,_={needsRenderFrame:!1},b={},E={},U=r.touches?this._getMapTouches(r.touches):void 0,D=U?Q.touchPos(this._el,U):p?void 0:Q.mousePos(this._el,r);for(const{handlerName:j,handler:$,allowed:ee}of this._handlers){if(!$.isEnabled())continue;let X;this._blockedByActive(E,ee,j)?$.reset():$[c||r.type]&&(X=$[c||r.type](r,D,U),this.mergeHandlerResult(_,b,X,j,y),X&&X.needsRenderFrame&&this._triggerRenderFrame()),(X||$.isActive())&&(E[j]=$)}const k={};for(const j in this._previousActiveHandlers)E[j]||(k[j]=y);this._previousActiveHandlers=E,(Object.keys(k).length||va(_))&&(this._changes.push([_,b,k]),this._triggerRenderFrame()),(Object.keys(E).length||va(_))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:P}=_;P&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],P(this._map))}mergeHandlerResult(r,c,p,y,_){if(!p)return;s.extend(r,p);const b={handlerName:y,originalEvent:p.originalEvent||_};p.zoomDelta!==void 0&&(c.zoom=b),p.panDelta!==void 0&&(c.drag=b),p.pitchDelta!==void 0&&(c.pitch=b),p.bearingDelta!==void 0&&(c.rotate=b)}_applyChanges(){const r={},c={},p={};for(const[y,_,b]of this._changes)y.panDelta&&(r.panDelta=(r.panDelta||new s.pointGeometry(0,0))._add(y.panDelta)),y.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(r.around=y.around),y.aroundCoord!==void 0&&(r.aroundCoord=y.aroundCoord),y.pinchAround!==void 0&&(r.pinchAround=y.pinchAround),y.noInertia&&(r.noInertia=y.noInertia),s.extend(c,_),s.extend(p,b);this._updateMapTransform(r,c,p),this._changes=[]}_updateMapTransform(r,c,p){const y=this._map,_=y.transform,b=Ae=>[Ae.x,Ae.y,Ae.z];if((Ae=>{const ue=this._eventsInProgress.drag;return ue&&!this._handlersById[ue.handlerName].isActive()})()&&!va(r)){const Ae=_.zoom;_.cameraElevationReference="sea",_.recenterOnTerrain(),_.cameraElevationReference="ground",Ae!==_.zoom&&this._map._update(!0)}if(!va(r))return this._fireEvents(c,p,!0);let{panDelta:E,zoomDelta:U,bearingDelta:D,pitchDelta:k,around:P,aroundCoord:j,pinchAround:$}=r;$!==void 0&&(P=$),(Ae=>c.drag&&!this._eventsInProgress.drag)()&&P&&(this._dragOrigin=b(_.pointCoordinate3D(P)),this._trackingEllipsoid.setup(_._camera.position,this._dragOrigin)),_.cameraElevationReference="sea",y._stop(!0),P=P||y.transform.centerPoint,D&&(_.bearing+=D),k&&(_.pitch+=k),_._updateCameraState();const ee=[0,0,0];if(E){const Ae=_.screenPointToMercatorRay(P),ue=_.screenPointToMercatorRay(P.sub(E)),J=this._trackingEllipsoid.projectRay(Ae.dir),he=this._trackingEllipsoid.projectRay(ue.dir);ee[0]=he[0]-J[0],ee[1]=he[1]-J[1]}const X=_.zoom,ae=[0,0,0];if(U){const Ae=b(j||_.pointCoordinate3D(P)),ue={dir:s.normalize([],s.sub([],Ae,_._camera.position))},J=_.screenPointToMercatorRay(_.centerPoint);if(ue.dir[2]<0){const he=s.altitudeFromMercatorZ(Ae[2],Ae[1]),ye=_.rayIntersectionCoordinate(_.pointRayIntersection(_.centerPoint,he)),De=_.zoomDeltaToMovement(b(ye),U)*(J.dir[2]/ue.dir[2]);s.scale(ae,ue.dir,De)}else if(_._terrainEnabled()){const he=_.zoomDeltaToMovement(Ae,U);s.scale(ae,ue.dir,he)}}const W=s.add(ee,ee,ae);_._translateCameraConstrained(W),U&&Math.abs(_.zoom-X)>1e-4&&_.recenterOnTerrain(),_.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(c,p,!0)}_fireEvents(r,c,p){const y=xA(this._eventsInProgress),_=xA(r),b={};for(const k in r){const{originalEvent:P}=r[k];this._eventsInProgress[k]||(b[`${k}start`]=P),this._eventsInProgress[k]=r[k]}!y&&_&&this._fireEvent("movestart",_.originalEvent);for(const k in b)this._fireEvent(k,b[k]);_&&this._fireEvent("move",_.originalEvent);for(const k in r){const{originalEvent:P}=r[k];this._fireEvent(k,P)}const E={};let U;for(const k in this._eventsInProgress){const{handlerName:P,originalEvent:j}=this._eventsInProgress[k];this._handlersById[P].isActive()||(delete this._eventsInProgress[k],U=c[P]||j,E[`${k}end`]=U)}for(const k in E)this._fireEvent(k,E[k]);const D=xA(this._eventsInProgress);if(p&&(y||_)&&!D){this._updatingCamera=!0;const k=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),P=j=>j!==0&&-this._bearingSnap<j&&j<this._bearingSnap;k?(P(k.bearing||this._map.getBearing())&&(k.bearing=0),this._map.easeTo(k,{originalEvent:U})):(this._map.fire(new s.Event("moveend",{originalEvent:U})),P(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,c){this._map.fire(new s.Event(r,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new md("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Xc="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class gd extends s.Evented{constructor(r,c){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=c.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,c){return this.jumpTo({center:r},c)}panBy(r,c,p){return r=s.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,s.extend({offset:r},c),p)}panTo(r,c,p){return this.easeTo(s.extend({center:r},c),p)}getZoom(){return this.transform.zoom}setZoom(r,c){return this.jumpTo({zoom:r},c),this}zoomTo(r,c,p){return this.easeTo(s.extend({zoom:r},c),p)}zoomIn(r,c){return this.zoomTo(this.getZoom()+1,r,c),this}zoomOut(r,c){return this.zoomTo(this.getZoom()-1,r,c),this}getBearing(){return this.transform.bearing}setBearing(r,c){return this.jumpTo({bearing:r},c),this}getPadding(){return this.transform.padding}setPadding(r,c){return this.jumpTo({padding:r},c),this}rotateTo(r,c,p){return this.easeTo(s.extend({bearing:r},c),p)}resetNorth(r,c){return this.rotateTo(0,s.extend({duration:1e3},r),c),this}resetNorthPitch(r,c){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},r),c),this}snapToNorth(r,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,c):this}getPitch(){return this.transform.pitch}setPitch(r,c){return this.jumpTo({pitch:r},c),this}cameraForBounds(r,c){r=s.LngLatBounds.convert(r);const p=c&&c.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),p,c)}_extendCameraOptions(r){const c={top:0,bottom:0,right:0,left:0};if(typeof(r=s.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const p=r.padding;r.padding={top:p,bottom:p,right:p,left:p}}return r.padding=s.extend(c,r.padding),r}_cameraForBoxAndBearing(r,c,p,y){const _=this._extendCameraOptions(y),b=this.transform,E=b.padding,U=b.project(s.LngLat.convert(r)),D=b.project(s.LngLat.convert(c)),k=U.rotate(-s.degToRad(p)),P=D.rotate(-s.degToRad(p)),j=new s.pointGeometry(Math.max(k.x,P.x),Math.max(k.y,P.y)),$=new s.pointGeometry(Math.min(k.x,P.x),Math.min(k.y,P.y)),ee=j.sub($),X=(b.width-(E.left+E.right+_.padding.left+_.padding.right))/ee.x,ae=(b.height-(E.top+E.bottom+_.padding.top+_.padding.bottom))/ee.y;if(ae<0||X<0)return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const W=Math.min(b.scaleZoom(b.scale*Math.min(X,ae)),_.maxZoom),Ae=typeof _.offset.x=="number"?new s.pointGeometry(_.offset.x,_.offset.y):s.pointGeometry.convert(_.offset),ue=new s.pointGeometry((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(p*Math.PI/180),J=Ae.add(ue).mult(b.scale/b.zoomScale(W));return{center:b.unproject(U.add(D).div(2).sub(J)),zoom:W,bearing:p}}_cameraForBox(r,c,p,y,_){const b=this._extendCameraOptions(_);p=p||0,y=y||0,r=s.LngLat.convert(r),c=s.LngLat.convert(c);const E=this.transform.clone();E.padding=b.padding;const U=this.getFreeCameraOptions(),D=new s.LngLat(.5*(r.lng+c.lng),.5*(r.lat+c.lat)),k=.5*(p+y);if(E._camera.position[2]<s.mercatorZfromAltitude(k,D.lat))return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");U.lookAtPoint(D),E.setFreeCameraOptions(U);const P=s.MercatorCoordinate.fromLngLat(r),j=s.MercatorCoordinate.fromLngLat(c),$=E.pointRayIntersection(E.centerPoint,k),ee=[(X=E.rayIntersectionCoordinate($)).x,X.y,X.z];var X;const ae=E.screenPointToMercatorRay(E.centerPoint);let W,Ae=0;do{const ue=Math.floor(E.zoom),J=1<<ue,he=Math.min(J*P.x,J*j.x),ye=Math.min(J*P.y,J*j.y),De=Math.max(J*P.x,J*j.x),Le=Math.max(J*P.y,J*j.y),Ve=new ge([he,ye,p],[De,Le,y]),Ge=we.fromInvProjectionMatrix(E.invProjMatrix,E.worldSize,ue);if(Ve.intersects(Ge)!==2){W&&(E._camera.position=s.scaleAndAdd([],E._camera.position,ae.dir,-W),E._updateStateFromCamera());break}const at=s.sub([],E._camera.position,ee);W=.5*s.length(at),E._camera.position=s.scaleAndAdd([],E._camera.position,ae.dir,W);try{E._updateStateFromCamera()}catch{return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++Ae<10);return{center:E.center,zoom:E.zoom,bearing:E.bearing,pitch:E.pitch}}fitBounds(r,c,p){return this._fitInternal(this.cameraForBounds(r,c),c,p)}_raycastElevationBox(r,c){const p=this.transform.elevation;if(!p)return;const y=new s.pointGeometry(r.x,c.y),_=new s.pointGeometry(c.x,r.y),b=p.pointCoordinate(r);if(!b)return;const E=p.pointCoordinate(c);if(!E)return;const U=p.pointCoordinate(y);if(!U)return;const D=p.pointCoordinate(_);if(!D)return;const k=new s.MercatorCoordinate(b[0],b[1]).toLngLat(),P=new s.MercatorCoordinate(E[0],E[1]).toLngLat(),j=new s.MercatorCoordinate(U[0],U[1]).toLngLat(),$=new s.MercatorCoordinate(D[0],D[1]).toLngLat(),ee=Math.min(k.lng,Math.min(P.lng,Math.min(j.lng,$.lng))),X=Math.min(k.lat,Math.min(P.lat,Math.min(j.lat,$.lat))),ae=Math.max(k.lng,Math.max(P.lng,Math.max(j.lng,$.lng))),W=Math.max(k.lat,Math.max(P.lat,Math.max(j.lat,$.lat))),Ae=Math.min(b[3],Math.min(E[3],Math.min(U[3],D[3]))),ue=Math.max(b[3],Math.max(E[3],Math.max(U[3],D[3])));return{minLngLat:new s.LngLat(ee,X),maxLngLat:new s.LngLat(ae,W),minAltitude:Ae,maxAltitude:ue}}fitScreenCoordinates(r,c,p,y,_){let b,E,U,D;const k=s.pointGeometry.convert(r),P=s.pointGeometry.convert(c),j=this._raycastElevationBox(k,P);if(j)b=j.minLngLat,E=j.maxLngLat,U=j.minAltitude,D=j.maxAltitude;else{if(this.transform.anyCornerOffEdge(k,P))return this;b=this.transform.pointLocation(k),E=this.transform.pointLocation(P)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(s.pointGeometry.convert(r)),this.transform.pointLocation(s.pointGeometry.convert(c)),p,y):this._cameraForBox(b,E,U,D,y),y,_)}_fitInternal(r,c,p){return r?(delete(c=s.extend(r,c)).padding,c.linear?this.easeTo(c,p):this.flyTo(c,p)):this}jumpTo(r,c){this.stop();const p=this.transform;let y=!1,_=!1,b=!1;return"zoom"in r&&p.zoom!==+r.zoom&&(y=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=s.LngLat.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(_=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(b=!0,p.pitch=+r.pitch),r.padding==null||p.isPaddingEqual(r.padding)||(p.padding=r.padding),this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),y&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),_&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),b&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c))}getFreeCameraOptions(){return this.transform.projection.name!=="mercator"&&s.warnOnce(Xc),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,c){const p=this.transform;if(p.projection.name!=="mercator")return void s.warnOnce(Xc);this.stop();const y=p.zoom,_=p.pitch,b=p.bearing;p.setFreeCameraOptions(r);const E=y!==p.zoom,U=_!==p.pitch,D=b!==p.bearing;return this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),E&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),D&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),U&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)),this}easeTo(r,c){this._stop(!1,r.easeId),((r=s.extend({offset:[0,0],duration:500,easing:s.ease},r)).animate===!1||!r.essential&&s.exported.prefersReducedMotion)&&(r.duration=0);const p=this.transform,y=this.getZoom(),_=this.getBearing(),b=this.getPitch(),E=this.getPadding(),U="zoom"in r?+r.zoom:y,D="bearing"in r?this._normalizeBearing(r.bearing,_):_,k="pitch"in r?+r.pitch:b,P="padding"in r?r.padding:p.padding,j=s.pointGeometry.convert(r.offset);let $=p.centerPoint.add(j);const ee=p.pointLocation($),X=s.LngLat.convert(r.center||ee);this._normalizeCenter(X);const ae=p.project(ee),W=p.project(X).sub(ae),Ae=p.zoomScale(U-y);let ue,J;r.around&&(ue=s.LngLat.convert(r.around),J=p.locationPoint(ue));const he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||U!==y,this._rotating=this._rotating||_!==D,this._pitching=this._pitching||k!==b,this._padding=!p.isPaddingEqual(P),this._easeId=r.easeId,this._prepareEase(c,r.noMoveStart,he),this._ease(ye=>{if(this._zooming&&(p.zoom=s.number(y,U,ye)),this._rotating&&(p.bearing=s.number(_,D,ye)),this._pitching&&(p.pitch=s.number(b,k,ye)),this._padding&&(p.interpolatePadding(E,P,ye),$=p.centerPoint.add(j)),ue)p.setLocationAtPoint(ue,J);else{const De=p.zoomScale(p.zoom-y),Le=U>y?Math.min(2,Ae):Math.max(.5,Ae),Ve=Math.pow(Le,1-ye),Ge=p.unproject(ae.add(W.mult(ye*Ve)).mult(De));p.setLocationAtPoint(p.renderWorldCopies?Ge.wrap():Ge,$)}this._fireMoveEvents(c)},ye=>{p.recenterOnTerrain(),this._afterEase(c,ye)},r),this}_prepareEase(r,c,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||p.moving||this.fire(new s.Event("movestart",r)),this._zooming&&!p.zooming&&this.fire(new s.Event("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new s.Event("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new s.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new s.Event("move",r)),this._zooming&&this.fire(new s.Event("zoom",r)),this._rotating&&this.fire(new s.Event("rotate",r)),this._pitching&&this.fire(new s.Event("pitch",r))}_afterEase(r,c){if(this._easeId&&c&&this._easeId===c)return;delete this._easeId,this.transform.cameraElevationReference="ground";const p=this._zooming,y=this._rotating,_=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new s.Event("zoomend",r)),y&&this.fire(new s.Event("rotateend",r)),_&&this.fire(new s.Event("pitchend",r)),this.fire(new s.Event("moveend",r))}flyTo(r,c){if(!r.essential&&s.exported.prefersReducedMotion){const ft=s.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ft,c)}this.stop(),r=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},r);const p=this.transform,y=this.getZoom(),_=this.getBearing(),b=this.getPitch(),E=this.getPadding(),U="zoom"in r?s.clamp(+r.zoom,p.minZoom,p.maxZoom):y,D="bearing"in r?this._normalizeBearing(r.bearing,_):_,k="pitch"in r?+r.pitch:b,P="padding"in r?r.padding:p.padding,j=p.zoomScale(U-y),$=s.pointGeometry.convert(r.offset);let ee=p.centerPoint.add($);const X=p.pointLocation(ee),ae=s.LngLat.convert(r.center||X);this._normalizeCenter(ae);const W=p.project(X),Ae=p.project(ae).sub(W);let ue=r.curve;const J=Math.max(p.width,p.height),he=J/j,ye=Ae.mag();if("minZoom"in r){const ft=s.clamp(Math.min(r.minZoom,y,U),p.minZoom,p.maxZoom),bt=J/p.zoomScale(ft-y);ue=Math.sqrt(bt/ye*2)}const De=ue*ue;function Le(ft){const bt=(he*he-J*J+(ft?-1:1)*De*De*ye*ye)/(2*(ft?he:J)*De*ye);return Math.log(Math.sqrt(bt*bt+1)-bt)}function Ve(ft){return(Math.exp(ft)-Math.exp(-ft))/2}function Ge(ft){return(Math.exp(ft)+Math.exp(-ft))/2}const at=Le(0);let He=function(ft){return Ge(at)/Ge(at+ue*ft)},ht=function(ft){return J*((Ge(at)*(Ve(bt=at+ue*ft)/Ge(bt))-Ve(at))/De)/ye;var bt},Qe=(Le(1)-at)/ue;if(Math.abs(ye)<1e-6||!isFinite(Qe)){if(Math.abs(J-he)<1e-6)return this.easeTo(r,c);const ft=he<J?-1:1;Qe=Math.abs(Math.log(he/J))/ue,ht=function(){return 0},He=function(bt){return Math.exp(ft*ue*bt)}}return r.duration="duration"in r?+r.duration:1e3*Qe/("screenSpeed"in r?+r.screenSpeed/ue:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=_!==D,this._pitching=k!==b,this._padding=!p.isPaddingEqual(P),this._prepareEase(c,!1),this._ease(ft=>{const bt=ft*Qe,Pt=1/He(bt);p.zoom=ft===1?U:y+p.scaleZoom(Pt),this._rotating&&(p.bearing=s.number(_,D,ft)),this._pitching&&(p.pitch=s.number(b,k,ft)),this._padding&&(p.interpolatePadding(E,P,ft),ee=p.centerPoint.add($));const Ht=ft===1?ae:p.unproject(W.add(Ae.mult(ht(bt))).mult(Pt));p.setLocationAtPoint(p.renderWorldCopies?Ht.wrap():Ht,ee),p._updateCenterElevation(),this._fireMoveEvents(c)},()=>this._afterEase(c),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,c)}if(!r){const p=this.handlers;p&&p.stop(!1)}return this}_ease(r,c,p){p.animate===!1||p.duration===0?(r(1),c()):(this._easeStart=s.exported.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,c){r=s.wrap(r,-180,180);const p=Math.abs(r-c);return Math.abs(r-360-c)<p&&(r-=360),Math.abs(r+360-c)<p&&(r+=360),r}_normalizeCenter(r){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const p=r.lng-c.center.lng;r.lng+=p>180?-360:p<-180?360:0}}class Wc{constructor(r={}){this.options=r,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const c=this.options&&this.options.compact;return this._map=r,this._container=Q.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Q.create("button","mapboxgl-ctrl-attrib-button",this._container),Q.create("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden",!0),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Q.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){Q.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,c){const p=this._map._getUIString(`AttributionControl.${c}`);r.setAttribute("aria-label",p),r.firstElementChild&&r.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(r){const p=c.reduce((y,_,b)=>(_.value&&(y+=`${_.key}=${_.value}${b<c.length-1?"&":""}`),y),"?");r.href=`${s.config.FEEDBACK_URL}/${p}${this._map._hash?this._map._hash.getHashString(!0):""}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(y=>typeof y!="string"?"":y)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const c=this._map.style._sourceCaches;for(const y in c){const _=c[y];if(_.used){const b=_.getSource();b.attribution&&r.indexOf(b.attribution)<0&&r.push(b.attribution)}}r.sort((y,_)=>y.length-_.length),r=r.filter((y,_)=>{for(let b=_+1;b<r.length;b++)if(r[b].indexOf(y)>=0)return!1;return!0});const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class $c{constructor(){s.bindAll(["_updateLogo"],this),s.bindAll(["_updateCompact"],this)}onAdd(r){this._map=r,this._container=Q.create("div","mapboxgl-ctrl");const c=Q.create("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){Q.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const c in r){const p=r[c].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const c=r[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class qc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const c=++this._id;return this._queue.push({callback:r,id:c,cancelled:!1}),c}remove(r){const c=this._currentlyRunning,p=c?this._queue.concat(c):this._queue;for(const y of p)if(y.id===r)return void(y.cancelled=!0)}run(r=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const p of c)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Jc(d,r,c){if(d=new s.LngLat(d.lng,d.lat),r){const p=new s.LngLat(d.lng-360,d.lat),y=new s.LngLat(d.lng+360,d.lat),_=360*Math.ceil(Math.abs(d.lng-c.center.lng)/360),b=c.locationPoint(d).distSqr(r),E=r.x<0||r.y<0||r.x>c.width||r.y>c.height;c.locationPoint(p).distSqr(r)<b&&(E||Math.abs(p.lng-c.center.lng)<_)?d=p:c.locationPoint(y).distSqr(r)<b&&(E||Math.abs(y.lng-c.center.lng)<_)&&(d=y)}for(;Math.abs(d.lng-c.center.lng)>180;){const p=c.locationPoint(d);if(p.x>=0&&p.y>=0&&p.x<=c.width&&p.y<=c.height)break;d.lng>c.center.lng?d.lng-=360:d.lng+=360}return d}const wl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class wA extends s.Evented{constructor(r,c){if(super(),(r instanceof s.window.HTMLElement||c)&&(r=s.extend({element:r},c)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=s.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=Q.create("div"),this._element.setAttribute("aria-label","Map marker");const y=Q.createNS("http://www.w3.org/2000/svg","svg"),_=41,b=27;y.setAttributeNS(null,"display","block"),y.setAttributeNS(null,"height",`${_}px`),y.setAttributeNS(null,"width",`${b}px`),y.setAttributeNS(null,"viewBox",`0 0 ${b} ${_}`);const E=Q.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"stroke","none"),E.setAttributeNS(null,"stroke-width","1"),E.setAttributeNS(null,"fill","none"),E.setAttributeNS(null,"fill-rule","evenodd");const U=Q.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"fill-rule","nonzero");const D=Q.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"transform","translate(3.0, 29.0)"),D.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of k){const J=Q.createNS("http://www.w3.org/2000/svg","ellipse");J.setAttributeNS(null,"opacity","0.04"),J.setAttributeNS(null,"cx","10.5"),J.setAttributeNS(null,"cy","5.80029008"),J.setAttributeNS(null,"rx",ue.rx),J.setAttributeNS(null,"ry",ue.ry),D.appendChild(J)}const P=Q.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill",this._color);const j=Q.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),P.appendChild(j);const $=Q.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");const ee=Q.createNS("http://www.w3.org/2000/svg","path");ee.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(ee);const X=Q.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const ae=Q.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(8.0, 8.0)");const W=Q.createNS("http://www.w3.org/2000/svg","circle");W.setAttributeNS(null,"fill","#000000"),W.setAttributeNS(null,"opacity","0.25"),W.setAttributeNS(null,"cx","5.5"),W.setAttributeNS(null,"cy","5.5"),W.setAttributeNS(null,"r","5.4999962");const Ae=Q.createNS("http://www.w3.org/2000/svg","circle");Ae.setAttributeNS(null,"fill","#FFFFFF"),Ae.setAttributeNS(null,"cx","5.5"),Ae.setAttributeNS(null,"cy","5.5"),Ae.setAttributeNS(null,"r","5.4999962"),ae.appendChild(W),ae.appendChild(Ae),U.appendChild(D),U.appendChild(P),U.appendChild($),U.appendChild(X),U.appendChild(ae),y.appendChild(U),y.setAttributeNS(null,"height",_*this._scale+"px"),y.setAttributeNS(null,"width",b*this._scale+"px"),this._element.appendChild(y),this._offset=s.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()});const p=this._element.classList;for(const y in wl)p.remove(`mapboxgl-marker-anchor-${y}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),Q.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=s.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const c=r.code,p=r.charCode||r.keyCode;c!=="Space"&&c!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(r){const c=r.originalEvent.target,p=this._element;this._popup&&(c===p||p.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const r=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(r))return void this._clearFadeTimer();const c=this._map.unproject(r);let p=!1;if(this._map.transform._terrainEnabled()&&this._map.getTerrain()){const _=this._map.getFreeCameraOptions();if(_.position){const b=_.position.toLngLat();p=b.distanceTo(c)<.9*b.distanceTo(this._lngLat)}}const y=(1-this._map._queryFogOpacity(c))*(p?.2:1);this._element.style.opacity=`${y}`,this._popup&&this._popup._setOpacity(`${y}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(r){const c=this._map.transform;return!!r&&r.x>=0&&r.x<c.width&&r.y>=0&&r.y<c.height}_update(r){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Jc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(c=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let p="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?p="rotateX(0deg)":this._pitchAlignment==="map"&&(p=`rotateX(${this._map.getPitch()}deg)`),r&&r.type!=="moveend"||(this._pos=this._pos.round()),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&Q.setTransform(this._element,`${wl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${p} ${c}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})}_transformedOffset(){if(!this._defaultMarker)return this._offset;const r=this._map.transform,c=this._offset.mult(this._scale);return this._rotationAlignment==="map"&&c._rotate(r.angle),this._pitchAlignment==="map"&&(c.y*=Math.cos(r._pitch)),c}getOffset(){return this._offset}setOffset(r){return this._offset=s.pointGeometry.convert(r),this._update(),this}_onMove(r){if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(r){this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class yd{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const c=s.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,c,p){this._start=this.getValue(c),this._end=r,this._startTime=c,this._endTime=c+p}}const _d={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},{HTMLImageElement:BA,HTMLElement:vd,ImageBitmap:_s}=s.window,xd={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function bA(d){d.parentNode&&d.parentNode.removeChild(d)}const wd={showCompass:!0,showZoom:!0,visualizePitch:!1};class Yc{constructor(r,c,p=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Xo({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,p&&(this.mousePitch=new Vs({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Q.addEventListener(c,"mousedown",this.mousedown),Q.addEventListener(c,"touchstart",this.touchstart,{passive:!1}),Q.addEventListener(c,"touchmove",this.touchmove),Q.addEventListener(c,"touchend",this.touchend),Q.addEventListener(c,"touchcancel",this.reset)}down(r,c){this.mouseRotate.mousedown(r,c),this.mousePitch&&this.mousePitch.mousedown(r,c),Q.disableDrag()}move(r,c){const p=this.map,y=this.mouseRotate.mousemoveWindow(r,c);if(y&&y.bearingDelta&&p.setBearing(p.getBearing()+y.bearingDelta),this.mousePitch){const _=this.mousePitch.mousemoveWindow(r,c);_&&_.pitchDelta&&p.setPitch(p.getPitch()+_.pitchDelta)}}off(){const r=this.element;Q.removeEventListener(r,"mousedown",this.mousedown),Q.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),Q.removeEventListener(r,"touchmove",this.touchmove),Q.removeEventListener(r,"touchend",this.touchend),Q.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){Q.enableDrag(),Q.removeEventListener(s.window,"mousemove",this.mousemove),Q.removeEventListener(s.window,"mouseup",this.mouseup)}mousedown(r){this.down(s.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Q.mousePos(this.element,r)),Q.addEventListener(s.window,"mousemove",this.mousemove),Q.addEventListener(s.window,"mouseup",this.mouseup)}mousemove(r){this.move(r,Q.mousePos(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Q.touchPos(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=Q.touchPos(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const eu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let vs,Bl=0,CA=!1;const tu={maxWidth:100,unit:"metric"};function ru(d,r,c){const p=c&&c.maxWidth||100,y=d._container.getBoundingClientRect().height/2,_=d.unproject([0,y]),b=d.unproject([p,y]),E=_.distanceTo(b);if(c&&c.unit==="imperial"){const U=3.2808*E;U>5280?xa(r,p,U/5280,d._getUIString("ScaleControl.Miles"),d):xa(r,p,U,d._getUIString("ScaleControl.Feet"),d)}else c&&c.unit==="nautical"?xa(r,p,E/1852,d._getUIString("ScaleControl.NauticalMiles"),d):E>=1e3?xa(r,p,E/1e3,d._getUIString("ScaleControl.Kilometers"),d):xa(r,p,E,d._getUIString("ScaleControl.Meters"),d)}function xa(d,r,c,p,y){const _=function(E){const U=Math.pow(10,`${Math.floor(E)}`.length-1);let D=E/U;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(k){const P=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*P)/P}(D),U*D}(c),b=_/c;y._requestDomTask(()=>{d.style.width=r*b+"px",d.innerHTML=`${_}&nbsp;${p}`})}const fm={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},pm=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),wa={version:s.version,supported:F,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends gd{constructor(d){if((d=s.extend({},xd,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Vc(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._optimizeForTerrain=d.optimizeForTerrain,this._renderTaskQueue=new qc,this._domRenderTaskQueue=new qc,this._controls=[],this._markers=[],this._mapId=s.uniqueId(),this._locale=s.extend({},_d,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new yd(0),this._requestManager=new s.RequestManager(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,typeof d.container=="string"){if(this._container=s.window.document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof vd))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new xl(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),this._hash=d.hash&&new fl(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,s.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),d.attributionControl&&this.addControl(new Wc({customAttribution:d.customAttribution})),this._logoControl=new $c,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new s.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new s.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(d,r){if(r===void 0&&(r=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=d.onAdd(this);this._controls.push(d);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(d);return r>-1&&this._controls.splice(r,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){const[r,c]=this._containerDimensions();if(r===this.transform.width&&c===this.transform.height)return this;this._resizeCanvas(r,c),this.transform.resize(r,c),this.painter.resize(Math.ceil(r),Math.ceil(c));const p=!this._moving;return p&&this.fire(new s.Event("movestart",d)).fire(new s.Event("move",d)),this.fire(new s.Event("resize",d)),p&&this.fire(new s.Event("moveend",d)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(s.LngLatBounds.convert(d)),this._update()}setMinZoom(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d??22)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this._update()}getProjection(){return this.transform.getProjection()}setProjection(d){this._lazyInitEmptyStyle(),typeof d=="string"&&(d={name:d}),this._runtimeProjection=d,this.style.updateProjection()}project(d){return this.transform.locationPoint3D(s.LngLat.convert(d))}unproject(d){return this.transform.pointLocation3D(s.pointGeometry.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(d,r,c){if(d==="mouseenter"||d==="mouseover"){let p=!1;const y=b=>{const E=r.filter(D=>this.getLayer(D)),U=E.length?this.queryRenderedFeatures(b.point,{layers:E}):[];U.length?p||(p=!0,c.call(this,new _i(d,this,b.originalEvent,{features:U}))):p=!1},_=()=>{p=!1};return{layers:new Set(r),listener:c,delegates:{mousemove:y,mouseout:_}}}if(d==="mouseleave"||d==="mouseout"){let p=!1;const y=b=>{const E=r.filter(U=>this.getLayer(U));(E.length?this.queryRenderedFeatures(b.point,{layers:E}):[]).length?p=!0:p&&(p=!1,c.call(this,new _i(d,this,b.originalEvent)))},_=b=>{p&&(p=!1,c.call(this,new _i(d,this,b.originalEvent)))};return{layers:new Set(r),listener:c,delegates:{mousemove:y,mouseout:_}}}{const p=y=>{const _=r.filter(E=>this.getLayer(E)),b=_.length?this.queryRenderedFeatures(y.point,{layers:_}):[];b.length&&(y.features=b,c.call(this,y),delete y.features)};return{layers:new Set(r),listener:c,delegates:{[d]:p}}}}on(d,r,c){if(c===void 0)return super.on(d,r);Array.isArray(r)||(r=[r]);const p=this._createDelegatedListener(d,r,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(d,r,c){if(c===void 0)return super.once(d,r);Array.isArray(r)||(r=[r]);const p=this._createDelegatedListener(d,r,c);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(d,r,c){if(c===void 0)return super.off(d,r);r=new Set(Array.isArray(r)?r:[r]);const p=(_,b)=>{if(_.size!==b.size)return!1;for(const E of _)if(!b.has(E))return!1;return!0},y=this._delegatedListeners?this._delegatedListeners[d]:void 0;return y&&(_=>{for(let b=0;b<_.length;b++){const E=_[b];if(E.listener===c&&p(E.layers,r)){for(const U in E.delegates)this.off(U,E.delegates[U]);return _.splice(b,1),this}}})(y),this}queryRenderedFeatures(d,r){return this.style?(r!==void 0||d===void 0||d instanceof s.pointGeometry||Array.isArray(d)||(r=d,d=void 0),this.style.queryRenderedFeatures(d=d||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(d,r){return this.style.querySourceFeatures(d,r)}queryTerrainElevation(d,r){const c=this.transform.elevation;return c?(r=s.extend({},{exaggerated:!0},r),c.getAtPoint(s.MercatorCoordinate.fromLngLat(d),null,r.exaggerated)):null}setStyle(d,r){return(r=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&d?(this._diffStyle(d,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(d,r))}_getUIString(d){const r=this._locale[d];if(r==null)throw new Error(`Missing UI string '${d}'`);return r}_updateStyle(d,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),d&&(this.style=new Un(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Un(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,r){if(typeof d=="string"){const c=this._requestManager.normalizeStyleURL(d),p=this._requestManager.transformRequest(c,s.ResourceType.Style);s.getJSON(p,(y,_)=>{y?this.fire(new s.ErrorEvent(y)):_&&this._updateDiff(_,r)})}else typeof d=="object"&&this._updateDiff(d,r)}_updateDiff(d,r){try{this.style.setState(d)&&this._update(!0)}catch(c){s.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(d,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.warnOnce("There is no style added to the map.")}addSource(d,r){return this._lazyInitEmptyStyle(),this.style.addSource(d,r),this._update(!0)}isSourceLoaded(d){const r=this.style&&this.style._getSourceCaches(d);if(r.length!==0)return r.every(c=>c.loaded());this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${d}'`)))}areTilesLoaded(){const d=this.style&&this.style._sourceCaches;for(const r in d){const c=d[r]._tiles;for(const p in c){const y=c[p];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}addSourceType(d,r,c){return this._lazyInitEmptyStyle(),this.style.addSourceType(d,r,c)}removeSource(d){return this.style.removeSource(d),this._updateTerrain(),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,r,{pixelRatio:c=1,sdf:p=!1,stretchX:y,stretchY:_,content:b}={}){if(this._lazyInitEmptyStyle(),r instanceof BA||_s&&r instanceof _s){const{width:E,height:U,data:D}=s.exported.getImageData(r);this.style.addImage(d,{data:new s.RGBAImage({width:E,height:U},D),pixelRatio:c,stretchX:y,stretchY:_,content:b,sdf:p,version:0})}else{if(r.width===void 0||r.height===void 0)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:U,data:D}=r,k=r;this.style.addImage(d,{data:new s.RGBAImage({width:E,height:U},new Uint8Array(D)),pixelRatio:c,stretchX:y,stretchY:_,content:b,sdf:p,version:0,userImage:k}),k.onAdd&&k.onAdd(this,d)}}}updateImage(d,r){const c=this.style.getImage(d);if(!c)return this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=r instanceof BA||_s&&r instanceof _s?s.exported.getImageData(r):r,{width:y,height:_,data:b}=p;return y===void 0||_===void 0?this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):y!==c.data.width||_!==c.data.height?this.fire(new s.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(c.data.replace(b,!(r instanceof BA||_s&&r instanceof _s)),void this.style.updateImage(d,c))}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,r){s.getImage(this._requestManager.transformRequest(d,s.ResourceType.Image),(c,p)=>{r(c,p instanceof BA?s.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(d,r){return this._lazyInitEmptyStyle(),this.style.addLayer(d,r),this._update(!0)}moveLayer(d,r){return this.style.moveLayer(d,r),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}setLayerZoomRange(d,r,c){return this.style.setLayerZoomRange(d,r,c),this._update(!0)}setFilter(d,r,c={}){return this.style.setFilter(d,r,c),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,r,c,p={}){return this.style.setPaintProperty(d,r,c,p),this._update(!0)}getPaintProperty(d,r){return this.style.getPaintProperty(d,r)}setLayoutProperty(d,r,c,p={}){return this.style.setLayoutProperty(d,r,c,p),this._update(!0)}getLayoutProperty(d,r){return this.style.getLayoutProperty(d,r)}setLight(d,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(d){return this._lazyInitEmptyStyle(),this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(d),this.transform):0}setFeatureState(d,r){return this.style.setFeatureState(d,r),this._update()}removeFeatureState(d,r){return this.style.removeFeatureState(d,r),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}_containerDimensions(){let d=0,r=0;return this._container&&(d=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300),[d,r]}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=Q.create("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=Q.create("div","mapboxgl-canvas-container",d);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=Q.create("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const c=this._containerDimensions();this._resizeCanvas(c[0],c[1]);const p=this._controlContainer=Q.create("div","mapboxgl-control-container",d),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{y[_]=Q.create("div",`mapboxgl-ctrl-${_}`,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,r){const c=s.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(d),this._canvas.height=c*Math.ceil(r),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${r}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const r=this._markers.indexOf(d);r!==-1&&this._markers.splice(r,1)}_setupPainter(){const d=s.extend({},F.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);r?(s.storeAuthState(r,!0),this.painter=new qh(r,this.transform),this.on("data",c=>{c.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(r)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let r;const c=this.painter.context.extTimerQuery,p=s.exported.now();this.listens("gpu-timing-frame")&&(r=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,r));let y=this._updateAverageElevation(p);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;let _=!1;const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,D=this.transform.pitch,k=s.exported.now();this.style.zoomHistory.update(U,k);const P=new s.EvaluationParameters(U,{now:k,fadeDuration:b,pitch:D,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),j=P.crossFadingFactor();j===1&&j===this._crossFadingFactor||(_=!0,this._crossFadingFactor=j),this.style.update(P)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||_)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const U=s.exported.now()-p;c.endQueryEXT(c.TIME_ELAPSED_EXT,r),setTimeout(()=>{const D=c.getQueryObjectEXT(r,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(r),this.fire(new s.Event("gpu-timing-frame",{cpuTime:U,gpuTime:D}))},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const D=this.painter.queryGpuTimers(U);this.fire(new s.Event("gpu-timing-layer",{layerTimes:D}))},50)}const E=this._sourcesDirty||this._styleDirty||this._placementDirty||y;if(E||this._repaint)this.triggerRepaint();else{const U=!this.isMoving()&&this.loaded();if(U&&(y=this._updateAverageElevation(p,!0)),y)this.triggerRepaint();else if(this._triggerFrame(!1),U&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const D=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:D})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||E||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const d of this._markers)d._update()}_updateAverageElevation(d,r=!1){const c=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);if((r||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const p=this.transform.averageElevation;let y=this.transform.sampleAverageElevation();isNaN(y)?y=0:this._averageElevationLastSampledAt=d;const _=Math.abs(p-y);if(_>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(y),c(y);this._averageElevation.easeTo(y,d,300)}else if(_>1e-4)return this._averageElevation.jumpTo(y),c(y)}return!!this._averageElevation.isEasing(d)&&c(this._averageElevation.getValue(d))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===s.AUTH_ERR_MSG||d.status===401)){const r=this.painter.context.gl;s.storeAuthState(r,!1),this._logoControl instanceof $c&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const c=this.painter.context.gl,p=c.createFramebuffer();function y(_){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,_,0);const b=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,b),b}return c.bindFramebuffer(c.FRAMEBUFFER,p),this._canvasPixelComparison(y(d),r.canvasCopies.map(y),r.timeStamps)}_canvasPixelComparison(d,r,c){let p=c[1]-c[0];const y=d.length/4;for(let _=0;_<r.length;_++){const b=r[_];let E=0;for(let U=0;U<b.length;U+=4)b[U]===d[U]&&b[U+1]===d[U+1]&&b[U+2]===d[U+2]&&b[U+3]===d[U+3]&&(E+=1);p+=(c[_+2]-c[_+1])*(1-E/y)}return p}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.clearWorkerCaches(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),bA(this._canvasContainer),bA(this._controlContainer),bA(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=s.exported.frame(r=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(r)}))}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}_setCacheLimits(d,r){s.setCacheLimits(d,r)}get version(){return s.version}},NavigationControl:class{constructor(d){this.options=s.extend({},wd,d),this._container=Q.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),Q.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),Q.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=Q.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const d=this._map.getZoom(),r=d===this._map.getMaxZoom(),c=d===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())}_rotateCompassArrow(){const d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=d)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Yc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){Q.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(d,r){const c=Q.create("button",d,this._container);return c.type="button",c.addEventListener("click",r),c}_setButtonTitle(d,r){const c=this._map._getUIString(`NavigationControl.${r}`);d.setAttribute("aria-label",c),d.firstElementChild&&d.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends s.Evented{constructor(d){super(),this.options=s.extend({},eu,d),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=Kc(this._updateMarkerRotation,20)}onAdd(d){var r;return this._map=d,this._container=Q.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,vs!==void 0?r(vs):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(c=>{vs=c.state!=="denied",r(vs)}):(vs=!!s.window.navigator.geolocation,r(vs)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Q.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Bl=0,CA=!1}_isOutOfMapMaxBounds(d){const r=this._map.getMaxBounds(),c=d.coords;return r&&(c.longitude<r.getWest()||c.longitude>r.getEast()||c.latitude<r.getSouth()||c.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",d)),this._finish()}}_updateCamera(d){const r=new s.LngLat(d.coords.longitude,d.coords.latitude),c=d.coords.accuracy,p=this._map.getBearing(),y=s.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(c),y,{geolocateSource:!0})}_updateMarker(d){if(d){const r=new s.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map._container.getBoundingClientRect().height/2,r=this._map.unproject([0,d]),c=this._map.unproject([100,d]),p=r.distanceTo(c)/100,y=Math.ceil(2*this._accuracy/p);this._circleElement.style.width=`${y}px`,this._circleElement.style.height=`${y}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&CA)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=Q.create("button","mapboxgl-ctrl-geolocate",this._container),Q.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",d===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Q.create("div","mapboxgl-user-location"),this._dotElement.appendChild(Q.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Q.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new wA({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Q.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wA({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:d.absolute===!0&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Bl--,CA=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Bl++,Bl>1?(d={maximumAge:6e5,timeout:0},CA=!0):(d=this.options.positionOptions,CA=!1),this._geolocationWatchID=s.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else s.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&d()}).catch(console.error):d()}_clearWatch(){s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Wc,ScaleControl:class{constructor(d){this.options=s.extend({},tu,d),s.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){ru(this._map,this._container,this.options)}onAdd(d){return this._map=d,this._container=Q.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){Q.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(d){this.options.unit=d,ru(this._map,this._container,this.options)}},FullscreenControl:class{constructor(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof s.window.HTMLElement?this._container=d.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=Q.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){Q.remove(this._controlContainer),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=Q.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Q.create("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden",!0),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(d){super(),this.options=s.extend(Object.create(fm),d),s.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&Q.remove(this._content),this._container&&(Q.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=s.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(s.window.document.createTextNode(d))}setHTML(d){const r=s.window.document.createDocumentFragment(),c=s.window.document.createElement("body");let p;for(c.innerHTML=d;p=c.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Q.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(d),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._container&&this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._container&&this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let r;return this._classList.delete(d)?r=!1:(this._classList.add(d),r=!0),this._container&&this._updateClassList(),r}_createCloseButton(){this.options.closeButton&&(this._closeButton=Q.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.setAttribute("aria-hidden","true"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(d){this._update(d.point)}_onMouseMove(d){this._update(d.point)}_onDrag(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const r=this._pos,c=this._container.offsetWidth,p=this._container.offsetHeight;let y;return y=r.y+d.bottom.y<p?["top"]:r.y>this._map.transform.height-p?["bottom"]:[],r.x<c/2?y.push("left"):r.x>this._map.transform.width-c/2&&y.push("right"),y.length===0?"bottom":y.join("-")}_updateClassList(){const d=[...this._classList];d.push("mapboxgl-popup"),this._anchor&&d.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&d.push("mapboxgl-popup-track-pointer"),this._container.className=d.join(" ")}_update(d){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=Q.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=Q.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Jc(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||d){const r=this._pos=this._trackPointer&&d?d:this._map.project(this._lngLat),c=function(_){if(_||(_=new s.pointGeometry(0,0)),typeof _=="number"){const b=Math.round(Math.sqrt(.5*Math.pow(_,2)));return{center:new s.pointGeometry(0,0),top:new s.pointGeometry(0,_),"top-left":new s.pointGeometry(b,b),"top-right":new s.pointGeometry(-b,b),bottom:new s.pointGeometry(0,-_),"bottom-left":new s.pointGeometry(b,-b),"bottom-right":new s.pointGeometry(-b,-b),left:new s.pointGeometry(_,0),right:new s.pointGeometry(-_,0)}}if(_ instanceof s.pointGeometry||Array.isArray(_)){const b=s.pointGeometry.convert(_);return{center:b,top:b,"top-left":b,"top-right":b,bottom:b,"bottom-left":b,"bottom-right":b,left:b,right:b}}return{center:s.pointGeometry.convert(_.center||[0,0]),top:s.pointGeometry.convert(_.top||[0,0]),"top-left":s.pointGeometry.convert(_["top-left"]||[0,0]),"top-right":s.pointGeometry.convert(_["top-right"]||[0,0]),bottom:s.pointGeometry.convert(_.bottom||[0,0]),"bottom-left":s.pointGeometry.convert(_["bottom-left"]||[0,0]),"bottom-right":s.pointGeometry.convert(_["bottom-right"]||[0,0]),left:s.pointGeometry.convert(_.left||[0,0]),right:s.pointGeometry.convert(_.right||[0,0])}}(this.options.offset),p=this._anchor=this._getAnchor(c),y=r.add(c[p]).round();this._map._requestDomTask(()=>{this._container&&p&&Q.setTransform(this._container,`${wl[p]} translate(${y.x}px,${y.y}px)`)})}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(pm);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._content&&(this._content.style.opacity=d),this._tip&&(this._tip.style.opacity=d)}},Marker:wA,Style:Un,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:Hc,Evented:s.Evented,config:s.config,prewarm:function(){lt().acquire(me)},clearPrewarmedResources:function(){const d=Re;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(me),Re=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(d){s.config.ACCESS_TOKEN=d},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(d){s.config.API_URL=d},get workerCount(){return Te.workerCount},set workerCount(d){Te.workerCount=d},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){s.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){s.clearTileCache(d)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return wa});var B=m;return B})})(bb);var YI=bb.exports;const qf=Dp(YI);function mf(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var eT={exports:{}};(function(t,o){(function(a){t.exports=a()})(function(){return function(){function a(u,m,x){function B(M,z){if(!m[M]){if(!u[M]){var L=typeof mf=="function"&&mf;if(!z&&L)return L(M,!0);if(s)return s(M,!0);var Q=new Error("Cannot find module '"+M+"'");throw Q.code="MODULE_NOT_FOUND",Q}var V=m[M]={exports:{}};u[M][0].call(V.exports,function(ie){var de=u[M][1][ie];return B(de||ie)},V,V.exports,a,u,m,x)}return m[M].exports}for(var s=typeof mf=="function"&&mf,F=0;F<x.length;F++)B(x[F]);return B}return a}()({1:[function(a,u,m){var x={};function B(M){return Math.floor(Math.abs(M)+.5)*(M>=0?1:-1)}function s(M,z,L){M=B(M*L),z=B(z*L);var Q=M-z;Q<<=1,M-z<0&&(Q=~Q);for(var V="";Q>=32;)V+=String.fromCharCode((32|Q&31)+63),Q>>=5;return V+=String.fromCharCode(Q+63),V}x.decode=function(M,z){for(var L=0,Q=0,V=0,ie=[],de=0,re=0,K=null,G,ne,oe=Math.pow(10,Number.isInteger(z)?z:5);L<M.length;){K=null,de=0,re=0;do K=M.charCodeAt(L++)-63,re|=(K&31)<<de,de+=5;while(K>=32);G=re&1?~(re>>1):re>>1,de=re=0;do K=M.charCodeAt(L++)-63,re|=(K&31)<<de,de+=5;while(K>=32);ne=re&1?~(re>>1):re>>1,Q+=G,V+=ne,ie.push([Q/oe,V/oe])}return ie},x.encode=function(M,z){if(!M.length)return"";for(var L=Math.pow(10,Number.isInteger(z)?z:5),Q=s(M[0][0],0,L)+s(M[0][1],0,L),V=1;V<M.length;V++){var ie=M[V],de=M[V-1];Q+=s(ie[0],de[0],L),Q+=s(ie[1],de[1],L)}return Q};function F(M){for(var z=[],L=0;L<M.length;L++){var Q=M[L].slice();z.push([Q[1],Q[0]])}return z}x.fromGeoJSON=function(M,z){if(M&&M.type==="Feature"&&(M=M.geometry),!M||M.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return x.encode(F(M.coordinates),z)},x.toGeoJSON=function(M,z){var L=x.decode(M,z);return{type:"LineString",coordinates:F(L)}},typeof u=="object"&&u.exports&&(u.exports=x)},{}],2:[function(a,u,m){var x=a("is-obj"),B=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function F(L){if(L==null)throw new TypeError("Sources cannot be null or undefined");return Object(L)}function M(L,Q,V){var ie=Q[V];if(ie!=null){if(B.call(L,V)&&(L[V]===void 0||L[V]===null))throw new TypeError("Cannot convert undefined or null to object ("+V+")");!B.call(L,V)||!x(ie)?L[V]=ie:L[V]=z(Object(L[V]),Q[V])}}function z(L,Q){if(L===Q)return L;Q=Object(Q);for(var V in Q)B.call(Q,V)&&M(L,Q,V);if(Object.getOwnPropertySymbols)for(var ie=Object.getOwnPropertySymbols(Q),de=0;de<ie.length;de++)s.call(Q,ie[de])&&M(L,Q,ie[de]);return L}u.exports=function(Q){Q=F(Q);for(var V=1;V<arguments.length;V++)z(Q,arguments[V]);return Q}},{"is-obj":5}],3:[function(a,u,m){function x(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}u.exports=x,x.EventEmitter=x,x.prototype._events=void 0,x.prototype._maxListeners=void 0,x.defaultMaxListeners=10,x.prototype.setMaxListeners=function(z){if(!s(z)||z<0||isNaN(z))throw TypeError("n must be a positive number");return this._maxListeners=z,this},x.prototype.emit=function(z){var L,Q,V,ie,de,re;if(this._events||(this._events={}),z==="error"&&(!this._events.error||F(this._events.error)&&!this._events.error.length)){if(L=arguments[1],L instanceof Error)throw L;var K=new Error('Uncaught, unspecified "error" event. ('+L+")");throw K.context=L,K}if(Q=this._events[z],M(Q))return!1;if(B(Q))switch(arguments.length){case 1:Q.call(this);break;case 2:Q.call(this,arguments[1]);break;case 3:Q.call(this,arguments[1],arguments[2]);break;default:ie=Array.prototype.slice.call(arguments,1),Q.apply(this,ie)}else if(F(Q))for(ie=Array.prototype.slice.call(arguments,1),re=Q.slice(),V=re.length,de=0;de<V;de++)re[de].apply(this,ie);return!0},x.prototype.addListener=function(z,L){var Q;if(!B(L))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",z,B(L.listener)?L.listener:L),this._events[z]?F(this._events[z])?this._events[z].push(L):this._events[z]=[this._events[z],L]:this._events[z]=L,F(this._events[z])&&!this._events[z].warned&&(M(this._maxListeners)?Q=x.defaultMaxListeners:Q=this._maxListeners,Q&&Q>0&&this._events[z].length>Q&&(this._events[z].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[z].length),typeof console.trace=="function"&&console.trace())),this},x.prototype.on=x.prototype.addListener,x.prototype.once=function(z,L){if(!B(L))throw TypeError("listener must be a function");var Q=!1;function V(){this.removeListener(z,V),Q||(Q=!0,L.apply(this,arguments))}return V.listener=L,this.on(z,V),this},x.prototype.removeListener=function(z,L){var Q,V,ie,de;if(!B(L))throw TypeError("listener must be a function");if(!this._events||!this._events[z])return this;if(Q=this._events[z],ie=Q.length,V=-1,Q===L||B(Q.listener)&&Q.listener===L)delete this._events[z],this._events.removeListener&&this.emit("removeListener",z,L);else if(F(Q)){for(de=ie;de-- >0;)if(Q[de]===L||Q[de].listener&&Q[de].listener===L){V=de;break}if(V<0)return this;Q.length===1?(Q.length=0,delete this._events[z]):Q.splice(V,1),this._events.removeListener&&this.emit("removeListener",z,L)}return this},x.prototype.removeAllListeners=function(z){var L,Q;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[z]&&delete this._events[z],this;if(arguments.length===0){for(L in this._events)L!=="removeListener"&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events={},this}if(Q=this._events[z],B(Q))this.removeListener(z,Q);else if(Q)for(;Q.length;)this.removeListener(z,Q[Q.length-1]);return delete this._events[z],this},x.prototype.listeners=function(z){var L;return!this._events||!this._events[z]?L=[]:B(this._events[z])?L=[this._events[z]]:L=this._events[z].slice(),L},x.prototype.listenerCount=function(z){if(this._events){var L=this._events[z];if(B(L))return 1;if(L)return L.length}return 0},x.listenerCount=function(z,L){return z.listenerCount(L)};function B(z){return typeof z=="function"}function s(z){return typeof z=="number"}function F(z){return typeof z=="object"&&z!==null}function M(z){return z===void 0}},{}],4:[function(a,u,m){(function(){var x=this,B={};typeof m<"u"?u.exports=B:x.fuzzy=B,B.simpleFilter=function(s,F){return F.filter(function(M){return B.test(s,M)})},B.test=function(s,F){return B.match(s,F)!==null},B.match=function(s,F,M){M=M||{};var z=0,L=[],Q=F.length,V=0,ie=0,de=M.pre||"",re=M.post||"",K=M.caseSensitive&&F||F.toLowerCase(),G;s=M.caseSensitive&&s||s.toLowerCase();for(var ne=0;ne<Q;ne++)G=F[ne],K[ne]===s[z]?(G=de+G+re,z+=1,ie+=1+ie):ie=0,V+=ie,L[L.length]=G;return z===s.length?(V=K===s?1/0:V,{rendered:L.join(""),score:V}):null},B.filter=function(s,F,M){return!F||F.length===0?[]:typeof s!="string"?F:(M=M||{},F.reduce(function(z,L,Q,V){var ie=L;M.extract&&(ie=M.extract(L));var de=B.match(s,ie,M);return de!=null&&(z[z.length]={string:de.rendered,score:de.score,index:Q,original:L}),z},[]).sort(function(z,L){var Q=L.score-z.score;return Q||z.index-L.index}))}})()},{}],5:[function(a,u,m){u.exports=function(x){var B=typeof x;return x!==null&&(B==="object"||B==="function")}},{}],6:[function(a,u,m){var x=/<%=([\s\S]+?)%>/g;u.exports=x},{}],7:[function(a,u,m){(function(x){var B="Expected a function",s=NaN,F="[object Symbol]",M=/^\s+|\s+$/g,z=/^[-+]0x[0-9a-f]+$/i,L=/^0b[01]+$/i,Q=/^0o[0-7]+$/i,V=parseInt,ie=typeof x=="object"&&x&&x.Object===Object&&x,de=typeof self=="object"&&self&&self.Object===Object&&self,re=ie||de||Function("return this")(),K=Object.prototype,G=K.toString,ne=Math.max,oe=Math.min,we=function(){return re.Date.now()};function ge(qe,it,Xe){var Ne,At,Et,It,Ut,Dt,Vt=0,Je=!1,yt=!1,ke=!0;if(typeof qe!="function")throw new TypeError(B);it=et(it)||0,Ue(Xe)&&(Je=!!Xe.leading,yt="maxWait"in Xe,Et=yt?ne(et(Xe.maxWait)||0,it):Et,ke="trailing"in Xe?!!Xe.trailing:ke);function xt(sr){var dr=Ne,An=At;return Ne=At=void 0,Vt=sr,It=qe.apply(An,dr),It}function Se(sr){return Vt=sr,Ut=setTimeout(Ot,it),Je?xt(sr):It}function ot(sr){var dr=sr-Dt,An=sr-Vt,Ct=it-dr;return yt?oe(Ct,Et-An):Ct}function vt(sr){var dr=sr-Dt,An=sr-Vt;return Dt===void 0||dr>=it||dr<0||yt&&An>=Et}function Ot(){var sr=we();if(vt(sr))return nt(sr);Ut=setTimeout(Ot,ot(sr))}function nt(sr){return Ut=void 0,ke&&Ne?xt(sr):(Ne=At=void 0,It)}function tr(){Ut!==void 0&&clearTimeout(Ut),Vt=0,Ne=Dt=At=Ut=void 0}function br(){return Ut===void 0?It:nt(we())}function Dr(){var sr=we(),dr=vt(sr);if(Ne=arguments,At=this,Dt=sr,dr){if(Ut===void 0)return Se(Dt);if(yt)return Ut=setTimeout(Ot,it),xt(Dt)}return Ut===void 0&&(Ut=setTimeout(Ot,it)),It}return Dr.cancel=tr,Dr.flush=br,Dr}function Ue(qe){var it=typeof qe;return!!qe&&(it=="object"||it=="function")}function Ke(qe){return!!qe&&typeof qe=="object"}function Me(qe){return typeof qe=="symbol"||Ke(qe)&&G.call(qe)==F}function et(qe){if(typeof qe=="number")return qe;if(Me(qe))return s;if(Ue(qe)){var it=typeof qe.valueOf=="function"?qe.valueOf():qe;qe=Ue(it)?it+"":it}if(typeof qe!="string")return qe===0?qe:+qe;qe=qe.replace(M,"");var Xe=L.test(qe);return Xe||Q.test(qe)?V(qe.slice(2),Xe?2:8):z.test(qe)?s:+qe}u.exports=ge}).call(this,typeof po<"u"?po:typeof self<"u"?self:typeof window<"u"?window:{})},{}],8:[function(a,u,m){(function(x){var B=200,s="__lodash_hash_undefined__",F=1,M=2,z=9007199254740991,L="[object Arguments]",Q="[object Array]",V="[object AsyncFunction]",ie="[object Boolean]",de="[object Date]",re="[object Error]",K="[object Function]",G="[object GeneratorFunction]",ne="[object Map]",oe="[object Number]",we="[object Null]",ge="[object Object]",Ue="[object Promise]",Ke="[object Proxy]",Me="[object RegExp]",et="[object Set]",qe="[object String]",it="[object Symbol]",Xe="[object Undefined]",Ne="[object WeakMap]",At="[object ArrayBuffer]",Et="[object DataView]",It="[object Float32Array]",Ut="[object Float64Array]",Dt="[object Int8Array]",Vt="[object Int16Array]",Je="[object Int32Array]",yt="[object Uint8Array]",ke="[object Uint8ClampedArray]",xt="[object Uint16Array]",Se="[object Uint32Array]",ot=/[\\^$.*+?()[\]{}|]/g,vt=/^\[object .+?Constructor\]$/,Ot=/^(?:0|[1-9]\d*)$/,nt={};nt[It]=nt[Ut]=nt[Dt]=nt[Vt]=nt[Je]=nt[yt]=nt[ke]=nt[xt]=nt[Se]=!0,nt[L]=nt[Q]=nt[At]=nt[ie]=nt[Et]=nt[de]=nt[re]=nt[K]=nt[ne]=nt[oe]=nt[ge]=nt[Me]=nt[et]=nt[qe]=nt[Ne]=!1;var tr=typeof x=="object"&&x&&x.Object===Object&&x,br=typeof self=="object"&&self&&self.Object===Object&&self,Dr=tr||br||Function("return this")(),sr=typeof m=="object"&&m&&!m.nodeType&&m,dr=sr&&typeof u=="object"&&u&&!u.nodeType&&u,An=dr&&dr.exports===sr,Ct=An&&tr.process,mi=function(){try{return Ct&&Ct.binding&&Ct.binding("util")}catch{}}(),Nr=mi&&mi.isTypedArray;function $r(se,Ee){for(var Ye=-1,Ft=se==null?0:se.length,Mt=0,er=[];++Ye<Ft;){var Qr=se[Ye];Ee(Qr,Ye,se)&&(er[Mt++]=Qr)}return er}function to(se,Ee){for(var Ye=-1,Ft=Ee.length,Mt=se.length;++Ye<Ft;)se[Mt+Ye]=Ee[Ye];return se}function Ii(se,Ee){for(var Ye=-1,Ft=se==null?0:se.length;++Ye<Ft;)if(Ee(se[Ye],Ye,se))return!0;return!1}function gi(se,Ee){for(var Ye=-1,Ft=Array(se);++Ye<se;)Ft[Ye]=Ee(Ye);return Ft}function ro(se){return function(Ee){return se(Ee)}}function Ki(se,Ee){return se.has(Ee)}function Mn(se,Ee){return se==null?void 0:se[Ee]}function Ti(se){var Ee=-1,Ye=Array(se.size);return se.forEach(function(Ft,Mt){Ye[++Ee]=[Mt,Ft]}),Ye}function Vo(se,Ee){return function(Ye){return se(Ee(Ye))}}function Ln(se){var Ee=-1,Ye=Array(se.size);return se.forEach(function(Ft){Ye[++Ee]=Ft}),Ye}var wn=Array.prototype,os=Function.prototype,Ui=Object.prototype,no=Dr["__core-js_shared__"],_o=os.toString,ln=Ui.hasOwnProperty,ss=function(){var se=/[^.]+$/.exec(no&&no.keys&&no.keys.IE_PROTO||"");return se?"Symbol(src)_1."+se:""}(),Si=Ui.toString,vo=RegExp("^"+_o.call(ln).replace(ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zn=An?Dr.Buffer:void 0,qr=Dr.Symbol,Tn=Dr.Uint8Array,Qi=Ui.propertyIsEnumerable,as=wn.splice,Dn=qr?qr.toStringTag:void 0,oi=Object.getOwnPropertySymbols,Mi=Zn?Zn.isBuffer:void 0,Ko=Vo(Object.keys,Object),Li=hn(Dr,"DataView"),nn=hn(Dr,"Map"),Y=hn(Dr,"Promise"),O=hn(Dr,"Set"),N=hn(Dr,"WeakMap"),q=hn(Object,"create"),le=xr(Li),pe=xr(nn),Fe=xr(Y),Ce=xr(O),me=xr(N),Te=qr?qr.prototype:void 0,Re=Te?Te.valueOf:void 0;function lt(se){var Ee=-1,Ye=se==null?0:se.length;for(this.clear();++Ee<Ye;){var Ft=se[Ee];this.set(Ft[0],Ft[1])}}function $e(){this.__data__=q?q(null):{},this.size=0}function St(se){var Ee=this.has(se)&&delete this.__data__[se];return this.size-=Ee?1:0,Ee}function ut(se){var Ee=this.__data__;if(q){var Ye=Ee[se];return Ye===s?void 0:Ye}return ln.call(Ee,se)?Ee[se]:void 0}function xe(se){var Ee=this.__data__;return q?Ee[se]!==void 0:ln.call(Ee,se)}function Pe(se,Ee){var Ye=this.__data__;return this.size+=this.has(se)?0:1,Ye[se]=q&&Ee===void 0?s:Ee,this}lt.prototype.clear=$e,lt.prototype.delete=St,lt.prototype.get=ut,lt.prototype.has=xe,lt.prototype.set=Pe;function zt(se){var Ee=-1,Ye=se==null?0:se.length;for(this.clear();++Ee<Ye;){var Ft=se[Ee];this.set(Ft[0],Ft[1])}}function ar(){this.__data__=[],this.size=0}function Rt(se){var Ee=this.__data__,Ye=Gi(Ee,se);if(Ye<0)return!1;var Ft=Ee.length-1;return Ye==Ft?Ee.pop():as.call(Ee,Ye,1),--this.size,!0}function ir(se){var Ee=this.__data__,Ye=Gi(Ee,se);return Ye<0?void 0:Ee[Ye][1]}function or(se){return Gi(this.__data__,se)>-1}function io(se,Ee){var Ye=this.__data__,Ft=Gi(Ye,se);return Ft<0?(++this.size,Ye.push([se,Ee])):Ye[Ft][1]=Ee,this}zt.prototype.clear=ar,zt.prototype.delete=Rt,zt.prototype.get=ir,zt.prototype.has=or,zt.prototype.set=io;function cn(se){var Ee=-1,Ye=se==null?0:se.length;for(this.clear();++Ee<Ye;){var Ft=se[Ee];this.set(Ft[0],Ft[1])}}function dt(){this.size=0,this.__data__={hash:new lt,map:new(nn||zt),string:new lt}}function Yt(se){var Ee=wo(this,se).delete(se);return this.size-=Ee?1:0,Ee}function Wt(se){return wo(this,se).get(se)}function kr(se){return wo(this,se).has(se)}function oo(se,Ee){var Ye=wo(this,se),Ft=Ye.size;return Ye.set(se,Ee),this.size+=Ye.size==Ft?0:1,this}cn.prototype.clear=dt,cn.prototype.delete=Yt,cn.prototype.get=Wt,cn.prototype.has=kr,cn.prototype.set=oo;function Zt(se){var Ee=-1,Ye=se==null?0:se.length;for(this.__data__=new cn;++Ee<Ye;)this.add(se[Ee])}function As(se){return this.__data__.set(se,s),this}function xo(se){return this.__data__.has(se)}Zt.prototype.add=Zt.prototype.push=As,Zt.prototype.has=xo;function kn(se){var Ee=this.__data__=new zt(se);this.size=Ee.size}function Pn(){this.__data__=new zt,this.size=0}function gr(se){var Ee=this.__data__,Ye=Ee.delete(se);return this.size=Ee.size,Ye}function aa(se){return this.__data__.get(se)}function Di(se){return this.__data__.has(se)}function Go(se,Ee){var Ye=this.__data__;if(Ye instanceof zt){var Ft=Ye.__data__;if(!nn||Ft.length<B-1)return Ft.push([se,Ee]),this.size=++Ye.size,this;Ye=this.__data__=new cn(Ft)}return Ye.set(se,Ee),this.size=Ye.size,this}kn.prototype.clear=Pn,kn.prototype.delete=gr,kn.prototype.get=aa,kn.prototype.has=Di,kn.prototype.set=Go;function si(se,Ee){var Ye=Bn(se),Ft=!Ye&&Rn(se),Mt=!Ye&&!Ft&&Gr(se),er=!Ye&&!Ft&&!Mt&&Un(se),Qr=Ye||Ft||Mt||er,Jr=Qr?gi(se.length,String):[],jr=Jr.length;for(var wr in se)(Ee||ln.call(se,wr))&&!(Qr&&(wr=="length"||Mt&&(wr=="offset"||wr=="parent")||er&&(wr=="buffer"||wr=="byteLength"||wr=="byteOffset")||ze(wr,jr)))&&Jr.push(wr);return Jr}function Gi(se,Ee){for(var Ye=se.length;Ye--;)if(Sr(se[Ye][0],Ee))return Ye;return-1}function Xn(se,Ee,Ye){var Ft=Ee(se);return Bn(se)?Ft:to(Ft,Ye(se))}function rr(se){return se==null?se===void 0?Xe:we:Dn&&Dn in Object(se)?Bo(se):Pr(se)}function ji(se){return Co(se)&&rr(se)==L}function On(se,Ee,Ye,Ft,Mt){return se===Ee?!0:se==null||Ee==null||!Co(se)&&!Co(Ee)?se!==se&&Ee!==Ee:un(se,Ee,Ye,Ft,On,Mt)}function un(se,Ee,Ye,Ft,Mt,er){var Qr=Bn(se),Jr=Bn(Ee),jr=Qr?Q:_e(se),wr=Jr?Q:_e(Ee);jr=jr==L?ge:jr,wr=wr==L?ge:wr;var Xt=jr==ge,zn=wr==ge,on=jr==wr;if(on&&Gr(se)){if(!Gr(Ee))return!1;Qr=!0,Xt=!1}if(on&&!Xt)return er||(er=new kn),Qr||Un(se)?Ur(se,Ee,Ye,Ft,Mt,er):so(se,Ee,jr,Ye,Ft,Mt,er);if(!(Ye&F)){var $n=Xt&&ln.call(se,"__wrapped__"),ai=zn&&ln.call(Ee,"__wrapped__");if($n||ai){var yi=$n?se.value():se,ki=ai?Ee.value():Ee;return er||(er=new kn),Mt(yi,ki,Ye,Ft,er)}}return on?(er||(er=new kn),ao(se,Ee,Ye,Ft,Mt,er)):!1}function Wn(se){if(!bo(se)||$t(se))return!1;var Ee=Ps(se)?vo:vt;return Ee.test(xr(se))}function Aa(se){return Co(se)&&hs(se.length)&&!!nt[rr(se)]}function ls(se){if(!jt(se))return Ko(se);var Ee=[];for(var Ye in Object(se))ln.call(se,Ye)&&Ye!="constructor"&&Ee.push(Ye);return Ee}function Ur(se,Ee,Ye,Ft,Mt,er){var Qr=Ye&F,Jr=se.length,jr=Ee.length;if(Jr!=jr&&!(Qr&&jr>Jr))return!1;var wr=er.get(se);if(wr&&er.get(Ee))return wr==Ee;var Xt=-1,zn=!0,on=Ye&M?new Zt:void 0;for(er.set(se,Ee),er.set(Ee,se);++Xt<Jr;){var $n=se[Xt],ai=Ee[Xt];if(Ft)var yi=Qr?Ft(ai,$n,Xt,Ee,se,er):Ft($n,ai,Xt,se,Ee,er);if(yi!==void 0){if(yi)continue;zn=!1;break}if(on){if(!Ii(Ee,function(ki,jo){if(!Ki(on,jo)&&($n===ki||Mt($n,ki,Ye,Ft,er)))return on.push(jo)})){zn=!1;break}}else if(!($n===ai||Mt($n,ai,Ye,Ft,er))){zn=!1;break}}return er.delete(se),er.delete(Ee),zn}function so(se,Ee,Ye,Ft,Mt,er,Qr){switch(Ye){case Et:if(se.byteLength!=Ee.byteLength||se.byteOffset!=Ee.byteOffset)return!1;se=se.buffer,Ee=Ee.buffer;case At:return!(se.byteLength!=Ee.byteLength||!er(new Tn(se),new Tn(Ee)));case ie:case de:case oe:return Sr(+se,+Ee);case re:return se.name==Ee.name&&se.message==Ee.message;case Me:case qe:return se==Ee+"";case ne:var Jr=Ti;case et:var jr=Ft&F;if(Jr||(Jr=Ln),se.size!=Ee.size&&!jr)return!1;var wr=Qr.get(se);if(wr)return wr==Ee;Ft|=M,Qr.set(se,Ee);var Xt=Ur(Jr(se),Jr(Ee),Ft,Mt,er,Qr);return Qr.delete(se),Xt;case it:if(Re)return Re.call(se)==Re.call(Ee)}return!1}function ao(se,Ee,Ye,Ft,Mt,er){var Qr=Ye&F,Jr=zr(se),jr=Jr.length,wr=zr(Ee),Xt=wr.length;if(jr!=Xt&&!Qr)return!1;for(var zn=jr;zn--;){var on=Jr[zn];if(!(Qr?on in Ee:ln.call(Ee,on)))return!1}var $n=er.get(se);if($n&&er.get(Ee))return $n==Ee;var ai=!0;er.set(se,Ee),er.set(Ee,se);for(var yi=Qr;++zn<jr;){on=Jr[zn];var ki=se[on],jo=Ee[on];if(Ft)var uA=Qr?Ft(jo,ki,on,Ee,se,er):Ft(ki,jo,on,se,Ee,er);if(!(uA===void 0?ki===jo||Mt(ki,jo,Ye,Ft,er):uA)){ai=!1;break}yi||(yi=on=="constructor")}if(ai&&!yi){var ds=se.constructor,Zo=Ee.constructor;ds!=Zo&&"constructor"in se&&"constructor"in Ee&&!(typeof ds=="function"&&ds instanceof ds&&typeof Zo=="function"&&Zo instanceof Zo)&&(ai=!1)}return er.delete(se),er.delete(Ee),ai}function zr(se){return Xn(se,Eo,cs)}function wo(se,Ee){var Ye=se.__data__;return ct(Ee)?Ye[typeof Ee=="string"?"string":"hash"]:Ye.map}function hn(se,Ee){var Ye=Mn(se,Ee);return Wn(Ye)?Ye:void 0}function Bo(se){var Ee=ln.call(se,Dn),Ye=se[Dn];try{se[Dn]=void 0;var Ft=!0}catch{}var Mt=Si.call(se);return Ft&&(Ee?se[Dn]=Ye:delete se[Dn]),Mt}var cs=oi?function(se){return se==null?[]:(se=Object(se),$r(oi(se),function(Ee){return Qi.call(se,Ee)}))}:Os,_e=rr;(Li&&_e(new Li(new ArrayBuffer(1)))!=Et||nn&&_e(new nn)!=ne||Y&&_e(Y.resolve())!=Ue||O&&_e(new O)!=et||N&&_e(new N)!=Ne)&&(_e=function(se){var Ee=rr(se),Ye=Ee==ge?se.constructor:void 0,Ft=Ye?xr(Ye):"";if(Ft)switch(Ft){case le:return Et;case pe:return ne;case Fe:return Ue;case Ce:return et;case me:return Ne}return Ee});function ze(se,Ee){return Ee=Ee??z,!!Ee&&(typeof se=="number"||Ot.test(se))&&se>-1&&se%1==0&&se<Ee}function ct(se){var Ee=typeof se;return Ee=="string"||Ee=="number"||Ee=="symbol"||Ee=="boolean"?se!=="__proto__":se===null}function $t(se){return!!ss&&ss in se}function jt(se){var Ee=se&&se.constructor,Ye=typeof Ee=="function"&&Ee.prototype||Ui;return se===Ye}function Pr(se){return Si.call(se)}function xr(se){if(se!=null){try{return _o.call(se)}catch{}try{return se+""}catch{}}return""}function Sr(se,Ee){return se===Ee||se!==se&&Ee!==Ee}var Rn=ji(function(){return arguments}())?ji:function(se){return Co(se)&&ln.call(se,"callee")&&!Qi.call(se,"callee")},Bn=Array.isArray;function la(se){return se!=null&&hs(se.length)&&!Ps(se)}var Gr=Mi||Fo;function us(se,Ee){return On(se,Ee)}function Ps(se){if(!bo(se))return!1;var Ee=rr(se);return Ee==K||Ee==G||Ee==V||Ee==Ke}function hs(se){return typeof se=="number"&&se>-1&&se%1==0&&se<=z}function bo(se){var Ee=typeof se;return se!=null&&(Ee=="object"||Ee=="function")}function Co(se){return se!=null&&typeof se=="object"}var Un=Nr?ro(Nr):Aa;function Eo(se){return la(se)?si(se):ls(se)}function Os(){return[]}function Fo(){return!1}u.exports=us}).call(this,typeof po<"u"?po:typeof self<"u"?self:typeof window<"u"?window:{})},{}],9:[function(a,u,m){(function(x){var B=a("lodash._reinterpolate"),s=a("lodash.templatesettings"),F=800,M=16,z=1/0,L=9007199254740991,Q="[object Arguments]",V="[object Array]",ie="[object AsyncFunction]",de="[object Boolean]",re="[object Date]",K="[object DOMException]",G="[object Error]",ne="[object Function]",oe="[object GeneratorFunction]",we="[object Map]",ge="[object Number]",Ue="[object Null]",Ke="[object Object]",Me="[object Proxy]",et="[object RegExp]",qe="[object Set]",it="[object String]",Xe="[object Symbol]",Ne="[object Undefined]",At="[object WeakMap]",Et="[object ArrayBuffer]",It="[object DataView]",Ut="[object Float32Array]",Dt="[object Float64Array]",Vt="[object Int8Array]",Je="[object Int16Array]",yt="[object Int32Array]",ke="[object Uint8Array]",xt="[object Uint8ClampedArray]",Se="[object Uint16Array]",ot="[object Uint32Array]",vt=/\b__p \+= '';/g,Ot=/\b(__p \+=) '' \+/g,nt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,tr=/[\\^$.*+?()[\]{}|]/g,br=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Dr=/^\[object .+?Constructor\]$/,sr=/^(?:0|[1-9]\d*)$/,dr=/($^)/,An=/['\n\r\u2028\u2029\\]/g,Ct={};Ct[Ut]=Ct[Dt]=Ct[Vt]=Ct[Je]=Ct[yt]=Ct[ke]=Ct[xt]=Ct[Se]=Ct[ot]=!0,Ct[Q]=Ct[V]=Ct[Et]=Ct[de]=Ct[It]=Ct[re]=Ct[G]=Ct[ne]=Ct[we]=Ct[ge]=Ct[Ke]=Ct[et]=Ct[qe]=Ct[it]=Ct[At]=!1;var mi={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Nr=typeof x=="object"&&x&&x.Object===Object&&x,$r=typeof self=="object"&&self&&self.Object===Object&&self,to=Nr||$r||Function("return this")(),Ii=typeof m=="object"&&m&&!m.nodeType&&m,gi=Ii&&typeof u=="object"&&u&&!u.nodeType&&u,ro=gi&&gi.exports===Ii,Ki=ro&&Nr.process,Mn=function(){try{var _e=gi&&gi.require&&gi.require("util").types;return _e||Ki&&Ki.binding&&Ki.binding("util")}catch{}}(),Ti=Mn&&Mn.isTypedArray;function Vo(_e,ze,ct){switch(ct.length){case 0:return _e.call(ze);case 1:return _e.call(ze,ct[0]);case 2:return _e.call(ze,ct[0],ct[1]);case 3:return _e.call(ze,ct[0],ct[1],ct[2])}return _e.apply(ze,ct)}function Ln(_e,ze){for(var ct=-1,$t=_e==null?0:_e.length,jt=Array($t);++ct<$t;)jt[ct]=ze(_e[ct],ct,_e);return jt}function wn(_e,ze){for(var ct=-1,$t=Array(_e);++ct<_e;)$t[ct]=ze(ct);return $t}function os(_e){return function(ze){return _e(ze)}}function Ui(_e,ze){return Ln(ze,function(ct){return _e[ct]})}function no(_e){return"\\"+mi[_e]}function _o(_e,ze){return _e==null?void 0:_e[ze]}function ln(_e,ze){return function(ct){return _e(ze(ct))}}var ss=Function.prototype,Si=Object.prototype,vo=to["__core-js_shared__"],Zn=ss.toString,qr=Si.hasOwnProperty,Tn=function(){var _e=/[^.]+$/.exec(vo&&vo.keys&&vo.keys.IE_PROTO||"");return _e?"Symbol(src)_1."+_e:""}(),Qi=Si.toString,as=Zn.call(Object),Dn=RegExp("^"+Zn.call(qr).replace(tr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),oi=ro?to.Buffer:void 0,Mi=to.Symbol,Ko=ln(Object.getPrototypeOf,Object),Li=Si.propertyIsEnumerable,nn=Mi?Mi.toStringTag:void 0,Y=function(){try{var _e=io(Object,"defineProperty");return _e({},"",{}),_e}catch{}}(),O=oi?oi.isBuffer:void 0,N=ln(Object.keys,Object),q=Math.max,le=Date.now,pe=Mi?Mi.prototype:void 0,Fe=pe?pe.toString:void 0;function Ce(_e,ze){var ct=Di(_e),$t=!ct&&aa(_e),jt=!ct&&!$t&&si(_e),Pr=!ct&&!$t&&!jt&&Aa(_e),xr=ct||$t||jt||Pr,Sr=xr?wn(_e.length,String):[],Rn=Sr.length;for(var Bn in _e)(ze||qr.call(_e,Bn))&&!(xr&&(Bn=="length"||jt&&(Bn=="offset"||Bn=="parent")||Pr&&(Bn=="buffer"||Bn=="byteLength"||Bn=="byteOffset")||dt(Bn,Rn)))&&Sr.push(Bn);return Sr}function me(_e,ze,ct){var $t=_e[ze];(!(qr.call(_e,ze)&&gr($t,ct))||ct===void 0&&!(ze in _e))&&Te(_e,ze,ct)}function Te(_e,ze,ct){ze=="__proto__"&&Y?Y(_e,ze,{configurable:!0,enumerable:!0,value:ct,writable:!0}):_e[ze]=ct}function Re(_e){return _e==null?_e===void 0?Ne:Ue:nn&&nn in Object(_e)?cn(_e):Zt(_e)}function lt(_e){return On(_e)&&Re(_e)==Q}function $e(_e){if(!ji(_e)||Wt(_e))return!1;var ze=Xn(_e)?Dn:Dr;return ze.test(Pn(_e))}function St(_e){return On(_e)&&rr(_e.length)&&!!Ct[Re(_e)]}function ut(_e){if(!kr(_e))return N(_e);var ze=[];for(var ct in Object(_e))qr.call(_e,ct)&&ct!="constructor"&&ze.push(ct);return ze}function xe(_e){if(!ji(_e))return oo(_e);var ze=kr(_e),ct=[];for(var $t in _e)$t=="constructor"&&(ze||!qr.call(_e,$t))||ct.push($t);return ct}function Pe(_e,ze){return xo(As(_e,ze,Bo),_e+"")}var zt=Y?function(_e,ze){return Y(_e,"toString",{configurable:!0,enumerable:!1,value:hn(ze),writable:!0})}:Bo;function ar(_e){if(typeof _e=="string")return _e;if(Di(_e))return Ln(_e,ar)+"";if(Wn(_e))return Fe?Fe.call(_e):"";var ze=_e+"";return ze=="0"&&1/_e==-z?"-0":ze}function Rt(_e,ze,ct,$t){var jt=!ct;ct||(ct={});for(var Pr=-1,xr=ze.length;++Pr<xr;){var Sr=ze[Pr],Rn=$t?$t(ct[Sr],_e[Sr],Sr,ct,_e):void 0;Rn===void 0&&(Rn=_e[Sr]),jt?Te(ct,Sr,Rn):me(ct,Sr,Rn)}return ct}function ir(_e){return Pe(function(ze,ct){var $t=-1,jt=ct.length,Pr=jt>1?ct[jt-1]:void 0,xr=jt>2?ct[2]:void 0;for(Pr=_e.length>3&&typeof Pr=="function"?(jt--,Pr):void 0,xr&&Yt(ct[0],ct[1],xr)&&(Pr=jt<3?void 0:Pr,jt=1),ze=Object(ze);++$t<jt;){var Sr=ct[$t];Sr&&_e(ze,Sr,$t,Pr)}return ze})}function or(_e,ze,ct,$t){return _e===void 0||gr(_e,Si[ct])&&!qr.call($t,ct)?ze:_e}function io(_e,ze){var ct=_o(_e,ze);return $e(ct)?ct:void 0}function cn(_e){var ze=qr.call(_e,nn),ct=_e[nn];try{_e[nn]=void 0;var $t=!0}catch{}var jt=Qi.call(_e);return $t&&(ze?_e[nn]=ct:delete _e[nn]),jt}function dt(_e,ze){var ct=typeof _e;return ze=ze??L,!!ze&&(ct=="number"||ct!="symbol"&&sr.test(_e))&&_e>-1&&_e%1==0&&_e<ze}function Yt(_e,ze,ct){if(!ji(ct))return!1;var $t=typeof ze;return($t=="number"?Go(ct)&&dt(ze,ct.length):$t=="string"&&ze in ct)?gr(ct[ze],_e):!1}function Wt(_e){return!!Tn&&Tn in _e}function kr(_e){var ze=_e&&_e.constructor,ct=typeof ze=="function"&&ze.prototype||Si;return _e===ct}function oo(_e){var ze=[];if(_e!=null)for(var ct in Object(_e))ze.push(ct);return ze}function Zt(_e){return Qi.call(_e)}function As(_e,ze,ct){return ze=q(ze===void 0?_e.length-1:ze,0),function(){for(var $t=arguments,jt=-1,Pr=q($t.length-ze,0),xr=Array(Pr);++jt<Pr;)xr[jt]=$t[ze+jt];jt=-1;for(var Sr=Array(ze+1);++jt<ze;)Sr[jt]=$t[jt];return Sr[ze]=ct(xr),Vo(_e,this,Sr)}}var xo=kn(zt);function kn(_e){var ze=0,ct=0;return function(){var $t=le(),jt=M-($t-ct);if(ct=$t,jt>0){if(++ze>=F)return arguments[0]}else ze=0;return _e.apply(void 0,arguments)}}function Pn(_e){if(_e!=null){try{return Zn.call(_e)}catch{}try{return _e+""}catch{}}return""}function gr(_e,ze){return _e===ze||_e!==_e&&ze!==ze}var aa=lt(function(){return arguments}())?lt:function(_e){return On(_e)&&qr.call(_e,"callee")&&!Li.call(_e,"callee")},Di=Array.isArray;function Go(_e){return _e!=null&&rr(_e.length)&&!Xn(_e)}var si=O||cs;function Gi(_e){if(!On(_e))return!1;var ze=Re(_e);return ze==G||ze==K||typeof _e.message=="string"&&typeof _e.name=="string"&&!un(_e)}function Xn(_e){if(!ji(_e))return!1;var ze=Re(_e);return ze==ne||ze==oe||ze==ie||ze==Me}function rr(_e){return typeof _e=="number"&&_e>-1&&_e%1==0&&_e<=L}function ji(_e){var ze=typeof _e;return _e!=null&&(ze=="object"||ze=="function")}function On(_e){return _e!=null&&typeof _e=="object"}function un(_e){if(!On(_e)||Re(_e)!=Ke)return!1;var ze=Ko(_e);if(ze===null)return!0;var ct=qr.call(ze,"constructor")&&ze.constructor;return typeof ct=="function"&&ct instanceof ct&&Zn.call(ct)==as}function Wn(_e){return typeof _e=="symbol"||On(_e)&&Re(_e)==Xe}var Aa=Ti?os(Ti):St;function ls(_e){return _e==null?"":ar(_e)}var Ur=ir(function(_e,ze,ct,$t){Rt(ze,ao(ze),_e,$t)});function so(_e){return Go(_e)?Ce(_e):ut(_e)}function ao(_e){return Go(_e)?Ce(_e,!0):xe(_e)}function zr(_e,ze,ct){var $t=s.imports._.templateSettings||s;ct&&Yt(_e,ze,ct)&&(ze=void 0),_e=ls(_e),ze=Ur({},ze,$t,or);var jt=Ur({},ze.imports,$t.imports,or),Pr=so(jt),xr=Ui(jt,Pr),Sr,Rn,Bn=0,la=ze.interpolate||dr,Gr="__p += '",us=RegExp((ze.escape||dr).source+"|"+la.source+"|"+(la===B?br:dr).source+"|"+(ze.evaluate||dr).source+"|$","g"),Ps=qr.call(ze,"sourceURL")?"//# sourceURL="+(ze.sourceURL+"").replace(/[\r\n]/g," ")+`
`:"";_e.replace(us,function(Co,Un,Eo,Os,Fo,se){return Eo||(Eo=Os),Gr+=_e.slice(Bn,se).replace(An,no),Un&&(Sr=!0,Gr+=`' +
__e(`+Un+`) +
'`),Fo&&(Rn=!0,Gr+=`';
`+Fo+`;
__p += '`),Eo&&(Gr+=`' +
((__t = (`+Eo+`)) == null ? '' : __t) +
'`),Bn=se+Co.length,Co}),Gr+=`';
`;var hs=qr.call(ze,"variable")&&ze.variable;hs||(Gr=`with (obj) {
`+Gr+`
}
`),Gr=(Rn?Gr.replace(vt,""):Gr).replace(Ot,"$1").replace(nt,"$1;"),Gr="function("+(hs||"obj")+`) {
`+(hs?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Sr?", __e = _.escape":"")+(Rn?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Gr+`return __p
}`;var bo=wo(function(){return Function(Pr,Ps+"return "+Gr).apply(void 0,xr)});if(bo.source=Gr,Gi(bo))throw bo;return bo}var wo=Pe(function(_e,ze){try{return Vo(_e,void 0,ze)}catch(ct){return Gi(ct)?ct:new Error(ct)}});function hn(_e){return function(){return _e}}function Bo(_e){return _e}function cs(){return!1}u.exports=zr}).call(this,typeof po<"u"?po:typeof self<"u"?self:typeof window<"u"?window:{})},{"lodash._reinterpolate":6,"lodash.templatesettings":10}],10:[function(a,u,m){(function(x){var B=a("lodash._reinterpolate"),s=1/0,F="[object Null]",M="[object Symbol]",z="[object Undefined]",L=/[&<>"']/g,Q=RegExp(L.source),V=/<%-([\s\S]+?)%>/g,ie=/<%([\s\S]+?)%>/g,de={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},re=typeof x=="object"&&x&&x.Object===Object&&x,K=typeof self=="object"&&self&&self.Object===Object&&self,G=re||K||Function("return this")();function ne(ke,xt){for(var Se=-1,ot=ke==null?0:ke.length,vt=Array(ot);++Se<ot;)vt[Se]=xt(ke[Se],Se,ke);return vt}function oe(ke){return function(xt){return ke==null?void 0:ke[xt]}}var we=oe(de),ge=Object.prototype,Ue=ge.hasOwnProperty,Ke=ge.toString,Me=G.Symbol,et=Me?Me.toStringTag:void 0,qe=Me?Me.prototype:void 0,it=qe?qe.toString:void 0,Xe={escape:V,evaluate:ie,interpolate:B,variable:"",imports:{_:{escape:yt}}};function Ne(ke){return ke==null?ke===void 0?z:F:et&&et in Object(ke)?Et(ke):It(ke)}function At(ke){if(typeof ke=="string")return ke;if(Ut(ke))return ne(ke,At)+"";if(Vt(ke))return it?it.call(ke):"";var xt=ke+"";return xt=="0"&&1/ke==-s?"-0":xt}function Et(ke){var xt=Ue.call(ke,et),Se=ke[et];try{ke[et]=void 0;var ot=!0}catch{}var vt=Ke.call(ke);return ot&&(xt?ke[et]=Se:delete ke[et]),vt}function It(ke){return Ke.call(ke)}var Ut=Array.isArray;function Dt(ke){return ke!=null&&typeof ke=="object"}function Vt(ke){return typeof ke=="symbol"||Dt(ke)&&Ne(ke)==M}function Je(ke){return ke==null?"":At(ke)}function yt(ke){return ke=Je(ke),ke&&Q.test(ke)?ke.replace(L,we):ke}u.exports=Xe}).call(this,typeof po<"u"?po:typeof self<"u"?self:typeof window<"u"?window:{})},{"lodash._reinterpolate":6}],11:[function(a,u,m){var x=a("./_root"),B=x.Symbol;u.exports=B},{"./_root":18}],12:[function(a,u,m){var x=a("./_Symbol"),B=a("./_getRawTag"),s=a("./_objectToString"),F="[object Null]",M="[object Undefined]",z=x?x.toStringTag:void 0;function L(Q){return Q==null?Q===void 0?M:F:z&&z in Object(Q)?B(Q):s(Q)}u.exports=L},{"./_Symbol":11,"./_getRawTag":15,"./_objectToString":16}],13:[function(a,u,m){(function(x){var B=typeof x=="object"&&x&&x.Object===Object&&x;u.exports=B}).call(this,typeof po<"u"?po:typeof self<"u"?self:typeof window<"u"?window:{})},{}],14:[function(a,u,m){var x=a("./_overArg"),B=x(Object.getPrototypeOf,Object);u.exports=B},{"./_overArg":17}],15:[function(a,u,m){var x=a("./_Symbol"),B=Object.prototype,s=B.hasOwnProperty,F=B.toString,M=x?x.toStringTag:void 0;function z(L){var Q=s.call(L,M),V=L[M];try{L[M]=void 0;var ie=!0}catch{}var de=F.call(L);return ie&&(Q?L[M]=V:delete L[M]),de}u.exports=z},{"./_Symbol":11}],16:[function(a,u,m){var x=Object.prototype,B=x.toString;function s(F){return B.call(F)}u.exports=s},{}],17:[function(a,u,m){function x(B,s){return function(F){return B(s(F))}}u.exports=x},{}],18:[function(a,u,m){var x=a("./_freeGlobal"),B=typeof self=="object"&&self&&self.Object===Object&&self,s=x||B||Function("return this")();u.exports=s},{"./_freeGlobal":13}],19:[function(a,u,m){function x(B){return B!=null&&typeof B=="object"}u.exports=x},{}],20:[function(a,u,m){var x=a("./_baseGetTag"),B=a("./_getPrototype"),s=a("./isObjectLike"),F="[object Object]",M=Function.prototype,z=Object.prototype,L=M.toString,Q=z.hasOwnProperty,V=L.call(Object);function ie(de){if(!s(de)||x(de)!=F)return!1;var re=B(de);if(re===null)return!0;var K=Q.call(re,"constructor")&&re.constructor;return typeof K=="function"&&K instanceof K&&L.call(K)==V}u.exports=ie},{"./_baseGetTag":12,"./_getPrototype":14,"./isObjectLike":19}],21:[function(a,u,m){var x=u.exports={},B,s;function F(){throw new Error("setTimeout has not been defined")}function M(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?B=setTimeout:B=F}catch{B=F}try{typeof clearTimeout=="function"?s=clearTimeout:s=M}catch{s=M}})();function z(oe){if(B===setTimeout)return setTimeout(oe,0);if((B===F||!B)&&setTimeout)return B=setTimeout,setTimeout(oe,0);try{return B(oe,0)}catch{try{return B.call(null,oe,0)}catch{return B.call(this,oe,0)}}}function L(oe){if(s===clearTimeout)return clearTimeout(oe);if((s===M||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(oe);try{return s(oe)}catch{try{return s.call(null,oe)}catch{return s.call(this,oe)}}}var Q=[],V=!1,ie,de=-1;function re(){!V||!ie||(V=!1,ie.length?Q=ie.concat(Q):de=-1,Q.length&&K())}function K(){if(!V){var oe=z(re);V=!0;for(var we=Q.length;we;){for(ie=Q,Q=[];++de<we;)ie&&ie[de].run();de=-1,we=Q.length}ie=null,V=!1,L(oe)}}x.nextTick=function(oe){var we=new Array(arguments.length-1);if(arguments.length>1)for(var ge=1;ge<arguments.length;ge++)we[ge-1]=arguments[ge];Q.push(new G(oe,we)),Q.length===1&&!V&&z(K)};function G(oe,we){this.fun=oe,this.array=we}G.prototype.run=function(){this.fun.apply(null,this.array)},x.title="browser",x.browser=!0,x.env={},x.argv=[],x.version="",x.versions={};function ne(){}x.on=ne,x.addListener=ne,x.once=ne,x.off=ne,x.removeListener=ne,x.removeAllListeners=ne,x.emit=ne,x.prependListener=ne,x.prependOnceListener=ne,x.listeners=function(oe){return[]},x.binding=function(oe){throw new Error("process.binding is not supported")},x.cwd=function(){return"/"},x.chdir=function(oe){throw new Error("process.chdir is not supported")},x.umask=function(){return 0}},{}],22:[function(a,u,m){m.__esModule=!0;function x(s){return function(F){var M=F.dispatch,z=F.getState;return function(L){return function(Q){return typeof Q=="function"?Q(M,z,s):L(Q)}}}}var B=x();B.withExtraArgument=x,m.default=B},{}],23:[function(a,u,m){m.__esModule=!0;var x=Object.assign||function(z){for(var L=1;L<arguments.length;L++){var Q=arguments[L];for(var V in Q)Object.prototype.hasOwnProperty.call(Q,V)&&(z[V]=Q[V])}return z};m.default=M;var B=a("./compose"),s=F(B);function F(z){return z&&z.__esModule?z:{default:z}}function M(){for(var z=arguments.length,L=Array(z),Q=0;Q<z;Q++)L[Q]=arguments[Q];return function(V){return function(ie,de,re){var K=V(ie,de,re),G=K.dispatch,ne=[],oe={getState:K.getState,dispatch:function(ge){return G(ge)}};return ne=L.map(function(we){return we(oe)}),G=s.default.apply(void 0,ne)(K.dispatch),x({},K,{dispatch:G})}}}},{"./compose":26}],24:[function(a,u,m){m.__esModule=!0,m.default=B;function x(s,F){return function(){return F(s.apply(void 0,arguments))}}function B(s,F){if(typeof s=="function")return x(s,F);if(typeof s!="object"||s===null)throw new Error("bindActionCreators expected an object or a function, instead received "+(s===null?"null":typeof s)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var M=Object.keys(s),z={},L=0;L<M.length;L++){var Q=M[L],V=s[Q];typeof V=="function"&&(z[Q]=x(V,F))}return z}},{}],25:[function(a,u,m){(function(x){m.__esModule=!0,m.default=Q;var B=a("./createStore"),s=a("lodash/isPlainObject");M(s);var F=a("./utils/warning");M(F);function M(V){return V&&V.__esModule?V:{default:V}}function z(V,ie){var de=ie&&ie.type,re=de&&'"'+de.toString()+'"'||"an action";return"Given action "+re+', reducer "'+V+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function L(V){Object.keys(V).forEach(function(ie){var de=V[ie],re=de(void 0,{type:B.ActionTypes.INIT});if(typeof re>"u")throw new Error('Reducer "'+ie+`" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.`);var K="@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".");if(typeof de(void 0,{type:K})>"u")throw new Error('Reducer "'+ie+'" returned undefined when probed with a random type. '+("Don't try to handle "+B.ActionTypes.INIT+' or other actions in "redux/*" ')+"namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.")})}function Q(V){for(var ie=Object.keys(V),de={},re=0;re<ie.length;re++){var K=ie[re];typeof V[K]=="function"&&(de[K]=V[K])}var G=Object.keys(de),ne=void 0;try{L(de)}catch(oe){ne=oe}return function(){var we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ge=arguments[1];if(ne)throw ne;for(var Ue=!1,Ke={},Me=0;Me<G.length;Me++){var et=G[Me],qe=de[et],it=we[et],Xe=qe(it,ge);if(typeof Xe>"u"){var Ne=z(et,ge);throw new Error(Ne)}Ke[et]=Xe,Ue=Ue||Xe!==it}return Ue?Ke:we}}}).call(this,a("_process"))},{"./createStore":27,"./utils/warning":29,_process:21,"lodash/isPlainObject":20}],26:[function(a,u,m){m.__esModule=!0,m.default=x;function x(){for(var B=arguments.length,s=Array(B),F=0;F<B;F++)s[F]=arguments[F];return s.length===0?function(M){return M}:s.length===1?s[0]:s.reduce(function(M,z){return function(){return M(z.apply(void 0,arguments))}})}},{}],27:[function(a,u,m){m.__esModule=!0,m.ActionTypes=void 0,m.default=L;var x=a("lodash/isPlainObject"),B=M(x),s=a("symbol-observable"),F=M(s);function M(Q){return Q&&Q.__esModule?Q:{default:Q}}var z=m.ActionTypes={INIT:"@@redux/INIT"};function L(Q,V,ie){var de;if(typeof V=="function"&&typeof ie>"u"&&(ie=V,V=void 0),typeof ie<"u"){if(typeof ie!="function")throw new Error("Expected the enhancer to be a function.");return ie(L)(Q,V)}if(typeof Q!="function")throw new Error("Expected the reducer to be a function.");var re=Q,K=V,G=[],ne=G,oe=!1;function we(){ne===G&&(ne=G.slice())}function ge(){return K}function Ue(qe){if(typeof qe!="function")throw new Error("Expected listener to be a function.");var it=!0;return we(),ne.push(qe),function(){if(it){it=!1,we();var Ne=ne.indexOf(qe);ne.splice(Ne,1)}}}function Ke(qe){if(!(0,B.default)(qe))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(typeof qe.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(oe)throw new Error("Reducers may not dispatch actions.");try{oe=!0,K=re(K,qe)}finally{oe=!1}for(var it=G=ne,Xe=0;Xe<it.length;Xe++){var Ne=it[Xe];Ne()}return qe}function Me(qe){if(typeof qe!="function")throw new Error("Expected the nextReducer to be a function.");re=qe,Ke({type:z.INIT})}function et(){var qe,it=Ue;return qe={subscribe:function(Ne){if(typeof Ne!="object")throw new TypeError("Expected the observer to be an object.");function At(){Ne.next&&Ne.next(ge())}At();var Et=it(At);return{unsubscribe:Et}}},qe[F.default]=function(){return this},qe}return Ke({type:z.INIT}),de={dispatch:Ke,subscribe:Ue,getState:ge,replaceReducer:Me},de[F.default]=et,de}},{"lodash/isPlainObject":20,"symbol-observable":33}],28:[function(a,u,m){(function(x){m.__esModule=!0,m.compose=m.applyMiddleware=m.bindActionCreators=m.combineReducers=m.createStore=void 0;var B=a("./createStore"),s=K(B),F=a("./combineReducers"),M=K(F),z=a("./bindActionCreators"),L=K(z),Q=a("./applyMiddleware"),V=K(Q),ie=a("./compose"),de=K(ie),re=a("./utils/warning");K(re);function K(G){return G&&G.__esModule?G:{default:G}}m.createStore=s.default,m.combineReducers=M.default,m.bindActionCreators=L.default,m.applyMiddleware=V.default,m.compose=de.default}).call(this,a("_process"))},{"./applyMiddleware":23,"./bindActionCreators":24,"./combineReducers":25,"./compose":26,"./createStore":27,"./utils/warning":29,_process:21}],29:[function(a,u,m){m.__esModule=!0,m.default=x;function x(B){typeof console<"u"&&typeof console.error=="function"&&console.error(B);try{throw new Error(B)}catch{}}},{}],30:[function(a,u,m){var x=a("./src/suggestions");window.Suggestions=u.exports=x},{"./src/suggestions":32}],31:[function(a,u,m){"Use strict";var x=function(B){return this.component=B,this.items=[],this.active=0,this.element=document.createElement("ul"),this.element.className="suggestions",this.selectingListItem=!1,B.el.parentNode.insertBefore(this.element,B.el.nextSibling),this};x.prototype.show=function(){this.element.style.display="block"},x.prototype.hide=function(){this.element.style.display="none"},x.prototype.add=function(B){this.items.push(B)},x.prototype.clear=function(){this.items=[],this.active=0},x.prototype.isEmpty=function(){return!this.items.length},x.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var B=0;B<this.items.length;B++)this.drawItem(this.items[B],this.active===B);this.show()},x.prototype.drawItem=function(B,s){var F=document.createElement("li"),M=document.createElement("a");s&&(F.className+=" active"),M.innerHTML=B.string,F.appendChild(M),this.element.appendChild(F),F.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),F.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,B)}).bind(this))},x.prototype.handleMouseUp=function(B){this.selectingListItem=!1,this.component.value(B.original),this.clear(),this.draw()},x.prototype.move=function(B){this.active=B,this.draw()},x.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)},x.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},u.exports=x},{}],32:[function(a,u,m){var x=a("xtend"),B=a("fuzzy"),s=a("./list"),F=function(M,z,L){return L=L||{},this.options=x({minLength:2,limit:5,filter:!0},L),this.el=M,this.data=z||[],this.list=new s(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(Q){this.handleKeyUp(Q.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(Q){this.handleKeyDown(Q)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(Q){this.handlePaste(Q)}).bind(this)),this};F.prototype.handleKeyUp=function(M){M===40||M===38||M===27||M===13||M===9||this.handleInputChange(this.el.value)},F.prototype.handleKeyDown=function(M){switch(M.keyCode){case 13:case 9:M.preventDefault(),this.list.isEmpty()||(this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}},F.prototype.handleBlur=function(){this.list.selectingListItem||this.list.hide()},F.prototype.handlePaste=function(M){if(M.clipboardData)this.handleInputChange(M.clipboardData.getData("Text"));else{var z=this;setTimeout(function(){z.handleInputChange(M.target.value)},100)}},F.prototype.handleInputChange=function(M){if(this.query=this.normalize(M),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(z){for(var L=0;L<z.length&&(this.list.add(z[L]),L!==this.options.limit-1);L++);this.list.draw()}).bind(this))},F.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},F.prototype.update=function(M){this.data=M,this.handleKeyUp()},F.prototype.clear=function(){this.data=[],this.list.clear()},F.prototype.normalize=function(M){return M=M.toLowerCase(),M},F.prototype.match=function(M,z){return M.indexOf(z)>-1},F.prototype.value=function(M){if(this.selected=M,this.el.value=this.getItemValue(M),document.createEvent){var z=document.createEvent("HTMLEvents");z.initEvent("change",!0,!1),this.el.dispatchEvent(z)}else this.el.fireEvent("onchange")},F.prototype.getCandidates=function(M){var z={pre:"<strong>",post:"</strong>",extract:(function(Q){return this.getItemValue(Q)}).bind(this)},L=this.options.filter?B.filter(this.query,this.data,z):this.data.map((function(Q){for(var V=this.getItemValue(Q),ie=this.normalize(V),de=ie.lastIndexOf(this.query);de>-1;){var re=de+this.query.length;V=V.slice(0,de)+"<strong>"+V.slice(de,re)+"</strong>"+V.slice(re),de=ie.slice(0,de).lastIndexOf(this.query)}return{original:Q,string:V}}).bind(this));M(L)},F.prototype.getItemValue=function(M){return M},u.exports=F},{"./list":31,fuzzy:4,xtend:37}],33:[function(a,u,m){(function(x){Object.defineProperty(m,"__esModule",{value:!0});var B=a("./ponyfill.js"),s=F(B);function F(L){return L&&L.__esModule?L:{default:L}}var M;typeof self<"u"?M=self:typeof window<"u"?M=window:typeof x<"u"?M=x:typeof u<"u"?M=u:M=Function("return this")();var z=(0,s.default)(M);m.default=z}).call(this,typeof po<"u"?po:typeof self<"u"?self:typeof window<"u"?window:{})},{"./ponyfill.js":34}],34:[function(a,u,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=x;function x(B){var s,F=B.Symbol;return typeof F=="function"?F.observable?s=F.observable:(s=F("observable"),F.observable=s):s="@@observable",s}},{}],35:[function(a,u,m){var x=a("turf-meta").coordEach;u.exports=function(B){var s=[1/0,1/0,-1/0,-1/0];return x(B,function(F){s[0]>F[0]&&(s[0]=F[0]),s[1]>F[1]&&(s[1]=F[1]),s[2]<F[0]&&(s[2]=F[0]),s[3]<F[1]&&(s[3]=F[1])}),s}},{"turf-meta":36}],36:[function(a,u,m){function x(M,z,L){var Q,V,ie,de,re,K,G,ne,oe=0,we,ge=M.type==="FeatureCollection",Ue=M.type==="Feature",Ke=ge?M.features.length:1;for(Q=0;Q<Ke;Q++)for(ne=ge?M.features[Q].geometry:Ue?M.geometry:M,we=ne.type==="GeometryCollection",K=we?ne.geometries.length:1,de=0;de<K;de++)if(re=we?ne.geometries[de]:ne,G=re.coordinates,oe=L&&(re.type==="Polygon"||re.type==="MultiPolygon")?1:0,re.type==="Point")z(G);else if(re.type==="LineString"||re.type==="MultiPoint")for(V=0;V<G.length;V++)z(G[V]);else if(re.type==="Polygon"||re.type==="MultiLineString")for(V=0;V<G.length;V++)for(ie=0;ie<G[V].length-oe;ie++)z(G[V][ie]);else if(re.type==="MultiPolygon")for(V=0;V<G.length;V++)for(ie=0;ie<G[V].length;ie++)for(l=0;l<G[V][ie].length-oe;l++)z(G[V][ie][l]);else throw new Error("Unknown Geometry Type")}u.exports.coordEach=x;function B(M,z,L,Q){return x(M,function(V){L=z(L,V)},Q),L}u.exports.coordReduce=B;function s(M,z){var L;switch(M.type){case"FeatureCollection":for(features=M.features,L=0;L<M.features.length;L++)z(M.features[L].properties);break;case"Feature":z(M.properties);break}}u.exports.propEach=s;function F(M,z,L){return s(M,function(Q){L=z(L,Q)}),L}u.exports.propReduce=F},{}],37:[function(a,u,m){u.exports=B;var x=Object.prototype.hasOwnProperty;function B(){for(var s={},F=0;F<arguments.length;F++){var M=arguments[F];for(var z in M)x.call(M,z)&&(s[z]=M[z])}return s}},{}],38:[function(a,u,m){Object.defineProperty(m,"__esModule",{value:!0}),m.queryOrigin=we,m.queryDestination=ge,m.queryOriginCoordinates=Ue,m.queryDestinationCoordinates=Ke,m.clearOrigin=Me,m.clearDestination=et,m.setOptions=qe,m.hoverMarker=it,m.setRouteIndex=Xe,m.createOrigin=Ne,m.createDestination=At,m.setProfile=Et,m.reverse=It,m.setOriginFromCoordinates=Ut,m.setDestinationFromCoordinates=Dt,m.addWaypoint=Vt,m.setWaypoint=Je,m.removeWaypoint=yt,m.eventSubscribe=ke,m.eventEmit=xt;var x=a("../constants/action_types"),B=z(x),s=a("../utils"),F=M(s);function M(Se){return Se&&Se.__esModule?Se:{default:Se}}function z(Se){if(Se&&Se.__esModule)return Se;var ot={};if(Se!=null)for(var vt in Se)Object.prototype.hasOwnProperty.call(Se,vt)&&(ot[vt]=Se[vt]);return ot.default=Se,ot}var L=new XMLHttpRequest;function Q(Se){return function(ot){var vt=F.default.createPoint(Se,{id:"origin","marker-symbol":"A"});ot({type:B.ORIGIN,origin:vt}),ot(xt("origin",{feature:vt}))}}function V(Se){return function(ot){var vt=F.default.createPoint(Se,{id:"destination","marker-symbol":"B"});ot({type:B.DESTINATION,destination:vt}),ot(xt("destination",{feature:vt}))}}function ie(Se){return function(ot){ot({type:B.DIRECTIONS,directions:Se}),ot(xt("route",{route:Se}))}}function de(Se){return{type:B.WAYPOINTS,waypoints:Se}}function re(Se){return{type:B.HOVER_MARKER,hoverMarker:Se}}function K(){return function(Se,ot){var vt=ot(),Ot=vt.api,nt=vt.accessToken,tr=vt.routeIndex,br=vt.profile,Dr=vt.alternatives,sr=vt.congestion,dr=vt.destination,An=vt.language,Ct=vt.exclude;if(dr&&dr.geometry){var mi=G(ot),Nr=[];Nr.push("geometries=polyline"),Dr&&Nr.push("alternatives=true"),sr&&Nr.push("annotations=congestion"),Nr.push("steps=true"),Nr.push("overview=full"),An&&Nr.push("language="+An),Ct&&Nr.push("exclude="+Ct),nt&&Nr.push("access_token="+nt),L.abort(),L.open("GET",""+Ot+br+"/"+mi+".json?"+Nr.join("&"),!0),L.onload=function(){if(L.status>=200&&L.status<400){var $r=JSON.parse(L.responseText);if($r.error)return Se(ie([])),Se(oe($r.error));Se(oe(null)),$r.routes[tr]||Se(Xe(0)),Se(ie($r.routes)),Se(Q($r.waypoints[0].location)),Se(V($r.waypoints[$r.waypoints.length-1].location))}else return Se(ie([])),Se(oe(JSON.parse(L.responseText).message))},L.onerror=function(){return Se(ie([])),Se(oe(JSON.parse(L.responseText).message))},L.send()}}}function G(Se){var ot=Se(),vt=ot.origin,Ot=ot.destination,nt=ot.waypoints,tr=[];return tr.push(vt.geometry.coordinates.join(",")),tr.push(";"),nt.length&&nt.forEach(function(br){tr.push(br.geometry.coordinates.join(",")),tr.push(";")}),tr.push(Ot.geometry.coordinates.join(",")),encodeURIComponent(tr.join(""))}function ne(Se){var ot={id:"waypoint"};return Object.assign(Se,{properties:Se.properties?Object.assign(Se.properties,ot):ot})}function oe(Se){return function(ot){ot({type:"ERROR",error:Se}),Se&&ot(xt("error",{error:Se}))}}function we(Se){return{type:B.ORIGIN_QUERY,query:Se}}function ge(Se){return{type:B.DESTINATION_QUERY,query:Se}}function Ue(Se){return{type:B.ORIGIN_FROM_COORDINATES,coordinates:Se}}function Ke(Se){return{type:B.DESTINATION_FROM_COORDINATES,coordinates:Se}}function Me(){return function(Se){Se({type:B.ORIGIN_CLEAR}),Se(xt("clear",{type:"origin"})),Se(oe(null))}}function et(){return function(Se){Se({type:B.DESTINATION_CLEAR}),Se(xt("clear",{type:"destination"})),Se(oe(null))}}function qe(Se){return{type:B.SET_OPTIONS,options:Se}}function it(Se){return function(ot){var vt=Se?F.default.createPoint(Se,{id:"hover"}):{};ot(re(vt))}}function Xe(Se){return{type:B.ROUTE_INDEX,routeIndex:Se}}function Ne(Se){return function(ot,vt){var Ot=vt(),nt=Ot.destination;ot(Q(Se)),nt.geometry&&ot(K())}}function At(Se){return function(ot,vt){var Ot=vt(),nt=Ot.origin;ot(V(Se)),nt.geometry&&ot(K())}}function Et(Se){return function(ot,vt){var Ot=vt(),nt=Ot.origin,tr=Ot.destination;ot({type:B.DIRECTIONS_PROFILE,profile:Se}),ot(xt("profile",{profile:Se})),nt.geometry&&tr.geometry&&ot(K())}}function It(){return function(Se,ot){var vt=ot();vt.destination.geometry&&Se(Q(vt.destination.geometry.coordinates)),vt.origin.geometry&&Se(V(vt.origin.geometry.coordinates)),vt.origin.geometry&&vt.destination.geometry&&Se(K());for(var Ot=document.getElementsByClassName("suggestions"),nt=0;nt<Ot.length;nt++)Ot[nt].style.visibility="hidden"}}function Ut(Se){return function(ot){if(F.default.validCoords(Se)||(Se=[F.default.wrap(Se[0]),F.default.wrap(Se[1])]),isNaN(Se[0])&&isNaN(Se[1]))return ot(oe(new Error("Coordinates are not valid")));ot(Ue(Se)),ot(Ne(Se))}}function Dt(Se){return function(ot){if(F.default.validCoords(Se)||(Se=[F.default.wrap(Se[0]),F.default.wrap(Se[1])]),isNaN(Se[0])&&isNaN(Se[1]))return ot(oe(new Error("Coordinates are not valid")));ot(At(Se)),ot(Ke(Se))}}function Vt(Se,ot){return function(vt,Ot){var nt=Ot(),tr=nt.destination,br=nt.waypoints;br.splice(Se,0,ne(ot)),vt(de(br)),tr.geometry&&vt(K())}}function Je(Se,ot){return function(vt,Ot){var nt=Ot(),tr=nt.destination,br=nt.waypoints;br[Se]=ne(ot),vt(de(br)),tr.geometry&&vt(K())}}function yt(Se){return function(ot,vt){var Ot=vt(),nt=Ot.destination,tr=Ot.waypoints;tr=tr.filter(function(br){return!F.default.coordinateMatch(br,Se)}),ot(de(tr)),nt.geometry&&ot(K())}}function ke(Se,ot){return function(vt,Ot){var nt=Ot(),tr=nt.events;return tr[Se]=tr[Se]||[],tr[Se].push(ot),{type:B.EVENTS,events:tr}}}function xt(Se,ot){var vt=this;return function(Ot,nt){var tr=nt(),br=tr.events;if(!br[Se])return{type:B.EVENTS,events:br};for(var Dr=br[Se].slice(),sr=0;sr<Dr.length;sr++)Dr[sr].call(vt,ot)}}},{"../constants/action_types":39,"../utils":47}],39:[function(a,u,m){Object.defineProperty(m,"__esModule",{value:!0}),m.DESTINATION="DESTINATION",m.DESTINATION_CLEAR="DESTINATION_CLEAR",m.DESTINATION_QUERY="DESTINATION_QUERY",m.DESTINATION_FROM_COORDINATES="DESTINATION_FROM_COORDINATES",m.DIRECTIONS="DIRECTIONS",m.DIRECTIONS_PROFILE="DIRECTIONS_PROFILE",m.EVENTS="EVENTS",m.ERROR="ERROR",m.HOVER_MARKER="HOVER_MARKER",m.ORIGIN="ORIGIN",m.ORIGIN_CLEAR="ORIGIN_CLEAR",m.ORIGIN_QUERY="ORIGIN_QUERY",m.ORIGIN_FROM_COORDINATES="ORIGIN_FROM_COORDINATES",m.ROUTE_INDEX="ROUTE_INDEX",m.SET_OPTIONS="SET_OPTIONS",m.WAYPOINTS="WAYPOINTS"},{}],40:[function(a,u,m){Object.defineProperty(m,"__esModule",{value:!0});var x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},B=function(){function K(G,ne){for(var oe=0;oe<ne.length;oe++){var we=ne[oe];we.enumerable=we.enumerable||!1,we.configurable=!0,"value"in we&&(we.writable=!0),Object.defineProperty(G,we.key,we)}}return function(G,ne,oe){return ne&&K(G.prototype,ne),oe&&K(G,oe),G}}(),s=a("suggestions"),F=ie(s),M=a("lodash.debounce"),z=ie(M),L=a("events"),Q=a("../utils"),V=ie(Q);function ie(K){return K&&K.__esModule?K:{default:K}}function de(K,G){if(!(K instanceof G))throw new TypeError("Cannot call a class as a function")}var re=function(){function K(G){de(this,K),this._ev=new L.EventEmitter,this.options=G,this.api=G&&G.api||"https://api.mapbox.com/geocoding/v5/mapbox.places/"}return B(K,[{key:"onAdd",value:function(ne){this._map=ne,this.request=new XMLHttpRequest;var oe=document.createElement("div");oe.className="mapboxgl-ctrl-geocoder";var we=document.createElement("span");we.className="geocoder-icon geocoder-icon-search";var ge=this._inputEl=document.createElement("input");ge.type="text",ge.placeholder=this.options.placeholder,ge.addEventListener("keydown",(0,z.default)((function(et){if(!et.target.value)return this._clearEl.classList.remove("active");et.metaKey||[9,27,37,39,13,38,40].indexOf(et.keyCode)!==-1||this._queryFromInput(et.target.value)}).bind(this)),200),ge.addEventListener("change",(function(et){et.target.value&&this._clearEl.classList.add("active");var qe=this._typeahead.selected;if(qe){if(this.options.flyTo)if(qe.bbox&&qe.context&&qe.context.length<=3||qe.bbox&&!qe.context){var it=qe.bbox;ne.fitBounds([[it[0],it[1]],[it[2],it[3]]])}else ne.flyTo({center:qe.center,zoom:this.options.zoom});this._input=qe,this.fire("result",{result:qe})}}).bind(this));var Ue=document.createElement("div");Ue.classList.add("geocoder-pin-right");var Ke=this._clearEl=document.createElement("button");Ke.className="geocoder-icon geocoder-icon-close",Ke.addEventListener("click",this._clear.bind(this));var Me=this._loadingEl=document.createElement("span");return Me.className="geocoder-icon geocoder-icon-loading",Ue.appendChild(Ke),Ue.appendChild(Me),oe.appendChild(we),oe.appendChild(ge),oe.appendChild(Ue),this.options.container&&(this.options.position=!1),this._typeahead=new F.default(ge,[],{filter:!1}),this._typeahead.getItemValue=function(et){return et.place_name},oe}},{key:"_geocode",value:function(ne,oe){this._loadingEl.classList.add("active"),this.fire("loading");var we=this.options,ge=["placeholder","zoom","flyTo","accessToken"],Ue=Object.keys(this.options).filter(function(Me){return ge.indexOf(Me)===-1}).map(function(Me){return Me+"="+we[Me]}),Ke=this.options.accessToken?this.options.accessToken:mapboxgl.accessToken;Ue.push("access_token="+Ke),this.request.abort(),this.request.open("GET",this.api+encodeURIComponent(ne.trim())+".json?"+Ue.join("&"),!0),this.request.onload=(function(){if(this._loadingEl.classList.remove("active"),this.request.status>=200&&this.request.status<400){var Me=JSON.parse(this.request.responseText);return Me.features.length?this._clearEl.classList.add("active"):(this._clearEl.classList.remove("active"),this._typeahead.selected=null),this.fire("results",{results:Me.features}),this._typeahead.update(Me.features),oe(Me.features)}else this.fire("error",{error:JSON.parse(this.request.responseText).message})}).bind(this),this.request.onerror=(function(){this._loadingEl.classList.remove("active"),this.fire("error",{error:JSON.parse(this.request.responseText).message})}).bind(this),this.request.send()}},{key:"_queryFromInput",value:function(ne){ne=ne.trim(),ne||this._clear(),ne.length>2&&this._geocode(ne,(function(oe){this._results=oe}).bind(this))}},{key:"_change",value:function(){var ne=document.createEvent("HTMLEvents");ne.initEvent("change",!0,!1),this._inputEl.dispatchEvent(ne)}},{key:"_query",value:function(ne){ne&&((typeof ne>"u"?"undefined":x(ne))==="object"&&ne.length&&(ne=[V.default.wrap(ne[0]),V.default.wrap(ne[1])].join()),this._geocode(ne,(function(oe){if(oe.length){var we=oe[0];this._results=oe,this._typeahead.selected=we,this._inputEl.value=we.place_name,this._change()}}).bind(this)))}},{key:"_setInput",value:function(ne){ne&&((typeof ne>"u"?"undefined":x(ne))==="object"&&ne.length&&(ne=[V.default.roundWithOriginalPrecision(V.default.wrap(ne[0]),ne[0]),V.default.roundWithOriginalPrecision(V.default.wrap(ne[1]),ne[1])].join()),this._inputEl.value=ne,this._input=null,this._typeahead.selected=null,this._typeahead.clear(),this._change())}},{key:"_clear",value:function(){this._input=null,this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._change(),this._inputEl.focus(),this._clearEl.classList.remove("active"),this.fire("clear")}},{key:"getResult",value:function(){return this._input}},{key:"query",value:function(ne){return this._query(ne),this}},{key:"setInput",value:function(ne){return this._setInput(ne),this}},{key:"on",value:function(ne,oe){return this._ev.on(ne,oe),this._ev.on("error",function(we){console.log(we)}),this}},{key:"fire",value:function(ne,oe){return this._ev.emit(ne,oe),this}},{key:"off",value:function(ne,oe){return this._ev.removeListener(ne,oe),this}}]),K}();m.default=re},{"../utils":47,events:3,"lodash.debounce":7,suggestions:30}],41:[function(a,u,m){Object.defineProperty(m,"__esModule",{value:!0});var x=function(){function G(ne,oe){for(var we=0;we<oe.length;we++){var ge=oe[we];ge.enumerable=ge.enumerable||!1,ge.configurable=!0,"value"in ge&&(ge.writable=!0),Object.defineProperty(ne,ge.key,ge)}}return function(ne,oe,we){return oe&&G(ne.prototype,oe),we&&G(ne,we),ne}}(),B=a("./geocoder"),s=ie(B),F=a("lodash.template"),M=ie(F),z=a("lodash.isequal"),L=ie(z),Q=a("turf-extent"),V=ie(Q);function ie(G){return G&&G.__esModule?G:{default:G}}function de(G,ne){if(!(G instanceof ne))throw new TypeError("Cannot call a class as a function")}var re=(0,M.default)(`<div class='mapbox-directions-component mapbox-directions-inputs'>
  <div class='mapbox-directions-component-keyline'>
    <div class='mapbox-directions-origin'>
      <label class='mapbox-form-label'>
        <span class='directions-icon directions-icon-depart'></span>
      </label>
      <div id='mapbox-directions-origin-input'></div>
    </div>

    <button
      class='directions-icon directions-icon-reverse directions-reverse js-reverse-inputs'
      title='Reverse origin &amp; destination'>
    </button>

    <div class='mapbox-directions-destination'>
      <label class='mapbox-form-label'>
        <span class='directions-icon directions-icon-arrive'></span>
      </label>
      <div id='mapbox-directions-destination-input'></div>
    </div>
  </div>

  <% if (controls.profileSwitcher) { %>
  <div class='mapbox-directions-profile mapbox-directions-component-keyline mapbox-directions-clearfix'><input
      id='mapbox-directions-profile-driving-traffic'
      type='radio'
      name='profile'
      value='mapbox/driving-traffic'
      <% if (profile === 'mapbox/driving-traffic') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-driving-traffic'>Traffic</label>
    <input
      id='mapbox-directions-profile-driving'
      type='radio'
      name='profile'
      value='mapbox/driving'
      <% if (profile === 'mapbox/driving') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-driving'>Driving</label>
    <input
      id='mapbox-directions-profile-walking'
      type='radio'
      name='profile'
      value='mapbox/walking'
      <% if (profile === 'mapbox/walking') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-walking'>Walking</label>
    <input
      id='mapbox-directions-profile-cycling'
      type='radio'
      name='profile'
      value='mapbox/cycling'
      <% if (profile === 'mapbox/cycling') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-cycling'>Cycling</label>
  </div>
  <% } %>
</div>
`),K=function(){function G(ne,oe,we,ge){de(this,G);var Ue=oe.getState(),Ke=Ue.originQuery,Me=Ue.destinationQuery,et=Ue.profile,qe=Ue.controls;ne.innerHTML=re({originQuery:Ke,destinationQuery:Me,profile:et,controls:qe}),this.container=ne,this.actions=we,this.store=oe,this._map=ge,this.onAdd(),this.render()}return x(G,[{key:"animateToCoordinates",value:function(oe,we){var ge=this.store.getState(),Ue=ge.origin,Ke=ge.destination,Me=ge.routePadding;if(Ue.geometry&&Ke.geometry&&!(0,L.default)(Ue.geometry,Ke.geometry)){var et=(0,V.default)({type:"FeatureCollection",features:[Ue,Ke]});this._map.fitBounds([[et[0],et[1]],[et[2],et[3]]],{padding:Me})}else this._map.flyTo({center:we})}},{key:"onAdd",value:function(){var oe=this,we=this.actions,ge=we.clearOrigin,Ue=we.clearDestination,Ke=we.createOrigin,Me=we.createDestination,et=we.setProfile,qe=we.reverse,it=this.store.getState(),Xe=it.geocoder,Ne=it.accessToken,At=it.flyTo,Et=it.placeholderOrigin,It=it.placeholderDestination,Ut=it.zoom;this.originInput=new s.default(Object.assign({},{accessToken:Ne},Xe,{flyTo:At,placeholder:Et,zoom:Ut}));var Dt=this.originInput.onAdd(this._map),Vt=this.container.querySelector("#mapbox-directions-origin-input");Vt.appendChild(Dt),this.destinationInput=new s.default(Object.assign({},{accessToken:Ne},Xe,{flyTo:At,placeholder:It,zoom:Ut}));var Je=this.destinationInput.onAdd(this._map);this.container.querySelector("#mapbox-directions-destination-input").appendChild(Je),this.originInput.on("result",function(ke){var xt=ke.result.center;Ke(xt),oe.animateToCoordinates("origin",xt)}),this.originInput.on("clear",ge),this.destinationInput.on("result",function(ke){var xt=ke.result.center;Me(xt),oe.animateToCoordinates("destination",xt)}),this.destinationInput.on("clear",Ue);var yt=this.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call(yt,function(ke){ke.addEventListener("change",function(){et(ke.value)})}),this.container.querySelector(".js-reverse-inputs").addEventListener("click",function(){var ke=oe.store.getState(),xt=ke.origin,Se=ke.destination;xt&&oe.actions.queryDestination(xt.geometry.coordinates),Se&&oe.actions.queryOrigin(Se.geometry.coordinates),qe()})}},{key:"render",value:function(){var oe=this;this.store.subscribe(function(){var we=oe.store.getState(),ge=we.originQuery,Ue=we.destinationQuery,Ke=we.originQueryCoordinates,Me=we.destinationQueryCoordinates;ge&&(oe.originInput.query(ge),oe.actions.queryOrigin(null)),Ue&&(oe.destinationInput.query(Ue),oe.actions.queryDestination(null)),Ke&&(oe.originInput.setInput(Ke),oe.animateToCoordinates("origin",Ke),oe.actions.queryOriginCoordinates(null)),Me&&(oe.destinationInput.setInput(Me),oe.animateToCoordinates("destination",Me),oe.actions.queryDestinationCoordinates(null))})}}]),G}();m.default=K},{"./geocoder":40,"lodash.isequal":8,"lodash.template":9,"turf-extent":35}],42:[function(a,u,m){Object.defineProperty(m,"__esModule",{value:!0});var x=function(){function K(G,ne){for(var oe=0;oe<ne.length;oe++){var we=ne[oe];we.enumerable=we.enumerable||!1,we.configurable=!0,"value"in we&&(we.writable=!0),Object.defineProperty(G,we.key,we)}}return function(G,ne,oe){return ne&&K(G.prototype,ne),oe&&K(G,oe),G}}(),B=a("../utils"),s=Q(B),F=a("lodash.template"),M=Q(F),z=a("lodash.isequal"),L=Q(z);function Q(K){return K&&K.__esModule?K:{default:K}}function V(K,G){if(!(K instanceof G))throw new TypeError("Cannot call a class as a function")}var ie=(0,M.default)(`<div class='directions-control directions-control-directions'>
  <div class='mapbox-directions-component mapbox-directions-route-summary<% if (routes > 1) { %> mapbox-directions-multiple<% } %>'>
    <% if (routes > 1) { %>
    <div class='mapbox-directions-routes mapbox-directions-clearfix'>
      <% for (var i = 0; i < routes; i++) { %>
        <input type='radio' name='routes' id='<%= i %>' <% if (i === routeIndex) { %>checked<% } %>>
        <label for='<%= i %>' class='mapbox-directions-route'><%= i + 1 %></label>
      <% } %>
    </div>
    <% } %>
    <h1><%- duration %></h1>
    <span><%- distance %></span>
  </div>

  <div class='mapbox-directions-instructions'>
    <div class='mapbox-directions-instructions-wrapper'>
      <ol class='mapbox-directions-steps'>
        <% steps.forEach(function(step) { %>
          <%
            var distance = step.distance ? format(step.distance) : false;
            var icon = step.maneuver.modifier ? step.maneuver.modifier.replace(/\\s+/g, '-').toLowerCase() : step.maneuver.type.replace(/\\s+/g, '-').toLowerCase();

            if (step.maneuver.type === 'arrive' || step.maneuver.type === 'depart') {
              icon = step.maneuver.type;
            }

            if (step.maneuver.type === 'roundabout' || step.maneuver.type === 'rotary') {
              icon= 'roundabout';
            }

            var lng = step.maneuver.location[0];
            var lat = step.maneuver.location[1];
          %>
          <li
            data-lat='<%= lat %>'
            data-lng='<%= lng %>'
            class='mapbox-directions-step'>
            <span class='directions-icon directions-icon-<%= icon %>'></span>
            <div class='mapbox-directions-step-maneuver'>
              <%= step.maneuver.instruction %>
            </div>
            <% if (distance) { %>
              <div class='mapbox-directions-step-distance'>
                <%= distance %>
              </div>
            <% } %>
          </li>
        <% }); %>
      </ol>
    </div>
  </div>
</div>
`),de=(0,M.default)(`<div class='directions-control directions-control-directions'>
  <div class='mapbox-directions-error'>
    <%= error %>
  </div>
</div>
`),re=function(){function K(G,ne,oe,we){V(this,K),this.container=G,this.actions=oe,this.store=ne,this._map=we,this.directions={},this.render()}return x(K,[{key:"render",value:function(){var ne=this;this.store.subscribe(function(){var oe=ne.actions,we=oe.hoverMarker,ge=oe.setRouteIndex,Ue=ne.store.getState(),Ke=Ue.routeIndex,Me=Ue.unit,et=Ue.directions,qe=Ue.error,it=Ue.compile,Xe=!(0,L.default)(et[Ke],ne.directions);if(qe){ne.container.innerHTML=de({error:qe});return}if(et.length&&Xe){var Ne=ne.directions=et[Ke];it&&Ne.legs.forEach(function(It){It.steps.forEach(function(Ut){Ut.maneuver.instruction=it("en",Ut)})}),ne.container.innerHTML=ie({routeIndex:Ke,routes:et.length,steps:Ne.legs[0].steps,format:s.default.format[Me],duration:s.default.format[Me](Ne.distance),distance:s.default.format.duration(Ne.duration)});var At=ne.container.querySelectorAll(".mapbox-directions-step");Array.prototype.forEach.call(At,function(It){var Ut=It.getAttribute("data-lng"),Dt=It.getAttribute("data-lat");It.addEventListener("mouseover",function(){we([Ut,Dt])}),It.addEventListener("mouseout",function(){we(null)}),It.addEventListener("click",function(){ne._map.flyTo({center:[Ut,Dt],zoom:16})})});var Et=ne.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call(Et,function(It){It.addEventListener("change",function(Ut){ge(parseInt(Ut.target.id,10))})})}else ne.container.innerHTML&&Xe&&(ne.container.innerHTML="")})}}]),K}();m.default=re},{"../utils":47,"lodash.isequal":8,"lodash.template":9}],43:[function(a,u,m){Object.defineProperty(m,"__esModule",{value:!0});var x=function(){function it(Xe,Ne){for(var At=0;At<Ne.length;At++){var Et=Ne[At];Et.enumerable=Et.enumerable||!1,Et.configurable=!0,"value"in Et&&(Et.writable=!0),Object.defineProperty(Xe,Et.key,Et)}}return function(Xe,Ne,At){return Ne&&it(Xe.prototype,Ne),At&&it(Xe,At),Xe}}(),B=a("redux"),s=a("redux-thunk"),F=Ue(s),M=a("@mapbox/polyline"),z=a("./utils"),L=Ue(z),Q=a("./reducers"),V=Ue(Q),ie=a("./actions"),de=ge(ie),re=a("./directions_style"),K=Ue(re),G=a("./controls/inputs"),ne=Ue(G),oe=a("./controls/instructions"),we=Ue(oe);function ge(it){if(it&&it.__esModule)return it;var Xe={};if(it!=null)for(var Ne in it)Object.prototype.hasOwnProperty.call(it,Ne)&&(Xe[Ne]=it[Ne]);return Xe.default=it,Xe}function Ue(it){return it&&it.__esModule?it:{default:it}}function Ke(it,Xe){if(!(it instanceof Xe))throw new TypeError("Cannot call a class as a function")}var Me=(0,B.applyMiddleware)(F.default)(B.createStore),et=Me(V.default),qe=function(){function it(Xe){Ke(this,it),this.actions=(0,B.bindActionCreators)(de,et.dispatch),this.actions.setOptions(Xe||{}),this.options=Xe||{},this.onDragDown=this._onDragDown.bind(this),this.onDragMove=this._onDragMove.bind(this),this.onDragUp=this._onDragUp.bind(this),this.move=this._move.bind(this),this.onClick=this._clickHandler().bind(this)}return x(it,[{key:"onAdd",value:function(Ne){var At=this;this._map=Ne;var Et=et.getState(),It=Et.controls,Ut=this.container=document.createElement("div");Ut.className="mapboxgl-ctrl-directions mapboxgl-ctrl";var Dt=document.createElement("div");Dt.className="directions-control directions-control-inputs",new ne.default(Dt,et,this.actions,this._map);var Vt=document.createElement("div");return Vt.className="directions-control directions-control-instructions",new we.default(Vt,et,{hoverMarker:this.actions.hoverMarker,setRouteIndex:this.actions.setRouteIndex},this._map),It.inputs&&Ut.appendChild(Dt),It.instructions&&Ut.appendChild(Vt),this.subscribedActions(),this._map.loaded()?this.mapState():this._map.on("load",function(){return At.mapState()}),Ut}},{key:"onRemove",value:function(Ne){return this.container.parentNode.removeChild(this.container),this.removeRoutes(),Ne.off("mousedown",this.onDragDown),Ne.off("mousemove",this.move),Ne.off("touchstart",this.onDragDown),Ne.off("touchstart",this.move),Ne.off("click",this.onClick),this.storeUnsubscribe&&(this.storeUnsubscribe(),delete this.storeUnsubscribe),K.default.forEach(function(At){Ne.getLayer(At.id)&&Ne.removeLayer(At.id)}),Ne.getSource("directions")&&Ne.removeSource("directions"),this._map=null,this}},{key:"mapState",value:function(){var Ne=this,At=et.getState(),Et=At.profile;At.alternatives,At.congestion;var It=At.styles,Ut=At.interactive;At.compile,this.actions.eventEmit("profile",{profile:Et});var Dt={type:"geojson",data:{type:"FeatureCollection",features:[]}};this._map.addSource("directions",Dt),It&&It.length&&It.forEach(function(Vt){return Ne._map.addLayer(Vt)}),K.default.forEach(function(Vt){Ne._map.getLayer(Vt.id)||Ne._map.addLayer(Vt)}),Ut&&(this._map.on("mousedown",this.onDragDown),this._map.on("mousemove",this.move),this._map.on("click",this.onClick),this._map.on("touchstart",this.move),this._map.on("touchstart",this.onDragDown))}},{key:"subscribedActions",value:function(){var Ne=this;this.storeUnsubscribe=et.subscribe(function(){var At=et.getState(),Et=At.origin,It=At.destination,Ut=At.hoverMarker,Dt=At.directions,Vt=At.routeIndex,Je={type:"FeatureCollection",features:[Et,It,Ut].filter(function(yt){return yt.geometry})};Dt.length&&Dt.forEach(function(yt,ke){var xt=[],Se=(0,M.decode)(yt.geometry,5).map(function(ot){return ot.reverse()});Se.forEach(function(ot,vt){var Ot=xt[xt.length-1],nt=yt.legs[0].annotation&&yt.legs[0].annotation.congestion&&yt.legs[0].annotation.congestion[vt-1];if(Ot&&(!nt||Ot.properties.congestion===nt))Ot.geometry.coordinates.push(ot);else{var tr={geometry:{type:"LineString",coordinates:[]},properties:{"route-index":ke,route:ke===Vt?"selected":"alternate"}};Ot&&tr.geometry.coordinates.push(Ot.geometry.coordinates[Ot.geometry.coordinates.length-1]),tr.geometry.coordinates.push(ot),nt&&(tr.properties.congestion=yt.legs[0].annotation.congestion[vt-1]),xt.push(tr)}}),Je.features=Je.features.concat(xt),ke===Vt&&yt.legs[0].steps.forEach(function(ot){ot.maneuver.type==="waypoint"&&Je.features.push({type:"Feature",geometry:ot.maneuver.location,properties:{id:"waypoint"}})})}),Ne._map.style&&Ne._map.getSource("directions")&&Ne._map.getSource("directions").setData(Je)})}},{key:"_clickHandler",value:function(){var Ne=null,At=250;return function(Et){if(Ne)clearTimeout(Ne),Ne=null,this._map.zoomIn();else{var It=this._onSingleClick.bind(this);Ne=setTimeout(function(){It(Et),Ne=null},At)}}}},{key:"_onSingleClick",value:function(Ne){var At=this,Et=et.getState(),It=Et.origin,Ut=[Ne.lngLat.lng,Ne.lngLat.lat];if(!It.geometry)this.actions.setOriginFromCoordinates(Ut);else{var Dt=this._map.queryRenderedFeatures(Ne.point,{layers:["directions-origin-point","directions-destination-point","directions-waypoint-point","directions-route-line-alt"]});if(Dt.length){if(Dt.forEach(function(Je){Je.layer.id==="directions-waypoint-point"&&At.actions.removeWaypoint(Je)}),Dt[0].properties.route==="alternate"){var Vt=Dt[0].properties["route-index"];this.actions.setRouteIndex(Vt)}}else this.actions.setDestinationFromCoordinates(Ut),this._map.flyTo({center:Ut})}}},{key:"_move",value:function(Ne){var At=this,Et=et.getState(),It=Et.hoverMarker,Ut=this._map.queryRenderedFeatures(Ne.point,{layers:["directions-route-line-alt","directions-route-line","directions-origin-point","directions-destination-point","directions-hover-point"]});this._map.getCanvas().style.cursor=Ut.length?"pointer":"",Ut.length?(this.isCursorOverPoint=Ut[0],this._map.dragPan.disable(),Ut.forEach(function(Dt){Dt.layer.id==="directions-route-line"?At.actions.hoverMarker([Ne.lngLat.lng,Ne.lngLat.lat]):It.geometry&&At.actions.hoverMarker(null)})):this.isCursorOverPoint&&(this.isCursorOverPoint=!1,this._map.dragPan.enable())}},{key:"_onDragDown",value:function(){this.isCursorOverPoint&&(this.isDragging=this.isCursorOverPoint,this._map.getCanvas().style.cursor="grab",this._map.on("mousemove",this.onDragMove),this._map.on("mouseup",this.onDragUp),this._map.on("touchmove",this.onDragMove),this._map.on("touchend",this.onDragUp))}},{key:"_onDragMove",value:function(Ne){if(this.isDragging){var At=[Ne.lngLat.lng,Ne.lngLat.lat];switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.createOrigin(At);break;case"directions-destination-point":this.actions.createDestination(At);break;case"directions-hover-point":this.actions.hoverMarker(At);break}}}},{key:"_onDragUp",value:function(){if(this.isDragging){var Ne=et.getState(),At=Ne.hoverMarker,Et=Ne.origin,It=Ne.destination;switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.setOriginFromCoordinates(Et.geometry.coordinates);break;case"directions-destination-point":this.actions.setDestinationFromCoordinates(It.geometry.coordinates);break;case"directions-hover-point":At.geometry&&!L.default.coordinateMatch(this.isDragging,At)&&this.actions.addWaypoint(0,At);break}this.isDragging=!1,this._map.getCanvas().style.cursor="",this._map.off("touchmove",this.onDragMove),this._map.off("touchend",this.onDragUp),this._map.off("mousemove",this.onDragMove),this._map.off("mouseup",this.onDragUp)}}},{key:"interactive",value:function(Ne){return Ne?(this._map.on("touchstart",this.move),this._map.on("touchstart",this.onDragDown),this._map.on("mousedown",this.onDragDown),this._map.on("mousemove",this.move),this._map.on("click",this.onClick)):(this._map.off("touchstart",this.move),this._map.off("touchstart",this.onDragDown),this._map.off("mousedown",this.onDragDown),this._map.off("mousemove",this.move),this._map.off("click",this.onClick)),this}},{key:"getOrigin",value:function(){return et.getState().origin}},{key:"setOrigin",value:function(Ne){return typeof Ne=="string"?this.actions.queryOrigin(Ne):this.actions.setOriginFromCoordinates(Ne),this}},{key:"getDestination",value:function(){return et.getState().destination}},{key:"setDestination",value:function(Ne){return typeof Ne=="string"?this.actions.queryDestination(Ne):this.actions.setDestinationFromCoordinates(Ne),this}},{key:"reverse",value:function(){return this.actions.reverse(),this}},{key:"addWaypoint",value:function(Ne,At){return At.type||(At=L.default.createPoint(At,{id:"waypoint"})),this.actions.addWaypoint(Ne,At),this}},{key:"setWaypoint",value:function(Ne,At){return At.type||(At=L.default.createPoint(At,{id:"waypoint"})),this.actions.setWaypoint(Ne,At),this}},{key:"removeWaypoint",value:function(Ne){var At=et.getState(),Et=At.waypoints;return this.actions.removeWaypoint(Et[Ne]),this}},{key:"getWaypoints",value:function(){return et.getState().waypoints}},{key:"removeRoutes",value:function(){return this.actions.clearOrigin(),this.actions.clearDestination(),this}},{key:"on",value:function(Ne,At){return this.actions.eventSubscribe(Ne,At),this}}]),it}();m.default=qe},{"./actions":38,"./controls/inputs":41,"./controls/instructions":42,"./directions_style":44,"./reducers":46,"./utils":47,"@mapbox/polyline":1,redux:28,"redux-thunk":22}],44:[function(a,u,m){Object.defineProperty(m,"__esModule",{value:!0});var x=[{id:"directions-route-line-alt",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#bbb","line-width":4},filter:["all",["in","$type","LineString"],["in","route","alternate"]]},{id:"directions-route-line-casing",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2d5f99","line-width":12},filter:["all",["in","$type","LineString"],["in","route","selected"]]},{id:"directions-route-line",type:"line",source:"directions",layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":{property:"congestion",type:"categorical",default:"#4882c5",stops:[["unknown","#4882c5"],["low","#4882c5"],["moderate","#f09a46"],["heavy","#e34341"],["severe","#8b2342"]]},"line-width":7},filter:["all",["in","$type","LineString"],["in","route","selected"]]},{id:"directions-hover-point-casing",type:"circle",source:"directions",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-hover-point",type:"circle",source:"directions",paint:{"circle-radius":6,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-waypoint-point-casing",type:"circle",source:"directions",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-waypoint-point",type:"circle",source:"directions",paint:{"circle-radius":6,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-origin-point",type:"circle",source:"directions",paint:{"circle-radius":18,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-origin-label",type:"symbol",source:"directions",layout:{"text-field":"A","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-destination-point",type:"circle",source:"directions",paint:{"circle-radius":18,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]},{id:"directions-destination-label",type:"symbol",source:"directions",layout:{"text-field":"B","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]}];m.default=x},{}],45:[function(a,u,m){var x=a("./directions"),B=s(x);function s(F){return F&&F.__esModule?F:{default:F}}u.exports=B.default},{"./directions":43}],46:[function(a,u,m){Object.defineProperty(m,"__esModule",{value:!0});var x=a("../constants/action_types.js"),B=z(x),s=a("deep-assign"),F=M(s);function M(V){return V&&V.__esModule?V:{default:V}}function z(V){if(V&&V.__esModule)return V;var ie={};if(V!=null)for(var de in V)Object.prototype.hasOwnProperty.call(V,de)&&(ie[de]=V[de]);return ie.default=V,ie}var L={api:"https://api.mapbox.com/directions/v5/",profile:"mapbox/driving-traffic",alternatives:!1,congestion:!1,unit:"imperial",flyTo:!0,placeholderOrigin:"Choose a starting place",placeholderDestination:"Choose destination",zoom:16,language:"en",compile:null,proximity:!1,styles:[],controls:{profileSwitcher:!0,inputs:!0,instructions:!0},geocoder:{},interactive:!0,events:{},origin:{},destination:{},hoverMarker:{},waypoints:[],originQuery:null,destinationQuery:null,originQueryCoordinates:null,destinationQueryCoordinates:null,directions:[],routeIndex:0,routePadding:80};function Q(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:L,ie=arguments[1];switch(ie.type){case B.SET_OPTIONS:return(0,F.default)({},V,ie.options);case B.DIRECTIONS_PROFILE:return Object.assign({},V,{profile:ie.profile});case B.ORIGIN:return Object.assign({},V,{origin:ie.origin,hoverMarker:{}});case B.DESTINATION:return Object.assign({},V,{destination:ie.destination,hoverMarker:{}});case B.HOVER_MARKER:return Object.assign({},V,{hoverMarker:ie.hoverMarker});case B.WAYPOINTS:return Object.assign({},V,{waypoints:ie.waypoints});case B.ORIGIN_QUERY:return Object.assign({},V,{originQuery:ie.query});case B.DESTINATION_QUERY:return Object.assign({},V,{destinationQuery:ie.query});case B.ORIGIN_FROM_COORDINATES:return Object.assign({},V,{originQueryCoordinates:ie.coordinates});case B.DESTINATION_FROM_COORDINATES:return Object.assign({},V,{destinationQueryCoordinates:ie.coordinates});case B.ORIGIN_CLEAR:return Object.assign({},V,{origin:{},originQuery:"",waypoints:[],directions:[]});case B.DESTINATION_CLEAR:return Object.assign({},V,{destination:{},destinationQuery:"",waypoints:[],directions:[]});case B.DIRECTIONS:return Object.assign({},V,{directions:ie.directions});case B.ROUTE_INDEX:return Object.assign({},V,{routeIndex:ie.routeIndex});case B.ERROR:return Object.assign({},V,{error:ie.error});default:return V}}m.default=Q},{"../constants/action_types.js":39,"deep-assign":2}],47:[function(a,u,m){Object.defineProperty(m,"__esModule",{value:!0});function x(L){return L[0]>=-180&&L[0]<=180&&L[1]>=-90&&L[1]<=90}function B(L,Q){return L=L.geometry.coordinates,Q=Q.geometry.coordinates,L.join()===Q.join()||L[0].toFixed(3)===Q[0].toFixed(3)&&L[1].toFixed(3)===Q[1].toFixed(3)}function s(L){var Q=360,V=((L- -180)%Q+Q)%Q+-180;return V===-180?180:V}function F(L,Q){var V=0;return Math.floor(Q)!==Q&&(V=Q.toString().split(".")[1].length),L.toFixed(Math.min(V,5))}function M(L,Q){return{type:"Feature",geometry:{type:"Point",coordinates:L},properties:Q||{}}}var z={duration:function(Q){var V=Math.floor(Q/60),ie=Math.floor(V/60);return Q%=60,V%=60,ie===0&&V===0?Q+"s":ie===0?V+"min":ie+"h "+V+"min"},imperial:function(Q){var V=Q/1609.344;return V>=100?V.toFixed(0)+"mi":V>=10?V.toFixed(1)+"mi":V>=.1?V.toFixed(2)+"mi":(V*5280).toFixed(0)+"ft"},metric:function(Q){return Q>=1e5?(Q/1e3).toFixed(0)+"km":Q>=1e4?(Q/1e3).toFixed(1)+"km":Q>=100?(Q/1e3).toFixed(2)+"km":Q.toFixed(0)+"m"}};m.default={format:z,coordinateMatch:B,createPoint:M,validCoords:x,wrap:s,roundWithOriginalPrecision:F}},{}]},{},[45])(45)})})(eT);var Eb={exports:{}};(function(t){var o={};function a(x){return Math.floor(Math.abs(x)+.5)*(x>=0?1:-1)}function u(x,B,s){x=a(x*s),B=a(B*s);var F=(x-B)*2;F<0&&(F=-F-1);for(var M="";F>=32;)M+=String.fromCharCode((32|F&31)+63),F/=32;return M+=String.fromCharCode((F|0)+63),M}o.decode=function(x,B){for(var s=0,F=0,M=0,z=[],L=0,Q=0,V=null,ie,de,re=Math.pow(10,Number.isInteger(B)?B:5);s<x.length;){V=null,L=1,Q=0;do V=x.charCodeAt(s++)-63,Q+=(V&31)*L,L*=32;while(V>=32);ie=Q&1?(-Q-1)/2:Q/2,L=1,Q=0;do V=x.charCodeAt(s++)-63,Q+=(V&31)*L,L*=32;while(V>=32);de=Q&1?(-Q-1)/2:Q/2,F+=ie,M+=de,z.push([F/re,M/re])}return z},o.encode=function(x,B){if(!x.length)return"";for(var s=Math.pow(10,Number.isInteger(B)?B:5),F=u(x[0][0],0,s)+u(x[0][1],0,s),M=1;M<x.length;M++){var z=x[M],L=x[M-1];F+=u(z[0],L[0],s),F+=u(z[1],L[1],s)}return F};function m(x){for(var B=[],s=0;s<x.length;s++){var F=x[s].slice();B.push([F[1],F[0]])}return B}o.fromGeoJSON=function(x,B){if(x&&x.type==="Feature"&&(x=x.geometry),!x||x.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return o.encode(m(x.coordinates),B)},o.toGeoJSON=function(x,B){var s=o.decode(x,B);return{type:"LineString",coordinates:m(s)}},t.exports&&(t.exports=o)})(Eb);var tT=Eb.exports;const rT=Dp(tT);/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ky=function(t,o){return Ky=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,u){a.__proto__=u}||function(a,u){for(var m in u)Object.prototype.hasOwnProperty.call(u,m)&&(a[m]=u[m])},Ky(t,o)};function is(t,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");Ky(t,o);function a(){this.constructor=t}t.prototype=o===null?Object.create(o):(a.prototype=o.prototype,new a)}var Gy=function(){return Gy=Object.assign||function(o){for(var a,u=1,m=arguments.length;u<m;u++){a=arguments[u];for(var x in a)Object.prototype.hasOwnProperty.call(a,x)&&(o[x]=a[x])}return o},Gy.apply(this,arguments)};function Hi(t,o,a,u){function m(x){return x instanceof a?x:new a(function(B){B(x)})}return new(a||(a=Promise))(function(x,B){function s(z){try{M(u.next(z))}catch(L){B(L)}}function F(z){try{M(u.throw(z))}catch(L){B(L)}}function M(z){z.done?x(z.value):m(z.value).then(s,F)}M((u=u.apply(t,o||[])).next())})}function wi(t,o){var a={label:0,sent:function(){if(x[0]&1)throw x[1];return x[1]},trys:[],ops:[]},u,m,x,B;return B={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(B[Symbol.iterator]=function(){return this}),B;function s(M){return function(z){return F([M,z])}}function F(M){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,m&&(x=M[0]&2?m.return:M[0]?m.throw||((x=m.return)&&x.call(m),0):m.next)&&!(x=x.call(m,M[1])).done)return x;switch(m=0,x&&(M=[M[0]&2,x.value]),M[0]){case 0:case 1:x=M;break;case 4:return a.label++,{value:M[1],done:!1};case 5:a.label++,m=M[1],M=[0];continue;case 7:M=a.ops.pop(),a.trys.pop();continue;default:if(x=a.trys,!(x=x.length>0&&x[x.length-1])&&(M[0]===6||M[0]===2)){a=0;continue}if(M[0]===3&&(!x||M[1]>x[0]&&M[1]<x[3])){a.label=M[1];break}if(M[0]===6&&a.label<x[1]){a.label=x[1],x=M;break}if(x&&a.label<x[2]){a.label=x[2],a.ops.push(M);break}x[2]&&a.ops.pop(),a.trys.pop();continue}M=o.call(t,a)}catch(z){M=[6,z],m=0}finally{u=x=0}if(M[0]&5)throw M[1];return{value:M[0]?M[1]:void 0,done:!0}}}function gf(t,o,a){if(a||arguments.length===2)for(var u=0,m=o.length,x;u<m;u++)(x||!(u in o))&&(x||(x=Array.prototype.slice.call(o,0,u)),x[u]=o[u]);return t.concat(x||o)}var oa=function(){function t(o,a,u,m){this.left=o,this.top=a,this.width=u,this.height=m}return t.prototype.add=function(o,a,u,m){return new t(this.left+o,this.top+a,this.width+u,this.height+m)},t.fromClientRect=function(o,a){return new t(a.left+o.windowBounds.left,a.top+o.windowBounds.top,a.width,a.height)},t.fromDOMRectList=function(o,a){var u=Array.from(a).find(function(m){return m.width!==0});return u?new t(u.left+o.windowBounds.left,u.top+o.windowBounds.top,u.width,u.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),$p=function(t,o){return oa.fromClientRect(t,o.getBoundingClientRect())},nT=function(t){var o=t.body,a=t.documentElement;if(!o||!a)throw new Error("Unable to get document size");var u=Math.max(Math.max(o.scrollWidth,a.scrollWidth),Math.max(o.offsetWidth,a.offsetWidth),Math.max(o.clientWidth,a.clientWidth)),m=Math.max(Math.max(o.scrollHeight,a.scrollHeight),Math.max(o.offsetHeight,a.offsetHeight),Math.max(o.clientHeight,a.clientHeight));return new oa(0,0,u,m)},qp=function(t){for(var o=[],a=0,u=t.length;a<u;){var m=t.charCodeAt(a++);if(m>=55296&&m<=56319&&a<u){var x=t.charCodeAt(a++);(x&64512)===56320?o.push(((m&1023)<<10)+(x&1023)+65536):(o.push(m),a--)}else o.push(m)}return o},Fn=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var a=t.length;if(!a)return"";for(var u=[],m=-1,x="";++m<a;){var B=t[m];B<=65535?u.push(B):(B-=65536,u.push((B>>10)+55296,B%1024+56320)),(m+1===a||u.length>16384)&&(x+=String.fromCharCode.apply(String,u),u.length=0)}return x},Mw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",iT=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var yf=0;yf<Mw.length;yf++)iT[Mw.charCodeAt(yf)]=yf;var Lw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ku=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var _f=0;_f<Lw.length;_f++)Ku[Lw.charCodeAt(_f)]=_f;var oT=function(t){var o=t.length*.75,a=t.length,u,m=0,x,B,s,F;t[t.length-1]==="="&&(o--,t[t.length-2]==="="&&o--);var M=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(o):new Array(o),z=Array.isArray(M)?M:new Uint8Array(M);for(u=0;u<a;u+=4)x=Ku[t.charCodeAt(u)],B=Ku[t.charCodeAt(u+1)],s=Ku[t.charCodeAt(u+2)],F=Ku[t.charCodeAt(u+3)],z[m++]=x<<2|B>>4,z[m++]=(B&15)<<4|s>>2,z[m++]=(s&3)<<6|F&63;return M},sT=function(t){for(var o=t.length,a=[],u=0;u<o;u+=2)a.push(t[u+1]<<8|t[u]);return a},aT=function(t){for(var o=t.length,a=[],u=0;u<o;u+=4)a.push(t[u+3]<<24|t[u+2]<<16|t[u+1]<<8|t[u]);return a},GA=5,l0=6+5,Pg=2,AT=l0-GA,Fb=65536>>GA,lT=1<<GA,Og=lT-1,cT=1024>>GA,uT=Fb+cT,hT=uT,dT=32,fT=hT+dT,pT=65536>>l0,mT=1<<AT,gT=mT-1,Dw=function(t,o,a){return t.slice?t.slice(o,a):new Uint16Array(Array.prototype.slice.call(t,o,a))},yT=function(t,o,a){return t.slice?t.slice(o,a):new Uint32Array(Array.prototype.slice.call(t,o,a))},_T=function(t,o){var a=oT(t),u=Array.isArray(a)?aT(a):new Uint32Array(a),m=Array.isArray(a)?sT(a):new Uint16Array(a),x=24,B=Dw(m,x/2,u[4]/2),s=u[5]===2?Dw(m,(x+u[4])/2):yT(u,Math.ceil((x+u[4])/4));return new vT(u[0],u[1],u[2],u[3],B,s)},vT=function(){function t(o,a,u,m,x,B){this.initialValue=o,this.errorValue=a,this.highStart=u,this.highValueIndex=m,this.index=x,this.data=B}return t.prototype.get=function(o){var a;if(o>=0){if(o<55296||o>56319&&o<=65535)return a=this.index[o>>GA],a=(a<<Pg)+(o&Og),this.data[a];if(o<=65535)return a=this.index[Fb+(o-55296>>GA)],a=(a<<Pg)+(o&Og),this.data[a];if(o<this.highStart)return a=fT-pT+(o>>l0),a=this.index[a],a+=o>>GA&gT,a=this.index[a],a=(a<<Pg)+(o&Og),this.data[a];if(o<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),kw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xT=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var vf=0;vf<kw.length;vf++)xT[kw.charCodeAt(vf)]=vf;var wT="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Pw=50,BT=1,Ib=2,Tb=3,bT=4,CT=5,Ow=7,Ub=8,Rw=9,Ka=10,jy=11,zw=12,Zy=13,ET=14,Gu=15,Xy=16,xf=17,Du=18,FT=19,Hw=20,Wy=21,ku=22,Rg=23,Kl=24,mo=25,ju=26,Zu=27,Gl=28,IT=29,PA=30,TT=31,wf=32,Bf=33,$y=34,qy=35,Jy=36,Ih=37,Yy=38,Jf=39,Yf=40,zg=41,Sb=42,UT=43,ST=[9001,65288],Qb="!",hr="",bf="",e_=_T(wT),$s=[PA,Jy],t_=[BT,Ib,Tb,CT],Mb=[Ka,Ub],Nw=[Zu,ju],QT=t_.concat(Mb),Vw=[Yy,Jf,Yf,$y,qy],MT=[Gu,Zy],LT=function(t,o){o===void 0&&(o="strict");var a=[],u=[],m=[];return t.forEach(function(x,B){var s=e_.get(x);if(s>Pw?(m.push(!0),s-=Pw):m.push(!1),["normal","auto","loose"].indexOf(o)!==-1&&[8208,8211,12316,12448].indexOf(x)!==-1)return u.push(B),a.push(Xy);if(s===bT||s===jy){if(B===0)return u.push(B),a.push(PA);var F=a[B-1];return QT.indexOf(F)===-1?(u.push(u[B-1]),a.push(F)):(u.push(B),a.push(PA))}if(u.push(B),s===TT)return a.push(o==="strict"?Wy:Ih);if(s===Sb||s===IT)return a.push(PA);if(s===UT)return x>=131072&&x<=196605||x>=196608&&x<=262141?a.push(Ih):a.push(PA);a.push(s)}),[u,a,m]},Hg=function(t,o,a,u){var m=u[a];if(Array.isArray(t)?t.indexOf(m)!==-1:t===m)for(var x=a;x<=u.length;){x++;var B=u[x];if(B===o)return!0;if(B!==Ka)break}if(m===Ka)for(var x=a;x>0;){x--;var s=u[x];if(Array.isArray(t)?t.indexOf(s)!==-1:t===s)for(var F=a;F<=u.length;){F++;var B=u[F];if(B===o)return!0;if(B!==Ka)break}if(s!==Ka)break}return!1},Kw=function(t,o){for(var a=t;a>=0;){var u=o[a];if(u===Ka)a--;else return u}return 0},DT=function(t,o,a,u,m){if(a[u]===0)return hr;var x=u-1;if(Array.isArray(m)&&m[x]===!0)return hr;var B=x-1,s=x+1,F=o[x],M=B>=0?o[B]:0,z=o[s];if(F===Ib&&z===Tb)return hr;if(t_.indexOf(F)!==-1)return Qb;if(t_.indexOf(z)!==-1||Mb.indexOf(z)!==-1)return hr;if(Kw(x,o)===Ub)return bf;if(e_.get(t[x])===jy||(F===wf||F===Bf)&&e_.get(t[s])===jy||F===Ow||z===Ow||F===Rw||[Ka,Zy,Gu].indexOf(F)===-1&&z===Rw||[xf,Du,FT,Kl,Gl].indexOf(z)!==-1||Kw(x,o)===ku||Hg(Rg,ku,x,o)||Hg([xf,Du],Wy,x,o)||Hg(zw,zw,x,o))return hr;if(F===Ka)return bf;if(F===Rg||z===Rg)return hr;if(z===Xy||F===Xy)return bf;if([Zy,Gu,Wy].indexOf(z)!==-1||F===ET||M===Jy&&MT.indexOf(F)!==-1||F===Gl&&z===Jy||z===Hw||$s.indexOf(z)!==-1&&F===mo||$s.indexOf(F)!==-1&&z===mo||F===Zu&&[Ih,wf,Bf].indexOf(z)!==-1||[Ih,wf,Bf].indexOf(F)!==-1&&z===ju||$s.indexOf(F)!==-1&&Nw.indexOf(z)!==-1||Nw.indexOf(F)!==-1&&$s.indexOf(z)!==-1||[Zu,ju].indexOf(F)!==-1&&(z===mo||[ku,Gu].indexOf(z)!==-1&&o[s+1]===mo)||[ku,Gu].indexOf(F)!==-1&&z===mo||F===mo&&[mo,Gl,Kl].indexOf(z)!==-1)return hr;if([mo,Gl,Kl,xf,Du].indexOf(z)!==-1)for(var L=x;L>=0;){var Q=o[L];if(Q===mo)return hr;if([Gl,Kl].indexOf(Q)!==-1)L--;else break}if([Zu,ju].indexOf(z)!==-1)for(var L=[xf,Du].indexOf(F)!==-1?B:x;L>=0;){var Q=o[L];if(Q===mo)return hr;if([Gl,Kl].indexOf(Q)!==-1)L--;else break}if(Yy===F&&[Yy,Jf,$y,qy].indexOf(z)!==-1||[Jf,$y].indexOf(F)!==-1&&[Jf,Yf].indexOf(z)!==-1||[Yf,qy].indexOf(F)!==-1&&z===Yf||Vw.indexOf(F)!==-1&&[Hw,ju].indexOf(z)!==-1||Vw.indexOf(z)!==-1&&F===Zu||$s.indexOf(F)!==-1&&$s.indexOf(z)!==-1||F===Kl&&$s.indexOf(z)!==-1||$s.concat(mo).indexOf(F)!==-1&&z===ku&&ST.indexOf(t[s])===-1||$s.concat(mo).indexOf(z)!==-1&&F===Du)return hr;if(F===zg&&z===zg){for(var V=a[x],ie=1;V>0&&(V--,o[V]===zg);)ie++;if(ie%2!==0)return hr}return F===wf&&z===Bf?hr:bf},kT=function(t,o){o||(o={lineBreak:"normal",wordBreak:"normal"});var a=LT(t,o.lineBreak),u=a[0],m=a[1],x=a[2];(o.wordBreak==="break-all"||o.wordBreak==="break-word")&&(m=m.map(function(s){return[mo,PA,Sb].indexOf(s)!==-1?Ih:s}));var B=o.wordBreak==="keep-all"?x.map(function(s,F){return s&&t[F]>=19968&&t[F]<=40959}):void 0;return[u,m,B]},PT=function(){function t(o,a,u,m){this.codePoints=o,this.required=a===Qb,this.start=u,this.end=m}return t.prototype.slice=function(){return Fn.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),OT=function(t,o){var a=qp(t),u=kT(a,o),m=u[0],x=u[1],B=u[2],s=a.length,F=0,M=0;return{next:function(){if(M>=s)return{done:!0,value:null};for(var z=hr;M<s&&(z=DT(a,x,m,++M,B))===hr;);if(z!==hr||M===s){var L=new PT(a,z,F,M);return F=M,{value:L,done:!1}}return{done:!0,value:null}}}},RT=1,zT=2,Ph=4,Gw=8,Cp=10,jw=47,lh=92,HT=9,NT=32,Cf=34,Pu=61,VT=35,KT=36,GT=37,Ef=39,Ff=40,Ou=41,jT=95,Ji=45,ZT=33,XT=60,WT=62,$T=64,qT=91,JT=93,YT=61,eU=123,If=63,tU=125,Zw=124,rU=126,nU=128,Xw=65533,Ng=42,VA=43,iU=44,oU=58,sU=59,Th=46,aU=0,AU=8,lU=11,cU=14,uU=31,hU=127,Is=-1,Lb=48,Db=97,kb=101,dU=102,fU=117,pU=122,Pb=65,Ob=69,Rb=70,mU=85,gU=90,bi=function(t){return t>=Lb&&t<=57},yU=function(t){return t>=55296&&t<=57343},jl=function(t){return bi(t)||t>=Pb&&t<=Rb||t>=Db&&t<=dU},_U=function(t){return t>=Db&&t<=pU},vU=function(t){return t>=Pb&&t<=gU},xU=function(t){return _U(t)||vU(t)},wU=function(t){return t>=nU},Tf=function(t){return t===Cp||t===HT||t===NT},Ep=function(t){return xU(t)||wU(t)||t===jT},Ww=function(t){return Ep(t)||bi(t)||t===Ji},BU=function(t){return t>=aU&&t<=AU||t===lU||t>=cU&&t<=uU||t===hU},Ra=function(t,o){return t!==lh?!1:o!==Cp},Uf=function(t,o,a){return t===Ji?Ep(o)||Ra(o,a):Ep(t)?!0:!!(t===lh&&Ra(t,o))},Vg=function(t,o,a){return t===VA||t===Ji?bi(o)?!0:o===Th&&bi(a):bi(t===Th?o:t)},bU=function(t){var o=0,a=1;(t[o]===VA||t[o]===Ji)&&(t[o]===Ji&&(a=-1),o++);for(var u=[];bi(t[o]);)u.push(t[o++]);var m=u.length?parseInt(Fn.apply(void 0,u),10):0;t[o]===Th&&o++;for(var x=[];bi(t[o]);)x.push(t[o++]);var B=x.length,s=B?parseInt(Fn.apply(void 0,x),10):0;(t[o]===Ob||t[o]===kb)&&o++;var F=1;(t[o]===VA||t[o]===Ji)&&(t[o]===Ji&&(F=-1),o++);for(var M=[];bi(t[o]);)M.push(t[o++]);var z=M.length?parseInt(Fn.apply(void 0,M),10):0;return a*(m+s*Math.pow(10,-B))*Math.pow(10,F*z)},CU={type:2},EU={type:3},FU={type:4},IU={type:13},TU={type:8},UU={type:21},SU={type:9},QU={type:10},MU={type:11},LU={type:12},DU={type:14},Sf={type:23},kU={type:1},PU={type:25},OU={type:24},RU={type:26},zU={type:27},HU={type:28},NU={type:29},VU={type:31},r_={type:32},zb=function(){function t(){this._value=[]}return t.prototype.write=function(o){this._value=this._value.concat(qp(o))},t.prototype.read=function(){for(var o=[],a=this.consumeToken();a!==r_;)o.push(a),a=this.consumeToken();return o},t.prototype.consumeToken=function(){var o=this.consumeCodePoint();switch(o){case Cf:return this.consumeStringToken(Cf);case VT:var a=this.peekCodePoint(0),u=this.peekCodePoint(1),m=this.peekCodePoint(2);if(Ww(a)||Ra(u,m)){var x=Uf(a,u,m)?zT:RT,B=this.consumeName();return{type:5,value:B,flags:x}}break;case KT:if(this.peekCodePoint(0)===Pu)return this.consumeCodePoint(),IU;break;case Ef:return this.consumeStringToken(Ef);case Ff:return CU;case Ou:return EU;case Ng:if(this.peekCodePoint(0)===Pu)return this.consumeCodePoint(),DU;break;case VA:if(Vg(o,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(o),this.consumeNumericToken();break;case iU:return FU;case Ji:var s=o,F=this.peekCodePoint(0),M=this.peekCodePoint(1);if(Vg(s,F,M))return this.reconsumeCodePoint(o),this.consumeNumericToken();if(Uf(s,F,M))return this.reconsumeCodePoint(o),this.consumeIdentLikeToken();if(F===Ji&&M===WT)return this.consumeCodePoint(),this.consumeCodePoint(),OU;break;case Th:if(Vg(o,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(o),this.consumeNumericToken();break;case jw:if(this.peekCodePoint(0)===Ng)for(this.consumeCodePoint();;){var z=this.consumeCodePoint();if(z===Ng&&(z=this.consumeCodePoint(),z===jw))return this.consumeToken();if(z===Is)return this.consumeToken()}break;case oU:return RU;case sU:return zU;case XT:if(this.peekCodePoint(0)===ZT&&this.peekCodePoint(1)===Ji&&this.peekCodePoint(2)===Ji)return this.consumeCodePoint(),this.consumeCodePoint(),PU;break;case $T:var L=this.peekCodePoint(0),Q=this.peekCodePoint(1),V=this.peekCodePoint(2);if(Uf(L,Q,V)){var B=this.consumeName();return{type:7,value:B}}break;case qT:return HU;case lh:if(Ra(o,this.peekCodePoint(0)))return this.reconsumeCodePoint(o),this.consumeIdentLikeToken();break;case JT:return NU;case YT:if(this.peekCodePoint(0)===Pu)return this.consumeCodePoint(),TU;break;case eU:return MU;case tU:return LU;case fU:case mU:var ie=this.peekCodePoint(0),de=this.peekCodePoint(1);return ie===VA&&(jl(de)||de===If)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(o),this.consumeIdentLikeToken();case Zw:if(this.peekCodePoint(0)===Pu)return this.consumeCodePoint(),SU;if(this.peekCodePoint(0)===Zw)return this.consumeCodePoint(),UU;break;case rU:if(this.peekCodePoint(0)===Pu)return this.consumeCodePoint(),QU;break;case Is:return r_}return Tf(o)?(this.consumeWhiteSpace(),VU):bi(o)?(this.reconsumeCodePoint(o),this.consumeNumericToken()):Ep(o)?(this.reconsumeCodePoint(o),this.consumeIdentLikeToken()):{type:6,value:Fn(o)}},t.prototype.consumeCodePoint=function(){var o=this._value.shift();return typeof o>"u"?-1:o},t.prototype.reconsumeCodePoint=function(o){this._value.unshift(o)},t.prototype.peekCodePoint=function(o){return o>=this._value.length?-1:this._value[o]},t.prototype.consumeUnicodeRangeToken=function(){for(var o=[],a=this.consumeCodePoint();jl(a)&&o.length<6;)o.push(a),a=this.consumeCodePoint();for(var u=!1;a===If&&o.length<6;)o.push(a),a=this.consumeCodePoint(),u=!0;if(u){var m=parseInt(Fn.apply(void 0,o.map(function(F){return F===If?Lb:F})),16),x=parseInt(Fn.apply(void 0,o.map(function(F){return F===If?Rb:F})),16);return{type:30,start:m,end:x}}var B=parseInt(Fn.apply(void 0,o),16);if(this.peekCodePoint(0)===Ji&&jl(this.peekCodePoint(1))){this.consumeCodePoint(),a=this.consumeCodePoint();for(var s=[];jl(a)&&s.length<6;)s.push(a),a=this.consumeCodePoint();var x=parseInt(Fn.apply(void 0,s),16);return{type:30,start:B,end:x}}else return{type:30,start:B,end:B}},t.prototype.consumeIdentLikeToken=function(){var o=this.consumeName();return o.toLowerCase()==="url"&&this.peekCodePoint(0)===Ff?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Ff?(this.consumeCodePoint(),{type:19,value:o}):{type:20,value:o}},t.prototype.consumeUrlToken=function(){var o=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Is)return{type:22,value:""};var a=this.peekCodePoint(0);if(a===Ef||a===Cf){var u=this.consumeStringToken(this.consumeCodePoint());return u.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Is||this.peekCodePoint(0)===Ou)?(this.consumeCodePoint(),{type:22,value:u.value}):(this.consumeBadUrlRemnants(),Sf)}for(;;){var m=this.consumeCodePoint();if(m===Is||m===Ou)return{type:22,value:Fn.apply(void 0,o)};if(Tf(m))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Is||this.peekCodePoint(0)===Ou?(this.consumeCodePoint(),{type:22,value:Fn.apply(void 0,o)}):(this.consumeBadUrlRemnants(),Sf);if(m===Cf||m===Ef||m===Ff||BU(m))return this.consumeBadUrlRemnants(),Sf;if(m===lh)if(Ra(m,this.peekCodePoint(0)))o.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Sf;else o.push(m)}},t.prototype.consumeWhiteSpace=function(){for(;Tf(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var o=this.consumeCodePoint();if(o===Ou||o===Is)return;Ra(o,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(o){for(var a=5e4,u="";o>0;){var m=Math.min(a,o);u+=Fn.apply(void 0,this._value.splice(0,m)),o-=m}return this._value.shift(),u},t.prototype.consumeStringToken=function(o){var a="",u=0;do{var m=this._value[u];if(m===Is||m===void 0||m===o)return a+=this.consumeStringSlice(u),{type:0,value:a};if(m===Cp)return this._value.splice(0,u),kU;if(m===lh){var x=this._value[u+1];x!==Is&&x!==void 0&&(x===Cp?(a+=this.consumeStringSlice(u),u=-1,this._value.shift()):Ra(m,x)&&(a+=this.consumeStringSlice(u),a+=Fn(this.consumeEscapedCodePoint()),u=-1))}u++}while(!0)},t.prototype.consumeNumber=function(){var o=[],a=Ph,u=this.peekCodePoint(0);for((u===VA||u===Ji)&&o.push(this.consumeCodePoint());bi(this.peekCodePoint(0));)o.push(this.consumeCodePoint());u=this.peekCodePoint(0);var m=this.peekCodePoint(1);if(u===Th&&bi(m))for(o.push(this.consumeCodePoint(),this.consumeCodePoint()),a=Gw;bi(this.peekCodePoint(0));)o.push(this.consumeCodePoint());u=this.peekCodePoint(0),m=this.peekCodePoint(1);var x=this.peekCodePoint(2);if((u===Ob||u===kb)&&((m===VA||m===Ji)&&bi(x)||bi(m)))for(o.push(this.consumeCodePoint(),this.consumeCodePoint()),a=Gw;bi(this.peekCodePoint(0));)o.push(this.consumeCodePoint());return[bU(o),a]},t.prototype.consumeNumericToken=function(){var o=this.consumeNumber(),a=o[0],u=o[1],m=this.peekCodePoint(0),x=this.peekCodePoint(1),B=this.peekCodePoint(2);if(Uf(m,x,B)){var s=this.consumeName();return{type:15,number:a,flags:u,unit:s}}return m===GT?(this.consumeCodePoint(),{type:16,number:a,flags:u}):{type:17,number:a,flags:u}},t.prototype.consumeEscapedCodePoint=function(){var o=this.consumeCodePoint();if(jl(o)){for(var a=Fn(o);jl(this.peekCodePoint(0))&&a.length<6;)a+=Fn(this.consumeCodePoint());Tf(this.peekCodePoint(0))&&this.consumeCodePoint();var u=parseInt(a,16);return u===0||yU(u)||u>1114111?Xw:u}return o===Is?Xw:o},t.prototype.consumeName=function(){for(var o="";;){var a=this.consumeCodePoint();if(Ww(a))o+=Fn(a);else if(Ra(a,this.peekCodePoint(0)))o+=Fn(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(a),o}},t}(),Hb=function(){function t(o){this._tokens=o}return t.create=function(o){var a=new zb;return a.write(o),new t(a.read())},t.parseValue=function(o){return t.create(o).parseComponentValue()},t.parseValues=function(o){return t.create(o).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var o=this.consumeToken();o.type===31;)o=this.consumeToken();if(o.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(o);var a=this.consumeComponentValue();do o=this.consumeToken();while(o.type===31);if(o.type===32)return a;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var o=[];;){var a=this.consumeComponentValue();if(a.type===32)return o;o.push(a),o.push()}},t.prototype.consumeComponentValue=function(){var o=this.consumeToken();switch(o.type){case 11:case 28:case 2:return this.consumeSimpleBlock(o.type);case 19:return this.consumeFunction(o)}return o},t.prototype.consumeSimpleBlock=function(o){for(var a={type:o,values:[]},u=this.consumeToken();;){if(u.type===32||GU(u,o))return a;this.reconsumeToken(u),a.values.push(this.consumeComponentValue()),u=this.consumeToken()}},t.prototype.consumeFunction=function(o){for(var a={name:o.value,values:[],type:18};;){var u=this.consumeToken();if(u.type===32||u.type===3)return a;this.reconsumeToken(u),a.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var o=this._tokens.shift();return typeof o>"u"?r_:o},t.prototype.reconsumeToken=function(o){this._tokens.unshift(o)},t}(),Oh=function(t){return t.type===15},Uc=function(t){return t.type===17},Rr=function(t){return t.type===20},KU=function(t){return t.type===0},n_=function(t,o){return Rr(t)&&t.value===o},Nb=function(t){return t.type!==31},wc=function(t){return t.type!==31&&t.type!==4},Ds=function(t){var o=[],a=[];return t.forEach(function(u){if(u.type===4){if(a.length===0)throw new Error("Error parsing function args, zero tokens for arg");o.push(a),a=[];return}u.type!==31&&a.push(u)}),a.length&&o.push(a),o},GU=function(t,o){return o===11&&t.type===12||o===28&&t.type===29?!0:o===2&&t.type===3},AA=function(t){return t.type===17||t.type===15},Qn=function(t){return t.type===16||AA(t)},Vb=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},fi={type:17,number:0,flags:Ph},c0={type:16,number:50,flags:Ph},Ga={type:16,number:100,flags:Ph},Xu=function(t,o,a){var u=t[0],m=t[1];return[Kr(u,o),Kr(typeof m<"u"?m:u,a)]},Kr=function(t,o){if(t.type===16)return t.number/100*o;if(Oh(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},Kb="deg",Gb="grad",jb="rad",Zb="turn",Jp={name:"angle",parse:function(t,o){if(o.type===15)switch(o.unit){case Kb:return Math.PI*o.number/180;case Gb:return Math.PI/200*o.number;case jb:return o.number;case Zb:return Math.PI*2*o.number}throw new Error("Unsupported angle type")}},Xb=function(t){return t.type===15&&(t.unit===Kb||t.unit===Gb||t.unit===jb||t.unit===Zb)},Wb=function(t){var o=t.filter(Rr).map(function(a){return a.value}).join(" ");switch(o){case"to bottom right":case"to right bottom":case"left top":case"top left":return[fi,fi];case"to top":case"bottom":return Po(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[fi,Ga];case"to right":case"left":return Po(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Ga,Ga];case"to bottom":case"top":return Po(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Ga,fi];case"to left":case"right":return Po(270)}return 0},Po=function(t){return Math.PI*t/180},tA={name:"color",parse:function(t,o){if(o.type===18){var a=jU[o.name];if(typeof a>"u")throw new Error('Attempting to parse an unsupported color function "'+o.name+'"');return a(t,o.values)}if(o.type===5){if(o.value.length===3){var u=o.value.substring(0,1),m=o.value.substring(1,2),x=o.value.substring(2,3);return ja(parseInt(u+u,16),parseInt(m+m,16),parseInt(x+x,16),1)}if(o.value.length===4){var u=o.value.substring(0,1),m=o.value.substring(1,2),x=o.value.substring(2,3),B=o.value.substring(3,4);return ja(parseInt(u+u,16),parseInt(m+m,16),parseInt(x+x,16),parseInt(B+B,16)/255)}if(o.value.length===6){var u=o.value.substring(0,2),m=o.value.substring(2,4),x=o.value.substring(4,6);return ja(parseInt(u,16),parseInt(m,16),parseInt(x,16),1)}if(o.value.length===8){var u=o.value.substring(0,2),m=o.value.substring(2,4),x=o.value.substring(4,6),B=o.value.substring(6,8);return ja(parseInt(u,16),parseInt(m,16),parseInt(x,16),parseInt(B,16)/255)}}if(o.type===20){var s=na[o.value.toUpperCase()];if(typeof s<"u")return s}return na.TRANSPARENT}},rA=function(t){return(255&t)===0},ni=function(t){var o=255&t,a=255&t>>8,u=255&t>>16,m=255&t>>24;return o<255?"rgba("+m+","+u+","+a+","+o/255+")":"rgb("+m+","+u+","+a+")"},ja=function(t,o,a,u){return(t<<24|o<<16|a<<8|Math.round(u*255)<<0)>>>0},$w=function(t,o){if(t.type===17)return t.number;if(t.type===16){var a=o===3?1:255;return o===3?t.number/100*a:Math.round(t.number/100*a)}return 0},qw=function(t,o){var a=o.filter(wc);if(a.length===3){var u=a.map($w),m=u[0],x=u[1],B=u[2];return ja(m,x,B,1)}if(a.length===4){var s=a.map($w),m=s[0],x=s[1],B=s[2],F=s[3];return ja(m,x,B,F)}return 0};function Kg(t,o,a){return a<0&&(a+=1),a>=1&&(a-=1),a<1/6?(o-t)*a*6+t:a<1/2?o:a<2/3?(o-t)*6*(2/3-a)+t:t}var Jw=function(t,o){var a=o.filter(wc),u=a[0],m=a[1],x=a[2],B=a[3],s=(u.type===17?Po(u.number):Jp.parse(t,u))/(Math.PI*2),F=Qn(m)?m.number/100:0,M=Qn(x)?x.number/100:0,z=typeof B<"u"&&Qn(B)?Kr(B,1):1;if(F===0)return ja(M*255,M*255,M*255,1);var L=M<=.5?M*(F+1):M+F-M*F,Q=M*2-L,V=Kg(Q,L,s+1/3),ie=Kg(Q,L,s),de=Kg(Q,L,s-1/3);return ja(V*255,ie*255,de*255,z)},jU={hsl:Jw,hsla:Jw,rgb:qw,rgba:qw},ch=function(t,o){return tA.parse(t,Hb.create(o).parseComponentValue())},na={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},ZU={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,o){return o.map(function(a){if(Rr(a))switch(a.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},XU={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Yp=function(t,o){var a=tA.parse(t,o[0]),u=o[1];return u&&Qn(u)?{color:a,stop:u}:{color:a,stop:null}},Yw=function(t,o){var a=t[0],u=t[t.length-1];a.stop===null&&(a.stop=fi),u.stop===null&&(u.stop=Ga);for(var m=[],x=0,B=0;B<t.length;B++){var s=t[B].stop;if(s!==null){var F=Kr(s,o);F>x?m.push(F):m.push(x),x=F}else m.push(null)}for(var M=null,B=0;B<m.length;B++){var z=m[B];if(z===null)M===null&&(M=B);else if(M!==null){for(var L=B-M,Q=m[M-1],V=(z-Q)/(L+1),ie=1;ie<=L;ie++)m[M+ie-1]=V*ie;M=null}}return t.map(function(de,re){var K=de.color;return{color:K,stop:Math.max(Math.min(1,m[re]/o),0)}})},WU=function(t,o,a){var u=o/2,m=a/2,x=Kr(t[0],o)-u,B=m-Kr(t[1],a);return(Math.atan2(B,x)+Math.PI*2)%(Math.PI*2)},$U=function(t,o,a){var u=typeof t=="number"?t:WU(t,o,a),m=Math.abs(o*Math.sin(u))+Math.abs(a*Math.cos(u)),x=o/2,B=a/2,s=m/2,F=Math.sin(u-Math.PI/2)*s,M=Math.cos(u-Math.PI/2)*s;return[m,x-M,x+M,B-F,B+F]},ts=function(t,o){return Math.sqrt(t*t+o*o)},eB=function(t,o,a,u,m){var x=[[0,0],[0,o],[t,0],[t,o]];return x.reduce(function(B,s){var F=s[0],M=s[1],z=ts(a-F,u-M);return(m?z<B.optimumDistance:z>B.optimumDistance)?{optimumCorner:s,optimumDistance:z}:B},{optimumDistance:m?1/0:-1/0,optimumCorner:null}).optimumCorner},qU=function(t,o,a,u,m){var x=0,B=0;switch(t.size){case 0:t.shape===0?x=B=Math.min(Math.abs(o),Math.abs(o-u),Math.abs(a),Math.abs(a-m)):t.shape===1&&(x=Math.min(Math.abs(o),Math.abs(o-u)),B=Math.min(Math.abs(a),Math.abs(a-m)));break;case 2:if(t.shape===0)x=B=Math.min(ts(o,a),ts(o,a-m),ts(o-u,a),ts(o-u,a-m));else if(t.shape===1){var s=Math.min(Math.abs(a),Math.abs(a-m))/Math.min(Math.abs(o),Math.abs(o-u)),F=eB(u,m,o,a,!0),M=F[0],z=F[1];x=ts(M-o,(z-a)/s),B=s*x}break;case 1:t.shape===0?x=B=Math.max(Math.abs(o),Math.abs(o-u),Math.abs(a),Math.abs(a-m)):t.shape===1&&(x=Math.max(Math.abs(o),Math.abs(o-u)),B=Math.max(Math.abs(a),Math.abs(a-m)));break;case 3:if(t.shape===0)x=B=Math.max(ts(o,a),ts(o,a-m),ts(o-u,a),ts(o-u,a-m));else if(t.shape===1){var s=Math.max(Math.abs(a),Math.abs(a-m))/Math.max(Math.abs(o),Math.abs(o-u)),L=eB(u,m,o,a,!1),M=L[0],z=L[1];x=ts(M-o,(z-a)/s),B=s*x}break}return Array.isArray(t.size)&&(x=Kr(t.size[0],u),B=t.size.length===2?Kr(t.size[1],m):x),[x,B]},JU=function(t,o){var a=Po(180),u=[];return Ds(o).forEach(function(m,x){if(x===0){var B=m[0];if(B.type===20&&B.value==="to"){a=Wb(m);return}else if(Xb(B)){a=Jp.parse(t,B);return}}var s=Yp(t,m);u.push(s)}),{angle:a,stops:u,type:1}},Qf=function(t,o){var a=Po(180),u=[];return Ds(o).forEach(function(m,x){if(x===0){var B=m[0];if(B.type===20&&["top","left","right","bottom"].indexOf(B.value)!==-1){a=Wb(m);return}else if(Xb(B)){a=(Jp.parse(t,B)+Po(270))%Po(360);return}}var s=Yp(t,m);u.push(s)}),{angle:a,stops:u,type:1}},YU=function(t,o){var a=Po(180),u=[],m=1,x=0,B=3,s=[];return Ds(o).forEach(function(F,M){var z=F[0];if(M===0){if(Rr(z)&&z.value==="linear"){m=1;return}else if(Rr(z)&&z.value==="radial"){m=2;return}}if(z.type===18){if(z.name==="from"){var L=tA.parse(t,z.values[0]);u.push({stop:fi,color:L})}else if(z.name==="to"){var L=tA.parse(t,z.values[0]);u.push({stop:Ga,color:L})}else if(z.name==="color-stop"){var Q=z.values.filter(wc);if(Q.length===2){var L=tA.parse(t,Q[1]),V=Q[0];Uc(V)&&u.push({stop:{type:16,number:V.number*100,flags:V.flags},color:L})}}}}),m===1?{angle:(a+Po(180))%Po(360),stops:u,type:m}:{size:B,shape:x,stops:u,position:s,type:m}},$b="closest-side",qb="farthest-side",Jb="closest-corner",Yb="farthest-corner",eC="circle",tC="ellipse",rC="cover",nC="contain",eS=function(t,o){var a=0,u=3,m=[],x=[];return Ds(o).forEach(function(B,s){var F=!0;if(s===0){var M=!1;F=B.reduce(function(L,Q){if(M)if(Rr(Q))switch(Q.value){case"center":return x.push(c0),L;case"top":case"left":return x.push(fi),L;case"right":case"bottom":return x.push(Ga),L}else(Qn(Q)||AA(Q))&&x.push(Q);else if(Rr(Q))switch(Q.value){case eC:return a=0,!1;case tC:return a=1,!1;case"at":return M=!0,!1;case $b:return u=0,!1;case rC:case qb:return u=1,!1;case nC:case Jb:return u=2,!1;case Yb:return u=3,!1}else if(AA(Q)||Qn(Q))return Array.isArray(u)||(u=[]),u.push(Q),!1;return L},F)}if(F){var z=Yp(t,B);m.push(z)}}),{size:u,shape:a,stops:m,position:x,type:2}},Mf=function(t,o){var a=0,u=3,m=[],x=[];return Ds(o).forEach(function(B,s){var F=!0;if(s===0?F=B.reduce(function(z,L){if(Rr(L))switch(L.value){case"center":return x.push(c0),!1;case"top":case"left":return x.push(fi),!1;case"right":case"bottom":return x.push(Ga),!1}else if(Qn(L)||AA(L))return x.push(L),!1;return z},F):s===1&&(F=B.reduce(function(z,L){if(Rr(L))switch(L.value){case eC:return a=0,!1;case tC:return a=1,!1;case nC:case $b:return u=0,!1;case qb:return u=1,!1;case Jb:return u=2,!1;case rC:case Yb:return u=3,!1}else if(AA(L)||Qn(L))return Array.isArray(u)||(u=[]),u.push(L),!1;return z},F)),F){var M=Yp(t,B);m.push(M)}}),{size:u,shape:a,stops:m,position:x,type:2}},tS=function(t){return t.type===1},rS=function(t){return t.type===2},u0={name:"image",parse:function(t,o){if(o.type===22){var a={url:o.value,type:0};return t.cache.addImage(o.value),a}if(o.type===18){var u=iC[o.name];if(typeof u>"u")throw new Error('Attempting to parse an unsupported image function "'+o.name+'"');return u(t,o.values)}throw new Error("Unsupported image type "+o.type)}};function nS(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!iC[t.name])}var iC={"linear-gradient":JU,"-moz-linear-gradient":Qf,"-ms-linear-gradient":Qf,"-o-linear-gradient":Qf,"-webkit-linear-gradient":Qf,"radial-gradient":eS,"-moz-radial-gradient":Mf,"-ms-radial-gradient":Mf,"-o-radial-gradient":Mf,"-webkit-radial-gradient":Mf,"-webkit-gradient":YU},iS={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,o){if(o.length===0)return[];var a=o[0];return a.type===20&&a.value==="none"?[]:o.filter(function(u){return wc(u)&&nS(u)}).map(function(u){return u0.parse(t,u)})}},oS={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,o){return o.map(function(a){if(Rr(a))switch(a.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},sS={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,o){return Ds(o).map(function(a){return a.filter(Qn)}).map(Vb)}},aS={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,o){return Ds(o).map(function(a){return a.filter(Rr).map(function(u){return u.value}).join(" ")}).map(AS)}},AS=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},gc;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(gc||(gc={}));var lS={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,o){return Ds(o).map(function(a){return a.filter(cS)})}},cS=function(t){return Rr(t)||Qn(t)},em=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},uS=em("top"),hS=em("right"),dS=em("bottom"),fS=em("left"),tm=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(o,a){return Vb(a.filter(Qn))}}},pS=tm("top-left"),mS=tm("top-right"),gS=tm("bottom-right"),yS=tm("bottom-left"),rm=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(o,a){switch(a){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},_S=rm("top"),vS=rm("right"),xS=rm("bottom"),wS=rm("left"),nm=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(o,a){return Oh(a)?a.number:0}}},BS=nm("top"),bS=nm("right"),CS=nm("bottom"),ES=nm("left"),FS={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},IS={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,o){switch(o){case"rtl":return 1;case"ltr":default:return 0}}},TS={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,o){return o.filter(Rr).reduce(function(a,u){return a|US(u.value)},0)}},US=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},SS={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,o){switch(o){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},QS={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,o){return o.type===20&&o.value==="normal"?0:o.type===17||o.type===15?o.number:0}},Fp;(function(t){t.NORMAL="normal",t.STRICT="strict"})(Fp||(Fp={}));var MS={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,o){switch(o){case"strict":return Fp.STRICT;case"normal":default:return Fp.NORMAL}}},LS={name:"line-height",initialValue:"normal",prefix:!1,type:4},tB=function(t,o){return Rr(t)&&t.value==="normal"?1.2*o:t.type===17?o*t.number:Qn(t)?Kr(t,o):o},DS={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,o){return o.type===20&&o.value==="none"?null:u0.parse(t,o)}},kS={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,o){switch(o){case"inside":return 0;case"outside":default:return 1}}},i_={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,o){switch(o){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},im=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},PS=im("top"),OS=im("right"),RS=im("bottom"),zS=im("left"),HS={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,o){return o.filter(Rr).map(function(a){switch(a.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},NS={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,o){switch(o){case"break-word":return"break-word";case"normal":default:return"normal"}}},om=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},VS=om("top"),KS=om("right"),GS=om("bottom"),jS=om("left"),ZS={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,o){switch(o){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},XS={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,o){switch(o){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},WS={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,o){return o.length===1&&n_(o[0],"none")?[]:Ds(o).map(function(a){for(var u={color:na.TRANSPARENT,offsetX:fi,offsetY:fi,blur:fi},m=0,x=0;x<a.length;x++){var B=a[x];AA(B)?(m===0?u.offsetX=B:m===1?u.offsetY=B:u.blur=B,m++):u.color=tA.parse(t,B)}return u})}},$S={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,o){switch(o){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},qS={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,o){if(o.type===20&&o.value==="none")return null;if(o.type===18){var a=eQ[o.name];if(typeof a>"u")throw new Error('Attempting to parse an unsupported transform function "'+o.name+'"');return a(o.values)}return null}},JS=function(t){var o=t.filter(function(a){return a.type===17}).map(function(a){return a.number});return o.length===6?o:null},YS=function(t){var o=t.filter(function(F){return F.type===17}).map(function(F){return F.number}),a=o[0],u=o[1];o[2],o[3];var m=o[4],x=o[5];o[6],o[7],o[8],o[9],o[10],o[11];var B=o[12],s=o[13];return o[14],o[15],o.length===16?[a,u,m,x,B,s]:null},eQ={matrix:JS,matrix3d:YS},rB={type:16,number:50,flags:Ph},tQ=[rB,rB],rQ={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,o){var a=o.filter(Qn);return a.length!==2?tQ:[a[0],a[1]]}},nQ={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,o){switch(o){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},uh;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(uh||(uh={}));var iQ={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,o){switch(o){case"break-all":return uh.BREAK_ALL;case"keep-all":return uh.KEEP_ALL;case"normal":default:return uh.NORMAL}}},oQ={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,o){if(o.type===20)return{auto:!0,order:0};if(Uc(o))return{auto:!1,order:o.number};throw new Error("Invalid z-index number parsed")}},oC={name:"time",parse:function(t,o){if(o.type===15)switch(o.unit.toLowerCase()){case"s":return 1e3*o.number;case"ms":return o.number}throw new Error("Unsupported time type")}},sQ={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,o){return Uc(o)?o.number:1}},aQ={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},AQ={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,o){return o.filter(Rr).map(function(a){switch(a.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(a){return a!==0})}},lQ={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,o){var a=[],u=[];return o.forEach(function(m){switch(m.type){case 20:case 0:a.push(m.value);break;case 17:a.push(m.number.toString());break;case 4:u.push(a.join(" ")),a.length=0;break}}),a.length&&u.push(a.join(" ")),u.map(function(m){return m.indexOf(" ")===-1?m:"'"+m+"'"})}},cQ={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},uQ={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,o){if(Uc(o))return o.number;if(Rr(o))switch(o.value){case"bold":return 700;case"normal":default:return 400}return 400}},hQ={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,o){return o.filter(Rr).map(function(a){return a.value})}},dQ={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,o){switch(o){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Gn=function(t,o){return(t&o)!==0},fQ={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,o){if(o.length===0)return[];var a=o[0];return a.type===20&&a.value==="none"?[]:o}},pQ={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,o){if(o.length===0)return null;var a=o[0];if(a.type===20&&a.value==="none")return null;for(var u=[],m=o.filter(Nb),x=0;x<m.length;x++){var B=m[x],s=m[x+1];if(B.type===20){var F=s&&Uc(s)?s.number:1;u.push({counter:B.value,increment:F})}}return u}},mQ={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,o){if(o.length===0)return[];for(var a=[],u=o.filter(Nb),m=0;m<u.length;m++){var x=u[m],B=u[m+1];if(Rr(x)&&x.value!=="none"){var s=B&&Uc(B)?B.number:0;a.push({counter:x.value,reset:s})}}return a}},gQ={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,o){return o.filter(Oh).map(function(a){return oC.parse(t,a)})}},yQ={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,o){if(o.length===0)return null;var a=o[0];if(a.type===20&&a.value==="none")return null;var u=[],m=o.filter(KU);if(m.length%2!==0)return null;for(var x=0;x<m.length;x+=2){var B=m[x].value,s=m[x+1].value;u.push({open:B,close:s})}return u}},nB=function(t,o,a){if(!t)return"";var u=t[Math.min(o,t.length-1)];return u?a?u.open:u.close:""},_Q={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,o){return o.length===1&&n_(o[0],"none")?[]:Ds(o).map(function(a){for(var u={color:255,offsetX:fi,offsetY:fi,blur:fi,spread:fi,inset:!1},m=0,x=0;x<a.length;x++){var B=a[x];n_(B,"inset")?u.inset=!0:AA(B)?(m===0?u.offsetX=B:m===1?u.offsetY=B:m===2?u.blur=B:u.spread=B,m++):u.color=tA.parse(t,B)}return u})}},vQ={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,o){var a=[0,1,2],u=[];return o.filter(Rr).forEach(function(m){switch(m.value){case"stroke":u.push(1);break;case"fill":u.push(0);break;case"markers":u.push(2);break}}),a.forEach(function(m){u.indexOf(m)===-1&&u.push(m)}),u}},xQ={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},wQ={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,o){return Oh(o)?o.number:0}},BQ=function(){function t(o,a){var u,m;this.animationDuration=Qt(o,gQ,a.animationDuration),this.backgroundClip=Qt(o,ZU,a.backgroundClip),this.backgroundColor=Qt(o,XU,a.backgroundColor),this.backgroundImage=Qt(o,iS,a.backgroundImage),this.backgroundOrigin=Qt(o,oS,a.backgroundOrigin),this.backgroundPosition=Qt(o,sS,a.backgroundPosition),this.backgroundRepeat=Qt(o,aS,a.backgroundRepeat),this.backgroundSize=Qt(o,lS,a.backgroundSize),this.borderTopColor=Qt(o,uS,a.borderTopColor),this.borderRightColor=Qt(o,hS,a.borderRightColor),this.borderBottomColor=Qt(o,dS,a.borderBottomColor),this.borderLeftColor=Qt(o,fS,a.borderLeftColor),this.borderTopLeftRadius=Qt(o,pS,a.borderTopLeftRadius),this.borderTopRightRadius=Qt(o,mS,a.borderTopRightRadius),this.borderBottomRightRadius=Qt(o,gS,a.borderBottomRightRadius),this.borderBottomLeftRadius=Qt(o,yS,a.borderBottomLeftRadius),this.borderTopStyle=Qt(o,_S,a.borderTopStyle),this.borderRightStyle=Qt(o,vS,a.borderRightStyle),this.borderBottomStyle=Qt(o,xS,a.borderBottomStyle),this.borderLeftStyle=Qt(o,wS,a.borderLeftStyle),this.borderTopWidth=Qt(o,BS,a.borderTopWidth),this.borderRightWidth=Qt(o,bS,a.borderRightWidth),this.borderBottomWidth=Qt(o,CS,a.borderBottomWidth),this.borderLeftWidth=Qt(o,ES,a.borderLeftWidth),this.boxShadow=Qt(o,_Q,a.boxShadow),this.color=Qt(o,FS,a.color),this.direction=Qt(o,IS,a.direction),this.display=Qt(o,TS,a.display),this.float=Qt(o,SS,a.cssFloat),this.fontFamily=Qt(o,lQ,a.fontFamily),this.fontSize=Qt(o,cQ,a.fontSize),this.fontStyle=Qt(o,dQ,a.fontStyle),this.fontVariant=Qt(o,hQ,a.fontVariant),this.fontWeight=Qt(o,uQ,a.fontWeight),this.letterSpacing=Qt(o,QS,a.letterSpacing),this.lineBreak=Qt(o,MS,a.lineBreak),this.lineHeight=Qt(o,LS,a.lineHeight),this.listStyleImage=Qt(o,DS,a.listStyleImage),this.listStylePosition=Qt(o,kS,a.listStylePosition),this.listStyleType=Qt(o,i_,a.listStyleType),this.marginTop=Qt(o,PS,a.marginTop),this.marginRight=Qt(o,OS,a.marginRight),this.marginBottom=Qt(o,RS,a.marginBottom),this.marginLeft=Qt(o,zS,a.marginLeft),this.opacity=Qt(o,sQ,a.opacity);var x=Qt(o,HS,a.overflow);this.overflowX=x[0],this.overflowY=x[x.length>1?1:0],this.overflowWrap=Qt(o,NS,a.overflowWrap),this.paddingTop=Qt(o,VS,a.paddingTop),this.paddingRight=Qt(o,KS,a.paddingRight),this.paddingBottom=Qt(o,GS,a.paddingBottom),this.paddingLeft=Qt(o,jS,a.paddingLeft),this.paintOrder=Qt(o,vQ,a.paintOrder),this.position=Qt(o,XS,a.position),this.textAlign=Qt(o,ZS,a.textAlign),this.textDecorationColor=Qt(o,aQ,(u=a.textDecorationColor)!==null&&u!==void 0?u:a.color),this.textDecorationLine=Qt(o,AQ,(m=a.textDecorationLine)!==null&&m!==void 0?m:a.textDecoration),this.textShadow=Qt(o,WS,a.textShadow),this.textTransform=Qt(o,$S,a.textTransform),this.transform=Qt(o,qS,a.transform),this.transformOrigin=Qt(o,rQ,a.transformOrigin),this.visibility=Qt(o,nQ,a.visibility),this.webkitTextStrokeColor=Qt(o,xQ,a.webkitTextStrokeColor),this.webkitTextStrokeWidth=Qt(o,wQ,a.webkitTextStrokeWidth),this.wordBreak=Qt(o,iQ,a.wordBreak),this.zIndex=Qt(o,oQ,a.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return rA(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return Gn(this.display,4)||Gn(this.display,33554432)||Gn(this.display,268435456)||Gn(this.display,536870912)||Gn(this.display,67108864)||Gn(this.display,134217728)},t}(),bQ=function(){function t(o,a){this.content=Qt(o,fQ,a.content),this.quotes=Qt(o,yQ,a.quotes)}return t}(),iB=function(){function t(o,a){this.counterIncrement=Qt(o,pQ,a.counterIncrement),this.counterReset=Qt(o,mQ,a.counterReset)}return t}(),Qt=function(t,o,a){var u=new zb,m=a!==null&&typeof a<"u"?a.toString():o.initialValue;u.write(m);var x=new Hb(u.read());switch(o.type){case 2:var B=x.parseComponentValue();return o.parse(t,Rr(B)?B.value:o.initialValue);case 0:return o.parse(t,x.parseComponentValue());case 1:return o.parse(t,x.parseComponentValues());case 4:return x.parseComponentValue();case 3:switch(o.format){case"angle":return Jp.parse(t,x.parseComponentValue());case"color":return tA.parse(t,x.parseComponentValue());case"image":return u0.parse(t,x.parseComponentValue());case"length":var s=x.parseComponentValue();return AA(s)?s:fi;case"length-percentage":var F=x.parseComponentValue();return Qn(F)?F:fi;case"time":return oC.parse(t,x.parseComponentValue())}break}},CQ="data-html2canvas-debug",EQ=function(t){var o=t.getAttribute(CQ);switch(o){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},o_=function(t,o){var a=EQ(t);return a===1||o===a},ks=function(){function t(o,a){if(this.context=o,this.textNodes=[],this.elements=[],this.flags=0,o_(a,3))debugger;this.styles=new BQ(o,window.getComputedStyle(a,null)),A_(a)&&(this.styles.animationDuration.some(function(u){return u>0})&&(a.style.animationDuration="0s"),this.styles.transform!==null&&(a.style.transform="none")),this.bounds=$p(this.context,a),o_(a,4)&&(this.flags|=16)}return t}(),FQ="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",oB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wu=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Lf=0;Lf<oB.length;Lf++)Wu[oB.charCodeAt(Lf)]=Lf;var IQ=function(t){var o=t.length*.75,a=t.length,u,m=0,x,B,s,F;t[t.length-1]==="="&&(o--,t[t.length-2]==="="&&o--);var M=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(o):new Array(o),z=Array.isArray(M)?M:new Uint8Array(M);for(u=0;u<a;u+=4)x=Wu[t.charCodeAt(u)],B=Wu[t.charCodeAt(u+1)],s=Wu[t.charCodeAt(u+2)],F=Wu[t.charCodeAt(u+3)],z[m++]=x<<2|B>>4,z[m++]=(B&15)<<4|s>>2,z[m++]=(s&3)<<6|F&63;return M},TQ=function(t){for(var o=t.length,a=[],u=0;u<o;u+=2)a.push(t[u+1]<<8|t[u]);return a},UQ=function(t){for(var o=t.length,a=[],u=0;u<o;u+=4)a.push(t[u+3]<<24|t[u+2]<<16|t[u+1]<<8|t[u]);return a},jA=5,h0=6+5,Gg=2,SQ=h0-jA,sC=65536>>jA,QQ=1<<jA,jg=QQ-1,MQ=1024>>jA,LQ=sC+MQ,DQ=LQ,kQ=32,PQ=DQ+kQ,OQ=65536>>h0,RQ=1<<SQ,zQ=RQ-1,sB=function(t,o,a){return t.slice?t.slice(o,a):new Uint16Array(Array.prototype.slice.call(t,o,a))},HQ=function(t,o,a){return t.slice?t.slice(o,a):new Uint32Array(Array.prototype.slice.call(t,o,a))},NQ=function(t,o){var a=IQ(t),u=Array.isArray(a)?UQ(a):new Uint32Array(a),m=Array.isArray(a)?TQ(a):new Uint16Array(a),x=24,B=sB(m,x/2,u[4]/2),s=u[5]===2?sB(m,(x+u[4])/2):HQ(u,Math.ceil((x+u[4])/4));return new VQ(u[0],u[1],u[2],u[3],B,s)},VQ=function(){function t(o,a,u,m,x,B){this.initialValue=o,this.errorValue=a,this.highStart=u,this.highValueIndex=m,this.index=x,this.data=B}return t.prototype.get=function(o){var a;if(o>=0){if(o<55296||o>56319&&o<=65535)return a=this.index[o>>jA],a=(a<<Gg)+(o&jg),this.data[a];if(o<=65535)return a=this.index[sC+(o-55296>>jA)],a=(a<<Gg)+(o&jg),this.data[a];if(o<this.highStart)return a=PQ-OQ+(o>>h0),a=this.index[a],a+=o>>jA&zQ,a=this.index[a],a=(a<<Gg)+(o&jg),this.data[a];if(o<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),aB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",KQ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Df=0;Df<aB.length;Df++)KQ[aB.charCodeAt(Df)]=Df;var GQ=1,Zg=2,Xg=3,AB=4,lB=5,jQ=7,cB=8,Wg=9,$g=10,uB=11,hB=12,dB=13,fB=14,qg=15,ZQ=function(t){for(var o=[],a=0,u=t.length;a<u;){var m=t.charCodeAt(a++);if(m>=55296&&m<=56319&&a<u){var x=t.charCodeAt(a++);(x&64512)===56320?o.push(((m&1023)<<10)+(x&1023)+65536):(o.push(m),a--)}else o.push(m)}return o},XQ=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var a=t.length;if(!a)return"";for(var u=[],m=-1,x="";++m<a;){var B=t[m];B<=65535?u.push(B):(B-=65536,u.push((B>>10)+55296,B%1024+56320)),(m+1===a||u.length>16384)&&(x+=String.fromCharCode.apply(String,u),u.length=0)}return x},WQ=NQ(FQ),Qo="",Jg="",$Q=function(t){return WQ.get(t)},qQ=function(t,o,a){var u=a-2,m=o[u],x=o[a-1],B=o[a];if(x===Zg&&B===Xg)return Qo;if(x===Zg||x===Xg||x===AB||B===Zg||B===Xg||B===AB)return Jg;if(x===cB&&[cB,Wg,uB,hB].indexOf(B)!==-1||(x===uB||x===Wg)&&(B===Wg||B===$g)||(x===hB||x===$g)&&B===$g||B===dB||B===lB||B===jQ||x===GQ)return Qo;if(x===dB&&B===fB){for(;m===lB;)m=o[--u];if(m===fB)return Qo}if(x===qg&&B===qg){for(var s=0;m===qg;)s++,m=o[--u];if(s%2===0)return Qo}return Jg},JQ=function(t){var o=ZQ(t),a=o.length,u=0,m=0,x=o.map($Q);return{next:function(){if(u>=a)return{done:!0,value:null};for(var B=Qo;u<a&&(B=qQ(o,x,++u))===Qo;);if(B!==Qo||u===a){var s=XQ.apply(null,o.slice(m,u));return m=u,{value:s,done:!1}}return{done:!0,value:null}}}},YQ=function(t){for(var o=JQ(t),a=[],u;!(u=o.next()).done;)u.value&&a.push(u.value.slice());return a},eM=function(t){var o=123;if(t.createRange){var a=t.createRange();if(a.getBoundingClientRect){var u=t.createElement("boundtest");u.style.height=o+"px",u.style.display="block",t.body.appendChild(u),a.selectNode(u);var m=a.getBoundingClientRect(),x=Math.round(m.height);if(t.body.removeChild(u),x===o)return!0}}return!1},tM=function(t){var o=t.createElement("boundtest");o.style.width="50px",o.style.display="block",o.style.fontSize="12px",o.style.letterSpacing="0px",o.style.wordSpacing="0px",t.body.appendChild(o);var a=t.createRange();o.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var u=o.firstChild,m=qp(u.data).map(function(F){return Fn(F)}),x=0,B={},s=m.every(function(F,M){a.setStart(u,x),a.setEnd(u,x+F.length);var z=a.getBoundingClientRect();x+=F.length;var L=z.x>B.x||z.y>B.y;return B=z,M===0?!0:L});return t.body.removeChild(o),s},rM=function(){return typeof new Image().crossOrigin<"u"},nM=function(){return typeof new XMLHttpRequest().responseType=="string"},iM=function(t){var o=new Image,a=t.createElement("canvas"),u=a.getContext("2d");if(!u)return!1;o.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{u.drawImage(o,0,0),a.toDataURL()}catch{return!1}return!0},pB=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},oM=function(t){var o=t.createElement("canvas"),a=100;o.width=a,o.height=a;var u=o.getContext("2d");if(!u)return Promise.reject(!1);u.fillStyle="rgb(0, 255, 0)",u.fillRect(0,0,a,a);var m=new Image,x=o.toDataURL();m.src=x;var B=s_(a,a,0,0,m);return u.fillStyle="red",u.fillRect(0,0,a,a),mB(B).then(function(s){u.drawImage(s,0,0);var F=u.getImageData(0,0,a,a).data;u.fillStyle="red",u.fillRect(0,0,a,a);var M=t.createElement("div");return M.style.backgroundImage="url("+x+")",M.style.height=a+"px",pB(F)?mB(s_(a,a,0,0,M)):Promise.reject(!1)}).then(function(s){return u.drawImage(s,0,0),pB(u.getImageData(0,0,a,a).data)}).catch(function(){return!1})},s_=function(t,o,a,u,m){var x="http://www.w3.org/2000/svg",B=document.createElementNS(x,"svg"),s=document.createElementNS(x,"foreignObject");return B.setAttributeNS(null,"width",t.toString()),B.setAttributeNS(null,"height",o.toString()),s.setAttributeNS(null,"width","100%"),s.setAttributeNS(null,"height","100%"),s.setAttributeNS(null,"x",a.toString()),s.setAttributeNS(null,"y",u.toString()),s.setAttributeNS(null,"externalResourcesRequired","true"),B.appendChild(s),s.appendChild(m),B},mB=function(t){return new Promise(function(o,a){var u=new Image;u.onload=function(){return o(u)},u.onerror=a,u.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},ui={get SUPPORT_RANGE_BOUNDS(){var t=eM(document);return Object.defineProperty(ui,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=ui.SUPPORT_RANGE_BOUNDS&&tM(document);return Object.defineProperty(ui,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=iM(document);return Object.defineProperty(ui,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?oM(document):Promise.resolve(!1);return Object.defineProperty(ui,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=rM();return Object.defineProperty(ui,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=nM();return Object.defineProperty(ui,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(ui,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(ui,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},hh=function(){function t(o,a){this.text=o,this.bounds=a}return t}(),sM=function(t,o,a,u){var m=lM(o,a),x=[],B=0;return m.forEach(function(s){if(a.textDecorationLine.length||s.trim().length>0)if(ui.SUPPORT_RANGE_BOUNDS){var F=gB(u,B,s.length).getClientRects();if(F.length>1){var M=d0(s),z=0;M.forEach(function(Q){x.push(new hh(Q,oa.fromDOMRectList(t,gB(u,z+B,Q.length).getClientRects()))),z+=Q.length})}else x.push(new hh(s,oa.fromDOMRectList(t,F)))}else{var L=u.splitText(s.length);x.push(new hh(s,aM(t,u))),u=L}else ui.SUPPORT_RANGE_BOUNDS||(u=u.splitText(s.length));B+=s.length}),x},aM=function(t,o){var a=o.ownerDocument;if(a){var u=a.createElement("html2canvaswrapper");u.appendChild(o.cloneNode(!0));var m=o.parentNode;if(m){m.replaceChild(u,o);var x=$p(t,u);return u.firstChild&&m.replaceChild(u.firstChild,u),x}}return oa.EMPTY},gB=function(t,o,a){var u=t.ownerDocument;if(!u)throw new Error("Node has no owner document");var m=u.createRange();return m.setStart(t,o),m.setEnd(t,o+a),m},d0=function(t){if(ui.SUPPORT_NATIVE_TEXT_SEGMENTATION){var o=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(o.segment(t)).map(function(a){return a.segment})}return YQ(t)},AM=function(t,o){if(ui.SUPPORT_NATIVE_TEXT_SEGMENTATION){var a=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(a.segment(t)).map(function(u){return u.segment})}return uM(t,o)},lM=function(t,o){return o.letterSpacing!==0?d0(t):AM(t,o)},cM=[32,160,4961,65792,65793,4153,4241],uM=function(t,o){for(var a=OT(t,{lineBreak:o.lineBreak,wordBreak:o.overflowWrap==="break-word"?"break-word":o.wordBreak}),u=[],m,x=function(){if(m.value){var B=m.value.slice(),s=qp(B),F="";s.forEach(function(M){cM.indexOf(M)===-1?F+=Fn(M):(F.length&&u.push(F),u.push(Fn(M)),F="")}),F.length&&u.push(F)}};!(m=a.next()).done;)x();return u},hM=function(){function t(o,a,u){this.text=dM(a.data,u.textTransform),this.textBounds=sM(o,this.text,u,a)}return t}(),dM=function(t,o){switch(o){case 1:return t.toLowerCase();case 3:return t.replace(fM,pM);case 2:return t.toUpperCase();default:return t}},fM=/(^|\s|:|-|\(|\))([a-z])/g,pM=function(t,o,a){return t.length>0?o+a.toUpperCase():t},aC=function(t){is(o,t);function o(a,u){var m=t.call(this,a,u)||this;return m.src=u.currentSrc||u.src,m.intrinsicWidth=u.naturalWidth,m.intrinsicHeight=u.naturalHeight,m.context.cache.addImage(m.src),m}return o}(ks),AC=function(t){is(o,t);function o(a,u){var m=t.call(this,a,u)||this;return m.canvas=u,m.intrinsicWidth=u.width,m.intrinsicHeight=u.height,m}return o}(ks),lC=function(t){is(o,t);function o(a,u){var m=t.call(this,a,u)||this,x=new XMLSerializer,B=$p(a,u);return u.setAttribute("width",B.width+"px"),u.setAttribute("height",B.height+"px"),m.svg="data:image/svg+xml,"+encodeURIComponent(x.serializeToString(u)),m.intrinsicWidth=u.width.baseVal.value,m.intrinsicHeight=u.height.baseVal.value,m.context.cache.addImage(m.svg),m}return o}(ks),cC=function(t){is(o,t);function o(a,u){var m=t.call(this,a,u)||this;return m.value=u.value,m}return o}(ks),a_=function(t){is(o,t);function o(a,u){var m=t.call(this,a,u)||this;return m.start=u.start,m.reversed=typeof u.reversed=="boolean"&&u.reversed===!0,m}return o}(ks),mM=[{type:15,flags:0,unit:"px",number:3}],gM=[{type:16,flags:0,number:50}],yM=function(t){return t.width>t.height?new oa(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new oa(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},_M=function(t){var o=t.type===vM?new Array(t.value.length+1).join(""):t.value;return o.length===0?t.placeholder||"":o},Ip="checkbox",Tp="radio",vM="password",yB=707406591,f0=function(t){is(o,t);function o(a,u){var m=t.call(this,a,u)||this;switch(m.type=u.type.toLowerCase(),m.checked=u.checked,m.value=_M(u),(m.type===Ip||m.type===Tp)&&(m.styles.backgroundColor=3739148031,m.styles.borderTopColor=m.styles.borderRightColor=m.styles.borderBottomColor=m.styles.borderLeftColor=2779096575,m.styles.borderTopWidth=m.styles.borderRightWidth=m.styles.borderBottomWidth=m.styles.borderLeftWidth=1,m.styles.borderTopStyle=m.styles.borderRightStyle=m.styles.borderBottomStyle=m.styles.borderLeftStyle=1,m.styles.backgroundClip=[0],m.styles.backgroundOrigin=[0],m.bounds=yM(m.bounds)),m.type){case Ip:m.styles.borderTopRightRadius=m.styles.borderTopLeftRadius=m.styles.borderBottomRightRadius=m.styles.borderBottomLeftRadius=mM;break;case Tp:m.styles.borderTopRightRadius=m.styles.borderTopLeftRadius=m.styles.borderBottomRightRadius=m.styles.borderBottomLeftRadius=gM;break}return m}return o}(ks),uC=function(t){is(o,t);function o(a,u){var m=t.call(this,a,u)||this,x=u.options[u.selectedIndex||0];return m.value=x&&x.text||"",m}return o}(ks),hC=function(t){is(o,t);function o(a,u){var m=t.call(this,a,u)||this;return m.value=u.value,m}return o}(ks),dC=function(t){is(o,t);function o(a,u){var m=t.call(this,a,u)||this;m.src=u.src,m.width=parseInt(u.width,10)||0,m.height=parseInt(u.height,10)||0,m.backgroundColor=m.styles.backgroundColor;try{if(u.contentWindow&&u.contentWindow.document&&u.contentWindow.document.documentElement){m.tree=pC(a,u.contentWindow.document.documentElement);var x=u.contentWindow.document.documentElement?ch(a,getComputedStyle(u.contentWindow.document.documentElement).backgroundColor):na.TRANSPARENT,B=u.contentWindow.document.body?ch(a,getComputedStyle(u.contentWindow.document.body).backgroundColor):na.TRANSPARENT;m.backgroundColor=rA(x)?rA(B)?m.styles.backgroundColor:B:x}}catch{}return m}return o}(ks),xM=["OL","UL","MENU"],ep=function(t,o,a,u){for(var m=o.firstChild,x=void 0;m;m=x)if(x=m.nextSibling,mC(m)&&m.data.trim().length>0)a.textNodes.push(new hM(t,m,a.styles));else if(sc(m))if(vC(m)&&m.assignedNodes)m.assignedNodes().forEach(function(s){return ep(t,s,a,u)});else{var B=fC(t,m);B.styles.isVisible()&&(wM(m,B,u)?B.flags|=4:BM(B.styles)&&(B.flags|=2),xM.indexOf(m.tagName)!==-1&&(B.flags|=8),a.elements.push(B),m.slot,m.shadowRoot?ep(t,m.shadowRoot,B,u):!Up(m)&&!gC(m)&&!Sp(m)&&ep(t,m,B,u))}},fC=function(t,o){return l_(o)?new aC(t,o):yC(o)?new AC(t,o):gC(o)?new lC(t,o):bM(o)?new cC(t,o):CM(o)?new a_(t,o):EM(o)?new f0(t,o):Sp(o)?new uC(t,o):Up(o)?new hC(t,o):_C(o)?new dC(t,o):new ks(t,o)},pC=function(t,o){var a=fC(t,o);return a.flags|=4,ep(t,o,a,a),a},wM=function(t,o,a){return o.styles.isPositionedWithZIndex()||o.styles.opacity<1||o.styles.isTransformed()||p0(t)&&a.styles.isTransparent()},BM=function(t){return t.isPositioned()||t.isFloating()},mC=function(t){return t.nodeType===Node.TEXT_NODE},sc=function(t){return t.nodeType===Node.ELEMENT_NODE},A_=function(t){return sc(t)&&typeof t.style<"u"&&!tp(t)},tp=function(t){return typeof t.className=="object"},bM=function(t){return t.tagName==="LI"},CM=function(t){return t.tagName==="OL"},EM=function(t){return t.tagName==="INPUT"},FM=function(t){return t.tagName==="HTML"},gC=function(t){return t.tagName==="svg"},p0=function(t){return t.tagName==="BODY"},yC=function(t){return t.tagName==="CANVAS"},_B=function(t){return t.tagName==="VIDEO"},l_=function(t){return t.tagName==="IMG"},_C=function(t){return t.tagName==="IFRAME"},vB=function(t){return t.tagName==="STYLE"},IM=function(t){return t.tagName==="SCRIPT"},Up=function(t){return t.tagName==="TEXTAREA"},Sp=function(t){return t.tagName==="SELECT"},vC=function(t){return t.tagName==="SLOT"},xB=function(t){return t.tagName.indexOf("-")>0},TM=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(o){var a=this.counters[o];return a&&a.length?a[a.length-1]:1},t.prototype.getCounterValues=function(o){var a=this.counters[o];return a||[]},t.prototype.pop=function(o){var a=this;o.forEach(function(u){return a.counters[u].pop()})},t.prototype.parse=function(o){var a=this,u=o.counterIncrement,m=o.counterReset,x=!0;u!==null&&u.forEach(function(s){var F=a.counters[s.counter];F&&s.increment!==0&&(x=!1,F.length||F.push(1),F[Math.max(0,F.length-1)]+=s.increment)});var B=[];return x&&m.forEach(function(s){var F=a.counters[s.counter];B.push(s.counter),F||(F=a.counters[s.counter]=[]),F.push(s.reset)}),B},t}(),wB={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},BB={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},UM={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},SM={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Zl=function(t,o,a,u,m,x){return t<o||t>a?Uh(t,m,x.length>0):u.integers.reduce(function(B,s,F){for(;t>=s;)t-=s,B+=u.values[F];return B},"")+x},xC=function(t,o,a,u){var m="";do a||t--,m=u(t)+m,t/=o;while(t*o>=o);return m},En=function(t,o,a,u,m){var x=a-o+1;return(t<0?"-":"")+(xC(Math.abs(t),x,u,function(B){return Fn(Math.floor(B%x)+o)})+m)},DA=function(t,o,a){a===void 0&&(a=". ");var u=o.length;return xC(Math.abs(t),u,!1,function(m){return o[Math.floor(m%u)]})+a},Jl=1,Da=2,ka=4,$u=8,qs=function(t,o,a,u,m,x){if(t<-9999||t>9999)return Uh(t,4,m.length>0);var B=Math.abs(t),s=m;if(B===0)return o[0]+s;for(var F=0;B>0&&F<=4;F++){var M=B%10;M===0&&Gn(x,Jl)&&s!==""?s=o[M]+s:M>1||M===1&&F===0||M===1&&F===1&&Gn(x,Da)||M===1&&F===1&&Gn(x,ka)&&t>100||M===1&&F>1&&Gn(x,$u)?s=o[M]+(F>0?a[F-1]:"")+s:M===1&&F>0&&(s=a[F-1]+s),B=Math.floor(B/10)}return(t<0?u:"")+s},bB="",CB="",EB="",Yg="",Uh=function(t,o,a){var u=a?". ":"",m=a?"":"",x=a?", ":"",B=a?" ":"";switch(o){case 0:return""+B;case 1:return""+B;case 2:return""+B;case 5:var s=En(t,48,57,!0,u);return s.length<4?"0"+s:s;case 4:return DA(t,"",m);case 6:return Zl(t,1,3999,wB,3,u).toLowerCase();case 7:return Zl(t,1,3999,wB,3,u);case 8:return En(t,945,969,!1,u);case 9:return En(t,97,122,!1,u);case 10:return En(t,65,90,!1,u);case 11:return En(t,1632,1641,!0,u);case 12:case 49:return Zl(t,1,9999,BB,3,u);case 35:return Zl(t,1,9999,BB,3,u).toLowerCase();case 13:return En(t,2534,2543,!0,u);case 14:case 30:return En(t,6112,6121,!0,u);case 15:return DA(t,"",m);case 16:return DA(t,"",m);case 17:case 48:return qs(t,"",bB,"",m,Da|ka|$u);case 47:return qs(t,"",CB,"",m,Jl|Da|ka|$u);case 42:return qs(t,"",bB,"",m,Da|ka|$u);case 41:return qs(t,"",CB,"",m,Jl|Da|ka|$u);case 26:return qs(t,"","",EB,m,0);case 25:return qs(t,"","",EB,m,Jl|Da|ka);case 31:return qs(t,"","",Yg,x,Jl|Da|ka);case 33:return qs(t,"","",Yg,x,0);case 32:return qs(t,"","",Yg,x,Jl|Da|ka);case 18:return En(t,2406,2415,!0,u);case 20:return Zl(t,1,19999,SM,3,u);case 21:return En(t,2790,2799,!0,u);case 22:return En(t,2662,2671,!0,u);case 22:return Zl(t,1,10999,UM,3,u);case 23:return DA(t,"");case 24:return DA(t,"");case 27:return En(t,3302,3311,!0,u);case 28:return DA(t,"",m);case 29:return DA(t,"",m);case 34:return En(t,3792,3801,!0,u);case 37:return En(t,6160,6169,!0,u);case 38:return En(t,4160,4169,!0,u);case 39:return En(t,2918,2927,!0,u);case 40:return En(t,1776,1785,!0,u);case 43:return En(t,3046,3055,!0,u);case 44:return En(t,3174,3183,!0,u);case 45:return En(t,3664,3673,!0,u);case 46:return En(t,3872,3881,!0,u);case 3:default:return En(t,48,57,!0,u)}},wC="data-html2canvas-ignore",FB=function(){function t(o,a,u){if(this.context=o,this.options=u,this.scrolledElements=[],this.referenceElement=a,this.counters=new TM,this.quoteDepth=0,!a.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(a.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(o,a){var u=this,m=QM(o,a);if(!m.contentWindow)return Promise.reject("Unable to find iframe window");var x=o.defaultView.pageXOffset,B=o.defaultView.pageYOffset,s=m.contentWindow,F=s.document,M=DM(m).then(function(){return Hi(u,void 0,void 0,function(){var z,L;return wi(this,function(Q){switch(Q.label){case 0:return this.scrolledElements.forEach(RM),s&&(s.scrollTo(a.left,a.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(s.scrollY!==a.top||s.scrollX!==a.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(s.scrollX-a.left,s.scrollY-a.top,0,0))),z=this.options.onclone,L=this.clonedReferenceElement,typeof L>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:F.fonts&&F.fonts.ready?[4,F.fonts.ready]:[3,2];case 1:Q.sent(),Q.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,LM(F)]:[3,4];case 3:Q.sent(),Q.label=4;case 4:return typeof z=="function"?[2,Promise.resolve().then(function(){return z(F,L)}).then(function(){return m})]:[2,m]}})})});return F.open(),F.write(PM(document.doctype)+"<html></html>"),OM(this.referenceElement.ownerDocument,x,B),F.replaceChild(F.adoptNode(this.documentElement),F.documentElement),F.close(),M},t.prototype.createElementClone=function(o){if(o_(o,2))debugger;if(yC(o))return this.createCanvasClone(o);if(_B(o))return this.createVideoClone(o);if(vB(o))return this.createStyleClone(o);var a=o.cloneNode(!1);return l_(a)&&(l_(o)&&o.currentSrc&&o.currentSrc!==o.src&&(a.src=o.currentSrc,a.srcset=""),a.loading==="lazy"&&(a.loading="eager")),xB(a)?this.createCustomElementClone(a):a},t.prototype.createCustomElementClone=function(o){var a=document.createElement("html2canvascustomelement");return ey(o.style,a),a},t.prototype.createStyleClone=function(o){try{var a=o.sheet;if(a&&a.cssRules){var u=[].slice.call(a.cssRules,0).reduce(function(x,B){return B&&typeof B.cssText=="string"?x+B.cssText:x},""),m=o.cloneNode(!1);return m.textContent=u,m}}catch(x){if(this.context.logger.error("Unable to access cssRules property",x),x.name!=="SecurityError")throw x}return o.cloneNode(!1)},t.prototype.createCanvasClone=function(o){var a;if(this.options.inlineImages&&o.ownerDocument){var u=o.ownerDocument.createElement("img");try{return u.src=o.toDataURL(),u}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",o)}}var m=o.cloneNode(!1);try{m.width=o.width,m.height=o.height;var x=o.getContext("2d"),B=m.getContext("2d");if(B)if(!this.options.allowTaint&&x)B.putImageData(x.getImageData(0,0,o.width,o.height),0,0);else{var s=(a=o.getContext("webgl2"))!==null&&a!==void 0?a:o.getContext("webgl");if(s){var F=s.getContextAttributes();(F==null?void 0:F.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",o)}B.drawImage(o,0,0)}return m}catch{this.context.logger.info("Unable to clone canvas as it is tainted",o)}return m},t.prototype.createVideoClone=function(o){var a=o.ownerDocument.createElement("canvas");a.width=o.offsetWidth,a.height=o.offsetHeight;var u=a.getContext("2d");try{return u&&(u.drawImage(o,0,0,a.width,a.height),this.options.allowTaint||u.getImageData(0,0,a.width,a.height)),a}catch{this.context.logger.info("Unable to clone video as it is tainted",o)}var m=o.ownerDocument.createElement("canvas");return m.width=o.offsetWidth,m.height=o.offsetHeight,m},t.prototype.appendChildNode=function(o,a,u){(!sc(a)||!IM(a)&&!a.hasAttribute(wC)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(a)))&&(!this.options.copyStyles||!sc(a)||!vB(a))&&o.appendChild(this.cloneNode(a,u))},t.prototype.cloneChildNodes=function(o,a,u){for(var m=this,x=o.shadowRoot?o.shadowRoot.firstChild:o.firstChild;x;x=x.nextSibling)if(sc(x)&&vC(x)&&typeof x.assignedNodes=="function"){var B=x.assignedNodes();B.length&&B.forEach(function(s){return m.appendChildNode(a,s,u)})}else this.appendChildNode(a,x,u)},t.prototype.cloneNode=function(o,a){if(mC(o))return document.createTextNode(o.data);if(!o.ownerDocument)return o.cloneNode(!1);var u=o.ownerDocument.defaultView;if(u&&sc(o)&&(A_(o)||tp(o))){var m=this.createElementClone(o);m.style.transitionProperty="none";var x=u.getComputedStyle(o),B=u.getComputedStyle(o,":before"),s=u.getComputedStyle(o,":after");this.referenceElement===o&&A_(m)&&(this.clonedReferenceElement=m),p0(m)&&NM(m);var F=this.counters.parse(new iB(this.context,x)),M=this.resolvePseudoContent(o,m,B,dh.BEFORE);xB(o)&&(a=!0),_B(o)||this.cloneChildNodes(o,m,a),M&&m.insertBefore(M,m.firstChild);var z=this.resolvePseudoContent(o,m,s,dh.AFTER);return z&&m.appendChild(z),this.counters.pop(F),(x&&(this.options.copyStyles||tp(o))&&!_C(o)||a)&&ey(x,m),(o.scrollTop!==0||o.scrollLeft!==0)&&this.scrolledElements.push([m,o.scrollLeft,o.scrollTop]),(Up(o)||Sp(o))&&(Up(m)||Sp(m))&&(m.value=o.value),m}return o.cloneNode(!1)},t.prototype.resolvePseudoContent=function(o,a,u,m){var x=this;if(u){var B=u.content,s=a.ownerDocument;if(!(!s||!B||B==="none"||B==="-moz-alt-content"||u.display==="none")){this.counters.parse(new iB(this.context,u));var F=new bQ(this.context,u),M=s.createElement("html2canvaspseudoelement");ey(u,M),F.content.forEach(function(L){if(L.type===0)M.appendChild(s.createTextNode(L.value));else if(L.type===22){var Q=s.createElement("img");Q.src=L.value,Q.style.opacity="1",M.appendChild(Q)}else if(L.type===18){if(L.name==="attr"){var V=L.values.filter(Rr);V.length&&M.appendChild(s.createTextNode(o.getAttribute(V[0].value)||""))}else if(L.name==="counter"){var ie=L.values.filter(wc),de=ie[0],re=ie[1];if(de&&Rr(de)){var K=x.counters.getCounterValue(de.value),G=re&&Rr(re)?i_.parse(x.context,re.value):3;M.appendChild(s.createTextNode(Uh(K,G,!1)))}}else if(L.name==="counters"){var ne=L.values.filter(wc),de=ne[0],oe=ne[1],re=ne[2];if(de&&Rr(de)){var we=x.counters.getCounterValues(de.value),ge=re&&Rr(re)?i_.parse(x.context,re.value):3,Ue=oe&&oe.type===0?oe.value:"",Ke=we.map(function(qe){return Uh(qe,ge,!1)}).join(Ue);M.appendChild(s.createTextNode(Ke))}}}else if(L.type===20)switch(L.value){case"open-quote":M.appendChild(s.createTextNode(nB(F.quotes,x.quoteDepth++,!0)));break;case"close-quote":M.appendChild(s.createTextNode(nB(F.quotes,--x.quoteDepth,!1)));break;default:M.appendChild(s.createTextNode(L.value))}}),M.className=c_+" "+u_;var z=m===dh.BEFORE?" "+c_:" "+u_;return tp(a)?a.className.baseValue+=z:a.className+=z,M}}},t.destroy=function(o){return o.parentNode?(o.parentNode.removeChild(o),!0):!1},t}(),dh;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(dh||(dh={}));var QM=function(t,o){var a=t.createElement("iframe");return a.className="html2canvas-container",a.style.visibility="hidden",a.style.position="fixed",a.style.left="-10000px",a.style.top="0px",a.style.border="0",a.width=o.width.toString(),a.height=o.height.toString(),a.scrolling="no",a.setAttribute(wC,"true"),t.body.appendChild(a),a},MM=function(t){return new Promise(function(o){if(t.complete){o();return}if(!t.src){o();return}t.onload=o,t.onerror=o})},LM=function(t){return Promise.all([].slice.call(t.images,0).map(MM))},DM=function(t){return new Promise(function(o,a){var u=t.contentWindow;if(!u)return a("No window assigned for iframe");var m=u.document;u.onload=t.onload=function(){u.onload=t.onload=null;var x=setInterval(function(){m.body.childNodes.length>0&&m.readyState==="complete"&&(clearInterval(x),o(t))},50)}})},kM=["all","d","content"],ey=function(t,o){for(var a=t.length-1;a>=0;a--){var u=t.item(a);kM.indexOf(u)===-1&&o.style.setProperty(u,t.getPropertyValue(u))}return o},PM=function(t){var o="";return t&&(o+="<!DOCTYPE ",t.name&&(o+=t.name),t.internalSubset&&(o+=t.internalSubset),t.publicId&&(o+='"'+t.publicId+'"'),t.systemId&&(o+='"'+t.systemId+'"'),o+=">"),o},OM=function(t,o,a){t&&t.defaultView&&(o!==t.defaultView.pageXOffset||a!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(o,a)},RM=function(t){var o=t[0],a=t[1],u=t[2];o.scrollLeft=a,o.scrollTop=u},zM=":before",HM=":after",c_="___html2canvas___pseudoelement_before",u_="___html2canvas___pseudoelement_after",IB=`{
    content: "" !important;
    display: none !important;
}`,NM=function(t){VM(t,"."+c_+zM+IB+`
         .`+u_+HM+IB)},VM=function(t,o){var a=t.ownerDocument;if(a){var u=a.createElement("style");u.textContent=o,t.appendChild(u)}},BC=function(){function t(){}return t.getOrigin=function(o){var a=t._link;return a?(a.href=o,a.href=a.href,a.protocol+a.hostname+a.port):"about:blank"},t.isSameOrigin=function(o){return t.getOrigin(o)===t._origin},t.setContext=function(o){t._link=o.document.createElement("a"),t._origin=t.getOrigin(o.location.href)},t._origin="about:blank",t}(),KM=function(){function t(o,a){this.context=o,this._options=a,this._cache={}}return t.prototype.addImage=function(o){var a=Promise.resolve();return this.has(o)||(ry(o)||XM(o))&&(this._cache[o]=this.loadImage(o)).catch(function(){}),a},t.prototype.match=function(o){return this._cache[o]},t.prototype.loadImage=function(o){return Hi(this,void 0,void 0,function(){var a,u,m,x,B=this;return wi(this,function(s){switch(s.label){case 0:return a=BC.isSameOrigin(o),u=!ty(o)&&this._options.useCORS===!0&&ui.SUPPORT_CORS_IMAGES&&!a,m=!ty(o)&&!a&&!ry(o)&&typeof this._options.proxy=="string"&&ui.SUPPORT_CORS_XHR&&!u,!a&&this._options.allowTaint===!1&&!ty(o)&&!ry(o)&&!m&&!u?[2]:(x=o,m?[4,this.proxy(x)]:[3,2]);case 1:x=s.sent(),s.label=2;case 2:return this.context.logger.debug("Added image "+o.substring(0,256)),[4,new Promise(function(F,M){var z=new Image;z.onload=function(){return F(z)},z.onerror=M,(WM(x)||u)&&(z.crossOrigin="anonymous"),z.src=x,z.complete===!0&&setTimeout(function(){return F(z)},500),B._options.imageTimeout>0&&setTimeout(function(){return M("Timed out ("+B._options.imageTimeout+"ms) loading image")},B._options.imageTimeout)})];case 3:return[2,s.sent()]}})})},t.prototype.has=function(o){return typeof this._cache[o]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(o){var a=this,u=this._options.proxy;if(!u)throw new Error("No proxy defined");var m=o.substring(0,256);return new Promise(function(x,B){var s=ui.SUPPORT_RESPONSE_TYPE?"blob":"text",F=new XMLHttpRequest;F.onload=function(){if(F.status===200)if(s==="text")x(F.response);else{var L=new FileReader;L.addEventListener("load",function(){return x(L.result)},!1),L.addEventListener("error",function(Q){return B(Q)},!1),L.readAsDataURL(F.response)}else B("Failed to proxy resource "+m+" with status code "+F.status)},F.onerror=B;var M=u.indexOf("?")>-1?"&":"?";if(F.open("GET",""+u+M+"url="+encodeURIComponent(o)+"&responseType="+s),s!=="text"&&F instanceof XMLHttpRequest&&(F.responseType=s),a._options.imageTimeout){var z=a._options.imageTimeout;F.timeout=z,F.ontimeout=function(){return B("Timed out ("+z+"ms) proxying "+m)}}F.send()})},t}(),GM=/^data:image\/svg\+xml/i,jM=/^data:image\/.*;base64,/i,ZM=/^data:image\/.*/i,XM=function(t){return ui.SUPPORT_SVG_DRAWING||!$M(t)},ty=function(t){return ZM.test(t)},WM=function(t){return jM.test(t)},ry=function(t){return t.substr(0,4)==="blob"},$M=function(t){return t.substr(-3).toLowerCase()==="svg"||GM.test(t)},Tt=function(){function t(o,a){this.type=0,this.x=o,this.y=a}return t.prototype.add=function(o,a){return new t(this.x+o,this.y+a)},t}(),Xl=function(t,o,a){return new Tt(t.x+(o.x-t.x)*a,t.y+(o.y-t.y)*a)},kf=function(){function t(o,a,u,m){this.type=1,this.start=o,this.startControl=a,this.endControl=u,this.end=m}return t.prototype.subdivide=function(o,a){var u=Xl(this.start,this.startControl,o),m=Xl(this.startControl,this.endControl,o),x=Xl(this.endControl,this.end,o),B=Xl(u,m,o),s=Xl(m,x,o),F=Xl(B,s,o);return a?new t(this.start,u,B,F):new t(F,s,x,this.end)},t.prototype.add=function(o,a){return new t(this.start.add(o,a),this.startControl.add(o,a),this.endControl.add(o,a),this.end.add(o,a))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),Lo=function(t){return t.type===1},qM=function(){function t(o){var a=o.styles,u=o.bounds,m=Xu(a.borderTopLeftRadius,u.width,u.height),x=m[0],B=m[1],s=Xu(a.borderTopRightRadius,u.width,u.height),F=s[0],M=s[1],z=Xu(a.borderBottomRightRadius,u.width,u.height),L=z[0],Q=z[1],V=Xu(a.borderBottomLeftRadius,u.width,u.height),ie=V[0],de=V[1],re=[];re.push((x+F)/u.width),re.push((ie+L)/u.width),re.push((B+de)/u.height),re.push((M+Q)/u.height);var K=Math.max.apply(Math,re);K>1&&(x/=K,B/=K,F/=K,M/=K,L/=K,Q/=K,ie/=K,de/=K);var G=u.width-F,ne=u.height-Q,oe=u.width-L,we=u.height-de,ge=a.borderTopWidth,Ue=a.borderRightWidth,Ke=a.borderBottomWidth,Me=a.borderLeftWidth,et=Kr(a.paddingTop,o.bounds.width),qe=Kr(a.paddingRight,o.bounds.width),it=Kr(a.paddingBottom,o.bounds.width),Xe=Kr(a.paddingLeft,o.bounds.width);this.topLeftBorderDoubleOuterBox=x>0||B>0?tn(u.left+Me/3,u.top+ge/3,x-Me/3,B-ge/3,Tr.TOP_LEFT):new Tt(u.left+Me/3,u.top+ge/3),this.topRightBorderDoubleOuterBox=x>0||B>0?tn(u.left+G,u.top+ge/3,F-Ue/3,M-ge/3,Tr.TOP_RIGHT):new Tt(u.left+u.width-Ue/3,u.top+ge/3),this.bottomRightBorderDoubleOuterBox=L>0||Q>0?tn(u.left+oe,u.top+ne,L-Ue/3,Q-Ke/3,Tr.BOTTOM_RIGHT):new Tt(u.left+u.width-Ue/3,u.top+u.height-Ke/3),this.bottomLeftBorderDoubleOuterBox=ie>0||de>0?tn(u.left+Me/3,u.top+we,ie-Me/3,de-Ke/3,Tr.BOTTOM_LEFT):new Tt(u.left+Me/3,u.top+u.height-Ke/3),this.topLeftBorderDoubleInnerBox=x>0||B>0?tn(u.left+Me*2/3,u.top+ge*2/3,x-Me*2/3,B-ge*2/3,Tr.TOP_LEFT):new Tt(u.left+Me*2/3,u.top+ge*2/3),this.topRightBorderDoubleInnerBox=x>0||B>0?tn(u.left+G,u.top+ge*2/3,F-Ue*2/3,M-ge*2/3,Tr.TOP_RIGHT):new Tt(u.left+u.width-Ue*2/3,u.top+ge*2/3),this.bottomRightBorderDoubleInnerBox=L>0||Q>0?tn(u.left+oe,u.top+ne,L-Ue*2/3,Q-Ke*2/3,Tr.BOTTOM_RIGHT):new Tt(u.left+u.width-Ue*2/3,u.top+u.height-Ke*2/3),this.bottomLeftBorderDoubleInnerBox=ie>0||de>0?tn(u.left+Me*2/3,u.top+we,ie-Me*2/3,de-Ke*2/3,Tr.BOTTOM_LEFT):new Tt(u.left+Me*2/3,u.top+u.height-Ke*2/3),this.topLeftBorderStroke=x>0||B>0?tn(u.left+Me/2,u.top+ge/2,x-Me/2,B-ge/2,Tr.TOP_LEFT):new Tt(u.left+Me/2,u.top+ge/2),this.topRightBorderStroke=x>0||B>0?tn(u.left+G,u.top+ge/2,F-Ue/2,M-ge/2,Tr.TOP_RIGHT):new Tt(u.left+u.width-Ue/2,u.top+ge/2),this.bottomRightBorderStroke=L>0||Q>0?tn(u.left+oe,u.top+ne,L-Ue/2,Q-Ke/2,Tr.BOTTOM_RIGHT):new Tt(u.left+u.width-Ue/2,u.top+u.height-Ke/2),this.bottomLeftBorderStroke=ie>0||de>0?tn(u.left+Me/2,u.top+we,ie-Me/2,de-Ke/2,Tr.BOTTOM_LEFT):new Tt(u.left+Me/2,u.top+u.height-Ke/2),this.topLeftBorderBox=x>0||B>0?tn(u.left,u.top,x,B,Tr.TOP_LEFT):new Tt(u.left,u.top),this.topRightBorderBox=F>0||M>0?tn(u.left+G,u.top,F,M,Tr.TOP_RIGHT):new Tt(u.left+u.width,u.top),this.bottomRightBorderBox=L>0||Q>0?tn(u.left+oe,u.top+ne,L,Q,Tr.BOTTOM_RIGHT):new Tt(u.left+u.width,u.top+u.height),this.bottomLeftBorderBox=ie>0||de>0?tn(u.left,u.top+we,ie,de,Tr.BOTTOM_LEFT):new Tt(u.left,u.top+u.height),this.topLeftPaddingBox=x>0||B>0?tn(u.left+Me,u.top+ge,Math.max(0,x-Me),Math.max(0,B-ge),Tr.TOP_LEFT):new Tt(u.left+Me,u.top+ge),this.topRightPaddingBox=F>0||M>0?tn(u.left+Math.min(G,u.width-Ue),u.top+ge,G>u.width+Ue?0:Math.max(0,F-Ue),Math.max(0,M-ge),Tr.TOP_RIGHT):new Tt(u.left+u.width-Ue,u.top+ge),this.bottomRightPaddingBox=L>0||Q>0?tn(u.left+Math.min(oe,u.width-Me),u.top+Math.min(ne,u.height-Ke),Math.max(0,L-Ue),Math.max(0,Q-Ke),Tr.BOTTOM_RIGHT):new Tt(u.left+u.width-Ue,u.top+u.height-Ke),this.bottomLeftPaddingBox=ie>0||de>0?tn(u.left+Me,u.top+Math.min(we,u.height-Ke),Math.max(0,ie-Me),Math.max(0,de-Ke),Tr.BOTTOM_LEFT):new Tt(u.left+Me,u.top+u.height-Ke),this.topLeftContentBox=x>0||B>0?tn(u.left+Me+Xe,u.top+ge+et,Math.max(0,x-(Me+Xe)),Math.max(0,B-(ge+et)),Tr.TOP_LEFT):new Tt(u.left+Me+Xe,u.top+ge+et),this.topRightContentBox=F>0||M>0?tn(u.left+Math.min(G,u.width+Me+Xe),u.top+ge+et,G>u.width+Me+Xe?0:F-Me+Xe,M-(ge+et),Tr.TOP_RIGHT):new Tt(u.left+u.width-(Ue+qe),u.top+ge+et),this.bottomRightContentBox=L>0||Q>0?tn(u.left+Math.min(oe,u.width-(Me+Xe)),u.top+Math.min(ne,u.height+ge+et),Math.max(0,L-(Ue+qe)),Q-(Ke+it),Tr.BOTTOM_RIGHT):new Tt(u.left+u.width-(Ue+qe),u.top+u.height-(Ke+it)),this.bottomLeftContentBox=ie>0||de>0?tn(u.left+Me+Xe,u.top+we,Math.max(0,ie-(Me+Xe)),de-(Ke+it),Tr.BOTTOM_LEFT):new Tt(u.left+Me+Xe,u.top+u.height-(Ke+it))}return t}(),Tr;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Tr||(Tr={}));var tn=function(t,o,a,u,m){var x=4*((Math.sqrt(2)-1)/3),B=a*x,s=u*x,F=t+a,M=o+u;switch(m){case Tr.TOP_LEFT:return new kf(new Tt(t,M),new Tt(t,M-s),new Tt(F-B,o),new Tt(F,o));case Tr.TOP_RIGHT:return new kf(new Tt(t,o),new Tt(t+B,o),new Tt(F,M-s),new Tt(F,M));case Tr.BOTTOM_RIGHT:return new kf(new Tt(F,o),new Tt(F,o+s),new Tt(t+B,M),new Tt(t,M));case Tr.BOTTOM_LEFT:default:return new kf(new Tt(F,M),new Tt(F-B,M),new Tt(t,o+s),new Tt(t,o))}},Qp=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},JM=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},Mp=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},YM=function(){function t(o,a,u){this.offsetX=o,this.offsetY=a,this.matrix=u,this.type=0,this.target=6}return t}(),Pf=function(){function t(o,a){this.path=o,this.target=a,this.type=1}return t}(),eL=function(){function t(o){this.opacity=o,this.type=2,this.target=6}return t}(),tL=function(t){return t.type===0},bC=function(t){return t.type===1},rL=function(t){return t.type===2},TB=function(t,o){return t.length===o.length?t.some(function(a,u){return a===o[u]}):!1},nL=function(t,o,a,u,m){return t.map(function(x,B){switch(B){case 0:return x.add(o,a);case 1:return x.add(o+u,a);case 2:return x.add(o+u,a+m);case 3:return x.add(o,a+m)}return x})},CC=function(){function t(o){this.element=o,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),EC=function(){function t(o,a){if(this.container=o,this.parent=a,this.effects=[],this.curves=new qM(this.container),this.container.styles.opacity<1&&this.effects.push(new eL(this.container.styles.opacity)),this.container.styles.transform!==null){var u=this.container.bounds.left+this.container.styles.transformOrigin[0].number,m=this.container.bounds.top+this.container.styles.transformOrigin[1].number,x=this.container.styles.transform;this.effects.push(new YM(u,m,x))}if(this.container.styles.overflowX!==0){var B=Qp(this.curves),s=Mp(this.curves);TB(B,s)?this.effects.push(new Pf(B,6)):(this.effects.push(new Pf(B,2)),this.effects.push(new Pf(s,4)))}}return t.prototype.getEffects=function(o){for(var a=[2,3].indexOf(this.container.styles.position)===-1,u=this.parent,m=this.effects.slice(0);u;){var x=u.effects.filter(function(F){return!bC(F)});if(a||u.container.styles.position!==0||!u.parent){if(m.unshift.apply(m,x),a=[2,3].indexOf(u.container.styles.position)===-1,u.container.styles.overflowX!==0){var B=Qp(u.curves),s=Mp(u.curves);TB(B,s)||m.unshift(new Pf(s,6))}}else m.unshift.apply(m,x);u=u.parent}return m.filter(function(F){return Gn(F.target,o)})},t}(),h_=function(t,o,a,u){t.container.elements.forEach(function(m){var x=Gn(m.flags,4),B=Gn(m.flags,2),s=new EC(m,t);Gn(m.styles.display,2048)&&u.push(s);var F=Gn(m.flags,8)?[]:u;if(x||B){var M=x||m.styles.isPositioned()?a:o,z=new CC(s);if(m.styles.isPositioned()||m.styles.opacity<1||m.styles.isTransformed()){var L=m.styles.zIndex.order;if(L<0){var Q=0;M.negativeZIndex.some(function(ie,de){return L>ie.element.container.styles.zIndex.order?(Q=de,!1):Q>0}),M.negativeZIndex.splice(Q,0,z)}else if(L>0){var V=0;M.positiveZIndex.some(function(ie,de){return L>=ie.element.container.styles.zIndex.order?(V=de+1,!1):V>0}),M.positiveZIndex.splice(V,0,z)}else M.zeroOrAutoZIndexOrTransformedOrOpacity.push(z)}else m.styles.isFloating()?M.nonPositionedFloats.push(z):M.nonPositionedInlineLevel.push(z);h_(s,z,x?z:a,F)}else m.styles.isInlineLevel()?o.inlineLevel.push(s):o.nonInlineLevel.push(s),h_(s,o,a,F);Gn(m.flags,8)&&FC(m,F)})},FC=function(t,o){for(var a=t instanceof a_?t.start:1,u=t instanceof a_?t.reversed:!1,m=0;m<o.length;m++){var x=o[m];x.container instanceof cC&&typeof x.container.value=="number"&&x.container.value!==0&&(a=x.container.value),x.listValue=Uh(a,x.container.styles.listStyleType,!0),a+=u?-1:1}},iL=function(t){var o=new EC(t,null),a=new CC(o),u=[];return h_(o,a,a,u),FC(o.container,u),a},UB=function(t,o){switch(o){case 0:return Oo(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return Oo(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return Oo(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return Oo(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},oL=function(t,o){switch(o){case 0:return Oo(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return Oo(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return Oo(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return Oo(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},sL=function(t,o){switch(o){case 0:return Oo(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return Oo(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return Oo(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return Oo(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},aL=function(t,o){switch(o){case 0:return Of(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return Of(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return Of(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return Of(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},Of=function(t,o){var a=[];return Lo(t)?a.push(t.subdivide(.5,!1)):a.push(t),Lo(o)?a.push(o.subdivide(.5,!0)):a.push(o),a},Oo=function(t,o,a,u){var m=[];return Lo(t)?m.push(t.subdivide(.5,!1)):m.push(t),Lo(a)?m.push(a.subdivide(.5,!0)):m.push(a),Lo(u)?m.push(u.subdivide(.5,!0).reverse()):m.push(u),Lo(o)?m.push(o.subdivide(.5,!1).reverse()):m.push(o),m},IC=function(t){var o=t.bounds,a=t.styles;return o.add(a.borderLeftWidth,a.borderTopWidth,-(a.borderRightWidth+a.borderLeftWidth),-(a.borderTopWidth+a.borderBottomWidth))},Lp=function(t){var o=t.styles,a=t.bounds,u=Kr(o.paddingLeft,a.width),m=Kr(o.paddingRight,a.width),x=Kr(o.paddingTop,a.width),B=Kr(o.paddingBottom,a.width);return a.add(u+o.borderLeftWidth,x+o.borderTopWidth,-(o.borderRightWidth+o.borderLeftWidth+u+m),-(o.borderTopWidth+o.borderBottomWidth+x+B))},AL=function(t,o){return t===0?o.bounds:t===2?Lp(o):IC(o)},lL=function(t,o){return t===0?o.bounds:t===2?Lp(o):IC(o)},ny=function(t,o,a){var u=AL(Yl(t.styles.backgroundOrigin,o),t),m=lL(Yl(t.styles.backgroundClip,o),t),x=cL(Yl(t.styles.backgroundSize,o),a,u),B=x[0],s=x[1],F=Xu(Yl(t.styles.backgroundPosition,o),u.width-B,u.height-s),M=uL(Yl(t.styles.backgroundRepeat,o),F,x,u,m),z=Math.round(u.left+F[0]),L=Math.round(u.top+F[1]);return[M,z,L,B,s]},Wl=function(t){return Rr(t)&&t.value===gc.AUTO},Rf=function(t){return typeof t=="number"},cL=function(t,o,a){var u=o[0],m=o[1],x=o[2],B=t[0],s=t[1];if(!B)return[0,0];if(Qn(B)&&s&&Qn(s))return[Kr(B,a.width),Kr(s,a.height)];var F=Rf(x);if(Rr(B)&&(B.value===gc.CONTAIN||B.value===gc.COVER)){if(Rf(x)){var M=a.width/a.height;return M<x!=(B.value===gc.COVER)?[a.width,a.width/x]:[a.height*x,a.height]}return[a.width,a.height]}var z=Rf(u),L=Rf(m),Q=z||L;if(Wl(B)&&(!s||Wl(s))){if(z&&L)return[u,m];if(!F&&!Q)return[a.width,a.height];if(Q&&F){var V=z?u:m*x,ie=L?m:u/x;return[V,ie]}var de=z?u:a.width,re=L?m:a.height;return[de,re]}if(F){var K=0,G=0;return Qn(B)?K=Kr(B,a.width):Qn(s)&&(G=Kr(s,a.height)),Wl(B)?K=G*x:(!s||Wl(s))&&(G=K/x),[K,G]}var ne=null,oe=null;if(Qn(B)?ne=Kr(B,a.width):s&&Qn(s)&&(oe=Kr(s,a.height)),ne!==null&&(!s||Wl(s))&&(oe=z&&L?ne/u*m:a.height),oe!==null&&Wl(B)&&(ne=z&&L?oe/m*u:a.width),ne!==null&&oe!==null)return[ne,oe];throw new Error("Unable to calculate background-size for element")},Yl=function(t,o){var a=t[o];return typeof a>"u"?t[0]:a},uL=function(t,o,a,u,m){var x=o[0],B=o[1],s=a[0],F=a[1];switch(t){case 2:return[new Tt(Math.round(u.left),Math.round(u.top+B)),new Tt(Math.round(u.left+u.width),Math.round(u.top+B)),new Tt(Math.round(u.left+u.width),Math.round(F+u.top+B)),new Tt(Math.round(u.left),Math.round(F+u.top+B))];case 3:return[new Tt(Math.round(u.left+x),Math.round(u.top)),new Tt(Math.round(u.left+x+s),Math.round(u.top)),new Tt(Math.round(u.left+x+s),Math.round(u.height+u.top)),new Tt(Math.round(u.left+x),Math.round(u.height+u.top))];case 1:return[new Tt(Math.round(u.left+x),Math.round(u.top+B)),new Tt(Math.round(u.left+x+s),Math.round(u.top+B)),new Tt(Math.round(u.left+x+s),Math.round(u.top+B+F)),new Tt(Math.round(u.left+x),Math.round(u.top+B+F))];default:return[new Tt(Math.round(m.left),Math.round(m.top)),new Tt(Math.round(m.left+m.width),Math.round(m.top)),new Tt(Math.round(m.left+m.width),Math.round(m.height+m.top)),new Tt(Math.round(m.left),Math.round(m.height+m.top))]}},hL="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",SB="Hidden Text",dL=function(){function t(o){this._data={},this._document=o}return t.prototype.parseMetrics=function(o,a){var u=this._document.createElement("div"),m=this._document.createElement("img"),x=this._document.createElement("span"),B=this._document.body;u.style.visibility="hidden",u.style.fontFamily=o,u.style.fontSize=a,u.style.margin="0",u.style.padding="0",u.style.whiteSpace="nowrap",B.appendChild(u),m.src=hL,m.width=1,m.height=1,m.style.margin="0",m.style.padding="0",m.style.verticalAlign="baseline",x.style.fontFamily=o,x.style.fontSize=a,x.style.margin="0",x.style.padding="0",x.appendChild(this._document.createTextNode(SB)),u.appendChild(x),u.appendChild(m);var s=m.offsetTop-x.offsetTop+2;u.removeChild(x),u.appendChild(this._document.createTextNode(SB)),u.style.lineHeight="normal",m.style.verticalAlign="super";var F=m.offsetTop-u.offsetTop+2;return B.removeChild(u),{baseline:s,middle:F}},t.prototype.getMetrics=function(o,a){var u=o+" "+a;return typeof this._data[u]>"u"&&(this._data[u]=this.parseMetrics(o,a)),this._data[u]},t}(),TC=function(){function t(o,a){this.context=o,this.options=a}return t}(),fL=1e4,pL=function(t){is(o,t);function o(a,u){var m=t.call(this,a,u)||this;return m._activeEffects=[],m.canvas=u.canvas?u.canvas:document.createElement("canvas"),m.ctx=m.canvas.getContext("2d"),u.canvas||(m.canvas.width=Math.floor(u.width*u.scale),m.canvas.height=Math.floor(u.height*u.scale),m.canvas.style.width=u.width+"px",m.canvas.style.height=u.height+"px"),m.fontMetrics=new dL(document),m.ctx.scale(m.options.scale,m.options.scale),m.ctx.translate(-u.x,-u.y),m.ctx.textBaseline="bottom",m._activeEffects=[],m.context.logger.debug("Canvas renderer initialized ("+u.width+"x"+u.height+") with scale "+u.scale),m}return o.prototype.applyEffects=function(a){for(var u=this;this._activeEffects.length;)this.popEffect();a.forEach(function(m){return u.applyEffect(m)})},o.prototype.applyEffect=function(a){this.ctx.save(),rL(a)&&(this.ctx.globalAlpha=a.opacity),tL(a)&&(this.ctx.translate(a.offsetX,a.offsetY),this.ctx.transform(a.matrix[0],a.matrix[1],a.matrix[2],a.matrix[3],a.matrix[4],a.matrix[5]),this.ctx.translate(-a.offsetX,-a.offsetY)),bC(a)&&(this.path(a.path),this.ctx.clip()),this._activeEffects.push(a)},o.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},o.prototype.renderStack=function(a){return Hi(this,void 0,void 0,function(){var u;return wi(this,function(m){switch(m.label){case 0:return u=a.element.container.styles,u.isVisible()?[4,this.renderStackContent(a)]:[3,2];case 1:m.sent(),m.label=2;case 2:return[2]}})})},o.prototype.renderNode=function(a){return Hi(this,void 0,void 0,function(){return wi(this,function(u){switch(u.label){case 0:if(Gn(a.container.flags,16))debugger;return a.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(a)]:[3,3];case 1:return u.sent(),[4,this.renderNodeContent(a)];case 2:u.sent(),u.label=3;case 3:return[2]}})})},o.prototype.renderTextWithLetterSpacing=function(a,u,m){var x=this;if(u===0)this.ctx.fillText(a.text,a.bounds.left,a.bounds.top+m);else{var B=d0(a.text);B.reduce(function(s,F){return x.ctx.fillText(F,s,a.bounds.top+m),s+x.ctx.measureText(F).width},a.bounds.left)}},o.prototype.createFontStyle=function(a){var u=a.fontVariant.filter(function(B){return B==="normal"||B==="small-caps"}).join(""),m=vL(a.fontFamily).join(", "),x=Oh(a.fontSize)?""+a.fontSize.number+a.fontSize.unit:a.fontSize.number+"px";return[[a.fontStyle,u,a.fontWeight,x,m].join(" "),m,x]},o.prototype.renderTextNode=function(a,u){return Hi(this,void 0,void 0,function(){var m,x,B,s,F,M,z,L,Q=this;return wi(this,function(V){return m=this.createFontStyle(u),x=m[0],B=m[1],s=m[2],this.ctx.font=x,this.ctx.direction=u.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",F=this.fontMetrics.getMetrics(B,s),M=F.baseline,z=F.middle,L=u.paintOrder,a.textBounds.forEach(function(ie){L.forEach(function(de){switch(de){case 0:Q.ctx.fillStyle=ni(u.color),Q.renderTextWithLetterSpacing(ie,u.letterSpacing,M);var re=u.textShadow;re.length&&ie.text.trim().length&&(re.slice(0).reverse().forEach(function(K){Q.ctx.shadowColor=ni(K.color),Q.ctx.shadowOffsetX=K.offsetX.number*Q.options.scale,Q.ctx.shadowOffsetY=K.offsetY.number*Q.options.scale,Q.ctx.shadowBlur=K.blur.number,Q.renderTextWithLetterSpacing(ie,u.letterSpacing,M)}),Q.ctx.shadowColor="",Q.ctx.shadowOffsetX=0,Q.ctx.shadowOffsetY=0,Q.ctx.shadowBlur=0),u.textDecorationLine.length&&(Q.ctx.fillStyle=ni(u.textDecorationColor||u.color),u.textDecorationLine.forEach(function(K){switch(K){case 1:Q.ctx.fillRect(ie.bounds.left,Math.round(ie.bounds.top+M),ie.bounds.width,1);break;case 2:Q.ctx.fillRect(ie.bounds.left,Math.round(ie.bounds.top),ie.bounds.width,1);break;case 3:Q.ctx.fillRect(ie.bounds.left,Math.ceil(ie.bounds.top+z),ie.bounds.width,1);break}}));break;case 1:u.webkitTextStrokeWidth&&ie.text.trim().length&&(Q.ctx.strokeStyle=ni(u.webkitTextStrokeColor),Q.ctx.lineWidth=u.webkitTextStrokeWidth,Q.ctx.lineJoin=window.chrome?"miter":"round",Q.ctx.strokeText(ie.text,ie.bounds.left,ie.bounds.top+M)),Q.ctx.strokeStyle="",Q.ctx.lineWidth=0,Q.ctx.lineJoin="miter";break}})}),[2]})})},o.prototype.renderReplacedElement=function(a,u,m){if(m&&a.intrinsicWidth>0&&a.intrinsicHeight>0){var x=Lp(a),B=Mp(u);this.path(B),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(m,0,0,a.intrinsicWidth,a.intrinsicHeight,x.left,x.top,x.width,x.height),this.ctx.restore()}},o.prototype.renderNodeContent=function(a){return Hi(this,void 0,void 0,function(){var u,m,x,B,s,F,G,G,M,z,L,Q,oe,V,ie,we,de,re,K,G,ne,oe,we;return wi(this,function(ge){switch(ge.label){case 0:this.applyEffects(a.getEffects(4)),u=a.container,m=a.curves,x=u.styles,B=0,s=u.textNodes,ge.label=1;case 1:return B<s.length?(F=s[B],[4,this.renderTextNode(F,x)]):[3,4];case 2:ge.sent(),ge.label=3;case 3:return B++,[3,1];case 4:if(!(u instanceof aC))return[3,8];ge.label=5;case 5:return ge.trys.push([5,7,,8]),[4,this.context.cache.match(u.src)];case 6:return G=ge.sent(),this.renderReplacedElement(u,m,G),[3,8];case 7:return ge.sent(),this.context.logger.error("Error loading image "+u.src),[3,8];case 8:if(u instanceof AC&&this.renderReplacedElement(u,m,u.canvas),!(u instanceof lC))return[3,12];ge.label=9;case 9:return ge.trys.push([9,11,,12]),[4,this.context.cache.match(u.svg)];case 10:return G=ge.sent(),this.renderReplacedElement(u,m,G),[3,12];case 11:return ge.sent(),this.context.logger.error("Error loading svg "+u.svg.substring(0,255)),[3,12];case 12:return u instanceof dC&&u.tree?(M=new o(this.context,{scale:this.options.scale,backgroundColor:u.backgroundColor,x:0,y:0,width:u.width,height:u.height}),[4,M.render(u.tree)]):[3,14];case 13:z=ge.sent(),u.width&&u.height&&this.ctx.drawImage(z,0,0,u.width,u.height,u.bounds.left,u.bounds.top,u.bounds.width,u.bounds.height),ge.label=14;case 14:if(u instanceof f0&&(L=Math.min(u.bounds.width,u.bounds.height),u.type===Ip?u.checked&&(this.ctx.save(),this.path([new Tt(u.bounds.left+L*.39363,u.bounds.top+L*.79),new Tt(u.bounds.left+L*.16,u.bounds.top+L*.5549),new Tt(u.bounds.left+L*.27347,u.bounds.top+L*.44071),new Tt(u.bounds.left+L*.39694,u.bounds.top+L*.5649),new Tt(u.bounds.left+L*.72983,u.bounds.top+L*.23),new Tt(u.bounds.left+L*.84,u.bounds.top+L*.34085),new Tt(u.bounds.left+L*.39363,u.bounds.top+L*.79)]),this.ctx.fillStyle=ni(yB),this.ctx.fill(),this.ctx.restore()):u.type===Tp&&u.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(u.bounds.left+L/2,u.bounds.top+L/2,L/4,0,Math.PI*2,!0),this.ctx.fillStyle=ni(yB),this.ctx.fill(),this.ctx.restore())),mL(u)&&u.value.length){switch(Q=this.createFontStyle(x),oe=Q[0],V=Q[1],ie=this.fontMetrics.getMetrics(oe,V).baseline,this.ctx.font=oe,this.ctx.fillStyle=ni(x.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=yL(u.styles.textAlign),we=Lp(u),de=0,u.styles.textAlign){case 1:de+=we.width/2;break;case 2:de+=we.width;break}re=we.add(de,0,0,-we.height/2+1),this.ctx.save(),this.path([new Tt(we.left,we.top),new Tt(we.left+we.width,we.top),new Tt(we.left+we.width,we.top+we.height),new Tt(we.left,we.top+we.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new hh(u.value,re),x.letterSpacing,ie),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Gn(u.styles.display,2048))return[3,20];if(u.styles.listStyleImage===null)return[3,19];if(K=u.styles.listStyleImage,K.type!==0)return[3,18];G=void 0,ne=K.url,ge.label=15;case 15:return ge.trys.push([15,17,,18]),[4,this.context.cache.match(ne)];case 16:return G=ge.sent(),this.ctx.drawImage(G,u.bounds.left-(G.width+10),u.bounds.top),[3,18];case 17:return ge.sent(),this.context.logger.error("Error loading list-style-image "+ne),[3,18];case 18:return[3,20];case 19:a.listValue&&u.styles.listStyleType!==-1&&(oe=this.createFontStyle(x)[0],this.ctx.font=oe,this.ctx.fillStyle=ni(x.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",we=new oa(u.bounds.left,u.bounds.top+Kr(u.styles.paddingTop,u.bounds.width),u.bounds.width,tB(x.lineHeight,x.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new hh(a.listValue,we),x.letterSpacing,tB(x.lineHeight,x.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),ge.label=20;case 20:return[2]}})})},o.prototype.renderStackContent=function(a){return Hi(this,void 0,void 0,function(){var u,m,K,x,B,K,s,F,K,M,z,K,L,Q,K,V,ie,K,de,re,K;return wi(this,function(G){switch(G.label){case 0:if(Gn(a.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(a.element)];case 1:G.sent(),u=0,m=a.negativeZIndex,G.label=2;case 2:return u<m.length?(K=m[u],[4,this.renderStack(K)]):[3,5];case 3:G.sent(),G.label=4;case 4:return u++,[3,2];case 5:return[4,this.renderNodeContent(a.element)];case 6:G.sent(),x=0,B=a.nonInlineLevel,G.label=7;case 7:return x<B.length?(K=B[x],[4,this.renderNode(K)]):[3,10];case 8:G.sent(),G.label=9;case 9:return x++,[3,7];case 10:s=0,F=a.nonPositionedFloats,G.label=11;case 11:return s<F.length?(K=F[s],[4,this.renderStack(K)]):[3,14];case 12:G.sent(),G.label=13;case 13:return s++,[3,11];case 14:M=0,z=a.nonPositionedInlineLevel,G.label=15;case 15:return M<z.length?(K=z[M],[4,this.renderStack(K)]):[3,18];case 16:G.sent(),G.label=17;case 17:return M++,[3,15];case 18:L=0,Q=a.inlineLevel,G.label=19;case 19:return L<Q.length?(K=Q[L],[4,this.renderNode(K)]):[3,22];case 20:G.sent(),G.label=21;case 21:return L++,[3,19];case 22:V=0,ie=a.zeroOrAutoZIndexOrTransformedOrOpacity,G.label=23;case 23:return V<ie.length?(K=ie[V],[4,this.renderStack(K)]):[3,26];case 24:G.sent(),G.label=25;case 25:return V++,[3,23];case 26:de=0,re=a.positiveZIndex,G.label=27;case 27:return de<re.length?(K=re[de],[4,this.renderStack(K)]):[3,30];case 28:G.sent(),G.label=29;case 29:return de++,[3,27];case 30:return[2]}})})},o.prototype.mask=function(a){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(a.slice(0).reverse()),this.ctx.closePath()},o.prototype.path=function(a){this.ctx.beginPath(),this.formatPath(a),this.ctx.closePath()},o.prototype.formatPath=function(a){var u=this;a.forEach(function(m,x){var B=Lo(m)?m.start:m;x===0?u.ctx.moveTo(B.x,B.y):u.ctx.lineTo(B.x,B.y),Lo(m)&&u.ctx.bezierCurveTo(m.startControl.x,m.startControl.y,m.endControl.x,m.endControl.y,m.end.x,m.end.y)})},o.prototype.renderRepeat=function(a,u,m,x){this.path(a),this.ctx.fillStyle=u,this.ctx.translate(m,x),this.ctx.fill(),this.ctx.translate(-m,-x)},o.prototype.resizeImage=function(a,u,m){var x;if(a.width===u&&a.height===m)return a;var B=(x=this.canvas.ownerDocument)!==null&&x!==void 0?x:document,s=B.createElement("canvas");s.width=Math.max(1,u),s.height=Math.max(1,m);var F=s.getContext("2d");return F.drawImage(a,0,0,a.width,a.height,0,0,u,m),s},o.prototype.renderBackgroundImage=function(a){return Hi(this,void 0,void 0,function(){var u,m,x,B,s,F;return wi(this,function(M){switch(M.label){case 0:u=a.styles.backgroundImage.length-1,m=function(z){var L,Q,V,et,Et,It,Xe,Ne,Ke,ie,et,Et,It,Xe,Ne,de,re,K,G,ne,oe,we,ge,Ue,Ke,Me,et,qe,it,Xe,Ne,At,Et,It,Ut,Dt,Vt,Je,yt,ke,xt,Se;return wi(this,function(ot){switch(ot.label){case 0:if(z.type!==0)return[3,5];L=void 0,Q=z.url,ot.label=1;case 1:return ot.trys.push([1,3,,4]),[4,x.context.cache.match(Q)];case 2:return L=ot.sent(),[3,4];case 3:return ot.sent(),x.context.logger.error("Error loading background-image "+Q),[3,4];case 4:return L&&(V=ny(a,u,[L.width,L.height,L.width/L.height]),et=V[0],Et=V[1],It=V[2],Xe=V[3],Ne=V[4],Ke=x.ctx.createPattern(x.resizeImage(L,Xe,Ne),"repeat"),x.renderRepeat(et,Ke,Et,It)),[3,6];case 5:tS(z)?(ie=ny(a,u,[null,null,null]),et=ie[0],Et=ie[1],It=ie[2],Xe=ie[3],Ne=ie[4],de=$U(z.angle,Xe,Ne),re=de[0],K=de[1],G=de[2],ne=de[3],oe=de[4],we=document.createElement("canvas"),we.width=Xe,we.height=Ne,ge=we.getContext("2d"),Ue=ge.createLinearGradient(K,ne,G,oe),Yw(z.stops,re).forEach(function(vt){return Ue.addColorStop(vt.stop,ni(vt.color))}),ge.fillStyle=Ue,ge.fillRect(0,0,Xe,Ne),Xe>0&&Ne>0&&(Ke=x.ctx.createPattern(we,"repeat"),x.renderRepeat(et,Ke,Et,It))):rS(z)&&(Me=ny(a,u,[null,null,null]),et=Me[0],qe=Me[1],it=Me[2],Xe=Me[3],Ne=Me[4],At=z.position.length===0?[c0]:z.position,Et=Kr(At[0],Xe),It=Kr(At[At.length-1],Ne),Ut=qU(z,Et,It,Xe,Ne),Dt=Ut[0],Vt=Ut[1],Dt>0&&Vt>0&&(Je=x.ctx.createRadialGradient(qe+Et,it+It,0,qe+Et,it+It,Dt),Yw(z.stops,Dt*2).forEach(function(vt){return Je.addColorStop(vt.stop,ni(vt.color))}),x.path(et),x.ctx.fillStyle=Je,Dt!==Vt?(yt=a.bounds.left+.5*a.bounds.width,ke=a.bounds.top+.5*a.bounds.height,xt=Vt/Dt,Se=1/xt,x.ctx.save(),x.ctx.translate(yt,ke),x.ctx.transform(1,0,0,xt,0,0),x.ctx.translate(-yt,-ke),x.ctx.fillRect(qe,Se*(it-ke)+ke,Xe,Ne*Se),x.ctx.restore()):x.ctx.fill())),ot.label=6;case 6:return u--,[2]}})},x=this,B=0,s=a.styles.backgroundImage.slice(0).reverse(),M.label=1;case 1:return B<s.length?(F=s[B],[5,m(F)]):[3,4];case 2:M.sent(),M.label=3;case 3:return B++,[3,1];case 4:return[2]}})})},o.prototype.renderSolidBorder=function(a,u,m){return Hi(this,void 0,void 0,function(){return wi(this,function(x){return this.path(UB(m,u)),this.ctx.fillStyle=ni(a),this.ctx.fill(),[2]})})},o.prototype.renderDoubleBorder=function(a,u,m,x){return Hi(this,void 0,void 0,function(){var B,s;return wi(this,function(F){switch(F.label){case 0:return u<3?[4,this.renderSolidBorder(a,m,x)]:[3,2];case 1:return F.sent(),[2];case 2:return B=oL(x,m),this.path(B),this.ctx.fillStyle=ni(a),this.ctx.fill(),s=sL(x,m),this.path(s),this.ctx.fill(),[2]}})})},o.prototype.renderNodeBackgroundAndBorders=function(a){return Hi(this,void 0,void 0,function(){var u,m,x,B,s,F,M,z,L=this;return wi(this,function(Q){switch(Q.label){case 0:return this.applyEffects(a.getEffects(2)),u=a.container.styles,m=!rA(u.backgroundColor)||u.backgroundImage.length,x=[{style:u.borderTopStyle,color:u.borderTopColor,width:u.borderTopWidth},{style:u.borderRightStyle,color:u.borderRightColor,width:u.borderRightWidth},{style:u.borderBottomStyle,color:u.borderBottomColor,width:u.borderBottomWidth},{style:u.borderLeftStyle,color:u.borderLeftColor,width:u.borderLeftWidth}],B=gL(Yl(u.backgroundClip,0),a.curves),m||u.boxShadow.length?(this.ctx.save(),this.path(B),this.ctx.clip(),rA(u.backgroundColor)||(this.ctx.fillStyle=ni(u.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(a.container)]):[3,2];case 1:Q.sent(),this.ctx.restore(),u.boxShadow.slice(0).reverse().forEach(function(V){L.ctx.save();var ie=Qp(a.curves),de=V.inset?0:fL,re=nL(ie,-de+(V.inset?1:-1)*V.spread.number,(V.inset?1:-1)*V.spread.number,V.spread.number*(V.inset?-2:2),V.spread.number*(V.inset?-2:2));V.inset?(L.path(ie),L.ctx.clip(),L.mask(re)):(L.mask(ie),L.ctx.clip(),L.path(re)),L.ctx.shadowOffsetX=V.offsetX.number+de,L.ctx.shadowOffsetY=V.offsetY.number,L.ctx.shadowColor=ni(V.color),L.ctx.shadowBlur=V.blur.number,L.ctx.fillStyle=V.inset?ni(V.color):"rgba(0,0,0,1)",L.ctx.fill(),L.ctx.restore()}),Q.label=2;case 2:s=0,F=0,M=x,Q.label=3;case 3:return F<M.length?(z=M[F],z.style!==0&&!rA(z.color)&&z.width>0?z.style!==2?[3,5]:[4,this.renderDashedDottedBorder(z.color,z.width,s,a.curves,2)]:[3,11]):[3,13];case 4:return Q.sent(),[3,11];case 5:return z.style!==3?[3,7]:[4,this.renderDashedDottedBorder(z.color,z.width,s,a.curves,3)];case 6:return Q.sent(),[3,11];case 7:return z.style!==4?[3,9]:[4,this.renderDoubleBorder(z.color,z.width,s,a.curves)];case 8:return Q.sent(),[3,11];case 9:return[4,this.renderSolidBorder(z.color,s,a.curves)];case 10:Q.sent(),Q.label=11;case 11:s++,Q.label=12;case 12:return F++,[3,3];case 13:return[2]}})})},o.prototype.renderDashedDottedBorder=function(a,u,m,x,B){return Hi(this,void 0,void 0,function(){var s,F,M,z,L,Q,V,ie,de,re,K,G,ne,oe,we,ge,we,ge;return wi(this,function(Ue){return this.ctx.save(),s=aL(x,m),F=UB(x,m),B===2&&(this.path(F),this.ctx.clip()),Lo(F[0])?(M=F[0].start.x,z=F[0].start.y):(M=F[0].x,z=F[0].y),Lo(F[1])?(L=F[1].end.x,Q=F[1].end.y):(L=F[1].x,Q=F[1].y),m===0||m===2?V=Math.abs(M-L):V=Math.abs(z-Q),this.ctx.beginPath(),B===3?this.formatPath(s):this.formatPath(F.slice(0,2)),ie=u<3?u*3:u*2,de=u<3?u*2:u,B===3&&(ie=u,de=u),re=!0,V<=ie*2?re=!1:V<=ie*2+de?(K=V/(2*ie+de),ie*=K,de*=K):(G=Math.floor((V+de)/(ie+de)),ne=(V-G*ie)/(G-1),oe=(V-(G+1)*ie)/G,de=oe<=0||Math.abs(de-ne)<Math.abs(de-oe)?ne:oe),re&&(B===3?this.ctx.setLineDash([0,ie+de]):this.ctx.setLineDash([ie,de])),B===3?(this.ctx.lineCap="round",this.ctx.lineWidth=u):this.ctx.lineWidth=u*2+1.1,this.ctx.strokeStyle=ni(a),this.ctx.stroke(),this.ctx.setLineDash([]),B===2&&(Lo(F[0])&&(we=F[3],ge=F[0],this.ctx.beginPath(),this.formatPath([new Tt(we.end.x,we.end.y),new Tt(ge.start.x,ge.start.y)]),this.ctx.stroke()),Lo(F[1])&&(we=F[1],ge=F[2],this.ctx.beginPath(),this.formatPath([new Tt(we.end.x,we.end.y),new Tt(ge.start.x,ge.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},o.prototype.render=function(a){return Hi(this,void 0,void 0,function(){var u;return wi(this,function(m){switch(m.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=ni(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),u=iL(a),[4,this.renderStack(u)];case 1:return m.sent(),this.applyEffects([]),[2,this.canvas]}})})},o}(TC),mL=function(t){return t instanceof hC||t instanceof uC?!0:t instanceof f0&&t.type!==Tp&&t.type!==Ip},gL=function(t,o){switch(t){case 0:return Qp(o);case 2:return JM(o);case 1:default:return Mp(o)}},yL=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},_L=["-apple-system","system-ui"],vL=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(o){return _L.indexOf(o)===-1}):t},xL=function(t){is(o,t);function o(a,u){var m=t.call(this,a,u)||this;return m.canvas=u.canvas?u.canvas:document.createElement("canvas"),m.ctx=m.canvas.getContext("2d"),m.options=u,m.canvas.width=Math.floor(u.width*u.scale),m.canvas.height=Math.floor(u.height*u.scale),m.canvas.style.width=u.width+"px",m.canvas.style.height=u.height+"px",m.ctx.scale(m.options.scale,m.options.scale),m.ctx.translate(-u.x,-u.y),m.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+u.width+"x"+u.height+" at "+u.x+","+u.y+") with scale "+u.scale),m}return o.prototype.render=function(a){return Hi(this,void 0,void 0,function(){var u,m;return wi(this,function(x){switch(x.label){case 0:return u=s_(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,a),[4,wL(u)];case 1:return m=x.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=ni(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(m,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},o}(TC),wL=function(t){return new Promise(function(o,a){var u=new Image;u.onload=function(){o(u)},u.onerror=a,u.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},BL=function(){function t(o){var a=o.id,u=o.enabled;this.id=a,this.enabled=u,this.start=Date.now()}return t.prototype.debug=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,gf([this.id,this.getTime()+"ms"],o)):this.info.apply(this,o))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,gf([this.id,this.getTime()+"ms"],o))},t.prototype.warn=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,gf([this.id,this.getTime()+"ms"],o)):this.info.apply(this,o))},t.prototype.error=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,gf([this.id,this.getTime()+"ms"],o)):this.info.apply(this,o))},t.instances={},t}(),bL=function(){function t(o,a){var u;this.windowBounds=a,this.instanceName="#"+t.instanceCount++,this.logger=new BL({id:this.instanceName,enabled:o.logging}),this.cache=(u=o.cache)!==null&&u!==void 0?u:new KM(this,o)}return t.instanceCount=1,t}(),CL=function(t,o){return o===void 0&&(o={}),EL(t,o)};typeof window<"u"&&BC.setContext(window);var EL=function(t,o){return Hi(void 0,void 0,void 0,function(){var a,u,m,x,B,s,F,M,z,L,Q,V,ie,de,re,K,G,ne,oe,we,Ue,ge,Ue,Ke,Me,et,qe,it,Xe,Ne,At,Et,It,Ut,Dt,Vt,Je,yt,ke,xt;return wi(this,function(Se){switch(Se.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(a=t.ownerDocument,!a)throw new Error("Element is not attached to a Document");if(u=a.defaultView,!u)throw new Error("Document is not attached to a Window");return m={allowTaint:(Ke=o.allowTaint)!==null&&Ke!==void 0?Ke:!1,imageTimeout:(Me=o.imageTimeout)!==null&&Me!==void 0?Me:15e3,proxy:o.proxy,useCORS:(et=o.useCORS)!==null&&et!==void 0?et:!1},x=Gy({logging:(qe=o.logging)!==null&&qe!==void 0?qe:!0,cache:o.cache},m),B={windowWidth:(it=o.windowWidth)!==null&&it!==void 0?it:u.innerWidth,windowHeight:(Xe=o.windowHeight)!==null&&Xe!==void 0?Xe:u.innerHeight,scrollX:(Ne=o.scrollX)!==null&&Ne!==void 0?Ne:u.pageXOffset,scrollY:(At=o.scrollY)!==null&&At!==void 0?At:u.pageYOffset},s=new oa(B.scrollX,B.scrollY,B.windowWidth,B.windowHeight),F=new bL(x,s),M=(Et=o.foreignObjectRendering)!==null&&Et!==void 0?Et:!1,z={allowTaint:(It=o.allowTaint)!==null&&It!==void 0?It:!1,onclone:o.onclone,ignoreElements:o.ignoreElements,inlineImages:M,copyStyles:M},F.logger.debug("Starting document clone with size "+s.width+"x"+s.height+" scrolled to "+-s.left+","+-s.top),L=new FB(F,t,z),Q=L.clonedReferenceElement,Q?[4,L.toIFrame(a,s)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return V=Se.sent(),ie=p0(Q)||FM(Q)?nT(Q.ownerDocument):$p(F,Q),de=ie.width,re=ie.height,K=ie.left,G=ie.top,ne=FL(F,Q,o.backgroundColor),oe={canvas:o.canvas,backgroundColor:ne,scale:(Dt=(Ut=o.scale)!==null&&Ut!==void 0?Ut:u.devicePixelRatio)!==null&&Dt!==void 0?Dt:1,x:((Vt=o.x)!==null&&Vt!==void 0?Vt:0)+K,y:((Je=o.y)!==null&&Je!==void 0?Je:0)+G,width:(yt=o.width)!==null&&yt!==void 0?yt:Math.ceil(de),height:(ke=o.height)!==null&&ke!==void 0?ke:Math.ceil(re)},M?(F.logger.debug("Document cloned, using foreign object rendering"),Ue=new xL(F,oe),[4,Ue.render(Q)]):[3,3];case 2:return we=Se.sent(),[3,5];case 3:return F.logger.debug("Document cloned, element located at "+K+","+G+" with size "+de+"x"+re+" using computed rendering"),F.logger.debug("Starting DOM parsing"),ge=pC(F,Q),ne===ge.styles.backgroundColor&&(ge.styles.backgroundColor=na.TRANSPARENT),F.logger.debug("Starting renderer for element at "+oe.x+","+oe.y+" with size "+oe.width+"x"+oe.height),Ue=new pL(F,oe),[4,Ue.render(ge)];case 4:we=Se.sent(),Se.label=5;case 5:return(!((xt=o.removeContainer)!==null&&xt!==void 0)||xt)&&(FB.destroy(V)||F.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),F.logger.debug("Finished rendering"),[2,we]}})})},FL=function(t,o,a){var u=o.ownerDocument,m=u.documentElement?ch(t,getComputedStyle(u.documentElement).backgroundColor):na.TRANSPARENT,x=u.body?ch(t,getComputedStyle(u.body).backgroundColor):na.TRANSPARENT,B=typeof a=="string"?ch(t,a):a===null?na.TRANSPARENT:4294967295;return o===u.documentElement?rA(m)?rA(x)?B:x:m:B};qf.accessToken="pk.eyJ1IjoiemV1bHplaWxvciIsImEiOiJjbDBncjJ4aHEwMDk4M2tubXI2ejJmeHJxIn0.saBJtqAJkMT9t-Oxbtu_QA";const IL=()=>{const t=Pa.useRef(null),[o,a]=Pa.useState(24),[u,m]=Pa.useState(45),[x,B]=Pa.useState(5),[s,F]=Pa.useState(0);Pa.useEffect(()=>{const V=new qf.Map({container:t.current,style:"mapbox://styles/mapbox/dark-v11",center:[o,u],zoom:x,pitch:0,projection:"mercator",preserveDrawingBuffer:!0}),ie=new MapboxDirections({accessToken:qf.accessToken,unit:"metric",profile:"mapbox/driving",controls:{instructions:!1,profileSwitcher:!1}});V.addControl(ie,"top-left"),ie.on("route",re=>{const K=rT.toGeoJSON(re.route[0].geometry),G=Date.now(),ne=re.route[0].distance/1e3;F(oe=>oe+ne),V.addSource(G.toString(),{type:"geojson",data:K}),V.addLayer({id:G.toString(),type:"line",source:G.toString(),layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"orange","line-width":5}})});const de=re=>{if(re.key==="Escape"){const K=document.querySelector(".mapbox-directions-component-keyline"),G=K.querySelector(".geocoder-pin-right .geocoder-icon-close.active");K.querySelector(".geocoder-pin-right .geocoder-icon-close").click(),G.click()}};return window.addEventListener("keydown",de),V.addControl(new qf.NavigationControl,"top-right"),V.on("move",()=>{a(V.getCenter().lng.toFixed(4)),m(V.getCenter().lat.toFixed(4)),B(V.getZoom().toFixed(2))}),()=>{window.removeEventListener("keydown",de),V.remove()}},[]);const M=async()=>{const V=new window.AudioContext,de=await(await fetch("/camera.mp3")).arrayBuffer(),re=await V.decodeAudioData(de),K=V.createBufferSource();K.buffer=re,K.connect(V.destination),K.start()},z=async()=>{t.current&&(L(),M(),CL(t.current).then(V=>{const ie=document.createElement("a");ie.href=V.toDataURL("image/png"),ie.download="map.png",ie.click(),Q()}))},L=()=>{document.querySelector(".mapbox-directions-inputs").style.display="none",document.querySelector(".mapboxgl-ctrl-top-right").style.display="none",document.querySelector(".mapboxgl-ctrl-logo").style.display="none",document.querySelector(".mapboxgl-ctrl-attrib").style.display="none"},Q=()=>{document.querySelector(".mapbox-directions-inputs").style.display="",document.querySelector(".mapboxgl-ctrl-top-right").style.display="",document.querySelector(".mapboxgl-ctrl-logo").style.display="",document.querySelector(".mapboxgl-ctrl-attrib").style.display=""};return Mo.createElement("div",null,Mo.createElement("div",{className:"sidebarStyle"},Mo.createElement("button",{onClick:z,style:{fontSize:"2rem"}},"")),Mo.createElement("div",{className:"sidebarStyle",style:{marginRight:"5rem"}},Mo.createElement("p",null,"Total Kilometers: ",Math.round(s))),Mo.createElement("p",{className:"disclaimer"},"Press ESC to clear old routes."),Mo.createElement("div",{className:"map-container",ref:t}))};function TL(){return Mo.createElement("div",null,Mo.createElement(IL,null))}JI.render(Mo.createElement(Mo.StrictMode,null,Mo.createElement(TL,null)),document.getElementById("root"));
